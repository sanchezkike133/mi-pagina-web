;/*FB_PKG_DELIM*/

__d("BlobFactory",["emptyFunction"],(function(t,n,r,o,a,i,l){var e;function s(){try{new t.Blob,e=!0}catch(t){e=!1}}var u=t.BlobBuilder||t.WebKitBlobBuilder||t.MozBlobBuilder||t.MSBlobBuilder,c=t.Blob?{getBlob:function(r,o){if(r=r||[],o=o||{},e===void 0&&s(),e)return new t.Blob(r,o);for(var n=new u,a=0;a<r.length;a++)n.append(r[a]);return n.getBlob(o.type)},isSupported:r("emptyFunction").thatReturnsTrue}:{getBlob:function(t,n){},isSupported:r("emptyFunction").thatReturnsFalse},d=c;l.default=d}),98);
__d("ErrorMetadata",["fb-error"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(e){function t(){return e.apply(this,arguments)||this}return babelHelpers.inheritsLoose(t,e),t.addGlobalMetadata=function(n,r,o){e.addGlobalMetadata.call(this,n,r,o)},t})(r("fb-error").ErrorMetadata);l.default=e}),98);
__d("WAEncodeString",["WATextEncoding"],(function(t,n,r,o,a,i,l){"use strict";var e=o("WATextEncoding").newTextEncoder();function s(t){return e.encode(t)}l.toUtf8=s}),98);
__d("P2XFunnelIdGenerator",["WABase64","WACryptoHmac","WAEncodeString","WAWebUserPrefsMultiDevice","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(){function e(e,t){this.$1=e,this.$2=t}var t=e.prototype;return t.genFunnelInfo=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=yield o("WAWebUserPrefsMultiDevice").getChatThreadLoggingSecretB64();return e==null||e.trim().length===0?{funnel_id:"",is_logging_secret_available:!1}:{funnel_id:o("WABase64").encodeB64(yield o("WACryptoHmac").hmacSha256(o("WAEncodeString").toUtf8(e+this.$1),o("WAEncodeString").toUtf8(this.$2))),is_logging_secret_available:!0}});function t(){return e.apply(this,arguments)}return t})(),e})();l.P2XFunnelIdGenerator=e}),98);
__d("WAWebMerchantCommerceEventWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumBizPlatform"],(function(t,n,r,o,a,i,l){var e,s=(e=o("WAWebWamCodegenUtils")).defineEvents({MerchantCommerceEvent:[4688,{acceptedPaymentMethods:[1,e.TYPES.STRING],adId:[2,e.TYPES.STRING],appSessionId:[3,e.TYPES.STRING],bizPlatform:[4,o("WAWebWamEnumBizPlatform").BIZ_PLATFORM],commerceExperience:[6,e.TYPES.STRING],commerceFlowId:[20,e.TYPES.STRING],commerceInteractionAction:[7,e.TYPES.STRING],commerceInteractionActionType:[21,e.TYPES.STRING],commerceOrderStatus:[22,e.TYPES.STRING],commercePaymentStatus:[8,e.TYPES.STRING],commerceSessionId:[9,e.TYPES.STRING],commerceSurface:[10,e.TYPES.STRING],extraAttributes:[11,e.TYPES.STRING],isCtwaOriginated:[12,e.TYPES.BOOLEAN],isEligibleForAdSignal:[13,e.TYPES.BOOLEAN],merchantHasCatalog:[14,e.TYPES.BOOLEAN],merchantIsDiscoverable:[15,e.TYPES.BOOLEAN],p2mFlow:[17,e.TYPES.STRING],referral:[18,e.TYPES.STRING],sequenceId:[19,e.TYPES.INTEGER]},[1,1,1],"regular"]},{MerchantCommerceEvent:[]});l.MerchantCommerceEventWamEvent=s}),98);
__d("WAWebPsStructuredMessageInteractionWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumBizPlatform","WAWebWamEnumInteractionType","WAWebWamEnumMediaType","WAWebWamEnumStructuredMessageClass"],(function(t,n,r,o,a,i,l){var e,s=(e=o("WAWebWamCodegenUtils")).defineEvents({PsStructuredMessageInteraction:[3052,{bizPlatform:[1,o("WAWebWamEnumBizPlatform").BIZ_PLATFORM],businessOwnerJid:[7,e.TYPES.STRING],messageClass:[3,o("WAWebWamEnumStructuredMessageClass").STRUCTURED_MESSAGE_CLASS],messageClassAttributes:[5,e.TYPES.STRING],messageInteraction:[4,o("WAWebWamEnumInteractionType").INTERACTION_TYPE],messageMediaType:[2,o("WAWebWamEnumMediaType").MEDIA_TYPE],templateId:[8,e.TYPES.STRING],threadIdHmac:[9,e.TYPES.STRING]},[1,1,1],"private",0]},{PsStructuredMessageInteraction:[]});l.PsStructuredMessageInteractionWamEvent=s}),98);
__d("PaymentLinkWamLogger",["$InternalEnum","P2XFunnelIdGenerator","PaymentLink","WAWebABProps","WAWebChatGetters","WAWebLinkify","WAWebMerchantCommerceEventWamEvent","WAWebMobilePlatforms","WAWebMsgGetters","WAWebProtobufsE2E.pb","WAWebPsStructuredMessageInteractionWamEvent","WAWebStructuredMessageReceiveWamEvent","WAWebUserPrefsGeneral","WAWebUserPrefsMeUser","WAWebWamEnumBizPlatform","WAWebWamEnumInteractionType","WAWebWamEnumStructuredMessageClass","WAWebWamMsgUtils","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){"use strict";var e="receiver_log_key",s={CTA:"payment_link",P2M_FLOW:"PAYMENT_LINK"},u={INTERACTION_ACTION:"send_payment_link",INTERACTION_SURFACE:"chat",REFERRAL:"composer",COMMERCE_EXPERIENCE:"non_native",P2M_FLOW:"payment_link",ACCEPTED_PAYMENT_METHOD:"payment_link"},c=n("$InternalEnum")({NOT_STARTED:"not_started",STARTED:"started",COMPLETED:"completed"}),d=n("$InternalEnum")({INDIVIDUAL:"individual",GROUP:"group",BROADCAST:"broadcast",NEWSLETTER:"newsletter"}),m=n("$InternalEnum")({LINK:"link",LINK_PREVIEW:"link_preview",LINK_CTA:"link_cta",UNKNOWN:"unknown"});function p(e){var t,n,r,a=o("WAWebMsgGetters").getPaymentLinkMetadata(e),i=(a==null||(t=a.provider)==null?void 0:t.paramsJson)!=null?(n=JSON.parse(a==null||(r=a.provider)==null?void 0:r.paramsJson))==null?void 0:n.name:null;return i}function _(e){if(o("WAWebMsgGetters").getIsSentByMe(e))return!1;if(o("WAWebMsgGetters").getRichPreviewType(e)===o("WAWebProtobufsE2E.pb").Message$ExtendedTextMessage$PreviewType.PAYMENT_LINKS)return o("WAWebABProps").getABPropConfigValue("smb_payment_links_logging_enabled");var t=p(e);return t==null?!1:o("WAWebABProps").getABPropConfigValue("smb_payment_links_logging_enabled")}function f(e){return g.apply(this,arguments)}function g(){return g=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var n=new(o("P2XFunnelIdGenerator")).P2XFunnelIdGenerator(e,t.id.id+t.to.toJid());return n.genFunnelInfo()}),g.apply(this,arguments)}function h(e,t){return y.apply(this,arguments)}function y(){return y=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=p(e.msg),r=n!=null?n:t!=null?o("PaymentLink").getPSP(t):null,a=yield f(e.msg),i=C(e.msg,E(e.msg),a.funnel_id,a.is_logging_secret_available,r,n!=null),l=new(o("WAWebStructuredMessageReceiveWamEvent")).StructuredMessageReceiveWamEvent(babelHelpers.extends({},i,{messageClassAttributes:JSON.stringify(babelHelpers.extends({},i.messageClassAttributes))},x(e.msg)&&{businessOwnerJid:D(e)}));l.commit()}),y.apply(this,arguments)}function C(e,t,n,r,a,i){var l=b(e,t,n,r,a,i);return{bizPlatform:o("WAWebWamEnumBizPlatform").BIZ_PLATFORM.SMB,messageClass:o("WAWebWamEnumStructuredMessageClass").STRUCTURED_MESSAGE_CLASS.HSM,messageClassAttributes:l,messageMediaType:o("WAWebWamMsgUtils").getWamMediaType(e)}}function b(e,t,n,r,a,i){var l={funnel_id:n,is_logging_secret_available:r,cta:s.CTA,p2m_flow:s.P2M_FLOW,chat_type:t,has_link_preview:o("WAWebMsgGetters").getRichPreviewType(e)===o("WAWebProtobufsE2E.pb").Message$ExtendedTextMessage$PreviewType.PAYMENT_LINKS,is_payment_provider_in_metadata:i,is_forwarded:o("WAWebMsgGetters").getIsForwarded(e),is_edited:o("WAWebMsgGetters").getIsEdited(e)};return l=v(e,l),l=S(l,a),l=R(e,l),o("WAWebABProps").getABPropConfigValue("payment_link_trace_id_logging_enabled")&&(l=L(e,l)),l}function v(e,t){var n=$(e.paymentLinkMetadata);return babelHelpers.extends({},t,n!=null&&{cta_variant:n})}function S(e,t){return babelHelpers.extends({},e,t!=null&&{payment_provider:t})}function R(e,t){var n,r=o("WAWebMsgGetters").getPaymentLinkMetadata(e),a=z(r==null||(n=r.provider)==null?void 0:n.paramsJson);return babelHelpers.extends({},t,a!=null&&{metatags:a})}function L(e,t){var n,r=o("WAWebMsgGetters").getPaymentLinkMetadata(e),a=j(r==null||(n=r.provider)==null?void 0:n.paramsJson);return a==null||a===""?t:babelHelpers.extends({},t,{payment_link_trace_id:a})}function E(e){return k(e)?d.GROUP:I(e)?d.BROADCAST:T(e)?d.NEWSLETTER:d.INDIVIDUAL}function k(e){var t,n=e.from;return(t=n==null?void 0:n.isGroup())!=null?t:!1}function I(e){var t,n;return(t=(n=e.broadcastId)==null?void 0:n.isBroadcast())!=null?t:!1}function T(e){var t,n=e.from;return(t=n==null?void 0:n.isNewsletter())!=null?t:!1}function D(e){var t;if(e.interaction_component==null){var n;return(n=o("WAWebMsgGetters").getSender(e.msg))==null?void 0:n.toJid()}return(t=e.msg.senderObj)==null?void 0:t.id.toJid()}function x(e){var t;if(!o("WAWebABProps").getABPropConfigValue("payment_link_trace_id_logging_enabled"))return!0;var n=o("WAWebMsgGetters").getPaymentLinkMetadata(e),r=j(n==null||(t=n.provider)==null?void 0:t.paramsJson);return!(r!=null&&r!==""&&o("WAWebMsgGetters").getIsForwarded(e))}function $(e){var t,n;return(e==null||(t=e.header)==null?void 0:t.headerType)!=null?o("WAWebProtobufsE2E.pb").Message$PaymentLinkMetadata$PaymentLinkHeader$PaymentLinkHeaderType.getName(e==null||(n=e.header)==null?void 0:n.headerType).toLowerCase():null}function P(e,t){return N.apply(this,arguments)}function N(){return N=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=yield M(e,t,E(e.msg)),r=new(o("WAWebPsStructuredMessageInteractionWamEvent")).PsStructuredMessageInteractionWamEvent(babelHelpers.extends({},n,{messageClassAttributes:JSON.stringify(babelHelpers.extends({},n.messageClassAttributes))},x(e.msg)&&{businessOwnerJid:D(e)},{messageInteraction:o("WAWebWamEnumInteractionType").INTERACTION_TYPE.USER_PAY_NOW}));r.commit()}),N.apply(this,arguments)}function M(e,t,n){return w.apply(this,arguments)}function w(){return w=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n){var r,o=p(e.msg),a=o!=null?o:t,i=yield f(e.msg),l=C(e.msg,n,i.funnel_id,i.is_logging_secret_available,a,o!=null);return babelHelpers.extends({},l,{messageClassAttributes:babelHelpers.extends({},l.messageClassAttributes,{interaction_component:(r=e.interaction_component)!=null?r:m.UNKNOWN})})}),w.apply(this,arguments)}function A(){return o("WAWebMobilePlatforms").isSMB()&&o("WAWebABProps").getABPropConfigValue("smb_payment_links_seller_logging_enabled")}function F(e,t,n,r,o,a,i){return O.apply(this,arguments)}function O(){return O=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n,r,a,i,l){var s=o("WAWebLinkify").findLinks(e,!1,o("WAWebUserPrefsMeUser").getMeDevicePnOrThrow()),u=U(s,t,n,r,i,l);u&&B(a,u)}),O.apply(this,arguments)}function B(e,t){var n=new(o("WAWebMerchantCommerceEventWamEvent")).MerchantCommerceEventWamEvent({bizPlatform:o("WAWebWamEnumBizPlatform").BIZ_PLATFORM.SMB,commerceInteractionAction:u.INTERACTION_ACTION,commerceSurface:u.INTERACTION_SURFACE,referral:u.REFERRAL,commerceExperience:u.COMMERCE_EXPERIENCE,p2mFlow:u.P2M_FLOW,acceptedPaymentMethods:u.ACCEPTED_PAYMENT_METHOD,isEligibleForAdSignal:!1,merchantHasCatalog:e,extraAttributes:JSON.stringify(t)});n.commit()}function W(e){return o("WAWebChatGetters").getIsGroup(e)?d.GROUP:o("WAWebChatGetters").getIsBroadcast(e)?d.BROADCAST:o("WAWebChatGetters").getIsNewsletter(e)?d.NEWSLETTER:d.INDIVIDUAL}function q(e){if(o("WAWebChatGetters").getIsGroup(e))return e.getParticipantCount();if(o("WAWebChatGetters").getIsNewsletter(e)){var t,n;return(t=(n=e.newsletterMetadata)==null?void 0:n.size)!=null?t:1}return 1}function U(e,t,n,r,a,i){var l,s,u,c,d=e.map(function(e){return o("PaymentLink").getPSP(e.url)}).filter(function(e){return e!=null});if(d.length<=0)return null;var m=Array.from(new Set(d)),p=o("WAWebUserPrefsGeneral").getUserPrivacySettings(),_=p.disableLinkPreviews,f={url_preview_cancelled:t,url_preview_enabled:!_,url_preview_loaded:n!=null||t,payment_provider:m.toString(),rich_preview_type:(l=n==null||(s=n.data)==null?void 0:s.richPreviewType)!=null?l:o("WAWebProtobufsE2E.pb").Message$ExtendedTextMessage$PreviewType.NONE,does_preview_have_thumbnail:!K(n==null||(u=n.data)==null?void 0:u.thumbnail)||!K(n==null||(c=n.data)==null?void 0:c.thumbnailHQ),number_of_payment_links:d.length,number_of_links:e.length,link_preview_status:r,is_first_http_url_a_payment_link:Q(e),chat_participant_count:q(a),chat_type:W(a)};return f=V(f,i),f=H(f,i),o("WAWebABProps").getABPropConfigValue("payment_link_trace_id_logging_enabled")&&(f=G(f,i)),f}function V(e,t){var n=$(t);return babelHelpers.extends({},e,n!=null&&{cta_variant:n})}function H(e,t){var n,r=z(t==null||(n=t.provider)==null?void 0:n.paramsJson);return babelHelpers.extends({},e,r!=null&&{metatags:r})}function G(e,t){var n,r=j(t==null||(n=t.provider)==null?void 0:n.paramsJson);return r==null||r===""?e:babelHelpers.extends({},e,{payment_link_trace_id:r})}function z(e){try{var t,n=e==null?null:JSON.parse(e);if(n==null)return null;var r=n==null?void 0:n.meta_tags;if(r==null)return null;var o=null;r.is_business_verified!=null&&(o=babelHelpers.extends({},o,{is_business_verified:r.is_business_verified===!0}));var a=(t=r.provider_name)==null?void 0:t.trim();return a!=null&&(o=babelHelpers.extends({},o,{is_psp_name_available:a.length>0})),o}catch(e){return null}}function j(e){if(e==null||e==="")return null;try{var t=JSON.parse(e);return t.payment_link_trace_id}catch(e){return null}}function K(e){return e==null||e.trim().length===0}function Q(e){for(var t of e)if(t&&t.isHttp)return o("PaymentLink").getPSP(t.url)!=null;return!1}l.LinkPreviewStatus=c,l.ClickInteractionComponent=m,l.shouldLogReceiverEvent=_,l.genReceiverEventFunnelInfo=f,l.genLogReceiveEvent=h,l.genLogClickEvent=P,l.shouldLogSendEvent=A,l.genLogSendEventIfPaymentLink=F}),98);
__d("QPLUserFlow",["ErrorMetadata","ErrorPubSub","QuickPerformanceLogger","cr:1752405","justknobx","performance"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u;function c(e,t){if(t===null)return e!=null?e:null;var n=e!=null?e:{};return n.string||(n.string={}),n.string.uf_debug_info=t,n}var d=1024;function m(e){var t=String(e);return t.length>d?t.substring(0,d-3)+"...":t}var p=(function(){function t(){var t=this;n("cr:1752405")(),(e||(e=r("ErrorPubSub"))).unshiftListener(function(e){if(e.type==="fatal"){var n=t.getActiveFlowIDs();if(n.length!==0){var o=new(r("ErrorMetadata"));o.clearEntries(),r("justknobx")._("3809")&&n.forEach(function(n){(s||(s=r("QuickPerformanceLogger"))).forEachMarkerInstance(n,function(n,r){t.addPoint(r,"JAVASCRIPT_ERROR_THROWN",{data:{string:{logging_source:e.loggingSource,message_format:m(e.messageFormat),type:e.type},string_array:{message_params:e.messageParams.map(m)}},instanceKey:n})})}),n.forEach(function(e){o.addEntry("QPL","ACTIVE_FLOW_ID",e.toString())});var a=o.format();e.metadata?e.metadata=[].concat(e.metadata,a):e.metadata=a}}})}var o=t.prototype;return o.start=function(t,n){var e=n===void 0?{}:n,o=e.instanceKey,a=o===void 0?0:o,i=e.annotations,l=e.cancelExisting,u=l===void 0?!1:l,c=e.cancelOnUnload,d=c===void 0?!0:c,m=e.timestamp,p=e.trackedForLoss,_=p===void 0?!0:p,f=e.joinOptions,g=e.timeoutInMs,h=e.onFlowTimeout,y=e.qplInternalDoNotUseAbsoluteTimeOrigin,C=e.enableE2ETracing,b=C===void 0?!1:C;f!=null?(s||(s=r("QuickPerformanceLogger"))).markerStartForJoin(t,f.joinId,{instanceKey:a,cancelExisting:u,cancelOnUnload:d,trackedForLoss:_,type:2,qplInternalDoNotUseAbsoluteTimeOrigin:y,monotonicTimestamp:m,absoluteTimeOriginMs:f.absoluteTimeOriginMs,sourceIsPrimary:f.sourceIsPrimary,closeSession:f.closeSession,unreliableSourceClockProcessId:f.unreliableSourceClockProcessId,timeoutMS:g,onMarkerTimeout__DoNotUse:h,crashResilient:!0}):(s||(s=r("QuickPerformanceLogger"))).markerStart(t,a,m,{cancelExisting:u,cancelOnUnload:d,trackedForLoss:_,type:2,qplInternalDoNotUseAbsoluteTimeOrigin:y,timeoutMS:g,onMarkerTimeout__DoNotUse:h,enableE2ETracing:b,crashResilient:!0}),i&&(s||(s=r("QuickPerformanceLogger"))).markerAnnotate(t,i,{instanceKey:a})},o.addAlignmentPointForJoin=function(t,n,o){var e=o===void 0?{}:o,a=e.instanceKey,i=e.requestId,l=e.timestamp;(s||(s=r("QuickPerformanceLogger"))).addAlignmentPointForJoin(t,n,{instanceKey:a,requestId:i,timestamp:l})},o.startFromNavStart=function(t,n){var e=n===void 0?{}:n,o=e.instanceKey,a=o===void 0?0:o,i=e.annotations,l=e.cancelExisting,c=l===void 0?!1:l,d=e.cancelOnUnload,m=d===void 0?!0:d,p=e.trackedForLoss,_=p===void 0?!0:p,f=e.joinOptions,g=e.timeoutInMs,h=e.onFlowTimeout,y=e.qplInternalDoNotUseConvertToTimeOnServer;if(f!=null?(s||(s=r("QuickPerformanceLogger"))).markerStartForJoinFromNavStart(t,f.joinId,{instanceKey:a,cancelExisting:c,cancelOnUnload:m,trackedForLoss:_,type:2,qplInternalDoNotUseConvertToTimeOnServer:y,absoluteTimeOriginMs:f.absoluteTimeOriginMs,sourceIsPrimary:f.sourceIsPrimary,closeSession:f.closeSession,unreliableSourceClockProcessId:f.unreliableSourceClockProcessId,timeoutMS:g,onMarkerTimeout__DoNotUse:h,crashResilient:!0}):(s||(s=r("QuickPerformanceLogger"))).markerStartFromNavStart(t,a,{cancelExisting:c,cancelOnUnload:m,trackedForLoss:_,type:2,qplInternalDoNotUseConvertToTimeOnServer:y,timeoutMS:g,onMarkerTimeout__DoNotUse:h,crashResilient:!0}),i&&(s||(s=r("QuickPerformanceLogger"))).markerAnnotate(t,i,{instanceKey:a}),(f==null?void 0:f.addAlignmentPoints)===!0){var C,b=(C=f==null?void 0:f.requestId)!=null?C:"default_id",v=(u||(u=r("performance")))==null?void 0:(u||(u=r("performance"))).timing.requestStart;v!=null&&this.addAlignmentPointForJoin(t,0,{instanceKey:a,requestId:b,timestamp:v});var S=(u||(u=r("performance")))==null?void 0:(u||(u=r("performance"))).timing.responseEnd;S!=null&&this.addAlignmentPointForJoin(t,3,{instanceKey:a,requestId:b,timestamp:S})}},o.endSuccess=function(t,n){var e=n===void 0?{}:n,r=e.instanceKey,o=r===void 0?0:r,a=e.annotations,i=e.timestamp,l=e.partialCompleteForFurtherJoin,s=l===void 0?!1:l;this.$1(t,s===!0?12524:2,o,a,i)},o.endFailure=function(t,n,r){var e=r===void 0?{}:r,o=e.instanceKey,a=o===void 0?0:o,i=e.debugInfo,l=e.annotations,s=e.timestamp,u=e.error;this.markError(t,n,{debugInfo:i,instanceKey:a,error:u}),this.$1(t,3,a,l,s)},o.endValidationFailure_DO_NOT_USE=function(t,n){var e=n===void 0?{}:n,r=e.instanceKey,o=r===void 0?0:r,a=e.debugInfo,i=e.annotations,l=e.timestamp;this.markError(t,"validation_failed",{debugInfo:a,instanceKey:o}),this.$1(t,7952,o,i,l)},o.endTimeout=function(t,n){var e=n===void 0?{}:n,o=e.instanceKey,a=o===void 0?0:o,i=e.annotations,l=e.timestamp,u=l===void 0?(s||(s=r("QuickPerformanceLogger"))).currentTimestamp():l;this.$1(t,113,a,i,u)},o.endCancel=function(t,n){var e=n===void 0?{}:n,r=e.instanceKey,o=r===void 0?0:r,a=e.cancelReason,i=a===void 0?4:a,l=e.annotations,s=e.timestamp;this.$1(t,i,o,l,s)},o.$1=function(t,n,o,a,i){i===void 0&&(i=(s||(s=r("QuickPerformanceLogger"))).currentTimestamp()),a&&(s||(s=r("QuickPerformanceLogger"))).markerAnnotate(t,a,{instanceKey:o}),(s||(s=r("QuickPerformanceLogger"))).markerEnd(t,n,o,i)},o.addAnnotations=function(t,n,o){var e=o===void 0?{}:o,a=e.instanceKey;(s||(s=r("QuickPerformanceLogger"))).markerAnnotate(t,n,{instanceKey:a})},o.addPoint=function(t,n,o){var e=o===void 0?{}:o,a=e.instanceKey,i=e.debugInfo,l=e.data,u=e.timestamp,d=c(l,i!=null?i:null);(s||(s=r("QuickPerformanceLogger"))).markerPoint(t,n,{data:d,instanceKey:a,timestamp:u})},o.markError=function(t,n,o){var e,a=o===void 0?{}:o,i=a.debugInfo,l=a.instanceKey,u=a.error;(s||(s=r("QuickPerformanceLogger"))).markerAnnotate(t,babelHelpers.extends({},this.$2(u),{bool:(e={},e.uf_has_error=!0,e)}),{instanceKey:l}),this.addPoint(t,n,{debugInfo:i,instanceKey:l})},o.storeBeforeNavigation=function(t,n){var e=n===void 0?{}:n,o=e.instanceKey,a=o===void 0?0:o;(s||(s=r("QuickPerformanceLogger"))).markerStoreBeforeNavigation(t,{instanceKey:a})},o.getActiveFlowIDs=function(){return(s||(s=r("QuickPerformanceLogger"))).getActiveMarkerIds({type:2})},o.$2=function(t){var e,n;if(t==null)return{};var r={int:{},string:{}};r.string.uf_error_name=t.name;var o=t;if((o==null||(e=o.source)==null?void 0:e.code)!=null&&(r.int.uf_graphql_error_code=o==null?void 0:o.source.code),(o==null||(n=o.source)==null||(n=n.exception)==null?void 0:n.class)!=null){var a;r.string.uf_graphql_exception_class=o==null||(a=o.source)==null||(a=a.exception)==null?void 0:a.class}return r},t})(),_=new p;l.default=_}),98);
__d("SubscriptionsHandler",["invariant"],(function(t,n,r,o,a,i,l,s){"use strict";var e=["remove","reset","unsubscribe","cancel","dispose"];function u(t){for(var n of e)if(typeof t[n]=="function")return t[n]}function c(e){var t;(t=u(e))==null||t.call(e)}var d=(function(){function e(){this.$1=[]}var t=e.prototype;return t.addSubscriptions=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];t.every(u)||s(0,3659),this.$1!=null?this.$1=this.$1.concat(t):t.forEach(c)},t.engage=function(){this.$1==null&&(this.$1=[])},t.release=function(){this.$1!=null&&(this.$1.forEach(c),this.$1=null)},t.releaseOne=function(t){var e=this.$1;if(e!=null){var n=e.indexOf(t);n!==-1&&(c(t),e.splice(n,1),e.length===0&&(this.$1=null))}},e})();l.default=d}),98);
__d("VideoTranscodeUtils",[],(function(t,n,r,o,a,i){"use strict";function e(e){return""+l(e).toFixed(2)}function l(e){return e/1024/1024}function s(e){var t,n,r,o,a,i,l,s,u,c,d=e.maybeTranscodeResponse,m=e.metadata,p=e.eventFlow,_=d!=null?d:{success:!1,error:{errorMessage:"No transcode response",errorType:"did-not-run"}};p.addAnnotations({bool:{did_transcode:_.success},int:{audio_number_of_channels:m==null||(t=m.audioInfo)==null?void 0:t.numberOfChannels,audio_sample_rate:m==null||(n=m.audioInfo)==null?void 0:n.samplingRate,duration_s:m==null||(r=m.videoInfo)==null?void 0:r.duration,metadata_latency_ms:m==null?void 0:m.metadataLatency,transcode_latency_ms:_.success?(o=_.value)==null?void 0:o.transcodeLatency:void 0,video_avg_bitrate:m==null||(a=m.videoInfo)==null?void 0:a.averageBitrate,video_fps:m==null||(i=m.videoInfo)==null?void 0:i.calculatedFps,video_height:m==null||(l=m.videoInfo)==null?void 0:l.videoHeight,video_width:m==null||(s=m.videoInfo)==null?void 0:s.videoWidth},string:{audio_codec:m==null||(u=m.audioInfo)==null?void 0:u.codec,transcode_error_message:_.success===!1?_.error.errorMessage:void 0,transcode_error_type:_.success===!1?_.error.errorType:void 0,video_codec:m==null||(c=m.videoInfo)==null?void 0:c.codec}})}i.bytesToMegaBytesString=e,i.annotateTranscodeReponse=s}),66);
__d("WAWamPrivateStatsToken",["WACryptoEd25519","WACryptoPrimitives"],(function(t,n,r,o,a,i,l){"use strict";function e(e,t){return o("WACryptoEd25519").runInAllocationScope(function(){var n,r=(n=o("WACryptoEd25519")).p3Element(),a=n.allocate(Uint8Array,32);a.set(t),u(a),o("WACryptoPrimitives").lowlevel.scalarbase(r,a);var i=n.hashToPoint(e),l=o("WACryptoPrimitives").lowlevel.add;l(i,r);var s=new Uint8Array(32);return n.pack(s,i),s})}function s(e,t,n){return o("WACryptoEd25519").runInAllocationScope(function(){var r=o("WACryptoEd25519").p3Element();if(o("WACryptoEd25519").unpack(r,e))return null;var a=o("WACryptoEd25519").p3Element();if(o("WACryptoEd25519").unpackneg(a,n)!==0)return null;var i=o("WACryptoEd25519").allocate(Uint8Array,32);i.set(t),u(i);var l=o("WACryptoEd25519").p3Element();o("WACryptoPrimitives").lowlevel.scalarmult(l,a,i);var s=o("WACryptoPrimitives").lowlevel.add;s(r,l);var c=new Uint8Array(32);return o("WACryptoEd25519").pack(c,r),c})}function u(e){e[0]&=248,e[31]&=127,e[31]|=64}l.blindToken=e,l.unblindToken=s}),98);
__d("WAACSTokenUtils",["WABinary","WACryptoDependencies","WACryptoPrimitives","WAWamPrivateStatsToken"],(function(t,n,r,o,a,i,l){"use strict";function e(){var e=new Uint8Array(32);o("WACryptoDependencies").getCrypto().getRandomValues(e);var t=new Uint8Array(32);o("WACryptoDependencies").getCrypto().getRandomValues(t);var n=o("WAWamPrivateStatsToken").blindToken(e,t);return{blindedToken:n,blindingFactor:t,token:e}}function s(e){var t=e.token,n=e.unblindedSignedToken,r=o("WABinary").Binary.build(t,n);return o("WACryptoPrimitives").hash(r.readByteArrayView())}l.getBlindedToken=e,l.getSharedSecret=s}),98);
__d("WAAlignChunkLengthsToMultipleOfAesBlockSize",[],(function(t,n,r,o,a,i){"use strict";function e(e){return parseInt((e+15)/16,10)*16}function l(t,n){for(var r=[],o=0,a=0,i=0,l=0;l<t.length;++l)if(o+=t[l],l===t.length-1&&n!=null&&n>0){o>a?r.push(n-a):(r.pop(),r.push(n-i));break}else if(o>a){var s=e(o-a);i=a,r.push(s),a+=s}return r}i.alignChunkSizeToMultipleAesBlockSize=e,i.alignChunkLengthsToMultipleOfAesBlockSize=l}),66);
__d("WABase64UrlSafe",[],(function(t,n,r,o,a,i){"use strict";function e(e){return e.replace(/\//g,"_").replace(/\+/g,"-")}function l(e){return e.replace(/-/g,"+").replace(/_/g,"/")}function s(e){for(var t=atob(e),n=t.length,r=new Uint8Array(new ArrayBuffer(n)),o=0;o<n;o++)r[o]=t.charCodeAt(o);return r}i.urlSafeBase64=e,i.urlSafeBase64ToStandard=l,i.getBytesFromBase64=s}),66);
__d("WABlobToArrayBuffer",["Promise","err"],(function(t,n,r,o,a,i,l){"use strict";var e;function s(t){return"arrayBuffer"in t&&typeof t.arrayBuffer=="function"?t.arrayBuffer():new(e||(e=n("Promise")))(function(e,n){var o=new FileReader;o.onload=function(){var t=o.result;t instanceof ArrayBuffer?e(t):n(r("err")("blobToArrayBuffer got error because result is not ArrayBuffer: "+typeof t))},o.onerror=function(){var e;n((e=o.error)!=null?e:r("err")("blobToArrayBuffer got unknown error"))},o.readAsArrayBuffer(t)})}l.blobToArrayBuffer=s}),98);
__d("WACert.pb",["WAProtoConst"],(function(t,n,r,o,a,i,l){var e,s={},u={},c={},d={},m={};s.name="NoiseCertificate",s.internalSpec={details:[1,(e=o("WAProtoConst")).TYPES.BYTES],signature:[2,e.TYPES.BYTES]},u.name="NoiseCertificate$Details",u.internalSpec={serial:[1,e.TYPES.UINT32],issuer:[2,e.TYPES.STRING],expires:[3,e.TYPES.UINT64],subject:[4,e.TYPES.STRING],key:[5,e.TYPES.BYTES]},c.name="CertChain",c.internalSpec={leaf:[1,e.TYPES.MESSAGE,d],intermediate:[2,e.TYPES.MESSAGE,d]},d.name="CertChain$NoiseCertificate",d.internalSpec={details:[1,e.TYPES.BYTES],signature:[2,e.TYPES.BYTES]},m.name="CertChain$NoiseCertificate$Details",m.internalSpec={serial:[1,e.TYPES.UINT32],issuerSerial:[2,e.TYPES.UINT32],key:[3,e.TYPES.BYTES],notBefore:[4,e.TYPES.UINT64],notAfter:[5,e.TYPES.UINT64]},l.NoiseCertificateSpec=s,l.NoiseCertificate$DetailsSpec=u,l.CertChainSpec=c,l.CertChain$NoiseCertificateSpec=d,l.CertChain$NoiseCertificate$DetailsSpec=m}),98);
__d("WAHandleChatStateProtocol",[],(function(t,n,r,o,a,i){"use strict";function e(e){var t;return e.name==="Paused"?t="idle":(e.name,t=e.value.composingMedia==="audio"?"recording_audio":"typing"),t}i.parseChatStatus=e}),66);
__d("WASmaxInChatstateInternalTestMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").flattenedChildWithTag(e,"test");if(!t.success)return t;var n=o("WASmaxParseUtils").optional(o("WASmaxParseUtils").attrString,t.value,"config");return n.success?o("WAResultOrError").makeResult({testConfig:n.value}):n}l.parseInternalTestMixin=e}),98);
__d("WASmaxInChatstateEnums",["WAJids"],(function(t,n,r,o,a,i,l){var e,s={validators:[(e=o("WAJids")).validateUserJid,e.validateUserJid,e.validateUserJid],typeName:"UserJid|UserJid|UserJid"},u={validators:[e.validateUserJid,e.validateUserJid,e.validateUserJid,e.validateUserJid],typeName:"UserJid|UserJid|UserJid|UserJid"};l.USERJID_USERJID_USERJID=s,l.USERJID_USERJID_USERJID_USERJID=u}),98);
__d("WASmaxInChatstateFromGroupMixin",["WAResultOrError","WASmaxInChatstateEnums","WASmaxParseJid","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"chatstate");if(!t.success)return t;var n=o("WASmaxParseJid").attrGroupJid(e,"from");if(!n.success)return n;var r=o("WASmaxParseJid").attrJidEnum(e,"participant",o("WASmaxInChatstateEnums").USERJID_USERJID_USERJID);if(!r.success)return r;var a=o("WASmaxParseUtils").optional(o("WASmaxParseJid").attrUserJid,e,"participant_pn");return a.success?o("WAResultOrError").makeResult({from:n.value,participant:r.value,participantPn:a.value}):a}l.parseFromGroupMixin=e}),98);
__d("WASmaxInChatstateFromUserMixin",["WAResultOrError","WASmaxInChatstateEnums","WASmaxParseJid","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"chatstate");if(!t.success)return t;var n=o("WASmaxParseJid").attrJidEnum(e,"from",o("WASmaxInChatstateEnums").USERJID_USERJID_USERJID_USERJID);return n.success?o("WAResultOrError").makeResult({from:n.value}):n}l.parseFromUserMixin=e}),98);
__d("WASmaxInChatstateStateSource",["WAResultOrError","WASmaxInChatstateFromGroupMixin","WASmaxInChatstateFromUserMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxInChatstateFromUserMixin").parseFromUserMixin(e);if(t.success)return o("WAResultOrError").makeResult({name:"FromUser",value:t.value});var n=o("WASmaxInChatstateFromGroupMixin").parseFromGroupMixin(e);return n.success?o("WAResultOrError").makeResult({name:"FromGroup",value:n.value}):o("WASmaxParseUtils").errorMixinDisjunction(e,["FromUser","FromGroup"],[t,n])}l.parseStateSource=e}),98);
__d("WASmaxInChatstateComposingMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"chatstate");if(!t.success)return t;var n=o("WASmaxParseUtils").flattenedChildWithTag(e,"composing");if(!n.success)return n;var r=o("WASmaxParseUtils").optionalLiteral(o("WASmaxParseUtils").attrString,n.value,"media","audio");return r.success?o("WAResultOrError").makeResult({composingMedia:r.value}):r}l.parseComposingMixin=e}),98);
__d("WASmaxInChatstatePausedMixin",["WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"chatstate");if(!t.success)return t;var n=o("WASmaxParseUtils").flattenedChildWithTag(e,"paused");return n.success?o("WASmaxParseUtils").voidSuccess:n}l.parsePausedMixin=e}),98);
__d("WASmaxInChatstateStateTypes",["WAResultOrError","WASmaxInChatstateComposingMixin","WASmaxInChatstatePausedMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxInChatstateComposingMixin").parseComposingMixin(e);if(t.success)return o("WAResultOrError").makeResult({name:"Composing",value:t.value});var n=o("WASmaxInChatstatePausedMixin").parsePausedMixin(e);return n.success?o("WAResultOrError").makeResult({name:"Paused",value:n.value}):o("WASmaxParseUtils").errorMixinDisjunction(e,["Composing","Paused"],[t,n])}l.parseStateTypes=e}),98);
__d("WASmaxInChatstateServerNotificationRequest",["WAResultOrError","WASmaxInChatstateInternalTestMixin","WASmaxInChatstateStateSource","WASmaxInChatstateStateTypes","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"chatstate");if(!t.success)return t;var n=o("WASmaxInChatstateInternalTestMixin").parseInternalTestMixin(e),r=o("WASmaxInChatstateStateSource").parseStateSource(e);if(!r.success)return r;var a=o("WASmaxInChatstateStateTypes").parseStateTypes(e);return a.success?o("WAResultOrError").makeResult({internalTestMixin:n.success?n.value:null,stateSource:r.value,stateTypes:a.value}):a}l.parseServerNotificationRequest=e}),98);
__d("WASmaxChatstateServerNotificationRPC",["WASmaxInChatstateServerNotificationRequest","WASmaxParsingFailure","WASmaxRpcUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxInChatstateServerNotificationRequest").parseServerNotificationRequest(e);if(!t.success)throw new(o("WASmaxParsingFailure")).SmaxParsingFailure(o("WASmaxRpcUtils").errorMessageRpcParsing("ServerNotification",{Request:t}));return{parsedRequest:t.value}}l.receiveServerNotificationRPC=e}),98);
__d("WACreateHandleChatState",["Promise","WAHandleChatStateProtocol","WAResultOrError","WASmaxChatstateServerNotificationRPC"],(function(t,n,r,o,a,i,l){"use strict";var e,s=(e||(e=n("Promise"))).resolve(o("WAResultOrError").makeResult("NO_ACK"));function u(e){var t,n,r=(t=e.individualMessage)==null?void 0:t.handleIndividualChatState,a=(n=e.groupMessage)==null?void 0:n.handleGroupChatState;return function(t){if(r==null&&a==null)return s;var e=o("WASmaxChatstateServerNotificationRPC").receiveServerNotificationRPC(t),n=e.parsedRequest,i=n.stateTypes,l=n.stateSource,u=o("WAHandleChatStateProtocol").parseChatStatus(i);if(l.name==="FromUser"){var c;return(c=r==null?void 0:r({status:u,jid:l.value.from}).then(o("WAResultOrError").makeResult))!=null?c:s}else{var d;return l.name,(d=a==null?void 0:a({status:u,jid:l.value.from,participant:l.value.participant}).then(o("WAResultOrError").makeResult))!=null?d:s}}}l.createHandleChatState=u}),98);
__d("WATypedArraysConcat",[],(function(t,n,r,o,a,i){"use strict";function e(e,t,n){n===void 0&&(n=0);var r=t.reduce(function(e,t){return e+t.length},n),o=new e(r),a=0;return t.forEach(function(e){o.set(e,a),a+=e.length}),o}i.concatTypedArrays=e}),66);
__d("WACryptoAesCbc",["Promise","WABinary","WACryptoDependencies","WATypedArraysCast","WATypedArraysConcat","asyncToGeneratorRuntime","err"],(function(t,n,r,o,a,i,l){"use strict";var e,s=16,u=1024,c=16,d=1024*1024,m=s*d,p=(function(){function e(e,t,n,r){this.$4=null,this.$6=!1,this.$1=e,this.$2=t,this.$3=n;var a={name:"AES-CBC",iv:r};this.$5=o("WACryptoDependencies").getCrypto().subtle.importKey("raw",n,"AES-CBC",!1,[t]).then(function(e){return{algo:a,key:e}})}var t=e.prototype;return t.append=function(t){var e=this;this.$7("append");var n,r=this.$4;if(r)if(r.writeByteArray(t),r.size()>u){var a=r.size()%s;n=r.readByteArrayView(r.size()-a),r.size()||(this.$4=null)}else n=null;else if(t.length>u){var i=t.length%s;i?(this.$4=new(o("WABinary")).Binary(t),n=this.$4.readByteArrayView(t.length-i)):n=t}else this.$4=new(o("WABinary")).Binary(t),n=null;var l=n;return l&&(this.$5=this.$5.then(function(t){var n=t.key,r=t.algo;if(e.$2==="encrypt")return o("WACryptoDependencies").getCrypto().subtle.encrypt(r,n,l).then(function(t){return e.$1.writeByteArray(new Uint8Array(t,0,t.byteLength-s)),new Uint8Array(t,t.byteLength-2*s,s)});var a=l.slice(-s);return o("WACryptoDependencies").getCrypto().subtle.decrypt(r,n,l).then(function(t){return e.$1.writeBuffer(t),a})}).then(function(t){var n={name:"AES-CBC",iv:t};return o("WACryptoDependencies").getCrypto().subtle.importKey("raw",e.$3,"AES-CBC",!1,[e.$2]).then(function(e){return{algo:n,key:e}})})),this.$5.then(function(){})},t.finalize=function(t){var e=this;this.$7("finalize");var n;if(this.$4){var r=this.$4;t&&r.writeByteArray(t),n=r.readByteArrayView(),this.$4=null}else t&&(n=t);if(n){var a=n;return this.$5.then(function(t){var n=t.algo,r=t.key;return e.$2==="encrypt"?o("WACryptoDependencies").getCrypto().subtle.encrypt(n,r,a):o("WACryptoDependencies").getCrypto().subtle.decrypt(n,r,a)}).then(function(t){e.$1.writeBuffer(t)})}else return this.$5.then(function(){})},t.$7=function(t){if(this.$6)throw r("err")("AesCbcStream."+t+" called after finalize")},e})();function _(e){return{name:"AES-CBC",iv:o("WATypedArraysCast").castTypedArrays(Uint8Array,e)}}function f(e){return o("WACryptoDependencies").getCrypto().subtle.importKey("raw",o("WATypedArraysCast").castTypedArrays(Uint8Array,e),"AES-CBC",!1,["encrypt"])}function g(e){if(e)return o("WATypedArraysCast").castTypedArrays(Uint8Array,e);var t=new Uint8Array(c);return o("WACryptoDependencies").getCrypto().getRandomValues(t),t}function h(e){var t=e.byteLength,n=s-t%s;return Number.isNaN(n)?t:t+n}function y(t,r,a){var i=_(r);return(e||(e=n("Promise"))).resolve(o("WACryptoDependencies").getCrypto().subtle.importKey("raw",o("WATypedArraysCast").castTypedArrays(Uint8Array,t),"AES-CBC",!1,["decrypt"])).then(function(e){return o("WACryptoDependencies").getCrypto().subtle.decrypt(i,e,a)})}function C(t,r){return(e||(e=n("Promise"))).resolve().then(function(){var e=r.slice(0,c),n=r.slice(c);return y(t,e,n)})}function b(t,r,a){return(e||(e=n("Promise"))).resolve().then(function(){var i=g(a),l=_(i);return(e||(e=n("Promise"))).resolve(f(t)).then(function(e){return o("WACryptoDependencies").getCrypto().subtle.encrypt(l,e,r)}).then(function(e){return o("WATypedArraysConcat").concatTypedArrays(Uint8Array,[i,new Uint8Array(e)]).buffer})})}function v(e,t,n,r){return S.apply(this,arguments)}function S(){return S=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n,o){if(o===void 0&&(o=m),o%s!==0)throw r("err")("chunkSize must be a multiple of "+s+", "+o+" received");var a=yield f(e),i=new Uint8Array(t),l=Math.ceil(i.byteLength/o),u=g(n),c=new Uint8Array(h(i)+u.byteLength);c.set(u);for(var d=0,p=u,_;d<l;d++){var y=d===l-1,C=d*o;_=i.subarray(C,C+o);var b=yield R(y,_,p,a),v=b.encryptedChunk,S=b.nextIv;c.set(v,u.byteLength+d*o),p=S}return c.buffer}),S.apply(this,arguments)}function R(e,t,n,r){return L.apply(this,arguments)}function L(){return L=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n,r){var a=yield o("WACryptoDependencies").getCrypto().subtle.encrypt(_(n),r,t).then(function(t){return e?new Uint8Array(t):new Uint8Array(t).subarray(0,-s)}),i=a.slice(-s);return{encryptedChunk:a,nextIv:i}}),L.apply(this,arguments)}l.AES_CBC_BLOCK_SIZE=s,l.AesCbcStream=p,l.importRawKey=f,l.getIv=g,l.aesCbcDecrypt=y,l.aesCbcDecryptSplit=C,l.aesCbcEncrypt=b,l.aesCbcEncryptWithChunking=v,l.aesCbcEncryptChunk=R}),98);
__d("WACryptoSha256Builder",["WABinary"],(function(t,n,r,o,a,i,l){"use strict";var e=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],s=64,u=4,c=(function(){function t(){this.h0=0,this.h1=0,this.h2=0,this.h3=0,this.h4=0,this.h5=0,this.h6=0,this.h7=0,this.tail=new Uint8Array(0),this.size=0,this.reset()}var n=t.prototype;return n.reset=function(){this.h0=1779033703,this.h1=3144134277,this.h2=1013904242,this.h3=2773480762,this.h4=1359893119,this.h5=2600822924,this.h6=528734635,this.h7=1541459225,this.tail=new Uint8Array(0),this.size=0},n.update=function(t){var e=new Uint8Array(this.tail.length+t.length);for(e.set(this.tail),e.set(t,this.tail.length),this.size+=t.length*8;e.length>=s;){var n=e.subarray(0,s);this.$1(n),e=e.slice(s)}return this.tail=e,this},n.$2=function(){var e=new Uint8Array(64);if(e.set(this.tail),e.set(new Uint8Array([128]),this.tail.length),this.tail.length+9>s){this.$1(e);var t=g(new Uint8Array(0),this.size);this.$1(t)}else{var n=g(e,this.size);this.$1(n)}},n.finish=function(){this.$2();var e=new(o("WABinary")).Binary;return e.writeUint32(this.h0),e.writeUint32(this.h1),e.writeUint32(this.h2),e.writeUint32(this.h3),e.writeUint32(this.h4),e.writeUint32(this.h5),e.writeUint32(this.h6),e.writeUint32(this.h7),this.reset(),e.readByteArrayView()},n.$1=function(n){for(var t=[],r=0;r<16;r++){var o=n.subarray(r*u,u*(r+1)),a=o[0]<<24|o[1]<<16|o[2]<<8|o[3];t.push(a)}for(var i=16;i<64;i++){var l=d(t[i-15]),s=m(t[i-2]),c=t[i-16]+(t[i-7]+l+s)>>>0;t.push(c)}for(var _=this.h0,f=this.h1,g=this.h2,h=this.h3,y=this.h4,C=this.h5,b=this.h6,v=this.h7,S=0;S<64;S++){var R=p(y,6)^p(y,11)^p(y,25),L=y&C^~y&b,E=p(_,2)^p(_,13)^p(_,22),k=_&f^_&g^f&g,I=v+R+L+e[S]+t[S],T=E+k;v=b,b=C,C=y,y=h+I>>>0,h=g,g=f,f=_,_=I+T>>>0}this.h0=this.h0+_>>>0,this.h1=this.h1+f>>>0,this.h2=this.h2+g>>>0,this.h3=this.h3+h>>>0,this.h4=this.h4+y>>>0,this.h5=this.h5+C>>>0,this.h6=this.h6+b>>>0,this.h7=this.h7+v>>>0},t})();function d(e){var t=p(e,7),n=p(e,18),r=_(e,3);return t^n^r}function m(e){var t=p(e,17),n=p(e,19),r=_(e,10);return t^n^r}function p(e,t){return e>>>t|e<<32-t}function _(e,t){return e>>>t}function f(e){return new Uint8Array(new Uint32Array([e]).buffer)}function g(e,t){var n=new Uint8Array(s);n.set(e);var r=f(t);return n.set(r.subarray(0,1),n.length-1),n.set(r.subarray(1,2),n.length-2),n.set(r.subarray(2,3),n.length-3),n.set(r.subarray(3,4),n.length-4),n.set(r.subarray(4,5),n.length-5),n.set(r.subarray(5,6),n.length-6),n.set(r.subarray(6,7),n.length-7),n.set(r.subarray(7,8),n.length-8),n}l.Sha256Builder=c,l.sigma0=d,l.sigma1=m,l.rotateRight=p,l.shiftRight=_}),98);
__d("WACryptoSha256HmacBuilder",["WACryptoSha256Builder"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(){function e(e){this.$1=new(o("WACryptoSha256Builder")).Sha256Builder,this.$2=new Uint8Array(0),this.reset(e)}var t=e.prototype;return t.reset=function(t){this.$2=new Uint8Array(64),t.length>64?this.$2.set(new(o("WACryptoSha256Builder")).Sha256Builder().update(t).finish(),0):this.$2.set(t,0);var e=this.$2.map(function(e){return e^54});this.$1=new(o("WACryptoSha256Builder")).Sha256Builder().update(e)},t.update=function(t){return this.$1.update(t),this},t.finish=function(){var e=this.$2.map(function(e){return e^92}),t=this.$1.finish();return new(o("WACryptoSha256Builder")).Sha256Builder().update(e).update(t).finish()},e})();l.Sha256HMacBuilder=e}),98);
__d("WACryptoHkdfSync",["WABinary","WACryptoSha256HmacBuilder","err"],(function(t,n,r,o,a,i,l){"use strict";var e=32,s=new Uint8Array(e),u=255*e;function c(e,t){return new(o("WACryptoSha256HmacBuilder")).Sha256HMacBuilder(t!=null?t:s).update(e).finish()}function d(t,n,a){if(a===void 0&&(a=new Uint8Array(0)),n<0||n>u)throw r("err")("HKDF::expand given bad length "+n);for(var i=Math.ceil(n/e),l=new Uint8Array(0),s=new(o("WABinary")).Binary,c=1;c<=i;c++)l=new(o("WACryptoSha256HmacBuilder")).Sha256HMacBuilder(t).update(o("WABinary").Binary.build(l,a,c).readByteArrayView()).finish(),s.writeByteArray(l);return s.readByteArrayView(n)}function m(e,t,n,r){return d(c(e,t),r,n)}l.hkdf=m}),98);
__d("WADynamicRouterAsync",["Promise","WALogger","err"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u={sentinel:"RESPONSE_NAMESPACE"},c={sentinel:"NOT_HANDLED"},d=(function(){function t(){var e=this;this.$2=(s||(s=n("Promise"))).resolve(),this.$3=new Map,this.$5=0,this.$6=null,this.$7=null,this.$8=null,this.fireAndForget=function(t,n,r,o){o===void 0&&(o=!1),e.$4==null||e.$4(t,n,r),e.$10(t,n,r,null,o)},this.sendAndReceive=function(t,r,o,a){return a===void 0&&(a=!1),e.$4==null||e.$4(t,r,o),new(s||(s=n("Promise")))(function(n,i){var l=null;e.$10(t,r,o,function(t){try{var r=_(t);r?l=r.call(t,function(t){e.$10(u,"",t,n,a)},function(t){e.$10(u,"",t,i,!1)}):e.$10(u,"",t,n,a)}catch(t){e.$10(u,"",t,i,!1)}},a)})},this.$9=function(){var t=e.$7;if(t){for(var n=e.$3,r;t&&!(r=m(n,t));)e.$7=t=t.nextRoute;if(!(!t||!r)){var o=e.$11(r,t),a=!0;if(o!==c){var i=t.prevRoute,l=t.nextRoute;e.$7===t&&(e.$7=l),i?i.nextRoute=l:e.$6=l,l?l.prevRoute=i:(a=!1,e.$8=i)}return a&&e.$2.then(e.$9).finally(function(){}),o}}}}var a=t.prototype;return a.setAckPayload=function(t){this.$1=t},a.getAckPayoad=function(){return this.$1},a.hasHandlerForNamespace=function(t){return this.$3.has(t)},a.getHandledNamespaces=function(){return Array.from(this.$3.keys())},a.setOnRouteCalled=function(t){this.$4=t},a.setNamespaceHandler=function(t,n){var e=this.$3,r=e.get(t);if(r!==n&&(++this.$5,e.set(t,n),!r)){var o=this.$6;o&&(this.$7||this.$2.then(this.$9).finally(function(){}),this.$7=o)}},a.setHandlers=function(n,a){function t(t,i,l){if(a[t]==null)throw o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose([""," is not defined for ",""])),t,n),r("err")(t+" is not defined for "+n);var s=a[t](i);l&&l(s)}this.setNamespaceHandler(n,t)},a.$10=function(t,n,r,o,a){var e=this.$8,i={namespace:t,route:n,arg:r,resolver:o,prevRoute:e,nextRoute:null,silentLog:a};this.$8=i;var l=!0;e?(e.nextRoute=i,l=!this.$7):this.$6=i,l&&m(this.$3,i)&&(this.$7=i,this.$2.then(this.$9).finally(function(){}))},a.$11=function(t,o){var e=o.route,a=o.arg,i=o.resolver,l=o.silentLog,u=this.$5,d=null,m=null;try{d=t(e,a,i,l)}catch(e){m=(s||(s=n("Promise"))).reject(e)}if(d===c)if(u===this.$5)m=(s||(s=n("Promise"))).reject(r("err")("DynamicRouter: NOT_HANDLED can only be used when updating handlers"));else return c;if(i){m&&i(m);return}else return m},t})();function m(e,t){var n=t.namespace;return n===u?p:e.get(n)}function p(e,t,n){n(t)}function _(e){if(e!=null&&(typeof e=="object"||typeof e=="function")){var t=e.then;return typeof t=="function"?t:null}return null}l.NOT_HANDLED=c,l.DynamicRouter=d}),98);
__d("WAErrorMessage",[],(function(t,n,r,o,a,i){"use strict";var e="NoErrorMessageProvided";function l(t){if(typeof t=="string")return t;if(t instanceof Error)return t.toString();if(typeof t=="object"){if(typeof(t==null?void 0:t.description)=="string")return t.description;if(typeof(t==null?void 0:t.message)=="string")return t.message}return e}i.NO_ERROR_MESSAGE_PROVIDED=e,i.maybeGetMessageFromError=l}),66);
__d("WAFrameSocket",["WABinary","WAErrors","WALogger"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c,d,m=(function(e){function t(t){var n,r="SocketClosed";return n=e.call(this,t!=null?t:r)||this,n.name=r,n}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.toString=function(){return this.name},t})(babelHelpers.wrapNativeSuper(Error)),p=(function(){function t(t,n){var r=this;this.$3=new(o("WABinary")).Binary,this.closed=!1,this.$4=!1,this.onFrame=null,this.onClose=null,this.$5=function(e){r.$3.writeByteArray(e),r.convertBufferedToFrames()},this.$6=function(){if(r.$3.peek(_)){o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["FrameSocket closed, waiting for pending processing"]))),r.$4=!0;return}r.$9()},this.$7=function(e){o("WALogger").DEV(s||(s=babelHelpers.taggedTemplateLiteralLoose(["FrameSocket error"]))).devConsole(e)},this.$2=n,this.$1=t,t.onData=this.$5,t.onClose=this.$6,t.onError=this.$7}var n=t.prototype;return n.sendFrame=function(t){if(!this.$4){this.throwIfClosed();var e=this.$2,n=t.byteLength;this.$8(n);var r=this.$1.dataToSend;e?(this.$2=null,r.ensureAdditionalCapacity(e.length+3+n),r.writeByteArray(e)):r.ensureAdditionalCapacity(3+n),r.writeUint8(n>>16),r.writeUint16(n&65535),r.write(t),this.$1.requestSend()}},n.$9=function(){if(!this.closed){o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["FrameSocket closed"]))),this.$4=!1,this.closed=!0;var e=this.onClose;e&&e()}},n.$8=function(t){if(t>=1<<24)throw o("WALogger").WARN(c||(c=babelHelpers.taggedTemplateLiteralLoose(["Buffer to send: ",""])),t),new(o("WAErrors")).BufferTooLargeError("Buffer too large: "+t)},n.convertBufferedToFrames=function(){for(var e=this.$3,t=this.onFrame;t&&e.peek(_);){var n=f(e),r=e.readByteArrayView(n);t(r),t=this.onFrame}this.$4&&!e.peek(_)&&this.$9(),t&&e.size()&&o("WALogger").LOG(d||(d=babelHelpers.taggedTemplateLiteralLoose(["FrameSocket: queueing partial frame of "," bytes"])),e.size())},n.throwIfClosed=function(){if(this.closed)throw new m},n.close=function(){this.$1.close()},t})();function _(e){if(e.size()<3)return!1;var t=f(e);return t<=e.size()}function f(e){return e.readUint8()<<16|e.readUint16()}l.SocketClosed=m,l.FrameSocket=p}),98);
__d("WASmaxInAbPropsIQErrorResponseMixin",["WAResultOrError","WASmaxParseReference","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxParseReference").attrStringFromReference(t,["id"]);if(!r.success)return r;var a=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"id",r.value);if(!a.success)return a;var i=o("WASmaxParseReference").attrStringFromReference(t,["to"]);if(!i.success)return i;var l=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"from",i.value);if(!l.success)return l;var s=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"type","error");return s.success?o("WAResultOrError").makeResult({type:s.value}):s}l.parseIQErrorResponseMixin=e}),98);
__d("WASmaxInAbPropsIQErrorBadRequestMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"error");if(!t.success)return t;var n=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"text","bad-request");if(!n.success)return n;var r=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrInt,e,"code",400);return r.success?o("WAResultOrError").makeResult({text:n.value,code:r.value}):r}l.parseIQErrorBadRequestMixin=e}),98);
__d("WASmaxInAbPropsIQErrorFeatureNotImplementedMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"error");if(!t.success)return t;var n=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"text","feature-not-implemented");if(!n.success)return n;var r=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrInt,e,"code",501);return r.success?o("WAResultOrError").makeResult({text:n.value,code:r.value}):r}l.parseIQErrorFeatureNotImplementedMixin=e}),98);
__d("WASmaxInAbPropsNoRetryErrors",["WAResultOrError","WASmaxInAbPropsIQErrorBadRequestMixin","WASmaxInAbPropsIQErrorFeatureNotImplementedMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxInAbPropsIQErrorBadRequestMixin").parseIQErrorBadRequestMixin(e);if(t.success)return o("WAResultOrError").makeResult({name:"IQErrorBadRequest",value:t.value});var n=o("WASmaxInAbPropsIQErrorFeatureNotImplementedMixin").parseIQErrorFeatureNotImplementedMixin(e);return n.success?o("WAResultOrError").makeResult({name:"IQErrorFeatureNotImplemented",value:n.value}):o("WASmaxParseUtils").errorMixinDisjunction(e,["IQErrorBadRequest","IQErrorFeatureNotImplemented"],[t,n])}l.parseNoRetryErrors=e}),98);
__d("WASmaxInAbPropsGetExperimentConfigResponseErrorNoRetry",["WAResultOrError","WASmaxInAbPropsIQErrorResponseMixin","WASmaxInAbPropsNoRetryErrors","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxParseUtils").flattenedChildWithTag(e,"error");if(!r.success)return r;var a=o("WASmaxInAbPropsIQErrorResponseMixin").parseIQErrorResponseMixin(e,t);if(!a.success)return a;var i=o("WASmaxInAbPropsNoRetryErrors").parseNoRetryErrors(r.value);return i.success?o("WAResultOrError").makeResult(babelHelpers.extends({},a.value,{errorNoRetryErrors:i.value})):i}l.parseGetExperimentConfigResponseErrorNoRetry=e}),98);
__d("WASmaxInAbPropsIQErrorInternalServerErrorMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"error");if(!t.success)return t;var n=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"text","internal-server-error");if(!n.success)return n;var r=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrInt,e,"code",500);return r.success?o("WAResultOrError").makeResult({text:n.value,code:r.value}):r}l.parseIQErrorInternalServerErrorMixin=e}),98);
__d("WASmaxInAbPropsGetExperimentConfigResponseErrorRetry",["WAResultOrError","WASmaxInAbPropsIQErrorInternalServerErrorMixin","WASmaxInAbPropsIQErrorResponseMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxParseUtils").flattenedChildWithTag(e,"error");if(!r.success)return r;var a=o("WASmaxInAbPropsIQErrorInternalServerErrorMixin").parseIQErrorInternalServerErrorMixin(r.value);if(!a.success)return a;var i=o("WASmaxInAbPropsIQErrorResponseMixin").parseIQErrorResponseMixin(e,t);return i.success?o("WAResultOrError").makeResult(babelHelpers.extends({errorIQErrorInternalServerErrorMixin:a.value},i.value)):i}l.parseGetExperimentConfigResponseErrorRetry=e}),98);
__d("WASmaxInAbPropsExperimentConfigMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"prop");if(!t.success)return t;var n=o("WASmaxParseUtils").attrIntRange(e,"config_code",1,void 0);if(!n.success)return n;var r=o("WASmaxParseUtils").attrString(e,"config_value");if(!r.success)return r;var a=o("WASmaxParseUtils").optional(o("WASmaxParseUtils").attrIntRange,e,"config_expo_key",0,void 0);return a.success?o("WAResultOrError").makeResult({configCode:n.value,configValue:r.value,configExpoKey:a.value}):a}l.parseExperimentConfigMixin=e}),98);
__d("WASmaxInAbPropsSamplingConfigMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"prop");if(!t.success)return t;var n=o("WASmaxParseUtils").attrIntRange(e,"event_code",1,void 0);if(!n.success)return n;var r=o("WASmaxParseUtils").attrIntRange(e,"sampling_weight",-1e4,1e4);return r.success?o("WAResultOrError").makeResult({eventCode:n.value,samplingWeight:r.value}):r}l.parseSamplingConfigMixin=e}),98);
__d("WASmaxInAbPropsConfigs",["WAResultOrError","WASmaxInAbPropsExperimentConfigMixin","WASmaxInAbPropsSamplingConfigMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxInAbPropsExperimentConfigMixin").parseExperimentConfigMixin(e);if(t.success)return o("WAResultOrError").makeResult({name:"ExperimentConfig",value:t.value});var n=o("WASmaxInAbPropsSamplingConfigMixin").parseSamplingConfigMixin(e);return n.success?o("WAResultOrError").makeResult({name:"SamplingConfig",value:n.value}):o("WASmaxParseUtils").errorMixinDisjunction(e,["ExperimentConfig","SamplingConfig"],[t,n])}l.parseConfigs=e}),98);
__d("WASmaxInAbPropsEnums",[],(function(t,n,r,o,a,i){var e={false:"false",true:"true"};i.ENUM_FALSE_TRUE=e}),66);
__d("WASmaxInAbPropsIQResultResponseMixin",["WAResultOrError","WASmaxParseReference","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxParseReference").attrStringFromReference(t,["id"]);if(!r.success)return r;var a=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"id",r.value);if(!a.success)return a;var i=o("WASmaxParseReference").attrStringFromReference(t,["to"]);if(!i.success)return i;var l=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"from",i.value);if(!l.success)return l;var s=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"type","result");return s.success?o("WAResultOrError").makeResult({type:s.value}):s}l.parseIQResultResponseMixin=e}),98);
__d("WASmaxInAbPropsGetExperimentConfigResponseSuccess",["WAResultOrError","WASmaxInAbPropsConfigs","WASmaxInAbPropsEnums","WASmaxInAbPropsIQResultResponseMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"prop");if(!t.success)return t;var n=o("WASmaxInAbPropsConfigs").parseConfigs(e);return n.success?o("WAResultOrError").makeResult({configs:n.value}):n}function s(e){var t=o("WASmaxParseUtils").assertTag(e,"erid");if(!t.success)return t;var n=o("WASmaxParseUtils").contentBytesRange(e,1,100);return n.success?o("WAResultOrError").makeResult({elementValue:n.value}):n}function u(t,n){var r=o("WASmaxParseUtils").assertTag(t,"iq");if(!r.success)return r;var a=o("WASmaxParseUtils").flattenedChildWithTag(t,"props");if(!a.success)return a;var i=o("WASmaxParseUtils").optionalChildWithTag(t,"erid",s);if(!i.success)return i;var l=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,a.value,"protocol","1");if(!l.success)return l;var u=o("WASmaxParseUtils").optional(o("WASmaxParseUtils").attrString,a.value,"ab_key");if(!u.success)return u;var c=o("WASmaxParseUtils").optional(o("WASmaxParseUtils").attrString,a.value,"hash");if(!c.success)return c;var d=o("WASmaxParseUtils").optional(o("WASmaxParseUtils").attrIntRange,a.value,"refresh",0,void 0);if(!d.success)return d;var m=o("WASmaxParseUtils").optional(o("WASmaxParseUtils").attrIntRange,a.value,"refresh_id",0,void 0);if(!m.success)return m;var p=o("WASmaxParseUtils").optional(o("WASmaxParseUtils").attrStringEnum,a.value,"delta_update",o("WASmaxInAbPropsEnums").ENUM_FALSE_TRUE);if(!p.success)return p;var _=o("WASmaxInAbPropsIQResultResponseMixin").parseIQResultResponseMixin(t,n);if(!_.success)return _;var f=o("WASmaxParseUtils").mapChildrenWithTag(a.value,"prop",0,1/0,e);return f.success?o("WAResultOrError").makeResult(babelHelpers.extends({propsProtocol:l.value,propsAbKey:u.value,propsHash:c.value,propsRefresh:d.value,propsRefreshId:m.value,propsDeltaUpdate:p.value},_.value,{erid:i.value,propsProp:f.value})):f}l.parseGetExperimentConfigResponseSuccessPropsProp=e,l.parseGetExperimentConfigResponseSuccessErid=s,l.parseGetExperimentConfigResponseSuccess=u}),98);
__d("WASmaxOutAbPropsBaseIQGetRequestMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(t,n,r,o,a,i,l){function e(){var e=o("WASmaxJsx").smax("iq",{id:o("WAWap").generateId(),type:"get"});return e}function s(t){var n=e();return o("WASmaxMixins").mergeStanzas(t,n)}l.mergeBaseIQGetRequestMixin=s}),98);
__d("WASmaxOutAbPropsGetExperimentConfigRequest",["WASmaxAttrs","WASmaxJsx","WASmaxOutAbPropsBaseIQGetRequestMixin","WAWap"],(function(t,n,r,o,a,i,l){function e(e){var t=e.propsHash,n=e.propsRefreshId,r=o("WASmaxOutAbPropsBaseIQGetRequestMixin").mergeBaseIQGetRequestMixin(o("WASmaxJsx").smax("iq",{xmlns:"abt",to:o("WAWap").S_WHATSAPP_NET},o("WASmaxJsx").smax("props",{protocol:"1",hash:o("WASmaxAttrs").OPTIONAL(o("WAWap").CUSTOM_STRING,t),refresh_id:o("WASmaxAttrs").OPTIONAL(o("WAWap").INT,n)})));return r}l.makeGetExperimentConfigRequest=e}),98);
__d("WASmaxAbPropsGetExperimentConfigRPC",["WAComms","WASmaxInAbPropsGetExperimentConfigResponseErrorNoRetry","WASmaxInAbPropsGetExperimentConfigResponseErrorRetry","WASmaxInAbPropsGetExperimentConfigResponseSuccess","WASmaxOutAbPropsGetExperimentConfigRequest","WASmaxParsingFailure","WASmaxRpcUtils","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){function e(e,t){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=o("WASmaxOutAbPropsGetExperimentConfigRequest").makeGetExperimentConfigRequest(e),r=yield o("WAComms").sendSmaxStanza(n,t),a=o("WASmaxInAbPropsGetExperimentConfigResponseSuccess").parseGetExperimentConfigResponseSuccess(r,n);if(a.success)return{name:"GetExperimentConfigResponseSuccess",value:a.value};var i=o("WASmaxInAbPropsGetExperimentConfigResponseErrorNoRetry").parseGetExperimentConfigResponseErrorNoRetry(r,n);if(i.success)return{name:"GetExperimentConfigResponseErrorNoRetry",value:i.value};var l=o("WASmaxInAbPropsGetExperimentConfigResponseErrorRetry").parseGetExperimentConfigResponseErrorRetry(r,n);if(l.success)return{name:"GetExperimentConfigResponseErrorRetry",value:l.value};throw new(o("WASmaxParsingFailure")).SmaxParsingFailure(o("WASmaxRpcUtils").errorMessageRpcParsing("GetExperimentConfig",{Success:a,ErrorNoRetry:i,ErrorRetry:l}))}),s.apply(this,arguments)}l.sendGetExperimentConfigRPC=e}),98);
__d("WAGetAbPropsProtocol",["WALogger","WAResultOrError","WASmaxAbPropsGetExperimentConfigRPC","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){"use strict";var e;function s(e){return u.apply(this,arguments)}function u(){return u=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var n=yield o("WASmaxAbPropsGetExperimentConfigRPC").sendGetExperimentConfigRPC(t);if(n.name==="GetExperimentConfigResponseSuccess"){var r=n.value,a=r.propsAbKey,i=r.propsHash,l=r.propsRefresh,s=r.propsRefreshId,u=r.propsProp,d=r.erid,m=r.propsDeltaUpdate,p=c(u),_=p.newProps,f=p.samplingConfigs;return o("WAResultOrError").makeResult({abKey:a,hash:i,refresh:l,refreshId:s,props:_,samplingConfigs:f,erid:d==null?void 0:d.elementValue,isDeltaUpdate:m==="true"})}return o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["getAbPropsProtocol failed ",""])),n.value),o("WAResultOrError").makeError()}),u.apply(this,arguments)}function c(e){var t=[],n=[];return e.forEach(function(e){var r=e.configs;if(r.name==="ExperimentConfig"){var o;t.push({configCode:r.value.configCode,configValue:r.value.configValue,configExpoKey:(o=r.value.configExpoKey)==null?void 0:o.toString()})}else r.name==="SamplingConfig"&&n.push({eventCode:r.value.eventCode,samplingWeight:r.value.samplingWeight})}),{newProps:t,samplingConfigs:n}}l.getAbPropsProtocol=s}),98);
/**
 * License: https://www.facebook.com/legal/license/MDzNl_j9yvg/
 */
__d("fflate-0.6.10",[],(function(t,n,r,o,a,i){"use strict";var e={},l={exports:e};function s(){var t,n="";try{t={}.Worker}catch(e){}e.default=t?function(e,r,o,a,i){var l=!1,s=new t(e+n,{eval:!0}).on("error",function(e){return i(e,null)}).on("message",function(e){return i(null,e)}).on("exit",function(e){e&&!l&&i(new Error("exited with code "+e),null)});return s.postMessage(o,a),s.terminate=function(){return l=!0,t.prototype.terminate.call(s)},s}:function(e,t,n,r,o){setImmediate(function(){return o(new Error("async operations unsupported - update to Node 12+ (or Node 10-11 with the --experimental-worker CLI flag)"),null)});var a=function(){};return{terminate:a,postMessage:a}}}var u=!1;function c(){return u||(u=!0,s()),l.exports}var d={},m={exports:d};function p(){var e=c(),t=Uint8Array,n=Uint16Array,r=Uint32Array,o=new t([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),a=new t([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),i=new t([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),l=function(e,t){for(var o=new n(31),a=0;a<31;++a)o[a]=t+=1<<e[a-1];for(var i=new r(o[30]),a=1;a<30;++a)for(var l=o[a];l<o[a+1];++l)i[l]=l-o[a]<<5|a;return[o,i]},s=l(o,2),u=s[0],m=s[1];u[28]=258,m[258]=28;for(var p=l(a,0),_=p[0],f=p[1],g=new n(32768),h=0;h<32768;++h){var y=(h&43690)>>>1|(h&21845)<<1;y=(y&52428)>>>2|(y&13107)<<2,y=(y&61680)>>>4|(y&3855)<<4,g[h]=((y&65280)>>>8|(y&255)<<8)>>>1}for(var C=(function(e,t,r){for(var o=e.length,a=0,i=new n(t);a<o;++a)++i[e[a]-1];var l=new n(t);for(a=0;a<t;++a)l[a]=l[a-1]+i[a-1]<<1;var s;if(r){s=new n(1<<t);var u=15-t;for(a=0;a<o;++a)if(e[a])for(var c=a<<4|e[a],d=t-e[a],m=l[e[a]-1]++<<d,p=m|(1<<d)-1;m<=p;++m)s[g[m]>>>u]=c}else for(s=new n(o),a=0;a<o;++a)e[a]&&(s[a]=g[l[e[a]-1]++]>>>15-e[a]);return s}),b=new t(288),h=0;h<144;++h)b[h]=8;for(var h=144;h<256;++h)b[h]=9;for(var h=256;h<280;++h)b[h]=7;for(var h=280;h<288;++h)b[h]=8;for(var v=new t(32),h=0;h<32;++h)v[h]=5;var S=C(b,9,0),R=C(b,9,1),L=C(v,5,0),E=C(v,5,1),k=function(e){for(var t=e[0],n=1;n<e.length;++n)e[n]>t&&(t=e[n]);return t},I=function(e,t,n){var r=t/8|0;return(e[r]|e[r+1]<<8)>>(t&7)&n},T=function(e,t){var n=t/8|0;return(e[n]|e[n+1]<<8|e[n+2]<<16)>>(t&7)},D=function(e){return(e/8|0)+(e&7&&1)},x=function(e,o,a){(o==null||o<0)&&(o=0),(a==null||a>e.length)&&(a=e.length);var i=new(e instanceof n?n:e instanceof r?r:t)(a-o);return i.set(e.subarray(o,a)),i},$=function(e,n,r){var l=e.length;if(!l||r&&!r.l&&l<5)return n||new t(0);var s=!n||r,c=!r||r.i;r||(r={}),n||(n=new t(l*3));var d=function(e){var r=n.length;if(e>r){var o=new t(Math.max(r*2,e));o.set(n),n=o}},m=r.f||0,p=r.p||0,f=r.b||0,g=r.l,h=r.d,y=r.m,b=r.n,v=l*8;do{if(!g){r.f=m=I(e,p,1);var S=I(e,p+1,3);if(p+=3,S)if(S==1)g=R,h=E,y=9,b=5;else if(S==2){var N=I(e,p,31)+257,M=I(e,p+10,15)+4,w=N+I(e,p+5,31)+1;p+=14;for(var A=new t(w),F=new t(19),O=0;O<M;++O)F[i[O]]=I(e,p+O*3,7);p+=M*3;for(var B=k(F),W=(1<<B)-1,q=C(F,B,1),O=0;O<w;){var U=q[I(e,p,W)];p+=U&15;var L=U>>>4;if(L<16)A[O++]=L;else{var V=0,H=0;for(L==16?(H=3+I(e,p,3),p+=2,V=A[O-1]):L==17?(H=3+I(e,p,7),p+=3):L==18&&(H=11+I(e,p,127),p+=7);H--;)A[O++]=V}}var G=A.subarray(0,N),z=A.subarray(N);y=k(G),b=k(z),g=C(G,y,1),h=C(z,b,1)}else throw"invalid block type";else{var L=D(p)+4,$=e[L-4]|e[L-3]<<8,P=L+$;if(P>l){if(c)throw"unexpected EOF";break}s&&d(f+$),n.set(e.subarray(L,P),f),r.b=f+=$,r.p=p=P*8;continue}if(p>v){if(c)throw"unexpected EOF";break}}s&&d(f+131072);for(var j=(1<<y)-1,K=(1<<b)-1,Q=p;;Q=p){var V=g[T(e,p)&j],X=V>>>4;if(p+=V&15,p>v){if(c)throw"unexpected EOF";break}if(!V)throw"invalid length/literal";if(X<256)n[f++]=X;else if(X==256){Q=p,g=null;break}else{var Y=X-254;if(X>264){var O=X-257,J=o[O];Y=I(e,p,(1<<J)-1)+u[O],p+=J}var Z=h[T(e,p)&K],ee=Z>>>4;if(!Z)throw"invalid distance";p+=Z&15;var z=_[ee];if(ee>3){var J=a[ee];z+=T(e,p)&(1<<J)-1,p+=J}if(p>v){if(c)throw"unexpected EOF";break}s&&d(f+131072);for(var te=f+Y;f<te;f+=4)n[f]=n[f-z],n[f+1]=n[f+1-z],n[f+2]=n[f+2-z],n[f+3]=n[f+3-z];f=te}}r.l=g,r.p=Q,r.b=f,g&&(m=1,r.m=y,r.d=h,r.n=b)}while(!m);return f==n.length?n:x(n,0,f)},P=function(e,t,n){n<<=t&7;var r=t/8|0;e[r]|=n,e[r+1]|=n>>>8},N=function(e,t,n){n<<=t&7;var r=t/8|0;e[r]|=n,e[r+1]|=n>>>8,e[r+2]|=n>>>16},M=function(e,r){for(var o=[],a=0;a<e.length;++a)e[a]&&o.push({s:a,f:e[a]});var i=o.length,l=o.slice();if(!i)return[q,0];if(i==1){var s=new t(o[0].s+1);return s[o[0].s]=1,[s,1]}o.sort(function(e,t){return e.f-t.f}),o.push({s:-1,f:25001});var u=o[0],c=o[1],d=0,m=1,p=2;for(o[0]={s:-1,f:u.f+c.f,l:u,r:c};m!=i-1;)u=o[o[d].f<o[p].f?d++:p++],c=o[d!=m&&o[d].f<o[p].f?d++:p++],o[m++]={s:-1,f:u.f+c.f,l:u,r:c};for(var _=l[0].s,a=1;a<i;++a)l[a].s>_&&(_=l[a].s);var f=new n(_+1),g=w(o[m-1],f,0);if(g>r){var a=0,h=0,y=g-r,C=1<<y;for(l.sort(function(e,t){return f[t.s]-f[e.s]||e.f-t.f});a<i;++a){var b=l[a].s;if(f[b]>r)h+=C-(1<<g-f[b]),f[b]=r;else break}for(h>>>=y;h>0;){var v=l[a].s;f[v]<r?h-=1<<r-f[v]++-1:++a}for(;a>=0&&h;--a){var S=l[a].s;f[S]==r&&(--f[S],++h)}g=r}return[new t(f),g]},w=function(e,t,n){return e.s==-1?Math.max(w(e.l,t,n+1),w(e.r,t,n+1)):t[e.s]=n},A=function(e){for(var t=e.length;t&&!e[--t];);for(var r=new n(++t),o=0,a=e[0],i=1,l=function(e){r[o++]=e},s=1;s<=t;++s)if(e[s]==a&&s!=t)++i;else{if(!a&&i>2){for(;i>138;i-=138)l(32754);i>2&&(l(i>10?i-11<<5|28690:i-3<<5|12305),i=0)}else if(i>3){for(l(a),--i;i>6;i-=6)l(8304);i>2&&(l(i-3<<5|8208),i=0)}for(;i--;)l(a);i=1,a=e[s]}return[r.subarray(0,o),t]},F=function(e,t){for(var n=0,r=0;r<t.length;++r)n+=e[r]*t[r];return n},O=function(e,t,n){var r=n.length,o=D(t+2);e[o]=r&255,e[o+1]=r>>>8,e[o+2]=e[o]^255,e[o+3]=e[o+1]^255;for(var a=0;a<r;++a)e[o+a+4]=n[a];return(o+4+r)*8},B=function(e,t,r,l,s,u,c,d,m,p,_){P(t,_++,r),++s[256];for(var f=M(s,15),g=f[0],h=f[1],y=M(u,15),R=y[0],E=y[1],k=A(g),I=k[0],T=k[1],D=A(R),x=D[0],$=D[1],w=new n(19),B=0;B<I.length;++B)w[I[B]&31]++;for(var B=0;B<x.length;++B)w[x[B]&31]++;for(var W=M(w,7),q=W[0],U=W[1],V=19;V>4&&!q[i[V-1]];--V);var H=p+5<<3,G=F(s,b)+F(u,v)+c,z=F(s,g)+F(u,R)+c+14+3*V+F(w,q)+(2*w[16]+3*w[17]+7*w[18]);if(H<=G&&H<=z)return O(t,_,e.subarray(m,m+p));var j,K,Q,X;if(P(t,_,1+(z<G)),_+=2,z<G){j=C(g,h,0),K=g,Q=C(R,E,0),X=R;var Y=C(q,U,0);P(t,_,T-257),P(t,_+5,$-1),P(t,_+10,V-4),_+=14;for(var B=0;B<V;++B)P(t,_+3*B,q[i[B]]);_+=3*V;for(var J=[I,x],Z=0;Z<2;++Z)for(var ee=J[Z],B=0;B<ee.length;++B){var te=ee[B]&31;P(t,_,Y[te]),_+=q[te],te>15&&(P(t,_,ee[B]>>>5&127),_+=ee[B]>>>12)}}else j=S,K=b,Q=L,X=v;for(var B=0;B<d;++B)if(l[B]>255){var te=l[B]>>>18&31;N(t,_,j[te+257]),_+=K[te+257],te>7&&(P(t,_,l[B]>>>23&31),_+=o[te]);var ne=l[B]&31;N(t,_,Q[ne]),_+=X[ne],ne>3&&(N(t,_,l[B]>>>5&8191),_+=a[ne])}else N(t,_,j[l[B]]),_+=K[l[B]];return N(t,_,j[256]),_+K[256]},W=new r([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),q=new t(0),U=function(e,i,l,s,u,c){var d=e.length,p=new t(s+d+5*(1+Math.ceil(d/7e3))+u),_=p.subarray(s,p.length-u),g=0;if(!i||d<8)for(var h=0;h<=d;h+=65535){var y=h+65535;y<d?g=O(_,g,e.subarray(h,y)):(_[h]=c,g=O(_,g,e.subarray(h,d)))}else{for(var C=W[i-1],b=C>>>13,v=C&8191,S=(1<<l)-1,R=new n(32768),L=new n(S+1),E=Math.ceil(l/3),k=2*E,I=function(t){return(e[t]^e[t+1]<<E^e[t+2]<<k)&S},T=new r(25e3),$=new n(288),P=new n(32),N=0,M=0,h=0,w=0,A=0,F=0;h<d;++h){var U=I(h),V=h&32767,H=L[U];if(R[V]=H,L[U]=V,A<=h){var G=d-h;if((N>7e3||w>24576)&&G>423){g=B(e,_,0,T,$,P,M,w,F,h-F,g),w=N=M=0,F=h;for(var z=0;z<286;++z)$[z]=0;for(var z=0;z<30;++z)P[z]=0}var j=2,K=0,Q=v,X=V-H&32767;if(G>2&&U==I(h-X))for(var Y=Math.min(b,G)-1,J=Math.min(32767,h),Z=Math.min(258,G);X<=J&&--Q&&V!=H;){if(e[h+j]==e[h+j-X]){for(var ee=0;ee<Z&&e[h+ee]==e[h+ee-X];++ee);if(ee>j){if(j=ee,K=X,ee>Y)break;for(var te=Math.min(X,ee-2),ne=0,z=0;z<te;++z){var re=h-X+z+32768&32767,oe=R[re],ae=re-oe+32768&32767;ae>ne&&(ne=ae,H=re)}}}V=H,H=R[V],X+=V-H+32768&32767}if(K){T[w++]=268435456|m[j]<<18|f[K];var ie=m[j]&31,le=f[K]&31;M+=o[ie]+a[le],++$[257+ie],++P[le],A=h+j,++N}else T[w++]=e[h],++$[e[h]]}}g=B(e,_,c,T,$,P,M,w,F,h-F,g),!c&&g&7&&(g=O(_,g+1,q))}return x(p,0,s+D(g)+u)},V=(function(){for(var e=new Int32Array(256),t=0;t<256;++t){for(var n=t,r=9;--r;)n=(n&1&&-306674912)^n>>>1;e[t]=n}return e})(),H=function(){var e=-1;return{p:function(t){for(var n=e,r=0;r<t.length;++r)n=V[n&255^t[r]]^n>>>8;e=n},d:function(){return~e}}},G=function(){var e=1,t=0;return{p:function(n){for(var r=e,o=t,a=n.length,i=0;i!=a;){for(var l=Math.min(i+2655,a);i<l;++i)o+=r+=n[i];r=(r&65535)+15*(r>>16),o=(o&65535)+15*(o>>16)}e=r,t=o},d:function(){return e%=65521,t%=65521,(e&255)<<24|e>>>8<<16|(t&255)<<8|t>>>8}}},z=function(e,t,n,r,o){return U(e,t.level==null?6:t.level,t.mem==null?Math.ceil(Math.max(8,Math.min(13,Math.log(e.length)))*1.5):12+t.mem,n,r,!o)},j=function(e,t){var n={};for(var r in e)n[r]=e[r];for(var r in t)n[r]=t[r];return n},K=function(e,t,n){for(var r=e(),o=e.toString(),a=o.slice(o.indexOf("[")+1,o.lastIndexOf("]")).replace(/ /g,"").split(","),i=0;i<r.length;++i){var l=r[i],s=a[i];if(typeof l=="function"){t+=";"+s+"=";var u=l.toString();if(l.prototype)if(u.indexOf("[native code]")!=-1){var c=u.indexOf(" ",8)+1;t+=u.slice(c,u.indexOf("(",c))}else{t+=u;for(var d in l.prototype)t+=";"+s+".prototype."+d+"="+l.prototype[d].toString()}else t+=u}else n[s]=l}return[t,n]},Q=[],X=function(e){var o=[];for(var a in e)(e[a]instanceof t||e[a]instanceof n||e[a]instanceof r)&&o.push((e[a]=new e[a].constructor(e[a])).buffer);return o},Y=function(t,n,r,o){var a;if(!Q[r]){for(var i="",l={},s=t.length-1,u=0;u<s;++u)a=K(t[u],i,l),i=a[0],l=a[1];Q[r]=K(t[s],i,l)}var c=j({},Q[r][1]);return e.default(Q[r][0]+";onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage="+n.toString()+"}",r,c,X(c),o)},J=function(){return[t,n,r,o,a,i,u,_,R,E,g,C,k,I,T,D,x,$,Ie,oe,ae]},Z=function(){return[t,n,r,o,a,i,m,f,S,b,L,v,g,W,q,C,P,N,M,w,A,F,O,B,D,x,U,z,Re,oe]},ee=function(){return[pe,ge,me,H,V]},te=function(){return[_e,fe]},ne=function(){return[he,me,G]},re=function(){return[ye]},oe=function(e){return postMessage(e,[e.buffer])},ae=function(e){return e&&e.size&&new t(e.size)},ie=function(e,t,n,r,o,a){var i=Y(n,r,o,function(e,t){i.terminate(),a(e,t)});return i.postMessage([e,t],t.consume?[e.buffer]:[]),function(){i.terminate()}},le=function(e){return e.ondata=function(e,t){return postMessage([e,t],[e.buffer])},function(t){return e.push(t.data[0],t.data[1])}},se=function(e,t,n,r,o){var a,i=Y(e,r,o,function(e,n){e?(i.terminate(),t.ondata.call(t,e)):(n[1]&&i.terminate(),t.ondata.call(t,e,n[0],n[1]))});i.postMessage(n),t.push=function(e,n){if(a)throw"stream finished";if(!t.ondata)throw"no stream handler";i.postMessage([e,a=n],[e.buffer])},t.terminate=function(){i.terminate()}},ue=function(e,t){return e[t]|e[t+1]<<8},ce=function(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0},de=function(e,t){return ce(e,t)+ce(e,t+4)*4294967296},me=function(e,t,n){for(;n;++t)e[t]=n,n>>>=8},pe=function(e,t){var n=t.filename;if(e[0]=31,e[1]=139,e[2]=8,e[8]=t.level<2?4:t.level==9?2:0,e[9]=3,t.mtime!=0&&me(e,4,Math.floor(new Date(t.mtime||Date.now())/1e3)),n){e[3]=8;for(var r=0;r<=n.length;++r)e[r+10]=n.charCodeAt(r)}},_e=function(e){if(e[0]!=31||e[1]!=139||e[2]!=8)throw"invalid gzip data";var t=e[3],n=10;t&4&&(n+=e[10]|(e[11]<<8)+2);for(var r=(t>>3&1)+(t>>4&1);r>0;r-=!e[n++]);return n+(t&2)},fe=function(e){var t=e.length;return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0},ge=function(e){return 10+(e.filename&&e.filename.length+1||0)},he=function(e,t){var n=t.level,r=n==0?0:n<6?1:n==9?3:2;e[0]=120,e[1]=r<<6|(r?32-2*r:1)},ye=function(e){if((e[0]&15)!=8||e[0]>>>4>7||(e[0]<<8|e[1])%31)throw"invalid zlib data";if(e[1]&32)throw"invalid zlib data: preset dictionaries not supported"};function Ce(e,t){return!t&&typeof e=="function"&&(t=e,e={}),this.ondata=t,e}var be=(function(){function e(e,t){!t&&typeof e=="function"&&(t=e,e={}),this.ondata=t,this.o=e||{}}return e.prototype.p=function(e,t){this.ondata(z(e,this.o,0,0,!t),t)},e.prototype.push=function(e,t){if(this.d)throw"stream finished";if(!this.ondata)throw"no stream handler";this.d=t,this.p(e,t||!1)},e})();d.Deflate=be;var ve=(function(){function e(e,t){se([Z,function(){return[le,be]}],this,Ce.call(this,e,t),function(e){var t=new be(e.data);onmessage=le(t)},6)}return e})();d.AsyncDeflate=ve;function Se(e,t,n){if(n||(n=t,t={}),typeof n!="function")throw"no callback";return ie(e,t,[Z],function(e){return oe(Re(e.data[0],e.data[1]))},0,n)}d.deflate=Se;function Re(e,t){return z(e,t||{},0,0)}d.deflateSync=Re;var Le=(function(){function e(e){this.s={},this.p=new t(0),this.ondata=e}return e.prototype.e=function(e){if(this.d)throw"stream finished";if(!this.ondata)throw"no stream handler";var n=this.p.length,r=new t(n+e.length);r.set(this.p),r.set(e,n),this.p=r},e.prototype.c=function(e){this.d=this.s.i=e||!1;var t=this.s.b,n=$(this.p,this.o,this.s);this.ondata(x(n,t,this.s.b),this.d),this.o=x(n,this.s.b-32768),this.s.b=this.o.length,this.p=x(this.p,this.s.p/8|0),this.s.p&=7},e.prototype.push=function(e,t){this.e(e),this.c(t)},e})();d.Inflate=Le;var Ee=(function(){function e(e){this.ondata=e,se([J,function(){return[le,Le]}],this,0,function(){var e=new Le;onmessage=le(e)},7)}return e})();d.AsyncInflate=Ee;function ke(e,t,n){if(n||(n=t,t={}),typeof n!="function")throw"no callback";return ie(e,t,[J],function(e){return oe(Ie(e.data[0],ae(e.data[1])))},1,n)}d.inflate=ke;function Ie(e,t){return $(e,t)}d.inflateSync=Ie;var Te=(function(){function e(e,t){this.c=H(),this.l=0,this.v=1,be.call(this,e,t)}return e.prototype.push=function(e,t){be.prototype.push.call(this,e,t)},e.prototype.p=function(e,t){this.c.p(e),this.l+=e.length;var n=z(e,this.o,this.v&&ge(this.o),t&&8,!t);this.v&&(pe(n,this.o),this.v=0),t&&(me(n,n.length-8,this.c.d()),me(n,n.length-4,this.l)),this.ondata(n,t)},e})();d.Gzip=Te,d.Compress=Te;var De=(function(){function e(e,t){se([Z,ee,function(){return[le,be,Te]}],this,Ce.call(this,e,t),function(e){var t=new Te(e.data);onmessage=le(t)},8)}return e})();d.AsyncGzip=De,d.AsyncCompress=De;function xe(e,t,n){if(n||(n=t,t={}),typeof n!="function")throw"no callback";return ie(e,t,[Z,ee,function(){return[$e]}],function(e){return oe($e(e.data[0],e.data[1]))},2,n)}d.gzip=xe,d.compress=xe;function $e(e,t){t||(t={});var n=H(),r=e.length;n.p(e);var o=z(e,t,ge(t),8),a=o.length;return pe(o,t),me(o,a-8,n.d()),me(o,a-4,r),o}d.gzipSync=$e,d.compressSync=$e;var Pe=(function(){function e(e){this.v=1,Le.call(this,e)}return e.prototype.push=function(e,t){if(Le.prototype.e.call(this,e),this.v){var n=this.p.length>3?_e(this.p):4;if(n>=this.p.length&&!t)return;this.p=this.p.subarray(n),this.v=0}if(t){if(this.p.length<8)throw"invalid gzip stream";this.p=this.p.subarray(0,-8)}Le.prototype.c.call(this,t)},e})();d.Gunzip=Pe;var Ne=(function(){function e(e){this.ondata=e,se([J,te,function(){return[le,Le,Pe]}],this,0,function(){var e=new Pe;onmessage=le(e)},9)}return e})();d.AsyncGunzip=Ne;function Me(e,t,n){if(n||(n=t,t={}),typeof n!="function")throw"no callback";return ie(e,t,[J,te,function(){return[we]}],function(e){return oe(we(e.data[0]))},3,n)}d.gunzip=Me;function we(e,n){return $(e.subarray(_e(e),-8),n||new t(fe(e)))}d.gunzipSync=we;var Ae=(function(){function e(e,t){this.c=G(),this.v=1,be.call(this,e,t)}return e.prototype.push=function(e,t){be.prototype.push.call(this,e,t)},e.prototype.p=function(e,t){this.c.p(e);var n=z(e,this.o,this.v&&2,t&&4,!t);this.v&&(he(n,this.o),this.v=0),t&&me(n,n.length-4,this.c.d()),this.ondata(n,t)},e})();d.Zlib=Ae;var Fe=(function(){function e(e,t){se([Z,ne,function(){return[le,be,Ae]}],this,Ce.call(this,e,t),function(e){var t=new Ae(e.data);onmessage=le(t)},10)}return e})();d.AsyncZlib=Fe;function Oe(e,t,n){if(n||(n=t,t={}),typeof n!="function")throw"no callback";return ie(e,t,[Z,ne,function(){return[Be]}],function(e){return oe(Be(e.data[0],e.data[1]))},4,n)}d.zlib=Oe;function Be(e,t){t||(t={});var n=G();n.p(e);var r=z(e,t,2,4);return he(r,t),me(r,r.length-4,n.d()),r}d.zlibSync=Be;var We=(function(){function e(e){this.v=1,Le.call(this,e)}return e.prototype.push=function(e,t){if(Le.prototype.e.call(this,e),this.v){if(this.p.length<2&&!t)return;this.p=this.p.subarray(2),this.v=0}if(t){if(this.p.length<4)throw"invalid zlib stream";this.p=this.p.subarray(0,-4)}Le.prototype.c.call(this,t)},e})();d.Unzlib=We;var qe=(function(){function e(e){this.ondata=e,se([J,re,function(){return[le,Le,We]}],this,0,function(){var e=new We;onmessage=le(e)},11)}return e})();d.AsyncUnzlib=qe;function Ue(e,t,n){if(n||(n=t,t={}),typeof n!="function")throw"no callback";return ie(e,t,[J,re,function(){return[Ve]}],function(e){return oe(Ve(e.data[0],ae(e.data[1])))},5,n)}d.unzlib=Ue;function Ve(e,t){return $((ye(e),e.subarray(2,-4)),t)}d.unzlibSync=Ve;var He=(function(){function e(e){this.G=Pe,this.I=Le,this.Z=We,this.ondata=e}return e.prototype.push=function(e,n){if(!this.ondata)throw"no stream handler";if(this.s)this.s.push(e,n);else{if(this.p&&this.p.length){var r=new t(this.p.length+e.length);r.set(this.p),r.set(e,this.p.length)}else this.p=e;if(this.p.length>2){var o=this,a=function(){o.ondata.apply(o,arguments)};this.s=this.p[0]==31&&this.p[1]==139&&this.p[2]==8?new this.G(a):(this.p[0]&15)!=8||this.p[0]>>4>7||(this.p[0]<<8|this.p[1])%31?new this.I(a):new this.Z(a),this.s.push(this.p,n),this.p=null}}},e})();d.Decompress=He;var Ge=(function(){function e(e){this.G=Ne,this.I=Ee,this.Z=qe,this.ondata=e}return e.prototype.push=function(e,t){He.prototype.push.call(this,e,t)},e})();d.AsyncDecompress=Ge;function ze(e,t,n){if(n||(n=t,t={}),typeof n!="function")throw"no callback";return e[0]==31&&e[1]==139&&e[2]==8?Me(e,t,n):(e[0]&15)!=8||e[0]>>4>7||(e[0]<<8|e[1])%31?ke(e,t,n):Ue(e,t,n)}d.decompress=ze;function je(e,t){return e[0]==31&&e[1]==139&&e[2]==8?we(e,t):(e[0]&15)!=8||e[0]>>4>7||(e[0]<<8|e[1])%31?Ie(e,t):Ve(e,t)}d.decompressSync=je;var Ke=function(e,n,r,o){for(var a in e){var i=e[a],l=n+a;i instanceof t?r[l]=[i,o]:Array.isArray(i)?r[l]=[i[0],j(o,i[1])]:Ke(i,l+"/",r,o)}},Qe=typeof TextEncoder!="undefined"&&new TextEncoder,Xe=typeof TextDecoder!="undefined"&&new TextDecoder,Ye=0;try{Xe.decode(q,{stream:!0}),Ye=1}catch(e){}var Je=function(e){for(var t="",n=0;;){var r=e[n++],o=(r>127)+(r>223)+(r>239);if(n+o>e.length)return[t,x(e,n-1)];o?o==3?(r=((r&15)<<18|(e[n++]&63)<<12|(e[n++]&63)<<6|e[n++]&63)-65536,t+=String.fromCharCode(55296|r>>10,56320|r&1023)):o&1?t+=String.fromCharCode((r&31)<<6|e[n++]&63):t+=String.fromCharCode((r&15)<<12|(e[n++]&63)<<6|e[n++]&63):t+=String.fromCharCode(r)}},Ze=(function(){function e(e){this.ondata=e,Ye?this.t=new TextDecoder:this.p=q}return e.prototype.push=function(e,n){if(!this.ondata)throw"no callback";if(n=!!n,this.t){if(this.ondata(this.t.decode(e,{stream:!0}),n),n){if(this.t.decode().length)throw"invalid utf-8 data";this.t=null}return}if(!this.p)throw"stream finished";var r=new t(this.p.length+e.length);r.set(this.p),r.set(e,this.p.length);var o=Je(r),a=o[0],i=o[1];if(n){if(i.length)throw"invalid utf-8 data";this.p=null}else this.p=i;this.ondata(a,n)},e})();d.DecodeUTF8=Ze;var et=(function(){function e(e){this.ondata=e}return e.prototype.push=function(e,t){if(!this.ondata)throw"no callback";if(this.d)throw"stream finished";this.ondata(tt(e),this.d=t||!1)},e})();d.EncodeUTF8=et;function tt(e,n){if(n){for(var r=new t(e.length),o=0;o<e.length;++o)r[o]=e.charCodeAt(o);return r}if(Qe)return Qe.encode(e);for(var a=e.length,i=new t(e.length+(e.length>>1)),l=0,s=function(e){i[l++]=e},o=0;o<a;++o){if(l+5>i.length){var u=new t(l+8+(a-o<<1));u.set(i),i=u}var c=e.charCodeAt(o);c<128||n?s(c):c<2048?(s(192|c>>6),s(128|c&63)):c>55295&&c<57344?(c=65536+(c&1047552)|e.charCodeAt(++o)&1023,s(240|c>>18),s(128|c>>12&63),s(128|c>>6&63),s(128|c&63)):(s(224|c>>12),s(128|c>>6&63),s(128|c&63))}return x(i,0,l)}d.strToU8=tt;function nt(e,t){if(t){for(var n="",r=0;r<e.length;r+=16384)n+=String.fromCharCode.apply(null,e.subarray(r,r+16384));return n}else{if(Xe)return Xe.decode(e);var o=Je(e),a=o[0],i=o[1];if(i.length)throw"invalid utf-8 data";return a}}d.strFromU8=nt;var rt=function(e){return e==1?3:e<6?2:e==9?1:0},ot=function(e,t){return t+30+ue(e,t+26)+ue(e,t+28)},at=function(e,t,n){var r=ue(e,t+28),o=nt(e.subarray(t+46,t+46+r),!(ue(e,t+8)&2048)),a=t+46+r,i=ce(e,t+20),l=n&&i==4294967295?it(e,a):[i,ce(e,t+24),ce(e,t+42)],s=l[0],u=l[1],c=l[2];return[ue(e,t+10),s,u,o,a+ue(e,t+30)+ue(e,t+32),c]},it=function(e,t){for(;ue(e,t)!=1;t+=4+ue(e,t+2));return[de(e,t+12),de(e,t+4),de(e,t+20)]},lt=function(e){var t=0;if(e)for(var n in e){var r=e[n].length;if(r>65535)throw"extra field too long";t+=r+4}return t},st=function(e,t,n,r,o,a,i,l){var s=r.length,u=n.extra,c=l&&l.length,d=lt(u);me(e,t,i!=null?33639248:67324752),t+=4,i!=null&&(e[t++]=20,e[t++]=n.os),e[t]=20,t+=2,e[t++]=n.flag<<1|(a==null&&8),e[t++]=o&&8,e[t++]=n.compression&255,e[t++]=n.compression>>8;var m=new Date(n.mtime==null?Date.now():n.mtime),p=m.getFullYear()-1980;if(p<0||p>119)throw"date not in range 1980-2099";if(me(e,t,p<<25|m.getMonth()+1<<21|m.getDate()<<16|m.getHours()<<11|m.getMinutes()<<5|m.getSeconds()>>>1),t+=4,a!=null&&(me(e,t,n.crc),me(e,t+4,a),me(e,t+8,n.size)),me(e,t+12,s),me(e,t+14,d),t+=16,i!=null&&(me(e,t,c),me(e,t+6,n.attrs),me(e,t+10,i),t+=14),e.set(r,t),t+=s,d)for(var _ in u){var f=u[_],g=f.length;me(e,t,+_),me(e,t+2,g),e.set(f,t+4),t+=4+g}return c&&(e.set(l,t),t+=c),t},ut=function(e,t,n,r,o){me(e,t,101010256),me(e,t+8,n),me(e,t+10,n),me(e,t+12,r),me(e,t+16,o)},ct=(function(){function e(e){this.filename=e,this.c=H(),this.size=0,this.compression=0}return e.prototype.process=function(e,t){this.ondata(null,e,t)},e.prototype.push=function(e,t){if(!this.ondata)throw"no callback - add to ZIP archive before pushing";this.c.p(e),this.size+=e.length,t&&(this.crc=this.c.d()),this.process(e,t||!1)},e})();d.ZipPassThrough=ct;var dt=(function(){function e(e,t){var n=this;t||(t={}),ct.call(this,e),this.d=new be(t,function(e,t){n.ondata(null,e,t)}),this.compression=8,this.flag=rt(t.level)}return e.prototype.process=function(e,t){try{this.d.push(e,t)}catch(e){this.ondata(e,null,t)}},e.prototype.push=function(e,t){ct.prototype.push.call(this,e,t)},e})();d.ZipDeflate=dt;var mt=(function(){function e(e,t){var n=this;t||(t={}),ct.call(this,e),this.d=new ve(t,function(e,t,r){n.ondata(e,t,r)}),this.compression=8,this.flag=rt(t.level),this.terminate=this.d.terminate}return e.prototype.process=function(e,t){this.d.push(e,t)},e.prototype.push=function(e,t){ct.prototype.push.call(this,e,t)},e})();d.AsyncZipDeflate=mt;var pt=(function(){function e(e){this.ondata=e,this.u=[],this.d=1}return e.prototype.add=function(e){var n=this;if(this.d&2)throw"stream finished";var r=tt(e.filename),o=r.length,a=e.comment,i=a&&tt(a),l=o!=e.filename.length||i&&a.length!=i.length,s=o+lt(e.extra)+30;if(o>65535)throw"filename too long";var u=new t(s);st(u,0,e,r,l);var c=[u],d=function(){for(var e=0,t=c;e<t.length;e++){var r=t[e];n.ondata(null,r,!1)}c=[]},m=this.d;this.d=0;var p=this.u.length,_=j(e,{f:r,u:l,o:i,t:function(){e.terminate&&e.terminate()},r:function(){if(d(),m){var e=n.u[p+1];e?e.r():n.d=1}m=1}}),f=0;e.ondata=function(r,o,a){if(r)n.ondata(r,o,a),n.terminate();else if(f+=o.length,c.push(o),a){var i=new t(16);me(i,0,134695760),me(i,4,e.crc),me(i,8,f),me(i,12,e.size),c.push(i),_.c=f,_.b=s+f+16,_.crc=e.crc,_.size=e.size,m&&_.r(),m=1}else m&&d()},this.u.push(_)},e.prototype.end=function(){var e=this;if(this.d&2)throw this.d&1?"stream finishing":"stream finished";this.d?this.e():this.u.push({r:function(){e.d&1&&(e.u.splice(-1,1),e.e())},t:function(){}}),this.d=3},e.prototype.e=function(){for(var e=0,n=0,r=0,o=0,a=this.u;o<a.length;o++){var i=a[o];r+=46+i.f.length+lt(i.extra)+(i.o?i.o.length:0)}for(var l=new t(r+22),s=0,u=this.u;s<u.length;s++){var i=u[s];st(l,e,i,i.f,i.u,i.c,n,i.o),e+=46+i.f.length+lt(i.extra)+(i.o?i.o.length:0),n+=i.b}ut(l,e,this.u.length,r,n),this.ondata(null,l,!0),this.d=2},e.prototype.terminate=function(){for(var e=0,t=this.u;e<t.length;e++){var n=t[e];n.t()}this.d=2},e})();d.Zip=pt;function _t(e,n,r){if(r||(r=n,n={}),typeof r!="function")throw"no callback";var o={};Ke(e,"",o,n);var a=Object.keys(o),i=a.length,l=0,s=0,u=i,c=new Array(i),d=[],m=function(){for(var e=0;e<d.length;++e)d[e]()},p=function(){var e=new t(s+22),n=l,o=s-l;s=0;for(var a=0;a<u;++a){var i=c[a];try{var d=i.c.length;st(e,s,i,i.f,i.u,d);var m=30+i.f.length+lt(i.extra),p=s+m;e.set(i.c,p),st(e,l,i,i.f,i.u,d,s,i.m),l+=16+m+(i.m?i.m.length:0),s=p+d}catch(e){return r(e,null)}}ut(e,l,c.length,o,n),r(null,e)};i||p();for(var _=function(e){var t=a[e],n=o[t],u=n[0],_=n[1],f=H(),g=u.length;f.p(u);var h=tt(t),y=h.length,C=_.comment,b=C&&tt(C),v=b&&b.length,S=lt(_.extra),R=_.level==0?0:8,L=function(n,o){if(n)m(),r(n,null);else{var a=o.length;c[e]=j(_,{size:g,crc:f.d(),c:o,f:h,m:b,u:y!=t.length||b&&C.length!=v,compression:R}),l+=30+y+S+a,s+=76+2*(y+S)+(v||0)+a,--i||p()}};if(y>65535&&L("filename too long",null),!R)L(null,u);else if(g<16e4)try{L(null,Re(u,_))}catch(e){L(e,null)}else d.push(Se(u,_,L))},f=0;f<u;++f)_(f);return m}d.zip=_t;function ft(e,n){n||(n={});var r={},o=[];Ke(e,"",r,n);var a=0,i=0;for(var l in r){var s=r[l],u=s[0],c=s[1],d=c.level==0?0:8,m=tt(l),p=m.length,_=c.comment,f=_&&tt(_),g=f&&f.length,h=lt(c.extra);if(p>65535)throw"filename too long";var y=d?Re(u,c):u,C=y.length,b=H();b.p(u),o.push(j(c,{size:u.length,crc:b.d(),c:y,f:m,m:f,u:p!=l.length||f&&_.length!=g,o:a,compression:d})),a+=30+p+h+C,i+=76+2*(p+h)+(g||0)+C}for(var v=new t(i+22),S=a,R=i-a,L=0;L<o.length;++L){var m=o[L];st(v,m.o,m,m.f,m.u,m.c.length);var E=30+m.f.length+lt(m.extra);v.set(m.c,m.o+E),st(v,a,m,m.f,m.u,m.c.length,m.o,m.m),a+=16+E+(m.m?m.m.length:0)}return ut(v,a,o.length,R,S),v}d.zipSync=ft;var gt=(function(){function e(){}return e.prototype.push=function(e,t){this.ondata(null,e,t)},e.compression=0,e})();d.UnzipPassThrough=gt;var ht=(function(){function e(){var e=this;this.i=new Le(function(t,n){e.ondata(null,t,n)})}return e.prototype.push=function(e,t){try{this.i.push(e,t)}catch(n){this.ondata(n,e,t)}},e.compression=8,e})();d.UnzipInflate=ht;var yt=(function(){function e(e,t){var n=this;t<32e4?this.i=new Le(function(e,t){n.ondata(null,e,t)}):(this.i=new Ee(function(e,t,r){n.ondata(e,t,r)}),this.terminate=this.i.terminate)}return e.prototype.push=function(e,t){this.i.terminate&&(e=x(e,0)),this.i.push(e,t)},e.compression=8,e})();d.AsyncUnzipInflate=yt;var Ct=(function(){function e(e){this.onfile=e,this.k=[],this.o={0:gt},this.p=q}return e.prototype.push=function(e,n){var r=this;if(!this.onfile)throw"no callback";if(!this.p)throw"stream finished";if(this.c>0){var o=Math.min(this.c,e.length),a=e.subarray(0,o);if(this.c-=o,this.d?this.d.push(a,!this.c):this.k[0].push(a),e=e.subarray(o),e.length)return this.push(e,n)}else{var i=0,l=0,s=void 0,u=void 0;this.p.length?e.length?(u=new t(this.p.length+e.length),u.set(this.p),u.set(e,this.p.length)):u=this.p:u=e;for(var c=u.length,d=this.c,m=d&&this.d,p=function(){var e,t=ce(u,l);if(t==67324752){i=1,s=l,_.d=null,_.c=0;var n=ue(u,l+6),o=ue(u,l+8),a=n&2048,m=n&8,p=ue(u,l+26),f=ue(u,l+28);if(c>l+30+p+f){var g=[];_.k.unshift(g),i=2;var h=ce(u,l+18),y=ce(u,l+22),C=nt(u.subarray(l+30,l+=30+p),!a);h==4294967295?(e=m?[-2]:it(u,l),h=e[0],y=e[1]):m&&(h=-1),l+=f,_.c=h;var b,v={name:C,compression:o,start:function(){if(!v.ondata)throw"no callback";if(!h)v.ondata(null,q,!0);else{var e=r.o[o];if(!e)throw"unknown compression type "+o;b=h<0?new e(C):new e(C,h,y),b.ondata=function(e,t,n){v.ondata(e,t,n)};for(var t=0,n=g;t<n.length;t++){var a=n[t];b.push(a,!1)}r.k[0]==g&&r.c?r.d=b:b.push(q,!0)}},terminate:function(){b&&b.terminate&&b.terminate()}};h>=0&&(v.size=h,v.originalSize=y),_.onfile(v)}return"break"}else if(d){if(t==134695760)return s=l+=12+(d==-2&&8),i=3,_.c=0,"break";if(t==33639248)return s=l-=4,i=3,_.c=0,"break"}},_=this;l<c-4;++l){var f=p();if(f==="break")break}if(this.p=q,d<0){var g=i?u.subarray(0,s-12-(d==-2&&8)-(ce(u,s-16)==134695760&&4)):u.subarray(0,l);m?m.push(g,!!i):this.k[+(i==2)].push(g)}if(i&2)return this.push(u.subarray(l),n);this.p=u.subarray(l)}if(n){if(this.c)throw"invalid zip file";this.p=null}},e.prototype.register=function(e){this.o[e.compression]=e},e})();d.Unzip=Ct;function bt(e,n){if(typeof n!="function")throw"no callback";for(var r=[],o=function(){for(var e=0;e<r.length;++e)r[e]()},a={},i=e.length-22;ce(e,i)!=101010256;--i)if(!i||e.length-i>65558){n("invalid zip file",null);return}var l=ue(e,i+8);l||n(null,{});var s=l,u=ce(e,i+16),c=u==4294967295;if(c){if(i=ce(e,i-12),ce(e,i)!=101075792){n("invalid zip file",null);return}s=l=ce(e,i+32),u=ce(e,i+48)}for(var d=function(i){var s=at(e,u,c),d=s[0],m=s[1],p=s[2],_=s[3],f=s[4],g=s[5],h=ot(e,g);u=f;var y=function(e,t){e?(o(),n(e,null)):(a[_]=t,--l||n(null,a))};if(!d)y(null,x(e,h,h+m));else if(d==8){var C=e.subarray(h,h+m);if(m<32e4)try{y(null,Ie(C,new t(p)))}catch(e){y(e,null)}else r.push(ke(C,{size:p},y))}else y("unknown compression type "+d,null)},m=0;m<s;++m)d(m);return o}d.unzip=bt;function vt(e){for(var n={},r=e.length-22;ce(e,r)!=101010256;--r)if(!r||e.length-r>65558)throw"invalid zip file";var o=ue(e,r+8);if(!o)return{};var a=ce(e,r+16),i=a==4294967295;if(i){if(r=ce(e,r-12),ce(e,r)!=101075792)throw"invalid zip file";o=ce(e,r+32),a=ce(e,r+48)}for(var l=0;l<o;++l){var s=at(e,a,i),u=s[0],c=s[1],d=s[2],m=s[3],p=s[4],_=s[5],f=ot(e,_);if(a=p,!u)n[m]=x(e,f,f+c);else if(u==8)n[m]=Ie(e.subarray(f,f+c),new t(d));else throw"unknown compression type "+u}return n}d.unzipSync=vt}var _=!1;function f(){return _||(_=!0,p()),m.exports}function g(e){switch(e){case void 0:return f()}}a.exports=g}),null);
__d("fflate",["fflate-0.6.10"],(function(t,n,r,o,a,i){a.exports=n("fflate-0.6.10")()}),null);
__d("WAGzip",["Promise","err","fflate"],(function(t,n,r,o,a,i,l){"use strict";var e,s=(function(e){function t(t){var n;return n=e.call(this,t)||this,n.$GzipWrapper$p_2=[],n.ondata=function(e,t){if(n.$GzipWrapper$p_2.push(e),!!t){var r=0;n.$GzipWrapper$p_2.forEach(function(e){r+=e.length});var o=new Uint8Array(r),a=0;n.$GzipWrapper$p_2.forEach(function(e){o.set(e,a),a+=e.length}),n.$GzipWrapper$p_1=o}},n}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.push=function(n,a){if(this.$GzipWrapper$p_1!=null)throw r("err")("Tried to push chunk to compressor after final block");n instanceof Uint8Array?e.prototype.push.call(this,n,a):n instanceof ArrayBuffer?e.prototype.push.call(this,new Uint8Array(n),a):e.prototype.push.call(this,o("fflate").strToU8(n),a)},n.result=function(){if(this.$GzipWrapper$p_1==null)throw r("err")("Tried to access result before adding final block");return this.$GzipWrapper$p_1},t})(o("fflate").Gzip);function u(e){return e===void 0&&(e={}),new s(e)}function c(e){return o("fflate").decompressSync(e)}function d(t){return(e||(e=n("Promise"))).resolve(c(t))}l.GzipWrapper=s,l.createDeflate=u,l.inflate=c,l.gzipInflate=d}),98);
__d("WAHandleDecisionTreeResult",["WAErrorMessage","WATagsLogger"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u;function c(t,n){var r=o("WATagsLogger").TAGS(["decision tree"]);return n.then(function(n){return n.success?n.value:n.error.type==="unknown-stanza"?(r.ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["unrecognized stanza: ",""])),t),"NO_ACK"):(n.error.type,r.ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[","] runtime-error ",""])),t.tag,n.error.error),"NO_ACK")}).catch(function(e){return r.ERROR(u||(u=babelHelpers.taggedTemplateLiteralLoose(["[","] unexpected-runtime-error: ",""])),t.tag,o("WAErrorMessage").maybeGetMessageFromError(e)),"NO_ACK"})}l.handleDecisionTreeResult=c}),98);
__d("WAIterableOperators",["err"],(function(t,n,r,o,a,i,l){"use strict";function*e(e){for(var t of e)yield t}function*s(e,t){var n=0;for(var r of e)yield t(r,n),n++}function u(e,t,n){return n===void 0&&(n=1),(function*(){if(n===0)throw r("err")("Step can't be zero.");if(n>0){if(e>t)return;for(var o=e;o<t;o+=n)yield o}else{if(e<t)return;for(var a=e;a>t;a+=n)yield a}})()}function*c(e,t){var n=0;for(var r of e)t(r,n)&&(yield r),n++}function*d(e,t){if(t<0)throw r("err")("Count must be a positive integer");var n=0;for(var o of e){if(n>=t)return;yield o,n++}}function m(e){for(var t of e)return t}l.iteratorFromArray=e,l.mapIterator=s,l.rangeIterator=u,l.filterIterator=c,l.takeIterator=d,l.first=m}),98);
__d("WAServerMediaType",["WAAssertUnreachable"],(function(t,n,r,o,a,i,l){"use strict";var e=["image","sticker","ptt","audio","document","video","gif","ppic","md-app-state","md-msg-hist","kyc-id","template","thumbnail-image","thumbnail-video","thumbnail-gif","thumbnail-document","thumbnail-link","payment-bg-image","novi-video","novi-image","product","product-catalog-image","xma-image","biz-cover-photo","preview","newsletter-music-artwork","newsletter-audio","newsletter-document","newsletter-image","newsletter-gif","newsletter-ptt","newsletter-sticker","newsletter-thumbnail-link","newsletter-video","sticker-pack","thumbnail-sticker-pack","music-artwork","group-history"];function s(e){switch(e){case"image":case"sticker":case"ptt":case"audio":case"document":case"video":case"gif":case"ppic":case"md-app-state":case"md-msg-hist":case"kyc-id":case"thumbnail-image":case"thumbnail-video":case"thumbnail-gif":case"thumbnail-document":case"thumbnail-link":case"payment-bg-image":case"novi-video":case"novi-image":case"template":case"product":case"product-catalog-image":case"xma-image":case"biz-cover-photo":case"preview":case"newsletter-music-artwork":case"newsletter-audio":case"newsletter-document":case"newsletter-image":case"newsletter-gif":case"newsletter-ptt":case"newsletter-sticker":case"newsletter-thumbnail-link":case"newsletter-video":case"sticker-pack":case"thumbnail-sticker-pack":case"music-artwork":case"group-history":return e;default:return null}}function u(e){switch(e){case"Image":return"image";case"Video":return"video";case"Ptt":return"ptt";case"Gif":return"gif";case"Sticker":return"sticker";case"DocumentFile":return"document";case"Text":case"Futureproof":case"Ciphertext":case"Unavailable":case"ExpiredEphemeral":case"Admin":case"Revoked":case"DeleteForMe":case"EphemeralSettingAdmin":case"EphemeralSyncResponse":case"EphemeralSettingChangeFromCurrentDevice":case"AlertICDC":case"GroupInvite":case"SenderKeyDistribution":case"Reaction":case"EditAction":case"ReceiverFetch":case"Raven":case"GroupPollCreate":case"GroupPollUpdate":return null;default:return r("WAAssertUnreachable")(e)}}l.SERVER_MEDIA=e,l.castToServerMediaType=s,l.getMediaType=u}),98);
__d("WAMediaConnParser",["WADeprecatedWapParser","WAServerMediaType"],(function(t,n,r,o,a,i,l){"use strict";var e=new(r("WADeprecatedWapParser"))("mediaConnParser",function(e){var t,n,r=e.child("media_conn"),o=c(r);return{hosts:o,authToken:r.attrString("auth"),authTokenExpiryTs:r.attrFutureTime("auth_ttl"),routesExpiryTs:r.attrFutureTime("ttl"),maxBuckets:r.attrInt("max_buckets"),maxManualRetry:(t=r.maybeAttrInt("max_manual_retry",0,4))!=null?t:3,maxAutoDownloadRetry:(n=r.maybeAttrInt("max_auto_download_retry",0,4))!=null?n:3}});function s(e){var t,n;if(e.hasAttr("fallback_hostname"))return{domain:e.attrString("fallback_hostname"),class:e.maybeAttrString("fallback_class"),ip4:(t=e.maybeAttrString("fallback_ip4"))!=null?t:void 0,ip6:(n=e.maybeAttrString("fallback_ip6"))!=null?n:void 0}}function u(e){var t,n,r,o;return{domain:e.attrString("hostname"),fallback:s(e),uploadable:d(e,"upload"),downloadable:d(e,"download"),isFallback:e.maybeAttrString("type")==="fallback",downloadBuckets:(t=(n=e.maybeChild("download_buckets"))==null?void 0:n.mapChildren(function(e){return parseInt(e.tag(),10)}))!=null?t:[],class:e.maybeAttrString("class"),ip4:(r=e.maybeAttrString("ip4"))!=null?r:void 0,ip6:(o=e.maybeAttrString("ip6"))!=null?o:void 0}}function c(e){return e.mapChildrenWithTag("host",u)}function d(e,t){return e.hasChild(t)?e.child(t).mapChildren(function(e){var t=e.tag();return o("WAServerMediaType").castToServerMediaType(t)}).filter(Boolean):o("WAServerMediaType").SERVER_MEDIA}l.mediaConnParser=e}),98);
__d("WAMediaWasmWorkerClient",["FBLogger","Promise","QPLUserFlow","VideoTranscodeUtils","WAByteArray","WACustomError","WAMediaWasmWorkerResource","WAPromiseTimeout","WAResultOrError","WorkerBundleResource","WorkerClient","WorkerMessagePort","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c,d,m,p,_,f,g,h,y,C,b,v,S,R,L,E,k,I,T,D,x,$=o("WorkerBundleResource").createDedicatedWebWorker(r("WAMediaWasmWorkerResource")),P="media_platform",N=function(){return r("FBLogger")(P).tags(["WAMediaWasmWorkerClient"])},M=new(o("WorkerMessagePort")).WorkerSyncedMessagePort($,"WAMediaWasmWorker");o("WorkerClient").init(M),N().DEBUG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["initiated."]))),M.addMessageListener("log",function(e){var t=e.logType,n=e.message;switch(t){case"dev":N().DEBUG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["from worker: ",""])),n);break;case"error":N().MUSTFIX(u||(u=babelHelpers.taggedTemplateLiteralLoose(["worker error: ",""])),n);break;default:}}),M.addMessageListener("qpl",function(e){w(e)});function w(e){var t=e.event,n=e.action;switch(n.type){case"point":{r("QPLUserFlow").addPoint(t,n.pointName,{instanceKey:n.instanceKey});break}case"annotations":{r("QPLUserFlow").addAnnotations(t,n.annotations,{instanceKey:n.instanceKey});break}default:N().MUSTFIX(c||(c=babelHelpers.taggedTemplateLiteralLoose(["Unknown QPL action type from worker: ",""])),n.type)}}function A(e){var t=e.input,n=e.eventFlow;return G({operation:"webpCheck",input:o("WAByteArray").uint8ArrayToBuffer(t)},n)}function F(e){var t=e.input,n=e.eventFlow;return N().INFO(d||(d=babelHelpers.taggedTemplateLiteralLoose(["mp4RepairMuxInWorker processing video"]))),G({operation:"mp4RepairMux",input:o("WAByteArray").uint8ArrayToBuffer(t)},n)}function O(e){return B.apply(this,arguments)}function B(){return B=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t,n=e.input,r=e.forceTranscode,a=e.supportsHevc,i=e.eventFlow;N().INFO(_||(_=babelHelpers.taggedTemplateLiteralLoose(["transcodeToMp4InWorker processing video"])));var l=H();N().INFO(f||(f=babelHelpers.taggedTemplateLiteralLoose(["sending input bytes to worker, requestId: ",""])),l);var s=yield j();if(!s.success)return o("WAResultOrError").makeError({error:s.error});var u=s.value,c=u.onMessageOnce("transcodeToMp4Response",function(e){return e.requestId===l}),d=o("WAByteArray").uint8ArrayToBuffer(n),m=d?[d]:void 0;u.postMessage({input:d,requestId:l,forceTranscode:r,supportsHevc:a,type:"transcodeToMp4Request",qplData:i.flowDetails},m),i==null||i.addPoint("sent_request_to_media_worker_start");var p=yield c,y=p.output;if(N().INFO(g||(g=babelHelpers.taggedTemplateLiteralLoose(["received output from worker, requestId: ",", success: ",""])),l,y.success),y.success){var C=y.value;return i==null||i.addPoint("sent_request_to_media_worker_end"),o("VideoTranscodeUtils").annotateTranscodeReponse({eventFlow:i,maybeTranscodeResponse:C.transcodeResponse,metadata:C.metadata}),o("WAResultOrError").makeResult(C)}return N().MUSTFIX(h||(h=babelHelpers.taggedTemplateLiteralLoose(["requestId: ",", error: ",""])),l,(t=y.error)==null?void 0:t.error.errorMessage),i==null||i.addPoint("sent_request_to_media_worker_end"),o("VideoTranscodeUtils").annotateTranscodeReponse({eventFlow:i,maybeTranscodeResponse:y.error.transcodeResponse,metadata:y.error.metadata}),i==null||i.addAnnotations({string:{errorMessage:y.error.error.errorMessage}}),o("WAResultOrError").makeError({error:y.error.error.errorType,transcodeResponse:y.error.transcodeResponse})}),B.apply(this,arguments)}function W(e){var t=e.imageData,n=e.quality,r=e.useHdScanConfig,a=e.eventFlow;return G({operation:"progressiveJpegEncode",input:o("WAByteArray").uint8ArrayToBuffer(t.data),height:t.height,width:t.width,quality:n,useHdScanConfig:r},a)}function q(e){return U.apply(this,arguments)}function U(){return U=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e.file,n=e.quality,r=e.useHdScanConfig,o=e.eventFlow,a=e.maxOutputResolution,i=yield t.arrayBuffer();return G({operation:"progressiveJpegEncodeWithFile",input:i,fileName:t.name,fileType:t.type,quality:n,useHdScanConfig:r,maxOutputWidth:a==null?void 0:a.width,maxOutputHeight:a==null?void 0:a.height},o)}),U.apply(this,arguments)}function V(e){N().INFO(m||(m=babelHelpers.taggedTemplateLiteralLoose(["start prewarming media wasm worker, operation: ",""])),e),M.postMessage({type:"prewarm",operation:e})}var H=(function(){var e=0;return function(){return++e}})();function G(e,t){return z.apply(this,arguments)}function z(){return z=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=H();N().INFO(y||(y=babelHelpers.taggedTemplateLiteralLoose(["sending input bytes to worker, requestId: ",""])),n);var r=yield j(t);if(!r.success)return r;var a=r.value,i=a.onMessageOnce("mediaOperationResponse",function(e){return e.requestId===n}),l=e.input?[e.input]:void 0;a.postMessage(babelHelpers.extends({},e,{requestId:n,type:"mediaOperationRequest"}),l),t==null||t.addPoint("sent_request_to_media_worker_start");var s=yield i,u=s.output;return u.success?(N().INFO(C||(C=babelHelpers.taggedTemplateLiteralLoose(["received output from worker, requestId: ",""])),n),t==null||t.addPoint("sent_request_to_media_worker_end",{bool:{isOpfsSyncSupported:u.value.isOpfsSyncSupported}}),o("WAResultOrError").makeResult(u.value.bytes)):(N().MUSTFIX(b||(b=babelHelpers.taggedTemplateLiteralLoose(["requestId: ",", error: ",""])),n,u.error.errorMessage),t==null||t.addPoint("sent_request_to_media_worker_fail"),o("WAResultOrError").makeError(u.error.errorType))}),z.apply(this,arguments)}function j(e){e==null||e.addPoint("get_connected_worker_port_start");var t=3e4;return o("WAPromiseTimeout").promiseTimeout(M.fullyConnected,t).then(function(t){return e==null||e.addPoint("get_connected_worker_port_end"),o("WAResultOrError").makeResult(t)}).catch(function(t){return e==null||e.addPoint("get_connected_worker_port_fail",{string:{workerPortFailure:t instanceof o("WACustomError").TimeoutError?"timeout":"runtime-error"}}),t instanceof o("WACustomError").TimeoutError?o("WAResultOrError").makeError("worker-connection-timeout"):(N().MUSTFIX(p||(p=babelHelpers.taggedTemplateLiteralLoose(["worker-connection-runtime-error: ",""])),t),o("WAResultOrError").makeError("worker-connection-runtime-error"))})}function K(e){return Q.apply(this,arguments)}function Q(){return Q=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t,r,a=e.file,i=e.maxDimension,l=e.thumbnailBlobByteSizeLimitBytes,s=e.thumbnailQualityPercentageWhenAboveByteSizeLimit,u=H();N().INFO(v||(v=babelHelpers.taggedTemplateLiteralLoose(["sending input to worker, requestId: ",""])),u);var c=yield j();if(!c.success)return c;var d=c.value,m=d.onMessageOnce("mediaGenerateImageThumbnailResponse",function(e){return e.requestId===u}),p=yield a.arrayBuffer(),_=p?[p]:void 0;d.postMessage({input:p,fileName:a.name,fileType:a.type,maxDimension:i,requestId:u,thumbnailBlobByteSizeLimitBytes:l,thumbnailQualityPercentageWhenAboveByteSizeLimit:s,type:"mediaGenerateImageThumbnailRequest"},_);var f=yield m;return N().INFO(S||(S=babelHelpers.taggedTemplateLiteralLoose(["received output from worker, requestId: ",", success: ",""])),u,f.output.success),f.output.success?o("WAResultOrError").makeResult(f.output.value):(N().MUSTFIX(R||(R=babelHelpers.taggedTemplateLiteralLoose(["requestId: ",", error: ",""])),u,(t=f.output.error)==null?void 0:t.errorMessage),(x||(x=n("Promise"))).reject((r=f.output.error)==null?void 0:r.errorMessage))}),Q.apply(this,arguments)}function X(e,t){return Y.apply(this,arguments)}function Y(){return Y=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){N().INFO(L||(L=babelHelpers.taggedTemplateLiteralLoose(["start media storage shadow test"])));var n=H(),r=yield j();if(!r.success)return o("WAResultOrError").makeError({errorName:"port-init",errorMessage:r.error});var a=r.value,i=a.onMessageOnce("mediaStorageShadowTestResponse",function(e){return e.requestId===n});a.postMessage({input:e,requestId:n,storageType:t,type:"mediaStorageShadowTestRequest"});var l=yield i,s=l.output;return s.success?(N().INFO(E||(E=babelHelpers.taggedTemplateLiteralLoose(["received storage results from worker, requestId: ",""])),n),o("WAResultOrError").makeResult(s.value)):(N().MUSTFIX(k||(k=babelHelpers.taggedTemplateLiteralLoose(["media storage test failed for storageType: ",", error: ",""])),t,s.error.errorMessage),o("WAResultOrError").makeError({errorName:s.error.errorName,errorMessage:s.error.errorMessage}))}),Y.apply(this,arguments)}function J(e){return Z.apply(this,arguments)}function Z(){return Z=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e.mediaType,n=e.rawMimeType,r=e.input,a=e.eventFlow,i=H();N().INFO(I||(I=babelHelpers.taggedTemplateLiteralLoose(["start kaleidoscope classifiy in worker, requestId: ",""])),i);var l=yield j(a);if(!l.success)return l;var s=l.value,u=s.onMessageOnce("kaleidoscopeClassifyResponse",function(e){return e.requestId===i});s.postMessage({mediaType:t,rawMimeType:n,input:r,requestId:i,type:"kaleidoscopeClassifyRequest"}),a==null||a.addPoint("sent_request_to_media_worker_start");var c=yield u,d=c.output;return d.success?(N().INFO(T||(T=babelHelpers.taggedTemplateLiteralLoose(["received output from worker, requestId: ",""])),i),a==null||a.addPoint("sent_request_to_media_worker_end"),d):(N().MUSTFIX(D||(D=babelHelpers.taggedTemplateLiteralLoose(["kaleidoscope classifiy error: ",", requestId: ",","])),d.error,i),a==null||a.addPoint("sent_request_to_media_worker_fail"),o("WAResultOrError").makeError(d.error))}),Z.apply(this,arguments)}l.webpCheckInWorker=A,l.mp4RepairMuxInWorker=F,l.transcodeToMp4InWorker=O,l.progressiveJpegEncodeInWorker=W,l.progressiveJpegEncodeInWorkerWithFile=q,l.prewarmMediaWasmWorker=V,l.getConnectedWorkerPortWithTimeout=j,l.generateImageThumbnailInWorker=K,l.runMediaStorageShadowTestWasmWorker=X,l.kaleidoscopeClassifyInWorker=J}),98);
__d("WANoiseSocket",["Promise","WACryptoDependencies","WALogger","WAPromiseQueue","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c,d=(c||(c=n("Promise"))).reject("UNINITIALIZED HANDSHAKE"),m=new Uint8Array(0);d.catch(function(){});var p=(function(){function t(t,n,r){var a=this;this.$4=[],this.$5=new(o("WAPromiseQueue")).PromiseQueue,this.$6=new(o("WAPromiseQueue")).PromiseQueue,this.$7=0,this.$8=0,this.$9=!1,this.$14=function(t){a.$1.closed?o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["NoiseSocket socket closed while encrypting frame"]))):(o("WALogger").DEV(e||(e=babelHelpers.taggedTemplateLiteralLoose(["Sending encrypted frame to web socket"]))).tags("WANoiseSocket"),a.$1.sendFrame(t))},this.$12=function(e){var t=a.$7++;a.$5.enqueueHandlers(g(a.$2,t,void 0,e),a.$15)},this.$13=function(){a.$9=!0,a.$5.wait().then(function(){a.$9=!1;var e=a.$11;e&&e()})},this.$15=function(e){a.$10?a.$10(e):a.$4.push(e)},this.$1=t,this.$3=n,this.$2=r,t.onFrame=this.$12,this.$1.onClose=this.$13,t.convertBufferedToFrames()}var r=t.prototype;return r.sendFrameAsync=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=yield this.sendFrame(e);return t});function t(t){return e.apply(this,arguments)}return t})(),r.sendFrame=function(t){if(this.$9)return(c||(c=n("Promise"))).resolve();this.$1.throwIfClosed();var e=this.$8++;return o("WALogger").DEV(u||(u=babelHelpers.taggedTemplateLiteralLoose(["sendFrame adding to queue with frame size: "," bytes"])),t.length).tags("WANoiseSocket"),this.$6.enqueueHandlers(f(this.$3,e,void 0,t),this.$14)},r.setOnFrame=function(t){this.$10=t},r.setOnClose=function(t){this.$11=t},r.close=function(){this.$1.close()},t})();function _(e){var t=new ArrayBuffer(12),n=new DataView(t);return n.setUint32(8,e),new Uint8Array(t)}function f(e,t,n,r){return o("WACryptoDependencies").getCrypto().subtle.encrypt({name:"AES-GCM",iv:_(t),additionalData:n?new Uint8Array(n):m},e,r)}function g(e,t,n,r){return o("WACryptoDependencies").getCrypto().subtle.decrypt({name:"AES-GCM",iv:_(t),additionalData:n?new Uint8Array(n):m},e,r)}l.NoiseSocket=p}),98);
__d("WANoiseHandshake",["Promise","WABinary","WACryptoDependencies","WACryptoHkdf","WACryptoSha256","WAErrors","WANoiseSocket","WAResolvable","WATagsLogger","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c,d=o("WATagsLogger").TAGS(["NoiseHandshake"]),m=(c||(c=n("Promise"))).reject("UNINITIALIZED HANDSHAKE"),p=new Uint8Array(0);m.catch(function(){});var _=(function(){function t(e){var t=this;this.$2=m,this.$3=m,this.$4=m,this.$5=0,this.$1=e,this.$6=new(o("WAResolvable")).Resolvable,e.onClose=function(){t.$6.reject(new(o("WAErrors")).Disconnected("NoiseHandshake: SocketClosed"))},b(this.$6.promise)}var r=t.prototype;return r.start=function(t,r){var e=o("WABinary").Binary.build(t).readBuffer(),a=e.byteLength===32?(c||(c=n("Promise"))).resolve(e):o("WACryptoSha256").sha256(e);this.$2=a,this.$3=a,this.$4=a.then(g),this.authenticate(r)},r.sendAndReceive=function(t){var e=this.$1,r=new(c||(c=n("Promise")))(function(n){e.onFrame=function(t){e.onFrame=null,n(t)},e.sendFrame(t)});return this.$7(r)},r.send=function(t){this.$1.sendFrame(t)},r.authenticate=function(t){this.$2=(c||(c=n("Promise"))).all([this.$2,t]).then(function(e){var t=e[0],n=e[1],r=o("WABinary").Binary.build(t,n).readByteArrayView();return o("WACryptoSha256").sha256(r)})},r.encrypt=(function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){try{var r=this.$5++,o=(c||(c=n("Promise"))).all([this.$4,this.$2,t]).then(function(e){var t=e[0],n=e[1],o=e[2];return h(t,r,n,o)});this.authenticate(o);var a=yield this.$7(o);return a}catch(t){throw d.ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["Error on encrypt: ",""])),t),t}});function r(e){return t.apply(this,arguments)}return r})(),r.decrypt=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){try{var r=this.$5++,o=(c||(c=n("Promise"))).all([this.$4,this.$2]).then(function(t){var n=t[0],o=t[1];return y(n,r,o,e)});this.authenticate(e);var a=yield this.$7(o);return a}catch(e){throw d.ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["Error on decrypt: "," reason: ",""])),e,t),e}});function t(t,n){return e.apply(this,arguments)}return t})(),r.finish=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=this;try{var t=this.$3.then(function(e){return C(e,new Uint8Array(0))}).then(function(e){var t=e[0],r=e[1];return(c||(c=n("Promise"))).all([g(t,["encrypt"]),g(r,["decrypt"])])}).then(function(t){var n=t[0],r=t[1];return new(o("WANoiseSocket")).NoiseSocket(e.$1,n,r)}),r=yield this.$7(t);return r}catch(e){throw d.ERROR(u||(u=babelHelpers.taggedTemplateLiteralLoose(["Error on finish: ",""])),e),e}});function t(){return e.apply(this,arguments)}return t})(),r.mixIntoKey=function(t){this.$5=0;var e=(c||(c=n("Promise"))).all([this.$3,t]).then(function(e){var t=e[0],n=e[1];return C(t,new Uint8Array(n))});this.$3=e.then(function(e){return e[0]}),this.$4=e.then(function(e){return g(e[1])}),b(this.$3),b(this.$4)},r.$7=function(t){var e=this;return(c||(c=n("Promise"))).race([t,this.$6.promise]).then(function(t){return e.$6.resolveWasCalled()?e.$6.promise:t})},t})();function f(e){var t=new ArrayBuffer(12),n=new DataView(t);return n.setUint32(8,e),new Uint8Array(t)}function g(e,t){return t===void 0&&(t=["encrypt","decrypt"]),o("WACryptoDependencies").getCrypto().subtle.importKey("raw",new Uint8Array(e),"AES-GCM",!1,t)}function h(e,t,n,r){return o("WACryptoDependencies").getCrypto().subtle.encrypt({name:"AES-GCM",iv:f(t),additionalData:n?new Uint8Array(n):p},e,r)}function y(e,t,n,r){return o("WACryptoDependencies").getCrypto().subtle.decrypt({name:"AES-GCM",iv:f(t),additionalData:n?new Uint8Array(n):p},e,r)}function C(e,t){return o("WACryptoHkdf").extractWithSaltAndExpand(t,new Uint8Array(e),"",64).then(function(e){return[e.slice(0,32),e.slice(32)]})}function b(e){e.catch(function(){})}l.NoiseHandshake=_}),98);
__d("WAOpusRecorderWorkerClient",["WAWebOpusRecorderWorkerResource","WorkerBundleResource"],(function(t,n,r,o,a,i,l){var e=(function(){function e(e){this.$1=o("WorkerBundleResource").createDedicatedWebWorker(r("WAWebOpusRecorderWorkerResource")),this.$1.onmessage=e!=null?e:null}var t=e.prototype;return t.getWorker=function(){return this.$1},t.postMessage=function(t,n){var e={type:"message",message:t};this.$1.postMessage(e,n)},t.addEventListener=function(t,n){this.$1.addEventListener(t,n)},t.removeEventListener=function(t,n){this.$1.addEventListener(t,n)},e})();function s(){return new e}function u(t){return new e(t)}l.WAOpusRecorderWorkerClient=e,l.getOpusEncoderWorker=s,l.getOpusDecoderWorker=u}),98);
__d("WAOpusRecorderPlayer",["Promise","WABinary","WABlobToArrayBuffer","WALogger","WAOpusRecorderWorkerClient"],(function(t,n,r,o,a,i,l){var e,s,u,c,d="audio/wav",m,p=0;function _(){return p++,m||(m=new window.AudioContext),m}function f(){if(p--,p===0&&m){try{m.close().catch(function(t){o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["releaseAudioContext close async error: ",""])),t).devConsole(t)})}catch(e){o("WALogger").WARN(s||(s=babelHelpers.taggedTemplateLiteralLoose(["releaseAudioContext close sync error: ",""])),e).devConsole(e)}m=void 0}}var g=(function(){function e(e){this.oggBlob=e}var t=e.prototype;return t.generateBlob=function(){return this.oggBlobToWAVBlob(this.oggBlob,1)},t.oggBlobToWAVBlob=function(t,r){var e=this;r===void 0&&(r=2);var a=r;return new(c||(c=n("Promise")))(function(n){var r=function(r){if(r.data==null){for(var t=function(t){l.forEach(function(e){for(var n=e[t]||e[0],r=0;r<n.length;r++)s.push(n[r])})},o=0;o<a;o++)t(o);var i=e.encodeWAV(s,c,a),u=new Blob([i.readByteArrayView()],{type:d});f(),n(u)}else l.push(r.data),a=l[0].length},i=o("WAOpusRecorderWorkerClient").getOpusDecoderWorker(r),l=[],s=[],c=_(),m={outputBufferSampleRate:c.sampleRate,bufferLength:4096};i.postMessage({command:"decode-init",config:m}),o("WABlobToArrayBuffer").blobToArrayBuffer(t).then(function(e){i.postMessage({command:"decode",pages:new Uint8Array(e)}),i.postMessage({command:"decode-done"})}).catch(function(e){o("WALogger").WARN(u||(u=babelHelpers.taggedTemplateLiteralLoose(["Player::oggBlobToWAVBlob error: ",""])),e).devConsole(e)})})},t.encodeWAV=function(t,n,r){var e=new(o("WABinary")).Binary(void 0,!0);e.ensureCapacity(44+t.length*2),e.writeString("RIFF"),e.writeUint32(36+t.length*2),e.writeString("WAVE"),e.writeString("fmt "),e.writeUint32(16),e.writeUint16(1),e.writeUint16(r),e.writeUint32(n.sampleRate),e.writeUint32(n.sampleRate*r*2),e.writeUint16(r*2),e.writeUint16(16),e.writeString("data"),e.writeUint32(t.length*2);for(var a=0;a<t.length;a++){var i=Math.max(-1,Math.min(t[a],1));i*=i>0?32767:32768,e.writeInt16(Math.floor(i))}return e},e})();l.default=g}),98);
__d("WAPriorityQueue",[],(function(t,n,r,o,a,i){"use strict";var e=(function(){function e(e,t){this.$2=e,this.$1=[],this.$3(t)}var t=e.prototype;return t.size=function(){return this.$1.length},t.$3=function(t){var e=this;t!=null&&t.length&&t.forEach(function(t){e.push(t)})},t.$4=function(t,n){var e=this.$1[n];this.$1[n]=this.$1[t],this.$1[t]=e},t.$5=function(t){if(t===void 0&&(t=0),t!==0){var e=this.$6(t),n=e*2+1,r=e*2+2,o=this.$1.length;if(!(t>=o)){var a=this.$7(e),i=e;if(n<o){var l=this.$7(n);a>l&&(i=n,a=l)}if(r<o){var s=this.$7(r);a>s&&(i=r)}i!==e&&(this.$4(i,e),this.$5(e))}}},t.$8=function(t){t===void 0&&(t=0);var e=t*2+1,n=t*2+2,r=this.$1.length;if(!(t>=r)){var o=this.$7(t),a=t;if(e<r){var i=this.$7(e);o>i&&(a=e,o=i)}if(n<r){var l=this.$7(n);o>l&&(a=n)}a!==t&&this.$4(a,t),e<r&&this.$8(e),n<r&&this.$8(n)}},t.$7=function(t){return this.$2(this.$1[t])},t.$6=function(t){return t%2===0?(t-2)/2:(t-1)/2},t.push=function(t){this.$1.push(t);var e=this.$1.length-1;this.$5(e)},t.pull=function(){var e=this.$1.shift();return this.heapify(),e},t.heapify=function(){this.$8(0)},t.peek=function(){return this.$1[0]},e})();i.default=e}),66);
__d("WAProgressiveJpegMarkers",[],(function(t,n,r,o,a,i){"use strict";var e=255,l=0,s={SOF0:192,SOF1:193,SOF2:194,SOF3:195,DHT:196,SOF5:197,SOF6:198,SOF7:199,JPG:200,SOF9:201,SOF10:202,SOF11:203,SOF13:205,SOF14:206,SOF15:207,RST0:208,RST1:209,RST2:210,RST3:211,RST4:212,RST5:213,RST6:214,RST7:215,SOI:216,EOI:217,SOS:218,DQT:219,DRI:221,APP0:224,APP1:225,APP2:226,APP3:227,APP4:228,APP5:229,APP6:230,APP7:231,APP8:232,APP9:233,APP10:234,APP11:235,APP12:236,APP13:237,APP14:238,APP15:239,COM:254,TEM:1},u=[l,s.RST0,s.RST1,s.RST2,s.RST3,s.RST4,s.RST5,s.RST6,s.RST7];i.MARKER_PREFIX=e,i.MARKER_ESCAPE_BYTE=l,i.MARKERS=s,i.SOS_STREAM=u}),66);
__d("WAPromiseCache",[],(function(t,n,r,o,a,i){"use strict";var e=function(t){this.promise=t,this.lastUsedTime=this.createdTime=+Date.now()},l=(function(){function t(e,t){var n=t.maxCached,r=n===void 0?10:n,o=t.maxAge,a=o===void 0?1/0:o,i=t.shouldCache;this.$1={},this.$2=r,this.$3=a,this.$4=e,this.$5=i}var n=t.prototype;return n.delete=function(t){delete this.$1[t]},n.getOrRun=function(n){var t=this,r=this.$1;if(this.$3!==1/0)for(var o=Date.now()-this.$3,a=Object.keys(r),i=0;i<a.length;i++){var l=a[i];r[l].createdTime<o&&delete r[l]}var s=r[n];if(s)return s.lastUsedTime=+Date.now(),s.promise;var u=Object.keys(r);if(u.length>=this.$2){for(var c,d,m=0;m<u.length;m++){var p=u[m],_=r[p];(d==null||_.lastUsedTime<d)&&(d=_.lastUsedTime,c=p)}c!=null&&delete r[c]}for(var f=arguments.length,g=new Array(f>1?f-1:0),h=1;h<f;h++)g[h-1]=arguments[h];var y=this.$4.apply(void 0,[n].concat(g));return r[n]=new e(y),y.then(function(e){var r=t.$5;t.$1[n]===y&&!r(e)&&delete t.$1[n]}).catch(function(){t.$1[n]===y&&delete t.$1[n]}),y},n.isCached=function(t){var e=this.$1,n=e[t];if(n){var r=!0;if(this.$3!==1/0){var o=Date.now()-this.$3;r=n.createdTime>=o}return r&&!!n}return!1},t})();i.default=l}),66);
__d("WAPromiseCallSync",["Promise"],(function(t,n,r,o,a,i){"use strict";var e;function l(t,r){try{for(var o=arguments.length,a=new Array(o>2?o-2:0),i=2;i<o;i++)a[i-2]=arguments[i];return(e||(e=n("Promise"))).resolve(t.apply(r,a))}catch(t){return(e||(e=n("Promise"))).reject(t)}}i.promiseCallSync=l}),66);
__d("WAPttComposerScaleWaveform",["invariant"],(function(t,n,r,o,a,i,l,s){function e(e,t){return t===e.length?e:t===0?[]:e.length===0?new Array(t).fill(0):t>e.length?u(e,t):c(e,t)}function u(e,t){t>e.length||s(0,75746,t,e.length);var n;if(e.length===1)n=0;else{var r=(t-e.length)/(e.length-1);n=1/(1+r)}var o=[];t>=1&&o.push(e[0]);for(var a=1;a<t-1;a++){var i=a*n,l=Math.floor(i),u=i-l;o.push(d(e[l],e[Math.ceil(i)],u))}return t>=2&&o.push(e[e.length-1]),o}function c(e,t){t<e.length||s(0,75747,t,e.length);var n=[],r=t/e.length,o=0,a=0,i=0;for(var l of e)o+=l,i+=1,a+=r,a>=1&&(n.push(o/i),i=0,o=0,a-=1);return i>0&&n.push(o/i),n}function d(e,t,n){return e+(t-e)*n}l.default=e}),98);
__d("WAQplUploader",["WALogger","WAPromiseDelays","WAPromiseRetryLoop","WAQplTypes","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p,_,f,g,h={minTimeout:1e3,maxTimeout:1e4,retries:5,type:"exponential"},y=100,C={MAX_COUNT:4,MIN_DELAY:1*1e3*60,MAX_DELAY:15*1e3*60},b=300,v=1440*60,S,R,L;function E(e,t){return k.apply(this,arguments)}function k(){return k=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n,r,a,i,l;S=t.healthLogger,R=t.storageApi,!L&&(o("WALogger").DEV(s||(s=babelHelpers.taggedTemplateLiteralLoose(["QPL Uploader, start"]))),L={sendEvents:e.sendEvents,isQplEnabled:e.isQplEnabled,startDelayInMs:1e3*((n=e.startDelayInSeconds)!=null?n:b),intervalInMs:1e3*((r=e.intervalInSeconds)!=null?r:v),minRetryDelayInMs:1e3*((a=e.minRetryDelayInSeconds)!=null?a:C.MIN_DELAY),maxRetryDelayInMs:1e3*((i=e.maxRetryDelayInSeconds)!=null?i:C.MAX_DELAY),maxRetryAttemptsCount:(l=e.maxRetryAttemptsCount)!=null?l:C.MAX_COUNT},o("WALogger").DEV(u||(u=babelHelpers.taggedTemplateLiteralLoose(["QPL Uploader, sleeping prior to start for "," ms"])),L.startDelayInMs),yield o("WAPromiseDelays").delayMs(L.startDelayInMs),yield $(),T())}),k.apply(this,arguments)}function I(){return $()}function T(){o("WALogger").DEV(e||(e=babelHelpers.taggedTemplateLiteralLoose(["QPL Uploader, sleeping between uploads for "," ms"])),L.intervalInMs),setTimeout(n("asyncToGeneratorRuntime").asyncToGenerator(function*(){yield $(),T()}),L.intervalInMs)}function D(){return x.apply(this,arguments)}function x(){return x=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=L.minRetryDelayInMs+Math.floor(Math.random()*(L.maxRetryDelayInMs-L.minRetryDelayInMs));yield o("WAPromiseDelays").delayMs(e)}),x.apply(this,arguments)}function $(e){return P.apply(this,arguments)}function P(){return P=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t;if(e===void 0&&(e=0),!!((t=L)!=null&&t.isQplEnabled())){o("WALogger").DEV(c||(c=babelHelpers.taggedTemplateLiteralLoose(["QPL Uploader, upload triggered, attempt ",""])),e);try{var n=yield R.getRowCount();o("WALogger").DEV(d||(d=babelHelpers.taggedTemplateLiteralLoose(["QPL Uploader, uploading "," rows"])),n);for(var r=0;r<n;){var a=yield R.getFromBottom(y);yield N(a);var i=a[0].id||0,l=a[a.length-1].id||0;yield R.deleteRange(i,l),r+=a.length}o("WALogger").DEV(m||(m=babelHelpers.taggedTemplateLiteralLoose(["QPL Uploader, done upload."])))}catch(t){if(o("WALogger").DEV(p||(p=babelHelpers.taggedTemplateLiteralLoose(["QPL Uploader upload session failed, error: ",""])),t),e<L.maxRetryAttemptsCount)yield D(),$(e+1);else{var s;o("WALogger").ERROR(_||(_=babelHelpers.taggedTemplateLiteralLoose(["QPL Uploader, error during upload session, error: ",""])),t).verbose().devConsole(t).sendLogs("QPL Uploader upload session failed"),(s=S)==null||s.errorUploadingChunk(t)}}}}),P.apply(this,arguments)}function N(e){return M.apply(this,arguments)}function M(){return M=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=new(o("WAPromiseRetryLoop")).PromiseRetryLoop({name:"QplUploadChunk",timer:{algo:{type:h.type,first:h.minTimeout},max:h.maxTimeout},code:function(n){var t=e[0].id,r=e[e.length-1].id;return o("WALogger").DEV(f||(f=babelHelpers.taggedTemplateLiteralLoose(["QPL Uploader, sending rows ","-",", count ",""])),t,r,e.length),L.sendEvents(e).then(function(){n()}).catch(function(e){if(e instanceof o("WAQplTypes").QplServerStatusCodeError)switch(e.statusCode){case 500:o("WALogger").WARN(g||(g=babelHelpers.taggedTemplateLiteralLoose(["QPL Uploader uploadChunk, retriable error: ",""])),e.message);break;default:n();break}throw e})}});t.start(),yield t.promise()}),M.apply(this,arguments)}l.start=E,l.forceQplUpload=I}),98);
__d("WASmaxOutChatstateInternalTestMixin",["WASmaxAttrs","WASmaxJsx","WASmaxMixins","WAWap"],(function(t,n,r,o,a,i,l){function e(e){var t=e.testConfig,n=o("WASmaxJsx").smax("smax$any",null,o("WASmaxJsx").smax("test",{config:o("WASmaxAttrs").OPTIONAL(o("WAWap").CUSTOM_STRING,t)}));return n}function s(t,n){var r=e(n);return o("WASmaxMixins").mergeStanzas(t,r)}l.mergeInternalTestMixin=s}),98);
__d("WASmaxMixinGroupExhaustiveError",[],(function(t,n,r,o,a,i){"use strict";var e=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return t=e.call.apply(e,[this].concat(r))||this,t.name="SmaxMixinGroupExhaustiveError",babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}return babelHelpers.inheritsLoose(t,e),t})(babelHelpers.wrapNativeSuper(Error));i.SmaxMixinGroupExhaustiveError=e}),66);
__d("WASmaxOutChatstateComposingMixin",["WASmaxAttrs","WASmaxJsx","WASmaxMixins"],(function(t,n,r,o,a,i,l){function e(e){var t=e.hasComposingMediaAudio,n=o("WASmaxJsx").smax("chatstate",null,o("WASmaxJsx").smax("composing",{media:o("WASmaxAttrs").OPTIONAL_LITERAL("audio",t)}));return n}function s(t,n){var r=e(n);return o("WASmaxMixins").mergeStanzas(t,r)}l.mergeComposingMixin=s}),98);
__d("WASmaxOutChatstatePausedMixin",["WASmaxJsx","WASmaxMixins"],(function(t,n,r,o,a,i,l){function e(){var e=o("WASmaxJsx").smax("chatstate",null,o("WASmaxJsx").smax("paused",null));return e}function s(t){var n=e();return o("WASmaxMixins").mergeStanzas(t,n)}l.mergePausedMixin=s}),98);
__d("WASmaxOutChatstateStateTypes",["WASmaxMixinGroupExhaustiveError","WASmaxOutChatstateComposingMixin","WASmaxOutChatstatePausedMixin"],(function(t,n,r,o,a,i,l){function e(e,t){if(t.composing)return o("WASmaxOutChatstateComposingMixin").mergeComposingMixin(e,t.composing);if(t.isPaused)return o("WASmaxOutChatstatePausedMixin").mergePausedMixin(e);throw new(o("WASmaxMixinGroupExhaustiveError")).SmaxMixinGroupExhaustiveError}l.mergeStateTypes=e}),98);
__d("WASmaxOutChatstateClientNotificationRequest",["WASmaxJsx","WASmaxMixins","WASmaxOutChatstateInternalTestMixin","WASmaxOutChatstateStateTypes","WAWap"],(function(t,n,r,o,a,i,l){function e(e){var t=e.chatstateTo,n=e.internalTestMixinArgs,r=e.stateTypesArgs,a=o("WASmaxOutChatstateStateTypes").mergeStateTypes(o("WASmaxMixins").optionalMerge(o("WASmaxOutChatstateInternalTestMixin").mergeInternalTestMixin,o("WASmaxJsx").smax("chatstate",{to:o("WAWap").JID(t)}),n),r);return a}l.makeClientNotificationRequest=e}),98);
__d("WASmaxChatstateClientNotificationRPC",["WAComms","WASmaxOutChatstateClientNotificationRequest","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){function e(e){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=o("WASmaxOutChatstateClientNotificationRequest").makeClientNotificationRequest(e);yield o("WAComms").castSmaxStanza(t)}),s.apply(this,arguments)}l.sendClientNotificationRPC=e}),98);
__d("WASendChatStateProtocol",["WALogger","WASmaxChatstateClientNotificationRPC"],(function(t,n,r,o,a,i,l){"use strict";var e;function s(t,n){o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["sendChatStateProtocol Sending "," to ",""])),n,t);var r;return n==="idle"?r={isPaused:!0}:r={composing:{hasComposingMediaAudio:n==="recording_audio"}},o("WASmaxChatstateClientNotificationRPC").sendClientNotificationRPC({chatstateTo:t,stateTypesArgs:r})}l.sendChatStateProtocol=s}),98);
__d("WASmaxInPassiveModeActiveIQResponseSuccess",["WAResultOrError","WASmaxParseJid","WASmaxParseReference","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxParseUtils").flattenedChildWithTag(e,"active");if(!r.success)return r;var a=o("WASmaxParseReference").attrStringFromReference(t,["id"]);if(!a.success)return a;var i=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"id",a.value);if(!i.success)return i;var l=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"type","result");if(!l.success)return l;var s=o("WASmaxParseJid").literalJid(o("WASmaxParseJid").attrDomainJid,e,"from","s.whatsapp.net");return s.success?o("WAResultOrError").makeResult({type:l.value,from:s.value}):s}l.parseActiveIQResponseSuccess=e}),98);
__d("WASmaxOutPassiveModeActiveIQRequest",["WASmaxJsx","WAWap"],(function(t,n,r,o,a,i,l){function e(){var e=o("WASmaxJsx").smax("iq",{id:o("WAWap").generateId(),type:"set",xmlns:"passive",to:o("WAWap").S_WHATSAPP_NET},o("WASmaxJsx").smax("active",null));return e}l.makeActiveIQRequest=e}),98);
__d("WASmaxPassiveModeActiveIQRPC",["WAComms","WASmaxInPassiveModeActiveIQResponseSuccess","WASmaxOutPassiveModeActiveIQRequest","WASmaxParsingFailure","WASmaxRpcUtils","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){function e(e){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=o("WASmaxOutPassiveModeActiveIQRequest").makeActiveIQRequest(),n=yield o("WAComms").sendSmaxStanza(t,e),r=o("WASmaxInPassiveModeActiveIQResponseSuccess").parseActiveIQResponseSuccess(n,t);if(r.success)return{name:"ActiveIQResponseSuccess",value:r.value};throw new(o("WASmaxParsingFailure")).SmaxParsingFailure(o("WASmaxRpcUtils").errorMessageRpcParsing("ActiveIQ",{Success:r}))}),s.apply(this,arguments)}l.sendActiveIQRPC=e}),98);
__d("WASmaxInPassiveModePassiveIQResponseSuccess",["WAResultOrError","WASmaxParseJid","WASmaxParseReference","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxParseUtils").flattenedChildWithTag(e,"passive");if(!r.success)return r;var a=o("WASmaxParseReference").attrStringFromReference(t,["id"]);if(!a.success)return a;var i=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"id",a.value);if(!i.success)return i;var l=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"type","result");if(!l.success)return l;var s=o("WASmaxParseJid").literalJid(o("WASmaxParseJid").attrDomainJid,e,"from","s.whatsapp.net");return s.success?o("WAResultOrError").makeResult({type:l.value,from:s.value}):s}l.parsePassiveIQResponseSuccess=e}),98);
__d("WASmaxOutPassiveModePassiveIQRequest",["WASmaxJsx","WAWap"],(function(t,n,r,o,a,i,l){function e(){var e=o("WASmaxJsx").smax("iq",{id:o("WAWap").generateId(),type:"set",xmlns:"passive",to:o("WAWap").S_WHATSAPP_NET},o("WASmaxJsx").smax("passive",null));return e}l.makePassiveIQRequest=e}),98);
__d("WASmaxPassiveModePassiveIQRPC",["WAComms","WASmaxInPassiveModePassiveIQResponseSuccess","WASmaxOutPassiveModePassiveIQRequest","WASmaxParsingFailure","WASmaxRpcUtils","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){function e(e){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=o("WASmaxOutPassiveModePassiveIQRequest").makePassiveIQRequest(),n=yield o("WAComms").sendSmaxStanza(t,e),r=o("WASmaxInPassiveModePassiveIQResponseSuccess").parsePassiveIQResponseSuccess(n,t);if(r.success)return{name:"PassiveIQResponseSuccess",value:r.value};throw new(o("WASmaxParsingFailure")).SmaxParsingFailure(o("WASmaxRpcUtils").errorMessageRpcParsing("PassiveIQ",{Success:r}))}),s.apply(this,arguments)}l.sendPassiveIQRPC=e}),98);
__d("WASendPassiveModeProtocol",["WALogger","WASmaxPassiveModeActiveIQRPC","WASmaxPassiveModePassiveIQRPC","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){"use strict";var e;function s(e){return u.apply(this,arguments)}function u(){return u=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){t==="active"?yield o("WASmaxPassiveModeActiveIQRPC").sendActiveIQRPC():yield o("WASmaxPassiveModePassiveIQRPC").sendPassiveIQRPC(),o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["sendPassiveModeIq: passive mode set to '","'"])),t)}),u.apply(this,arguments)}l.sendPassiveModeProtocol=s}),98);
__d("WASmaxOutPresenceAvailabilityRequest",["WASmaxAttrs","WASmaxJsx","WAWap"],(function(t,n,r,o,a,i,l){function e(e){var t=e.presenceType,n=e.presenceName,r=o("WASmaxJsx").smax("presence",{type:o("WASmaxAttrs").OPTIONAL(o("WAWap").CUSTOM_STRING,t),name:o("WASmaxAttrs").OPTIONAL(o("WAWap").CUSTOM_STRING,n)});return r}l.makeAvailabilityRequest=e}),98);
__d("WASmaxPresenceAvailabilityRPC",["WAComms","WASmaxOutPresenceAvailabilityRequest","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){function e(e){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=o("WASmaxOutPresenceAvailabilityRequest").makeAvailabilityRequest(e);yield o("WAComms").castSmaxStanza(t)}),s.apply(this,arguments)}l.sendAvailabilityRPC=e}),98);
__d("WASendPresenceStatusProtocol",["WASmaxPresenceAvailabilityRPC"],(function(t,n,r,o,a,i,l){"use strict";function e(e){var t=e.status,n=e.name;return o("WASmaxPresenceAvailabilityRPC").sendAvailabilityRPC({presenceType:t,presenceName:n})}l.sendPresenceStatusProtocol=e}),98);
__d("WASmaxInClientExpirationClientExpirationRequest",["WAResultOrError","WASmaxParseJid","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"ib");if(!t.success)return t;var n=o("WASmaxParseUtils").flattenedChildWithTag(e,"client_expiration");if(!n.success)return n;var r=o("WASmaxParseJid").literalJid(o("WASmaxParseJid").attrDomainJid,e,"from","s.whatsapp.net");if(!r.success)return r;var a=o("WASmaxParseUtils").optional(o("WASmaxParseUtils").attrIntRange,n.value,"t",0,void 0);return a.success?o("WAResultOrError").makeResult({from:r.value,clientExpirationT:a.value}):a}l.parseClientExpirationRequest=e}),98);
__d("WASmaxClientExpirationClientExpirationRPC",["WASmaxInClientExpirationClientExpirationRequest","WASmaxParsingFailure","WASmaxRpcUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxInClientExpirationClientExpirationRequest").parseClientExpirationRequest(e);if(!t.success)throw new(o("WASmaxParsingFailure")).SmaxParsingFailure(o("WASmaxRpcUtils").errorMessageRpcParsing("ClientExpiration",{Request:t}));return{parsedRequest:t.value}}l.receiveClientExpirationRPC=e}),98);
__d("WASmaxInGroupsServerNotificationMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"notification");if(!t.success)return t;var n=o("WASmaxParseUtils").attrIntRange(e,"t",0,void 0);if(!n.success)return n;var r=o("WASmaxParseUtils").attrStanzaId(e,"id");if(!r.success)return r;var a=o("WASmaxParseUtils").optional(o("WASmaxParseUtils").attrIntRange,e,"offline",0,1024);return a.success?o("WAResultOrError").makeResult({t:n.value,id:r.value,offline:a.value}):a}l.parseServerNotificationMixin=e}),98);
__d("WASmaxInGroupsGroupsDirtyNotificationRequest",["WAResultOrError","WASmaxInGroupsServerNotificationMixin","WASmaxParseJid","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"group");if(!t.success)return t;var n=o("WASmaxParseJid").attrGroupJid(e,"jid");return n.success?o("WAResultOrError").makeResult({jid:n.value}):n}function s(t){var n=o("WASmaxParseUtils").assertTag(t,"notification");if(!n.success)return n;var r=o("WASmaxParseUtils").flattenedChildWithTag(t,"groups_dirty");if(!r.success)return r;var a=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,t,"type","w:gp2");if(!a.success)return a;var i=o("WASmaxParseJid").literalJid(o("WASmaxParseJid").attrDomainJid,t,"from","g.us");if(!i.success)return i;var l=o("WASmaxInGroupsServerNotificationMixin").parseServerNotificationMixin(t);if(!l.success)return l;var s=o("WASmaxParseUtils").mapChildrenWithTag(r.value,"group",1,1e4,e);return s.success?o("WAResultOrError").makeResult(babelHelpers.extends({type:a.value,from:i.value},l.value,{groupsDirtyGroup:s.value})):s}l.parseGroupsDirtyNotificationRequestGroupsDirtyGroup=e,l.parseGroupsDirtyNotificationRequest=s}),98);
__d("WASmaxOutGroupsNotificationClientAckMixin",["WASmaxInGroupsEnums","WASmaxJsx","WASmaxMixins","WASmaxParseJid","WASmaxParseReference","WASmaxParseUtils","WASmaxParsingFailure","WAWap"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseReference").attrFromReference(o("WASmaxParseUtils").attrStanzaId,e,["id"]);if(!t.success)throw new(o("WASmaxParsingFailure")).SmaxParsingFailure(t.error);var n=o("WASmaxParseReference").attrFromReference(o("WASmaxParseJid").attrJidEnum,e,["from"],o("WASmaxInGroupsEnums").DOMAINJID_GROUPJID);if(!n.success)throw new(o("WASmaxParsingFailure")).SmaxParsingFailure(n.error);var r=o("WASmaxParseReference").attrFromReference(o("WASmaxParseUtils").attrString,e,["type"]);if(!r.success)throw new(o("WASmaxParsingFailure")).SmaxParsingFailure(r.error);var a=o("WASmaxJsx").smax("ack",{id:o("WAWap").STANZA_ID(t.value),to:o("WAWap").JID(n.value),class:"notification",type:o("WAWap").CUSTOM_STRING(r.value)});return a}function s(t,n){var r=e(n);return o("WASmaxMixins").mergeStanzas(t,r)}l.mergeNotificationClientAckMixin=s}),98);
__d("WASmaxOutGroupsGroupsDirtyNotificationResponseAck",["WASmaxJsx","WASmaxOutGroupsNotificationClientAckMixin"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxOutGroupsNotificationClientAckMixin").mergeNotificationClientAckMixin(o("WASmaxJsx").smax("ack",null),e);return t}l.makeGroupsDirtyNotificationResponseAck=e}),98);
__d("WASmaxGroupsGroupsDirtyNotificationRPC",["WASmaxInGroupsGroupsDirtyNotificationRequest","WASmaxOutGroupsGroupsDirtyNotificationResponseAck","WASmaxParsingFailure","WASmaxRpcUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxInGroupsGroupsDirtyNotificationRequest").parseGroupsDirtyNotificationRequest(e);if(!t.success)throw new(o("WASmaxParsingFailure")).SmaxParsingFailure(o("WASmaxRpcUtils").errorMessageRpcParsing("GroupsDirtyNotification",{Request:t}));return{parsedRequest:t.value,makeGroupsDirtyNotificationResponseAck:function(){return o("WASmaxOutGroupsGroupsDirtyNotificationResponseAck").makeGroupsDirtyNotificationResponseAck(e)}}}l.receiveGroupsDirtyNotificationRPC=e}),98);
__d("WASmaxInGroupsClientErrors",["WAResultOrError","WASmaxInGroupsIQErrorBadRequestMixin","WASmaxInGroupsIQErrorFallbackClientMixin","WASmaxInGroupsIQErrorForbiddenMixin","WASmaxInGroupsIQErrorItemNotFoundMixin","WASmaxInGroupsIQErrorLockedMixin","WASmaxInGroupsIQErrorNotAuthorizedMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxInGroupsIQErrorBadRequestMixin").parseIQErrorBadRequestMixin(e);if(t.success)return o("WAResultOrError").makeResult({name:"IQErrorBadRequest",value:t.value});var n=o("WASmaxInGroupsIQErrorItemNotFoundMixin").parseIQErrorItemNotFoundMixin(e);if(n.success)return o("WAResultOrError").makeResult({name:"IQErrorItemNotFound",value:n.value});var r=o("WASmaxInGroupsIQErrorNotAuthorizedMixin").parseIQErrorNotAuthorizedMixin(e);if(r.success)return o("WAResultOrError").makeResult({name:"IQErrorNotAuthorized",value:r.value});var a=o("WASmaxInGroupsIQErrorForbiddenMixin").parseIQErrorForbiddenMixin(e);if(a.success)return o("WAResultOrError").makeResult({name:"IQErrorForbidden",value:a.value});var i=o("WASmaxInGroupsIQErrorLockedMixin").parseIQErrorLockedMixin(e);if(i.success)return o("WAResultOrError").makeResult({name:"IQErrorLocked",value:i.value});var l=o("WASmaxInGroupsIQErrorFallbackClientMixin").parseIQErrorFallbackClientMixin(e);return l.success?o("WAResultOrError").makeResult({name:"IQErrorFallbackClient",value:l.value}):o("WASmaxParseUtils").errorMixinDisjunction(e,["IQErrorBadRequest","IQErrorItemNotFound","IQErrorNotAuthorized","IQErrorForbidden","IQErrorLocked","IQErrorFallbackClient"],[t,n,r,a,i,l])}l.parseClientErrors=e}),98);
__d("WASmaxInGroupsRevokeRequestCodeResponseClientError",["WAResultOrError","WASmaxInGroupsClientErrors","WASmaxInGroupsIQErrorResponseMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxParseUtils").flattenedChildWithTag(e,"error");if(!r.success)return r;var a=o("WASmaxInGroupsIQErrorResponseMixin").parseIQErrorResponseMixin(e,t);if(!a.success)return a;var i=o("WASmaxInGroupsClientErrors").parseClientErrors(r.value);return i.success?o("WAResultOrError").makeResult(babelHelpers.extends({},a.value,{errorClientErrors:i.value})):i}l.parseRevokeRequestCodeResponseClientError=e}),98);
__d("WASmaxInGroupsRevokeRequestCodeResponseServerError",["WASmaxInGroupsBaseServerErrorMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxInGroupsBaseServerErrorMixin").parseBaseServerErrorMixin(e,t);return r.success,r}l.parseRevokeRequestCodeResponseServerError=e}),98);
__d("WASmaxInGroupsRevokeRequestCodeResponseSuccess",["WAResultOrError","WASmaxInGroupsGroupAddressingModeMixin","WASmaxInGroupsIQResultResponseMixin","WASmaxInGroupsPhoneNumberMixin","WASmaxInGroupsUsernameAttMixin","WASmaxParseJid","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"participant");if(!t.success)return t;var n=o("WASmaxParseJid").attrUserJid(e,"jid");if(!n.success)return n;var r=o("WASmaxParseUtils").optionalLiteral(o("WASmaxParseUtils").attrString,e,"error","404");if(!r.success)return r;var a=o("WASmaxInGroupsPhoneNumberMixin").parsePhoneNumberMixin(e),i=o("WASmaxInGroupsUsernameAttMixin").parseUsernameAttMixin(e);return o("WAResultOrError").makeResult({jid:n.value,error:r.value,phoneNumberMixin:a.success?a.value:null,usernameAttMixin:i.success?i.value:null})}function s(t,n){var r=o("WASmaxParseUtils").assertTag(t,"iq");if(!r.success)return r;var a=o("WASmaxParseUtils").flattenedChildWithTag(t,"revoke");if(!a.success)return a;var i=o("WASmaxInGroupsIQResultResponseMixin").parseIQResultResponseMixin(t,n);if(!i.success)return i;var l=o("WASmaxInGroupsGroupAddressingModeMixin").parseGroupAddressingModeMixin(t),s=o("WASmaxParseUtils").mapChildrenWithTag(a.value,"participant",1,1e3,e);return s.success?o("WAResultOrError").makeResult(babelHelpers.extends({},i.value,{groupAddressingModeMixin:l.success?l.value:null,revokeParticipant:s.value})):s}l.parseRevokeRequestCodeResponseSuccessRevokeParticipant=e,l.parseRevokeRequestCodeResponseSuccess=s}),98);
__d("WASmaxOutGroupsBaseIQSetRequestMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(t,n,r,o,a,i,l){function e(){var e=o("WASmaxJsx").smax("iq",{id:o("WAWap").generateId(),type:"set"});return e}function s(t){var n=e();return o("WASmaxMixins").mergeStanzas(t,n)}l.mergeBaseIQSetRequestMixin=s}),98);
__d("WASmaxOutGroupsBaseSetGroupMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutGroupsBaseIQSetRequestMixin","WAWap"],(function(t,n,r,o,a,i,l){function e(e){var t=e.iqTo,n=o("WASmaxOutGroupsBaseIQSetRequestMixin").mergeBaseIQSetRequestMixin(o("WASmaxJsx").smax("iq",{to:o("WAWap").GROUP_JID(t),xmlns:"w:g2"}));return n}function s(t,n){var r=e(n);return o("WASmaxMixins").mergeStanzas(t,r)}l.mergeBaseSetGroupMixin=s}),98);
__d("WASmaxOutGroupsRevokeRequestCodeRequest",["WASmaxChildren","WASmaxJsx","WASmaxOutGroupsBaseSetGroupMixin","WAWap"],(function(t,n,r,o,a,i,l){function e(e){var t=e.participantJid,n=o("WASmaxJsx").smax("participant",{jid:o("WAWap").USER_JID(t)});return n}function s(t){var n=t.participantArgs,r=o("WASmaxOutGroupsBaseSetGroupMixin").mergeBaseSetGroupMixin(o("WASmaxJsx").smax("iq",null,o("WASmaxJsx").smax("revoke",null,o("WASmaxChildren").REPEATED_CHILD(e,n,1,1e3))),t);return r}l.makeRevokeRequestCodeRequestRevokeParticipant=e,l.makeRevokeRequestCodeRequest=s}),98);
__d("WASmaxGroupsRevokeRequestCodeRPC",["WAComms","WASmaxInGroupsRevokeRequestCodeResponseClientError","WASmaxInGroupsRevokeRequestCodeResponseServerError","WASmaxInGroupsRevokeRequestCodeResponseSuccess","WASmaxOutGroupsRevokeRequestCodeRequest","WASmaxParsingFailure","WASmaxRpcUtils","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){function e(e,t){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=o("WASmaxOutGroupsRevokeRequestCodeRequest").makeRevokeRequestCodeRequest(e),r=yield o("WAComms").sendSmaxStanza(n,t),a=o("WASmaxInGroupsRevokeRequestCodeResponseSuccess").parseRevokeRequestCodeResponseSuccess(r,n);if(a.success)return{name:"RevokeRequestCodeResponseSuccess",value:a.value};var i=o("WASmaxInGroupsRevokeRequestCodeResponseClientError").parseRevokeRequestCodeResponseClientError(r,n);if(i.success)return{name:"RevokeRequestCodeResponseClientError",value:i.value};var l=o("WASmaxInGroupsRevokeRequestCodeResponseServerError").parseRevokeRequestCodeResponseServerError(r,n);if(l.success)return{name:"RevokeRequestCodeResponseServerError",value:l.value};throw new(o("WASmaxParsingFailure")).SmaxParsingFailure(o("WASmaxRpcUtils").errorMessageRpcParsing("RevokeRequestCode",{Success:a,ClientError:i,ServerError:l}))}),s.apply(this,arguments)}l.sendRevokeRequestCodeRPC=e}),98);
__d("WASmaxInGroupsIQErrorNotAllowedMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"error");if(!t.success)return t;var n=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"text","not-allowed");if(!n.success)return n;var r=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrInt,e,"code",405);return r.success?o("WAResultOrError").makeResult({text:n.value,code:r.value}):r}l.parseIQErrorNotAllowedMixin=e}),98);
__d("WASmaxInGroupsIQErrorParentLinkedGroupsParticipantsResourceLimitMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"error");if(!t.success)return t;var n=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"text","linked-groups-participants-resource-limit");if(!n.success)return n;var r=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrInt,e,"code",412);return r.success?o("WAResultOrError").makeResult({text:n.value,code:r.value}):r}l.parseIQErrorParentLinkedGroupsParticipantsResourceLimitMixin=e}),98);
__d("WASmaxInGroupsIQErrorResourceConstraintMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"error");if(!t.success)return t;var n=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"text","resource-constraint");if(!n.success)return n;var r=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrInt,e,"code",500);return r.success?o("WAResultOrError").makeResult({text:n.value,code:r.value}):r}l.parseIQErrorResourceConstraintMixin=e}),98);
__d("WASmaxInGroupsIQErrorResourceLimitMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"error");if(!t.success)return t;var n=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"text","resource-limit");if(!n.success)return n;var r=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrInt,e,"code",419);return r.success?o("WAResultOrError").makeResult({text:n.value,code:r.value}):r}l.parseIQErrorResourceLimitMixin=e}),98);
__d("WASmaxInGroupsParentGroupMixin",["WAResultOrError","WASmaxParseJid"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseJid").attrGroupJid(e,"parent_group_jid");return t.success?o("WAResultOrError").makeResult({parentGroupJid:t.value}):t}l.parseParentGroupMixin=e}),98);
__d("WASmaxInMdAESEncryptionMetadataMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").flattenedChildWithTag(e,"encrypted_key");if(!t.success)return t;var n=o("WASmaxParseUtils").flattenedChildWithTag(e,"nonce");if(!n.success)return n;var r=o("WASmaxParseUtils").flattenedChildWithTag(e,"encrypted_data");if(!r.success)return r;var a=o("WASmaxParseUtils").flattenedChildWithTag(e,"auth_tag");if(!a.success)return a;var i=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"version","1");if(!i.success)return i;var l=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"algorithm","aes-256-gcm");if(!l.success)return l;var s=o("WASmaxParseUtils").contentBytesRange(t.value,1,2048);if(!s.success)return s;var u=o("WASmaxParseUtils").contentBytesRange(n.value,1,128);if(!u.success)return u;var c=o("WASmaxParseUtils").contentBytesRange(r.value,1,8192);if(!c.success)return c;var d=o("WASmaxParseUtils").contentBytesRange(a.value,1,128);return d.success?o("WAResultOrError").makeResult({version:i.value,algorithm:l.value,encryptedKeyElementValue:s.value,nonceElementValue:u.value,encryptedDataElementValue:c.value,authTagElementValue:d.value}):d}l.parseAESEncryptionMetadataMixin=e}),98);
__d("WASmaxInMdBaseIQSetRequestMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"iq");if(!t.success)return t;var n=o("WASmaxParseUtils").attrStanzaId(e,"id");if(!n.success)return n;var r=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"type","set");return r.success?o("WAResultOrError").makeResult({id:n.value,type:r.value}):r}l.parseBaseIQSetRequestMixin=e}),98);
__d("WASmaxInMdIQErrorBadRequestMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"error");if(!t.success)return t;var n=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"text","bad-request");if(!n.success)return n;var r=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrInt,e,"code",400);return r.success?o("WAResultOrError").makeResult({text:n.value,code:r.value}):r}l.parseIQErrorBadRequestMixin=e}),98);
__d("WASmaxInMdIQErrorInternalServerErrorMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"error");if(!t.success)return t;var n=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"text","internal-server-error");if(!n.success)return n;var r=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrInt,e,"code",500);return r.success?o("WAResultOrError").makeResult({text:n.value,code:r.value}):r}l.parseIQErrorInternalServerErrorMixin=e}),98);
__d("WASmaxInMdCompanionFinishErrors",["WAResultOrError","WASmaxInMdIQErrorBadRequestMixin","WASmaxInMdIQErrorInternalServerErrorMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxInMdIQErrorInternalServerErrorMixin").parseIQErrorInternalServerErrorMixin(e);if(t.success)return o("WAResultOrError").makeResult({name:"IQErrorInternalServerError",value:t.value});var n=o("WASmaxInMdIQErrorBadRequestMixin").parseIQErrorBadRequestMixin(e);return n.success?o("WAResultOrError").makeResult({name:"IQErrorBadRequest",value:n.value}):o("WASmaxParseUtils").errorMixinDisjunction(e,["IQErrorInternalServerError","IQErrorBadRequest"],[t,n])}l.parseCompanionFinishErrors=e}),98);
__d("WASmaxInMdIQErrorResponseMixin",["WAResultOrError","WASmaxParseReference","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxParseReference").attrStringFromReference(t,["id"]);if(!r.success)return r;var a=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"id",r.value);if(!a.success)return a;var i=o("WASmaxParseReference").attrStringFromReference(t,["to"]);if(!i.success)return i;var l=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"from",i.value);if(!l.success)return l;var s=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"type","error");return s.success?o("WAResultOrError").makeResult({type:s.value}):s}l.parseIQErrorResponseMixin=e}),98);
__d("WASmaxInMdCompanionFinishResponseError",["WAResultOrError","WASmaxInMdCompanionFinishErrors","WASmaxInMdIQErrorResponseMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxParseUtils").flattenedChildWithTag(e,"error");if(!r.success)return r;var a=o("WASmaxInMdIQErrorResponseMixin").parseIQErrorResponseMixin(e,t);if(!a.success)return a;var i=o("WASmaxInMdCompanionFinishErrors").parseCompanionFinishErrors(r.value);return i.success?o("WAResultOrError").makeResult(babelHelpers.extends({},a.value,{errorCompanionFinishErrors:i.value})):i}l.parseCompanionFinishResponseError=e}),98);
__d("WASmaxInMdIQResultResponseMixin",["WAResultOrError","WASmaxParseReference","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxParseReference").attrStringFromReference(t,["id"]);if(!r.success)return r;var a=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"id",r.value);if(!a.success)return a;var i=o("WASmaxParseReference").attrStringFromReference(t,["to"]);if(!i.success)return i;var l=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"from",i.value);if(!l.success)return l;var s=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"type","result");return s.success?o("WAResultOrError").makeResult({type:s.value}):s}l.parseIQResultResponseMixin=e}),98);
__d("WASmaxInMdCompanionFinishResponseSuccess",["WASmaxInMdIQResultResponseMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxInMdIQResultResponseMixin").parseIQResultResponseMixin(e,t);return r.success,r}l.parseCompanionFinishResponseSuccess=e}),98);
__d("WASmaxInMdIQErrorFeatureNotAvailableMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"error");if(!t.success)return t;var n=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"text","feature-not-available");if(!n.success)return n;var r=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrInt,e,"code",452);return r.success?o("WAResultOrError").makeResult({text:n.value,code:r.value}):r}l.parseIQErrorFeatureNotAvailableMixin=e}),98);
__d("WASmaxInMdIQErrorForbiddenMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"error");if(!t.success)return t;var n=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"text","forbidden");if(!n.success)return n;var r=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrInt,e,"code",403);return r.success?o("WAResultOrError").makeResult({text:n.value,code:r.value}):r}l.parseIQErrorForbiddenMixin=e}),98);
__d("WASmaxInMdIQErrorRateOverlimitMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"error");if(!t.success)return t;var n=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"text","rate-overlimit");if(!n.success)return n;var r=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrInt,e,"code",429);return r.success?o("WAResultOrError").makeResult({text:n.value,code:r.value}):r}l.parseIQErrorRateOverlimitMixin=e}),98);
__d("WASmaxInMdIqMixinErrors",["WAResultOrError","WASmaxInMdIQErrorBadRequestMixin","WASmaxInMdIQErrorFeatureNotAvailableMixin","WASmaxInMdIQErrorForbiddenMixin","WASmaxInMdIQErrorInternalServerErrorMixin","WASmaxInMdIQErrorRateOverlimitMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxInMdIQErrorInternalServerErrorMixin").parseIQErrorInternalServerErrorMixin(e);if(t.success)return o("WAResultOrError").makeResult({name:"IQErrorInternalServerError",value:t.value});var n=o("WASmaxInMdIQErrorBadRequestMixin").parseIQErrorBadRequestMixin(e);if(n.success)return o("WAResultOrError").makeResult({name:"IQErrorBadRequest",value:n.value});var r=o("WASmaxInMdIQErrorFeatureNotAvailableMixin").parseIQErrorFeatureNotAvailableMixin(e);if(r.success)return o("WAResultOrError").makeResult({name:"IQErrorFeatureNotAvailable",value:r.value});var a=o("WASmaxInMdIQErrorRateOverlimitMixin").parseIQErrorRateOverlimitMixin(e);if(a.success)return o("WAResultOrError").makeResult({name:"IQErrorRateOverlimit",value:a.value});var i=o("WASmaxInMdIQErrorForbiddenMixin").parseIQErrorForbiddenMixin(e);return i.success?o("WAResultOrError").makeResult({name:"IQErrorForbidden",value:i.value}):o("WASmaxParseUtils").errorMixinDisjunction(e,["IQErrorInternalServerError","IQErrorBadRequest","IQErrorFeatureNotAvailable","IQErrorRateOverlimit","IQErrorForbidden"],[t,n,r,a,i])}l.parseIqMixinErrors=e}),98);
__d("WASmaxInMdCompanionHelloResponseError",["WAResultOrError","WASmaxInMdIQErrorResponseMixin","WASmaxInMdIqMixinErrors","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxParseUtils").flattenedChildWithTag(e,"error");if(!r.success)return r;var a=o("WASmaxInMdIQErrorResponseMixin").parseIQErrorResponseMixin(e,t);if(!a.success)return a;var i=o("WASmaxInMdIqMixinErrors").parseIqMixinErrors(r.value);return i.success?o("WAResultOrError").makeResult(babelHelpers.extends({},a.value,{errorIqMixinErrors:i.value})):i}l.parseCompanionHelloResponseError=e}),98);
__d("WASmaxInMdCompanionHelloResponseNotifyCompanion",["WAResultOrError","WASmaxInMdIQResultResponseMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxParseUtils").flattenedChildWithTag(e,"link_code_companion_reg");if(!r.success)return r;var a=o("WASmaxParseUtils").flattenedChildWithTag(r.value,"link_code_pairing_ref");if(!a.success)return a;var i=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,r.value,"stage","companion_hello");if(!i.success)return i;var l=o("WASmaxParseUtils").contentBytes(a.value);if(!l.success)return l;var s=o("WASmaxInMdIQResultResponseMixin").parseIQResultResponseMixin(e,t);return s.success?o("WAResultOrError").makeResult(babelHelpers.extends({linkCodeCompanionRegStage:i.value,linkCodeCompanionRegLinkCodePairingRefElementValue:l.value},s.value)):s}l.parseCompanionHelloResponseNotifyCompanion=e}),98);
__d("WASmaxInMdEnums",[],(function(t,n,r,o,a,i){var e={0:"0",1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9",a:"a",b:"b",c:"c",d:"d",e:"e",f:"f",g:"g",h:"h",i:"i",j:"j",k:"k",l:"l",m:"m"},l={false:"false",true:"true"};i.ENUM_0_1_2_3_4_5_6_7_8_9_A_B_C_D_E_F_G_H_I_J_K_L_M=e,i.ENUM_FALSE_TRUE=l}),66);
__d("WASmaxInMdSetRegRequest",["WAResultOrError","WASmaxInMdAESEncryptionMetadataMixin","WASmaxInMdBaseIQSetRequestMixin","WASmaxInMdEnums","WASmaxParseJid","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"biz");if(!t.success)return t;var n=o("WASmaxParseUtils").attrString(e,"name");return n.success?o("WAResultOrError").makeResult({name:n.value}):n}function s(e){var t=o("WASmaxParseUtils").assertTag(e,"client-props");if(!t.success)return t;var n=o("WASmaxParseUtils").contentBytes(e);return n.success?o("WAResultOrError").makeResult({elementValue:n.value}):n}function u(e){var t=o("WASmaxParseUtils").assertTag(e,"encryption-metadata");if(!t.success)return t;var n=o("WASmaxInMdAESEncryptionMetadataMixin").parseAESEncryptionMetadataMixin(e);return n.success,n}function c(t){var n=o("WASmaxParseUtils").assertTag(t,"iq");if(!n.success)return n;var r=o("WASmaxParseUtils").flattenedChildWithTag(t,"pair-success");if(!r.success)return r;var a=o("WASmaxParseUtils").flattenedChildWithTag(r.value,"device-identity");if(!a.success)return a;var i=o("WASmaxParseUtils").flattenedChildWithTag(r.value,"device");if(!i.success)return i;var l=o("WASmaxParseUtils").flattenedChildWithTag(r.value,"platform");if(!l.success)return l;var c=o("WASmaxParseUtils").optionalChildWithTag(r.value,"biz",e);if(!c.success)return c;var d=o("WASmaxParseUtils").optionalChildWithTag(r.value,"client-props",s);if(!d.success)return d;var m=o("WASmaxParseUtils").optionalChildWithTag(r.value,"encryption-metadata",u);if(!m.success)return m;var p=o("WASmaxParseJid").literalJid(o("WASmaxParseJid").attrDomainJid,t,"from","s.whatsapp.net");if(!p.success)return p;var _=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,t,"xmlns","md");if(!_.success)return _;var f=o("WASmaxParseUtils").contentBytesRange(a.value,1,500);if(!f.success)return f;var g=o("WASmaxParseJid").attrDeviceJid(i.value,"jid");if(!g.success)return g;var h=o("WASmaxParseUtils").optional(o("WASmaxParseJid").attrDeviceJid,i.value,"lid");if(!h.success)return h;var y=o("WASmaxParseUtils").optional(o("WASmaxParseUtils").attrStringEnum,i.value,"beta",o("WASmaxInMdEnums").ENUM_FALSE_TRUE);if(!y.success)return y;var C=o("WASmaxParseUtils").attrString(l.value,"name");if(!C.success)return C;var b=o("WASmaxInMdBaseIQSetRequestMixin").parseBaseIQSetRequestMixin(t);return b.success?o("WAResultOrError").makeResult(babelHelpers.extends({from:p.value,xmlns:_.value,pairSuccessDeviceIdentityElementValue:f.value,pairSuccessDeviceJid:g.value,pairSuccessDeviceLid:h.value,pairSuccessDeviceBeta:y.value,pairSuccessPlatformName:C.value},b.value,{pairSuccessBiz:c.value,pairSuccessClientProps:d.value,pairSuccessEncryptionMetadata:m.value})):b}l.parseSetRegRequestPairSuccessBiz=e,l.parseSetRegRequestPairSuccessClientProps=s,l.parseSetRegRequestPairSuccessEncryptionMetadata=u,l.parseSetRegRequest=c}),98);
__d("WASmaxInMdSetToCompanionRequest",["WAResultOrError","WASmaxInMdBaseIQSetRequestMixin","WASmaxParseJid","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"ref");if(!t.success)return t;var n=o("WASmaxParseUtils").contentBytes(e);return n.success?o("WAResultOrError").makeResult({elementValue:n.value}):n}function s(t){var n=o("WASmaxParseUtils").assertTag(t,"iq");if(!n.success)return n;var r=o("WASmaxParseUtils").flattenedChildWithTag(t,"pair-device");if(!r.success)return r;var a=o("WASmaxParseJid").literalJid(o("WASmaxParseJid").attrDomainJid,t,"from","s.whatsapp.net");if(!a.success)return a;var i=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,t,"xmlns","md");if(!i.success)return i;var l=o("WASmaxInMdBaseIQSetRequestMixin").parseBaseIQSetRequestMixin(t);if(!l.success)return l;var s=o("WASmaxParseUtils").mapChildrenWithTag(r.value,"ref",6,6,e);return s.success?o("WAResultOrError").makeResult(babelHelpers.extends({from:a.value,xmlns:i.value},l.value,{pairDeviceRef:s.value})):s}l.parseSetToCompanionRequestPairDeviceRef=e,l.parseSetToCompanionRequest=s}),98);
__d("WASmaxInMessageDeliverAdminEditMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"message");if(!t.success)return t;var n=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"edit","3");return n.success?o("WAResultOrError").makeResult({edit:n.value}):n}l.parseAdminEditMixin=e}),98);
__d("WASmaxInMessageDeliverAdminRevokeMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"message");if(!t.success)return t;var n=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"edit","8");return n.success?o("WAResultOrError").makeResult({edit:n.value}):n}l.parseAdminRevokeMixin=e}),98);
__d("WASmaxInMessageDeliverContentTypeMediaMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"message");if(!t.success)return t;var n=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"type","media");return n.success?o("WAResultOrError").makeResult({type:n.value}):n}l.parseContentTypeMediaMixin=e}),98);
__d("WASmaxInMessageDeliverContentTypePollCreationMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"message");if(!t.success)return t;var n=o("WASmaxParseUtils").flattenedChildWithTag(e,"meta");if(!n.success)return n;var r=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"type","poll");if(!r.success)return r;var a=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,n.value,"polltype","creation");if(!a.success)return a;var i=o("WASmaxParseUtils").optional(o("WASmaxParseUtils").attrString,n.value,"contenttype");return i.success?o("WAResultOrError").makeResult({type:r.value,metaPolltype:a.value,metaContenttype:i.value}):i}l.parseContentTypePollCreationMixin=e}),98);
__d("WASmaxInMessageDeliverContentTypePollResultSnapshotMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"message");if(!t.success)return t;var n=o("WASmaxParseUtils").flattenedChildWithTag(e,"meta");if(!n.success)return n;var r=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"type","poll");if(!r.success)return r;var a=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,n.value,"polltype","result_snapshot");return a.success?o("WAResultOrError").makeResult({type:r.value,metaPolltype:a.value}):a}l.parseContentTypePollResultSnapshotMixin=e}),98);
__d("WASmaxInMessageDeliverContentTypePollVoteMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"message");if(!t.success)return t;var n=o("WASmaxParseUtils").flattenedChildWithTag(e,"meta");if(!n.success)return n;var r=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"type","poll");if(!r.success)return r;var a=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,n.value,"polltype","vote");if(!a.success)return a;var i=o("WASmaxParseUtils").optional(o("WASmaxParseUtils").attrString,n.value,"contenttype");return i.success?o("WAResultOrError").makeResult({type:r.value,metaPolltype:a.value,metaContenttype:i.value}):i}l.parseContentTypePollVoteMixin=e}),98);
__d("WASmaxInMessageDeliverContentTypeQuizCreationMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"message");if(!t.success)return t;var n=o("WASmaxParseUtils").flattenedChildWithTag(e,"meta");if(!n.success)return n;var r=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"type","poll");if(!r.success)return r;var a=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,n.value,"polltype","quiz_creation");if(!a.success)return a;var i=o("WASmaxParseUtils").optional(o("WASmaxParseUtils").attrString,n.value,"contenttype");return i.success?o("WAResultOrError").makeResult({type:r.value,metaPolltype:a.value,metaContenttype:i.value}):i}l.parseContentTypeQuizCreationMixin=e}),98);
__d("WASmaxInMessageDeliverContentTypeReactionMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"message");if(!t.success)return t;var n=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"type","reaction");return n.success?o("WAResultOrError").makeResult({type:n.value}):n}l.parseContentTypeReactionMixin=e}),98);
__d("WASmaxInMessageDeliverContentTypeTextMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"message");if(!t.success)return t;var n=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"type","text");return n.success?o("WAResultOrError").makeResult({type:n.value}):n}l.parseContentTypeTextMixin=e}),98);
__d("WASmaxInMessageDeliverContentTypeTextOrMediaOrPollCreationOrQuizCreationMixinGroup",["WAResultOrError","WASmaxInMessageDeliverContentTypeMediaMixin","WASmaxInMessageDeliverContentTypePollCreationMixin","WASmaxInMessageDeliverContentTypeQuizCreationMixin","WASmaxInMessageDeliverContentTypeTextMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxInMessageDeliverContentTypeTextMixin").parseContentTypeTextMixin(e);if(t.success)return o("WAResultOrError").makeResult({name:"ContentTypeText",value:t.value});var n=o("WASmaxInMessageDeliverContentTypeMediaMixin").parseContentTypeMediaMixin(e);if(n.success)return o("WAResultOrError").makeResult({name:"ContentTypeMedia",value:n.value});var r=o("WASmaxInMessageDeliverContentTypePollCreationMixin").parseContentTypePollCreationMixin(e);if(r.success)return o("WAResultOrError").makeResult({name:"ContentTypePollCreation",value:r.value});var a=o("WASmaxInMessageDeliverContentTypeQuizCreationMixin").parseContentTypeQuizCreationMixin(e);return a.success?o("WAResultOrError").makeResult({name:"ContentTypeQuizCreation",value:a.value}):o("WASmaxParseUtils").errorMixinDisjunction(e,["ContentTypeText","ContentTypeMedia","ContentTypePollCreation","ContentTypeQuizCreation"],[t,n,r,a])}l.parseContentTypeTextOrMediaOrPollCreationOrQuizCreationMixinGroup=e}),98);
__d("WASmaxInMessageDeliverEnums",["WAJids"],(function(t,n,r,o,a,i,l){var e,s={0:"0",1:"1"},u={"1p_sticker":"1p_sticker",audio:"audio",avatar_sticker:"avatar_sticker",buttons_response:"buttons_response",cataloglink:"cataloglink",collection:"collection",contact:"contact",contact_array:"contact_array",document:"document",feed_reshare:"feed_reshare",genai_sticker:"genai_sticker",gif:"gif",group_history:"group_history",history:"history",image:"image",list_response:"list_response",location:"location",motion_photo:"motion_photo",motion_video:"motion_video",native_flow_response:"native_flow_response",order:"order",product:"product",productlink:"productlink",ptt:"ptt",ptv:"ptv",sticker:"sticker",sticker_pack:"sticker_pack",story_reply:"story_reply",url:"url",user_created_sticker:"user_created_sticker",vcard:"vcard",video:"video",xma:"xma"},c={"1p_sticker":"1p_sticker",audio:"audio",avatar_sticker:"avatar_sticker",cataloglink:"cataloglink",collection:"collection",document:"document",genai_sticker:"genai_sticker",gif:"gif",image:"image",motion_photo:"motion_photo",motion_video:"motion_video",productlink:"productlink",ptt:"ptt",ptv:"ptv",sticker:"sticker",sticker_pack:"sticker_pack",url:"url",user_created_sticker:"user_created_sticker",vcard:"vcard",video:"video"},d={1:"1",2:"2"},m={1:"1",3:"3"},p={ACCEPT:"ACCEPT",REJECT:"REJECT",UNKNOWN:"UNKNOWN"},_={account_authentication_request:"account_authentication_request",address_message:"address_message",call_permission_request:"call_permission_request",form_message:"form_message",galaxy_message:"galaxy_message",menu_options:"menu_options"},f={address_message:"address_message",galaxy_message:"galaxy_message"},g={ads_manager:"ads_manager",graph_api:"graph_api",maiba:"maiba",maiba_ai_hub:"maiba_ai_hub",marketing_messages_with_optimizations:"marketing_messages_with_optimizations",unified_inbox:"unified_inbox"},h={ads_manager:"ads_manager",maiba:"maiba",maiba_ai_hub:"maiba_ai_hub",marketing_messages_with_optimizations:"marketing_messages_with_optimizations",third_party:"third_party",unified_inbox:"unified_inbox"},y={allowlist:"allowlist",contacts:"contacts",denylist:"denylist"},C={allow:"allow",bypass:"bypass",deny:"deny",error:"error"},b={ASPRESENTED:"ASPRESENTED",BIMONTHLY:"BIMONTHLY",DAILY:"DAILY",FORTNIGHTLY:"FORTNIGHTLY",HALFYEARLY:"HALFYEARLY",MONTHLY:"MONTHLY",ONETIME:"ONETIME",QUARTERLY:"QUARTERLY",UNKNOWN:"UNKNOWN",WEEKLY:"WEEKLY",YEARLY:"YEARLY"},v={audio:"audio",avatar_sticker:"avatar_sticker",buttons_response:"buttons_response",cataloglink:"cataloglink",contact:"contact",contact_array:"contact_array",document:"document",feed_reshare:"feed_reshare",gif:"gif",history:"history",image:"image",list_response:"list_response",location:"location",native_flow_response:"native_flow_response",order:"order",product:"product",productlink:"productlink",ptt:"ptt",ptv:"ptv",sticker:"sticker",story_reply:"story_reply",url:"url",vcard:"vcard",video:"video",xma:"xma"},S={br:"br",incentive:"incentive",p2m:"p2m",p2p:"p2p",payout:"payout",upi:"upi",upi_lite:"upi_lite"},R={buyer:"buyer",seller:"seller"},L={card:"card","net-banking":"net-banking",upi:"upi",wallet:"wallet"},E={creation:"creation",edit:"edit",response:"response"},k={default:"default",group_history:"group_history",history:"history",member_tag:"member_tag"},I={delivery:"delivery",impressions:"impressions",link_clicks:"link_clicks",no_optimization:"no_optimization",offsite_conversions:"offsite_conversions",replies:"replies"},T={DEREGISTER:"DEREGISTER",INIT_TOP_UP:"INIT_TOP_UP",PAY:"PAY",TOP_UP:"TOP_UP"},D={ds:"ds",fc:"fc",ge:"ge"},x={EXACT:"EXACT",MAX:"MAX"},$={FAILED:"FAILED",PAID:"PAID",PENDING:"PENDING"},P={FAILURE:"FAILURE",INIT:"INIT",SUCCESS:"SUCCESS"},N={false:"false",true:"true"},M={FBPAY:"FBPAY",UPI:"UPI"},w={first:"first",full:"full",inner:"inner",last:"last"},A={FULL:"FULL",MISSING_FIELD_NOT_PARTIAL:"MISSING_FIELD_NOT_PARTIAL",PARTIAL:"PARTIAL"},F={group:"group",sender:"sender"},O={guest:"guest",wa:"wa"},B={hd_image_dual_upload:"hd_image_dual_upload",hd_video_dual_upload:"hd_video_dual_upload",hevc_video_dual_upload:"hevc_video_dual_upload",media_poll:"media_poll",motion_photo:"motion_photo",sticker_annotation:"sticker_annotation"},W={high:"high",high_force:"high_force",low:"low"},q={high:"high",low:"low",unknown:"unknown"},U={hosted:"hosted",view_once:"view_once"},V={hpp_payment_link:"hpp_payment_link",upi:"upi"},H={lid:"lid",pn:"pn"},G={matched:"matched",unmatched:"unmatched"},z={message_limit_reached:"message_limit_reached",under_limit:"under_limit"},j={msg:"msg",pkmsg:"pkmsg"},K={new_member:"new_member",rereg_recovery_request:"rereg_recovery_request",rereg_recovery_response:"rereg_recovery_response",user_delete:"user_delete",user_update:"user_update"},Q={on_demand:"on_demand",scheduled:"scheduled"},X={p2m:"p2m",p2p:"p2p"},Y={request:"request",send:"send"},J={smb_mm:"smb_mm",smb_promo:"smb_promo"},Z={tier3:"tier3",tier6_matched:"tier6_matched",tier6_unmatched:"tier6_unmatched"},ee={"":"",call_permission_request:"call_permission_request",catalog_message:"catalog_message",menu_options:"menu_options",order_details:"order_details",order_status:"order_status",otp:"otp",payment_info:"payment_info",payment_key_info:"payment_key_info",payment_method:"payment_method",payment_status:"payment_status",voice_call:"voice_call"},te={validators:[(e=o("WAJids")).validateDeviceJid,e.validateBroadcastJid,e.validateDeviceJid,e.validateGroupJid,e.validateInteropDeviceJid,e.validateInteropDeviceJid,e.validateStatusJid],typeName:"DeviceJid|BroadcastJid|DeviceJid|GroupJid|InteropDeviceJid|InteropDeviceJid|StatusJid"},ne={validators:[e.validateDeviceJid,e.validateDeviceJid],typeName:"DeviceJid|DeviceJid"},re={validators:[e.validateDeviceJid,e.validateDeviceJid,e.validateInteropDeviceJid,e.validateInteropDeviceJid],typeName:"DeviceJid|DeviceJid|InteropDeviceJid|InteropDeviceJid"},oe={validators:[e.validateDeviceJid,e.validateDeviceJid,e.validateUserJid,e.validateUserJid,e.validateDeviceJid,e.validateUserJid],typeName:"DeviceJid|DeviceJid|UserJid|UserJid|DeviceJid|UserJid"},ae={validators:[e.validateDeviceJid,e.validateDeviceJid,e.validateUserJid,e.validateUserJid,e.validateUserJid],typeName:"DeviceJid|DeviceJid|UserJid|UserJid|UserJid"},ie={validators:[e.validateGroupJid,e.validateUserJid],typeName:"GroupJid|UserJid"},le={validators:[e.validateUserJid,e.validateUserJid],typeName:"UserJid|UserJid"};l.ENUM_0_1=s,l.ENUM_1PSTICKER_AUDIO_AVATARSTICKER_BUTTONSRESPONSE_CATALOGLINK_COLLECTION_CONTACT_CONTACTARRAY_DOCUMENT_FEEDRESHARE_GENAISTICKER_GIF_GROUPHISTORY_HISTORY_IMAGE_LISTRESPONSE_LOCATION_MOTIONPHOTO_MOTIONVIDEO_NATIVEFLOWRESPONSE_ORDER_PRODUCT_PRODUCTLINK_PTT_PTV_STICKER_STICKERPACK_STORYREPLY_URL_USERCREATEDSTICKER_VCARD_VIDEO_XMA=u,l.ENUM_1PSTICKER_AUDIO_AVATARSTICKER_CATALOGLINK_COLLECTION_DOCUMENT_GENAISTICKER_GIF_IMAGE_MOTIONPHOTO_MOTIONVIDEO_PRODUCTLINK_PTT_PTV_STICKER_STICKERPACK_URL_USERCREATEDSTICKER_VCARD_VIDEO=c,l.ENUM_1_2=d,l.ENUM_1_3=m,l.ENUM_ACCEPT_REJECT_UNKNOWN=p,l.ENUM_ACCOUNTAUTHENTICATIONREQUEST_ADDRESSMESSAGE_CALLPERMISSIONREQUEST_FORMMESSAGE_GALAXYMESSAGE_MENUOPTIONS=_,l.ENUM_ADDRESSMESSAGE_GALAXYMESSAGE=f,l.ENUM_ADSMANAGER_GRAPHAPI_MAIBA_MAIBAAIHUB_MARKETINGMESSAGESWITHOPTIMIZATIONS_UNIFIEDINBOX=g,l.ENUM_ADSMANAGER_MAIBA_MAIBAAIHUB_MARKETINGMESSAGESWITHOPTIMIZATIONS_THIRDPARTY_UNIFIEDINBOX=h,l.ENUM_ALLOWLIST_CONTACTS_DENYLIST=y,l.ENUM_ALLOW_BYPASS_DENY_ERROR=C,l.ENUM_ASPRESENTED_BIMONTHLY_DAILY_FORTNIGHTLY_HALFYEARLY_MONTHLY_ONETIME_QUARTERLY_UNKNOWN_WEEKLY_YEARLY=b,l.ENUM_AUDIO_AVATARSTICKER_BUTTONSRESPONSE_CATALOGLINK_CONTACT_CONTACTARRAY_DOCUMENT_FEEDRESHARE_GIF_HISTORY_IMAGE_LISTRESPONSE_LOCATION_NATIVEFLOWRESPONSE_ORDER_PRODUCT_PRODUCTLINK_PTT_PTV_STICKER_STORYREPLY_URL_VCARD_VIDEO_XMA=v,l.ENUM_BR_INCENTIVE_P2M_P2P_PAYOUT_UPI_UPILITE=S,l.ENUM_BUYER_SELLER=R,l.ENUM_CARD_NETBANKING_UPI_WALLET=L,l.ENUM_CREATION_EDIT_RESPONSE=E,l.ENUM_DEFAULTP_GROUPHISTORY_HISTORY_MEMBERTAG=k,l.ENUM_DELIVERY_IMPRESSIONS_LINKCLICKS_NOOPTIMIZATION_OFFSITECONVERSIONS_REPLIES=I,l.ENUM_DEREGISTER_INITTOPUP_PAY_TOPUP=T,l.ENUM_DS_FC_GE=D,l.ENUM_EXACT_MAX=x,l.ENUM_FAILED_PAID_PENDING=$,l.ENUM_FAILURE_INIT_SUCCESS=P,l.ENUM_FALSE_TRUE=N,l.ENUM_FBPAY_UPI=M,l.ENUM_FIRST_FULL_INNER_LAST=w,l.ENUM_FULL_MISSINGFIELDNOTPARTIAL_PARTIAL=A,l.ENUM_GROUP_SENDER=F,l.ENUM_GUEST_WA=O,l.ENUM_HDIMAGEDUALUPLOAD_HDVIDEODUALUPLOAD_HEVCVIDEODUALUPLOAD_MEDIAPOLL_MOTIONPHOTO_STICKERANNOTATION=B,l.ENUM_HIGH_HIGHFORCE_LOW=W,l.ENUM_HIGH_LOW_UNKNOWN=q,l.ENUM_HOSTED_VIEWONCE=U,l.ENUM_HPPPAYMENTLINK_UPI=V,l.ENUM_LID_PN=H,l.ENUM_MATCHED_UNMATCHED=G,l.ENUM_MESSAGELIMITREACHED_UNDERLIMIT=z,l.ENUM_MSG_PKMSG=j,l.ENUM_NEWMEMBER_REREGRECOVERYREQUEST_REREGRECOVERYRESPONSE_USERDELETE_USERUPDATE=K,l.ENUM_ONDEMAND_SCHEDULED=Q,l.ENUM_P2M_P2P=X,l.ENUM_REQUEST_SEND=Y,l.ENUM_SMBMM_SMBPROMO=J,l.ENUM_TIER3_TIER6MATCHED_TIER6UNMATCHED=Z,l.ENUM__CALLPERMISSIONREQUEST_CATALOGMESSAGE_MENUOPTIONS_ORDERDETAILS_ORDERSTATUS_OTP_PAYMENTINFO_PAYMENTKEYINFO_PAYMENTMETHOD_PAYMENTSTATUS_VOICECALL=ee,l.DEVICEJID_BROADCASTJID_DEVICEJID_GROUPJID_INTEROPDEVICEJID_INTEROPDEVICEJID_STATUSJID=te,l.DEVICEJID_DEVICEJID=ne,l.DEVICEJID_DEVICEJID_INTEROPDEVICEJID_INTEROPDEVICEJID=re,l.DEVICEJID_DEVICEJID_USERJID_USERJID_DEVICEJID_USERJID=oe,l.DEVICEJID_DEVICEJID_USERJID_USERJID_USERJID=ae,l.GROUPJID_USERJID=ie,l.USERJID_USERJID=le}),98);
__d("WASmaxInMessageDeliverMessageAssociationTypeMixin",["WAResultOrError","WASmaxInMessageDeliverEnums","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"message");if(!t.success)return t;var n=o("WASmaxParseUtils").flattenedChildWithTag(e,"meta");if(!n.success)return n;var r=o("WASmaxParseUtils").attrStringEnum(n.value,"message_association_type",o("WASmaxInMessageDeliverEnums").ENUM_HDIMAGEDUALUPLOAD_HDVIDEODUALUPLOAD_HEVCVIDEODUALUPLOAD_MEDIAPOLL_MOTIONPHOTO_STICKERANNOTATION);return r.success?o("WAResultOrError").makeResult({metaMessageAssociationType:r.value}):r}l.parseMessageAssociationTypeMixin=e}),98);
__d("WASmaxInMessageDeliverPayloadMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"plaintext");if(!t.success)return t;var n=o("WASmaxParseUtils").contentBytesRange(e,1,1048576);return n.success?o("WAResultOrError").makeResult({elementValue:n.value}):n}l.parsePayloadMixin=e}),98);
__d("WASmaxInMessageDeliverWAMOSubMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"message");if(!t.success)return t;var n=o("WASmaxParseUtils").flattenedChildWithTag(e,"meta");if(!n.success)return n;var r=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,n.value,"is_wamo_sub","true");return r.success?o("WAResultOrError").makeResult({metaIsWamoSub:r.value}):r}l.parseWAMOSubMixin=e}),98);
__d("WASmaxInMessageDeliverNewsletterMediaMixin",["WAResultOrError","WASmaxInMessageDeliverContentTypeMediaMixin","WASmaxInMessageDeliverEnums","WASmaxInMessageDeliverMessageAssociationTypeMixin","WASmaxInMessageDeliverPayloadMixin","WASmaxInMessageDeliverWAMOSubMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"message");if(!t.success)return t;var n=o("WASmaxParseUtils").flattenedChildWithTag(e,"plaintext");if(!n.success)return n;var r=o("WASmaxParseUtils").attrStringEnum(n.value,"mediatype",o("WASmaxInMessageDeliverEnums").ENUM_1PSTICKER_AUDIO_AVATARSTICKER_CATALOGLINK_COLLECTION_DOCUMENT_GENAISTICKER_GIF_IMAGE_MOTIONPHOTO_MOTIONVIDEO_PRODUCTLINK_PTT_PTV_STICKER_STICKERPACK_URL_USERCREATEDSTICKER_VCARD_VIDEO);if(!r.success)return r;var a=o("WASmaxInMessageDeliverPayloadMixin").parsePayloadMixin(n.value);if(!a.success)return a;var i=o("WASmaxInMessageDeliverContentTypeMediaMixin").parseContentTypeMediaMixin(e);if(!i.success)return i;var l=o("WASmaxInMessageDeliverWAMOSubMixin").parseWAMOSubMixin(e),s=o("WASmaxInMessageDeliverMessageAssociationTypeMixin").parseMessageAssociationTypeMixin(e);return o("WAResultOrError").makeResult(babelHelpers.extends({plaintextMediatype:r.value,plaintextPayloadMixin:a.value},i.value,{wAMOSubMixin:l.success?l.value:null,messageAssociationTypeMixin:s.success?s.value:null}))}l.parseNewsletterMediaMixin=e}),98);
__d("WASmaxInMessageDeliverNewsletterTextMixin",["WAResultOrError","WASmaxInMessageDeliverContentTypeTextMixin","WASmaxInMessageDeliverPayloadMixin","WASmaxInMessageDeliverWAMOSubMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"message");if(!t.success)return t;var n=o("WASmaxParseUtils").flattenedChildWithTag(e,"plaintext");if(!n.success)return n;var r=o("WASmaxInMessageDeliverPayloadMixin").parsePayloadMixin(n.value);if(!r.success)return r;var a=o("WASmaxInMessageDeliverContentTypeTextMixin").parseContentTypeTextMixin(e);if(!a.success)return a;var i=o("WASmaxInMessageDeliverWAMOSubMixin").parseWAMOSubMixin(e);return o("WAResultOrError").makeResult(babelHelpers.extends({plaintextPayloadMixin:r.value},a.value,{wAMOSubMixin:i.success?i.value:null}))}l.parseNewsletterTextMixin=e}),98);
__d("WASmaxInMessageDeliverNewsletterTextOrMediaMixinGroup",["WAResultOrError","WASmaxInMessageDeliverNewsletterMediaMixin","WASmaxInMessageDeliverNewsletterTextMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxInMessageDeliverNewsletterTextMixin").parseNewsletterTextMixin(e);if(t.success)return o("WAResultOrError").makeResult({name:"NewsletterText",value:t.value});var n=o("WASmaxInMessageDeliverNewsletterMediaMixin").parseNewsletterMediaMixin(e);return n.success?o("WAResultOrError").makeResult({name:"NewsletterMedia",value:n.value}):o("WASmaxParseUtils").errorMixinDisjunction(e,["NewsletterText","NewsletterMedia"],[t,n])}l.parseNewsletterTextOrMediaMixinGroup=e}),98);
__d("WASmaxInMessageDeliverQuestionTypeReplyMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"message");if(!t.success)return t;var n=o("WASmaxParseUtils").flattenedChildWithTag(e,"meta");if(!n.success)return n;var r=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,n.value,"questiontype","reply");return r.success?o("WAResultOrError").makeResult({metaQuestiontype:r.value}):r}l.parseQuestionTypeReplyMixin=e}),98);
__d("WASmaxInMessageDeliverNewsletterQuestionReplyMixin",["WAResultOrError","WASmaxInMessageDeliverNewsletterTextOrMediaMixinGroup","WASmaxInMessageDeliverQuestionTypeReplyMixin","WASmaxInMessageDeliverWAMOSubMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"message");if(!t.success)return t;var n=o("WASmaxInMessageDeliverQuestionTypeReplyMixin").parseQuestionTypeReplyMixin(e);if(!n.success)return n;var r=o("WASmaxInMessageDeliverWAMOSubMixin").parseWAMOSubMixin(e),a=o("WASmaxInMessageDeliverNewsletterTextOrMediaMixinGroup").parseNewsletterTextOrMediaMixinGroup(e);return a.success?o("WAResultOrError").makeResult(babelHelpers.extends({},n.value,{wAMOSubMixin:r.success?r.value:null,newsletterTextOrMediaMixinGroup:a.value})):a}l.parseNewsletterQuestionReplyMixin=e}),98);
__d("WASmaxInMessageDeliverNewsletterQuestionReplyOrTextOrMediaMixinGroup",["WAResultOrError","WASmaxInMessageDeliverNewsletterMediaMixin","WASmaxInMessageDeliverNewsletterQuestionReplyMixin","WASmaxInMessageDeliverNewsletterTextMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxInMessageDeliverNewsletterQuestionReplyMixin").parseNewsletterQuestionReplyMixin(e);if(t.success)return o("WAResultOrError").makeResult({name:"NewsletterQuestionReply",value:t.value});var n=o("WASmaxInMessageDeliverNewsletterTextMixin").parseNewsletterTextMixin(e);if(n.success)return o("WAResultOrError").makeResult({name:"NewsletterText",value:n.value});var r=o("WASmaxInMessageDeliverNewsletterMediaMixin").parseNewsletterMediaMixin(e);return r.success?o("WAResultOrError").makeResult({name:"NewsletterMedia",value:r.value}):o("WASmaxParseUtils").errorMixinDisjunction(e,["NewsletterQuestionReply","NewsletterText","NewsletterMedia"],[t,n,r])}l.parseNewsletterQuestionReplyOrTextOrMediaMixinGroup=e}),98);
__d("WASmaxInMessageDeliverNewsletterEditMixin",["WAResultOrError","WASmaxInMessageDeliverAdminEditMixin","WASmaxInMessageDeliverNewsletterQuestionReplyOrTextOrMediaMixinGroup","WASmaxInMessageDeliverWAMOSubMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"message");if(!t.success)return t;var n=o("WASmaxInMessageDeliverAdminEditMixin").parseAdminEditMixin(e);if(!n.success)return n;var r=o("WASmaxInMessageDeliverWAMOSubMixin").parseWAMOSubMixin(e),a=o("WASmaxInMessageDeliverNewsletterQuestionReplyOrTextOrMediaMixinGroup").parseNewsletterQuestionReplyOrTextOrMediaMixinGroup(e);return a.success?o("WAResultOrError").makeResult(babelHelpers.extends({},n.value,{wAMOSubMixin:r.success?r.value:null,newsletterQuestionReplyOrTextOrMediaMixinGroup:a.value})):a}l.parseNewsletterEditMixin=e}),98);
__d("WASmaxInMessageDeliverNewsletterPollCreationMixin",["WAResultOrError","WASmaxInMessageDeliverContentTypePollCreationMixin","WASmaxInMessageDeliverPayloadMixin","WASmaxInMessageDeliverWAMOSubMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"message");if(!t.success)return t;var n=o("WASmaxParseUtils").flattenedChildWithTag(e,"plaintext");if(!n.success)return n;var r=o("WASmaxInMessageDeliverPayloadMixin").parsePayloadMixin(n.value);if(!r.success)return r;var a=o("WASmaxInMessageDeliverContentTypePollCreationMixin").parseContentTypePollCreationMixin(e);if(!a.success)return a;var i=o("WASmaxInMessageDeliverWAMOSubMixin").parseWAMOSubMixin(e);return o("WAResultOrError").makeResult(babelHelpers.extends({plaintextPayloadMixin:r.value},a.value,{wAMOSubMixin:i.success?i.value:null}))}l.parseNewsletterPollCreationMixin=e}),98);
__d("WASmaxInMessageDeliverNewsletterPollResultSnapshotMixin",["WAResultOrError","WASmaxInMessageDeliverContentTypePollResultSnapshotMixin","WASmaxInMessageDeliverPayloadMixin","WASmaxInMessageDeliverWAMOSubMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"message");if(!t.success)return t;var n=o("WASmaxParseUtils").flattenedChildWithTag(e,"plaintext");if(!n.success)return n;var r=o("WASmaxInMessageDeliverPayloadMixin").parsePayloadMixin(n.value);if(!r.success)return r;var a=o("WASmaxInMessageDeliverContentTypePollResultSnapshotMixin").parseContentTypePollResultSnapshotMixin(e);if(!a.success)return a;var i=o("WASmaxInMessageDeliverWAMOSubMixin").parseWAMOSubMixin(e);return o("WAResultOrError").makeResult(babelHelpers.extends({plaintextPayloadMixin:r.value},a.value,{wAMOSubMixin:i.success?i.value:null}))}l.parseNewsletterPollResultSnapshotMixin=e}),98);
__d("WASmaxInMessageDeliverNewsletterPollVoteMixin",["WAResultOrError","WASmaxInMessageDeliverContentTypePollVoteMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"vote");if(!t.success)return t;var n=o("WASmaxParseUtils").contentBytesRange(e,32,32);return n.success?o("WAResultOrError").makeResult({elementValue:n.value}):n}function s(t){var n=o("WASmaxParseUtils").assertTag(t,"message");if(!n.success)return n;var r=o("WASmaxParseUtils").flattenedChildWithTag(t,"votes");if(!r.success)return r;var a=o("WASmaxInMessageDeliverContentTypePollVoteMixin").parseContentTypePollVoteMixin(t);if(!a.success)return a;var i=o("WASmaxParseUtils").mapChildrenWithTag(r.value,"vote",0,1e3,e);return i.success?o("WAResultOrError").makeResult(babelHelpers.extends({},a.value,{votesVote:i.value})):i}l.parseNewsletterPollVoteVotesVote=e,l.parseNewsletterPollVoteMixin=s}),98);
__d("WASmaxInMessageDeliverQuestionTypeQuestionMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"message");if(!t.success)return t;var n=o("WASmaxParseUtils").flattenedChildWithTag(e,"meta");if(!n.success)return n;var r=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,n.value,"questiontype","question");return r.success?o("WAResultOrError").makeResult({metaQuestiontype:r.value}):r}l.parseQuestionTypeQuestionMixin=e}),98);
__d("WASmaxInMessageDeliverNewsletterQuestionMixin",["WAResultOrError","WASmaxInMessageDeliverNewsletterTextOrMediaMixinGroup","WASmaxInMessageDeliverQuestionTypeQuestionMixin","WASmaxInMessageDeliverWAMOSubMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"message");if(!t.success)return t;var n=o("WASmaxInMessageDeliverQuestionTypeQuestionMixin").parseQuestionTypeQuestionMixin(e);if(!n.success)return n;var r=o("WASmaxInMessageDeliverWAMOSubMixin").parseWAMOSubMixin(e),a=o("WASmaxInMessageDeliverNewsletterTextOrMediaMixinGroup").parseNewsletterTextOrMediaMixinGroup(e);return a.success?o("WAResultOrError").makeResult(babelHelpers.extends({},n.value,{wAMOSubMixin:r.success?r.value:null,newsletterTextOrMediaMixinGroup:a.value})):a}l.parseNewsletterQuestionMixin=e}),98);
__d("WASmaxInMessageDeliverQuestionTypeResponseMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"message");if(!t.success)return t;var n=o("WASmaxParseUtils").flattenedChildWithTag(e,"meta");if(!n.success)return n;var r=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,n.value,"questiontype","response");return r.success?o("WAResultOrError").makeResult({metaQuestiontype:r.value}):r}l.parseQuestionTypeResponseMixin=e}),98);
__d("WASmaxInMessageDeliverResponseServerIDMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"message");if(!t.success)return t;var n=o("WASmaxParseUtils").flattenedChildWithTag(e,"meta");if(!n.success)return n;var r=o("WASmaxParseUtils").attrString(n.value,"response_server_id");return r.success?o("WAResultOrError").makeResult({metaResponseServerId:r.value}):r}l.parseResponseServerIDMixin=e}),98);
__d("WASmaxInMessageDeliverNewsletterQuestionResponseMixin",["WAResultOrError","WASmaxInMessageDeliverContentTypeTextMixin","WASmaxInMessageDeliverPayloadMixin","WASmaxInMessageDeliverQuestionTypeResponseMixin","WASmaxInMessageDeliverResponseServerIDMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"message");if(!t.success)return t;var n=o("WASmaxParseUtils").flattenedChildWithTag(e,"plaintext");if(!n.success)return n;var r=o("WASmaxInMessageDeliverPayloadMixin").parsePayloadMixin(n.value);if(!r.success)return r;var a=o("WASmaxInMessageDeliverContentTypeTextMixin").parseContentTypeTextMixin(e);if(!a.success)return a;var i=o("WASmaxInMessageDeliverQuestionTypeResponseMixin").parseQuestionTypeResponseMixin(e);if(!i.success)return i;var l=o("WASmaxInMessageDeliverResponseServerIDMixin").parseResponseServerIDMixin(e);return l.success?o("WAResultOrError").makeResult(babelHelpers.extends({plaintextPayloadMixin:r.value},a.value,i.value,l.value)):l}l.parseNewsletterQuestionResponseMixin=e}),98);
__d("WASmaxInMessageDeliverNewsletterQuizCreationMixin",["WAResultOrError","WASmaxInMessageDeliverContentTypeQuizCreationMixin","WASmaxInMessageDeliverPayloadMixin","WASmaxInMessageDeliverWAMOSubMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"message");if(!t.success)return t;var n=o("WASmaxParseUtils").flattenedChildWithTag(e,"plaintext");if(!n.success)return n;var r=o("WASmaxInMessageDeliverPayloadMixin").parsePayloadMixin(n.value);if(!r.success)return r;var a=o("WASmaxInMessageDeliverContentTypeQuizCreationMixin").parseContentTypeQuizCreationMixin(e);if(!a.success)return a;var i=o("WASmaxInMessageDeliverWAMOSubMixin").parseWAMOSubMixin(e);return o("WAResultOrError").makeResult(babelHelpers.extends({plaintextPayloadMixin:r.value},a.value,{wAMOSubMixin:i.success?i.value:null}))}l.parseNewsletterQuizCreationMixin=e}),98);
__d("WASmaxInMessageDeliverNewsletterReactionMixin",["WAResultOrError","WASmaxInMessageDeliverContentTypeReactionMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"message");if(!t.success)return t;var n=o("WASmaxParseUtils").flattenedChildWithTag(e,"reaction");if(!n.success)return n;var r=o("WASmaxParseUtils").attrString(n.value,"code");if(!r.success)return r;var a=o("WASmaxInMessageDeliverContentTypeReactionMixin").parseContentTypeReactionMixin(e);return a.success?o("WAResultOrError").makeResult(babelHelpers.extends({reactionCode:r.value},a.value)):a}l.parseNewsletterReactionMixin=e}),98);
__d("WASmaxInMessageDeliverRevokeMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"message");if(!t.success)return t;var n=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"edit","7");return n.success?o("WAResultOrError").makeResult({edit:n.value}):n}l.parseRevokeMixin=e}),98);
__d("WASmaxInMessageDeliverNewsletterReactionRevokeMixin",["WAResultOrError","WASmaxInMessageDeliverContentTypeReactionMixin","WASmaxInMessageDeliverRevokeMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"message");if(!t.success)return t;var n=o("WASmaxParseUtils").flattenedChildWithTag(e,"reaction");if(!n.success)return n;var r=o("WASmaxInMessageDeliverRevokeMixin").parseRevokeMixin(e);if(!r.success)return r;var a=o("WASmaxInMessageDeliverContentTypeReactionMixin").parseContentTypeReactionMixin(e);return a.success?o("WAResultOrError").makeResult(babelHelpers.extends({},r.value,a.value)):a}l.parseNewsletterReactionRevokeMixin=e}),98);
__d("WASmaxInMessageDeliverNewsletterRevokeMixin",["WAResultOrError","WASmaxInMessageDeliverAdminRevokeMixin","WASmaxInMessageDeliverContentTypeTextMixin","WASmaxInMessageDeliverWAMOSubMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"message");if(!t.success)return t;var n=o("WASmaxParseUtils").flattenedChildWithTag(e,"plaintext");if(!n.success)return n;var r=o("WASmaxInMessageDeliverAdminRevokeMixin").parseAdminRevokeMixin(e);if(!r.success)return r;var a=o("WASmaxInMessageDeliverContentTypeTextMixin").parseContentTypeTextMixin(e);if(!a.success)return a;var i=o("WASmaxInMessageDeliverWAMOSubMixin").parseWAMOSubMixin(e);return o("WAResultOrError").makeResult(babelHelpers.extends({},r.value,a.value,{wAMOSubMixin:i.success?i.value:null}))}l.parseNewsletterRevokeMixin=e}),98);
__d("WASmaxInMessageDeliverNewsletterWAMOEmptyMixin",["WAResultOrError","WASmaxInMessageDeliverAdminEditMixin","WASmaxInMessageDeliverAdminRevokeMixin","WASmaxInMessageDeliverContentTypeTextOrMediaOrPollCreationOrQuizCreationMixinGroup","WASmaxInMessageDeliverWAMOSubMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"message");if(!t.success)return t;var n=o("WASmaxParseUtils").flattenedChildWithTag(e,"plaintext");if(!n.success)return n;var r=o("WASmaxInMessageDeliverWAMOSubMixin").parseWAMOSubMixin(e);if(!r.success)return r;var a=o("WASmaxInMessageDeliverAdminRevokeMixin").parseAdminRevokeMixin(e),i=o("WASmaxInMessageDeliverAdminEditMixin").parseAdminEditMixin(e),l=o("WASmaxInMessageDeliverContentTypeTextOrMediaOrPollCreationOrQuizCreationMixinGroup").parseContentTypeTextOrMediaOrPollCreationOrQuizCreationMixinGroup(e);return l.success?o("WAResultOrError").makeResult(babelHelpers.extends({},r.value,{adminRevokeMixin:a.success?a.value:null,adminEditMixin:i.success?i.value:null,contentTypeTextOrMediaOrPollCreationOrQuizCreationMixinGroup:l.value})):l}l.parseNewsletterWAMOEmptyMixin=e}),98);
__d("WASmaxInMessageDeliverNewsletterMessageFanoutContent",["WAResultOrError","WASmaxInMessageDeliverNewsletterEditMixin","WASmaxInMessageDeliverNewsletterMediaMixin","WASmaxInMessageDeliverNewsletterPollCreationMixin","WASmaxInMessageDeliverNewsletterPollResultSnapshotMixin","WASmaxInMessageDeliverNewsletterPollVoteMixin","WASmaxInMessageDeliverNewsletterQuestionMixin","WASmaxInMessageDeliverNewsletterQuestionReplyMixin","WASmaxInMessageDeliverNewsletterQuestionResponseMixin","WASmaxInMessageDeliverNewsletterQuizCreationMixin","WASmaxInMessageDeliverNewsletterReactionMixin","WASmaxInMessageDeliverNewsletterReactionRevokeMixin","WASmaxInMessageDeliverNewsletterRevokeMixin","WASmaxInMessageDeliverNewsletterTextMixin","WASmaxInMessageDeliverNewsletterWAMOEmptyMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxInMessageDeliverNewsletterQuestionMixin").parseNewsletterQuestionMixin(e);if(t.success)return o("WAResultOrError").makeResult({name:"NewsletterQuestion",value:t.value});var n=o("WASmaxInMessageDeliverNewsletterQuestionResponseMixin").parseNewsletterQuestionResponseMixin(e);if(n.success)return o("WAResultOrError").makeResult({name:"NewsletterQuestionResponse",value:n.value});var r=o("WASmaxInMessageDeliverNewsletterEditMixin").parseNewsletterEditMixin(e);if(r.success)return o("WAResultOrError").makeResult({name:"NewsletterEdit",value:r.value});var a=o("WASmaxInMessageDeliverNewsletterQuestionReplyMixin").parseNewsletterQuestionReplyMixin(e);if(a.success)return o("WAResultOrError").makeResult({name:"NewsletterQuestionReply",value:a.value});var i=o("WASmaxInMessageDeliverNewsletterRevokeMixin").parseNewsletterRevokeMixin(e);if(i.success)return o("WAResultOrError").makeResult({name:"NewsletterRevoke",value:i.value});var l=o("WASmaxInMessageDeliverNewsletterTextMixin").parseNewsletterTextMixin(e);if(l.success)return o("WAResultOrError").makeResult({name:"NewsletterText",value:l.value});var s=o("WASmaxInMessageDeliverNewsletterMediaMixin").parseNewsletterMediaMixin(e);if(s.success)return o("WAResultOrError").makeResult({name:"NewsletterMedia",value:s.value});var u=o("WASmaxInMessageDeliverNewsletterReactionMixin").parseNewsletterReactionMixin(e);if(u.success)return o("WAResultOrError").makeResult({name:"NewsletterReaction",value:u.value});var c=o("WASmaxInMessageDeliverNewsletterReactionRevokeMixin").parseNewsletterReactionRevokeMixin(e);if(c.success)return o("WAResultOrError").makeResult({name:"NewsletterReactionRevoke",value:c.value});var d=o("WASmaxInMessageDeliverNewsletterPollCreationMixin").parseNewsletterPollCreationMixin(e);if(d.success)return o("WAResultOrError").makeResult({name:"NewsletterPollCreation",value:d.value});var m=o("WASmaxInMessageDeliverNewsletterQuizCreationMixin").parseNewsletterQuizCreationMixin(e);if(m.success)return o("WAResultOrError").makeResult({name:"NewsletterQuizCreation",value:m.value});var p=o("WASmaxInMessageDeliverNewsletterPollVoteMixin").parseNewsletterPollVoteMixin(e);if(p.success)return o("WAResultOrError").makeResult({name:"NewsletterPollVote",value:p.value});var _=o("WASmaxInMessageDeliverNewsletterPollResultSnapshotMixin").parseNewsletterPollResultSnapshotMixin(e);if(_.success)return o("WAResultOrError").makeResult({name:"NewsletterPollResultSnapshot",value:_.value});var f=o("WASmaxInMessageDeliverNewsletterWAMOEmptyMixin").parseNewsletterWAMOEmptyMixin(e);return f.success?o("WAResultOrError").makeResult({name:"NewsletterWAMOEmpty",value:f.value}):o("WASmaxParseUtils").errorMixinDisjunction(e,["NewsletterQuestion","NewsletterQuestionResponse","NewsletterEdit","NewsletterQuestionReply","NewsletterRevoke","NewsletterText","NewsletterMedia","NewsletterReaction","NewsletterReactionRevoke","NewsletterPollCreation","NewsletterQuizCreation","NewsletterPollVote","NewsletterPollResultSnapshot","NewsletterWAMOEmpty"],[t,n,r,a,i,l,s,u,c,d,m,p,_,f])}l.parseNewsletterMessageFanoutContent=e}),98);
__d("WASmaxInMessageDeliverNewsletterMessageLastEditTimestampMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"message");if(!t.success)return t;var n=o("WASmaxParseUtils").flattenedChildWithTag(e,"meta");if(!n.success)return n;var r=o("WASmaxParseUtils").attrIntRange(n.value,"msg_edit_t",15778656e5,41024736e5);return r.success?o("WAResultOrError").makeResult({metaMsgEditT:r.value}):r}l.parseNewsletterMessageLastEditTimestampMixin=e}),98);
__d("WASmaxInMessageDeliverNewsletterMessageOriginalTimestampMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"message");if(!t.success)return t;var n=o("WASmaxParseUtils").flattenedChildWithTag(e,"meta");if(!n.success)return n;var r=o("WASmaxParseUtils").attrIntRange(n.value,"original_msg_t",1577865600,4102473600);return r.success?o("WAResultOrError").makeResult({metaOriginalMsgT:r.value}):r}l.parseNewsletterMessageOriginalTimestampMixin=e}),98);
__d("WASmaxInMessageDeliverNewsletterMessageFanoutMixin",["WAResultOrError","WASmaxInMessageDeliverNewsletterMessageFanoutContent","WASmaxInMessageDeliverNewsletterMessageLastEditTimestampMixin","WASmaxInMessageDeliverNewsletterMessageOriginalTimestampMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"message");if(!t.success)return t;var n=o("WASmaxParseUtils").attrStanzaId(e,"id");if(!n.success)return n;var r=o("WASmaxParseUtils").attrIntRange(e,"server_id",99,2147476647);if(!r.success)return r;var a=o("WASmaxParseUtils").attrIntRange(e,"t",0,void 0);if(!a.success)return a;var i=o("WASmaxParseUtils").optionalLiteral(o("WASmaxParseUtils").attrString,e,"is_sender","true");if(!i.success)return i;var l=o("WASmaxInMessageDeliverNewsletterMessageOriginalTimestampMixin").parseNewsletterMessageOriginalTimestampMixin(e),s=o("WASmaxInMessageDeliverNewsletterMessageLastEditTimestampMixin").parseNewsletterMessageLastEditTimestampMixin(e),u=o("WASmaxInMessageDeliverNewsletterMessageFanoutContent").parseNewsletterMessageFanoutContent(e);return u.success?o("WAResultOrError").makeResult({id:n.value,serverId:r.value,t:a.value,isSender:i.value,newsletterMessageOriginalTimestampMixin:l.success?l.value:null,newsletterMessageLastEditTimestampMixin:s.success?s.value:null,newsletterMessageFanoutContent:u.value}):u}l.parseNewsletterMessageFanoutMixin=e}),98);
__d("WASmaxInMessageDeliverOfflineMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").attrIntRange(e,"offline",0,12);return t.success?o("WAResultOrError").makeResult({offline:t.value}):t}l.parseOfflineMixin=e}),98);
__d("WASmaxInMessageDeliverNewsletterMessageWithJIDMixin",["WAResultOrError","WASmaxInMessageDeliverNewsletterMessageFanoutMixin","WASmaxInMessageDeliverOfflineMixin","WASmaxParseJid","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"message");if(!t.success)return t;var n=o("WASmaxParseJid").attrNewsletterJid(e,"from");if(!n.success)return n;var r=o("WASmaxInMessageDeliverNewsletterMessageFanoutMixin").parseNewsletterMessageFanoutMixin(e);if(!r.success)return r;var a=o("WASmaxInMessageDeliverOfflineMixin").parseOfflineMixin(e);return o("WAResultOrError").makeResult(babelHelpers.extends({from:n.value},r.value,{offlineMixin:a.success?a.value:null}))}l.parseNewsletterMessageWithJIDMixin=e}),98);
__d("WASmaxInMessageDeliverReceiverContentTypeMediaRCATMixin",["WAResultOrError","WASmaxInMessageDeliverContentTypeMediaMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"message");if(!t.success)return t;var n=o("WASmaxParseUtils").flattenedChildWithTag(e,"plaintext");if(!n.success)return n;var r=o("WASmaxParseUtils").flattenedChildWithTag(e,"rcat");if(!r.success)return r;var a=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,n.value,"mediatype","url");if(!a.success)return a;var i=o("WASmaxParseUtils").contentBytes(r.value);if(!i.success)return i;var l=o("WASmaxInMessageDeliverContentTypeMediaMixin").parseContentTypeMediaMixin(e);return l.success?o("WAResultOrError").makeResult(babelHelpers.extends({plaintextMediatype:a.value,rcatElementValue:i.value},l.value)):l}l.parseReceiverContentTypeMediaRCATMixin=e}),98);
__d("WASmaxInMessageDeliverNewsletterRequest",["WAResultOrError","WASmaxInMessageDeliverNewsletterMessageWithJIDMixin","WASmaxInMessageDeliverReceiverContentTypeMediaRCATMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"message");if(!t.success)return t;var n=o("WASmaxInMessageDeliverNewsletterMessageWithJIDMixin").parseNewsletterMessageWithJIDMixin(e);if(!n.success)return n;var r=o("WASmaxInMessageDeliverReceiverContentTypeMediaRCATMixin").parseReceiverContentTypeMediaRCATMixin(e);return o("WAResultOrError").makeResult(babelHelpers.extends({},n.value,{receiverContentTypeMediaRCATMixin:r.success?r.value:null}))}l.parseNewsletterRequest=e}),98);
__d("WASmaxInMessageFallbackEnums",["WAJids"],(function(t,n,r,o,a,i,l){var e,s={validators:[(e=o("WAJids")).validateBroadcastJid,e.validateCallJid,e.validateDeviceJid,e.validateDomainJid,e.validateGroupJid,e.validateStatusJid,e.validateUserJid],typeName:"BroadcastJid|CallJid|DeviceJid|DomainJid|GroupJid|StatusJid|UserJid"};l.BROADCASTJID_CALLJID_DEVICEJID_DOMAINJID_GROUPJID_STATUSJID_USERJID=s}),98);
__d("WASmaxInMessagePublishAckAdminEditMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"ack");if(!t.success)return t;var n=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"edit","3");return n.success?o("WAResultOrError").makeResult({edit:n.value}):n}l.parseAckAdminEditMixin=e}),98);
__d("WASmaxInMessagePublishAckAdminRevokeMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"ack");if(!t.success)return t;var n=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"edit","8");return n.success?o("WAResultOrError").makeResult({edit:n.value}):n}l.parseAckAdminRevokeMixin=e}),98);
__d("WASmaxInMessagePublishAckMessageEditMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"ack");if(!t.success)return t;var n=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"edit","1");return n.success?o("WAResultOrError").makeResult({edit:n.value}):n}l.parseAckMessageEditMixin=e}),98);
__d("WASmaxInMessagePublishAckMessagePinMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"ack");if(!t.success)return t;var n=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"edit","2");return n.success?o("WAResultOrError").makeResult({edit:n.value}):n}l.parseAckMessagePinMixin=e}),98);
__d("WASmaxInMessagePublishEnums",["WAJids"],(function(t,n,r,o,a,i,l){var e,s={CBP:"CBP",NBP:"NBP",PMP:"PMP"},u={delivery:"delivery",no_optimization:"no_optimization"},c={false:"false",true:"true"},d={free_customer_service:"free_customer_service",free_entry_point:"free_entry_point",regular:"regular"},m={lid:"lid",pn:"pn"},p={validators:[(e=o("WAJids")).validateDeviceJid,e.validateDeviceJid,e.validateUserJid,e.validateUserJid],typeName:"DeviceJid|DeviceJid|UserJid|UserJid"},_={validators:[e.validateUserJid,e.validateUserJid],typeName:"UserJid|UserJid"};l.ENUM_CBP_NBP_PMP=s,l.ENUM_DELIVERY_NOOPTIMIZATION=u,l.ENUM_FALSE_TRUE=c,l.ENUM_FREECUSTOMERSERVICE_FREEENTRYPOINT_REGULAR=d,l.ENUM_LID_PN=m,l.DEVICEJID_DEVICEJID_USERJID_USERJID=p,l.USERJID_USERJID=_}),98);
__d("WASmaxInMessagePublishAckPaidConversationMixin",["WAResultOrError","WASmaxInMessagePublishEnums","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"delivery_context");if(!t.success)return t;var n=o("WASmaxParseUtils").attrStringEnum(e,"optimization_goal",o("WASmaxInMessagePublishEnums").ENUM_DELIVERY_NOOPTIMIZATION);return n.success?o("WAResultOrError").makeResult({optimizationGoal:n.value}):n}function s(e){var t=o("WASmaxParseUtils").assertTag(e,"source_url");if(!t.success)return t;var n=o("WASmaxParseUtils").contentString(e);return n.success?o("WAResultOrError").makeResult({elementValue:n.value}):n}function u(e){var t=o("WASmaxParseUtils").assertTag(e,"referral");if(!t.success)return t;var n=o("WASmaxParseUtils").optionalChildWithTag(e,"source_url",s);if(!n.success)return n;var r=o("WASmaxParseUtils").optional(o("WASmaxParseUtils").attrString,e,"source_type");return r.success?o("WAResultOrError").makeResult({sourceType:r.value,sourceUrl:n.value}):r}function c(e){var t=o("WASmaxParseUtils").assertTag(e,"origin");if(!t.success)return t;var n=o("WASmaxParseUtils").optionalChildWithTag(e,"referral",u);if(!n.success)return n;var r=o("WASmaxParseUtils").attrString(e,"type");return r.success?o("WAResultOrError").makeResult({type:r.value,referral:n.value}):r}function d(e){var t=o("WASmaxParseUtils").assertTag(e,"pricing");if(!t.success)return t;var n=o("WASmaxParseUtils").optional(o("WASmaxParseUtils").attrString,e,"consumer_country_code");if(!n.success)return n;var r=o("WASmaxParseUtils").optional(o("WASmaxParseUtils").attrString,e,"business_country_code");if(!r.success)return r;var a=o("WASmaxParseUtils").optional(o("WASmaxParseUtils").attrIntRange,e,"conversation_status",0,void 0);if(!a.success)return a;var i=o("WASmaxParseUtils").optional(o("WASmaxParseUtils").attrIntRange,e,"latest_c2b_timestamp",0,void 0);if(!i.success)return i;var l=o("WASmaxParseUtils").optional(o("WASmaxParseUtils").attrString,e,"analytics_conversation_id");if(!l.success)return l;var s=o("WASmaxParseUtils").optional(o("WASmaxParseUtils").attrIntRange,e,"b2c_timestamp",0,void 0);return s.success?o("WAResultOrError").makeResult({consumerCountryCode:n.value,businessCountryCode:r.value,conversationStatus:a.value,latestC2bTimestamp:i.value,analyticsConversationId:l.value,b2cTimestamp:s.value}):s}function m(t){var n=o("WASmaxParseUtils").assertTag(t,"ack");if(!n.success)return n;var r=o("WASmaxParseUtils").flattenedChildWithTag(t,"biz");if(!r.success)return r;var a=o("WASmaxParseUtils").optionalChildWithTag(r.value,"delivery_context",e);if(!a.success)return a;var i=o("WASmaxParseUtils").optionalChildWithTag(r.value,"origin",c);if(!i.success)return i;var l=o("WASmaxParseUtils").optionalChildWithTag(r.value,"pricing",d);if(!l.success)return l;var s=o("WASmaxParseUtils").attrString(r.value,"paid_convo_id");if(!s.success)return s;var u=o("WASmaxParseUtils").attrStringEnum(r.value,"pricing_model",o("WASmaxInMessagePublishEnums").ENUM_CBP_NBP_PMP);if(!u.success)return u;var m=o("WASmaxParseUtils").attrStringEnum(r.value,"billable",o("WASmaxInMessagePublishEnums").ENUM_FALSE_TRUE);if(!m.success)return m;var p=o("WASmaxParseUtils").optional(o("WASmaxParseUtils").attrIntRange,r.value,"expiration_timestamp",0,void 0);if(!p.success)return p;var _=o("WASmaxParseUtils").optional(o("WASmaxParseUtils").attrString,r.value,"pricing_category");if(!_.success)return _;var f=o("WASmaxParseUtils").optional(o("WASmaxParseUtils").attrStringEnum,r.value,"pricing_type",o("WASmaxInMessagePublishEnums").ENUM_FREECUSTOMERSERVICE_FREEENTRYPOINT_REGULAR);return f.success?o("WAResultOrError").makeResult({bizPaidConvoId:s.value,bizPricingModel:u.value,bizBillable:m.value,bizExpirationTimestamp:p.value,bizPricingCategory:_.value,bizPricingType:f.value,bizDeliveryContext:a.value,bizOrigin:i.value,bizPricing:l.value}):f}l.parseAckPaidConversationBizDeliveryContext=e,l.parseAckPaidConversationBizOriginReferralSourceUrl=s,l.parseAckPaidConversationBizOriginReferral=u,l.parseAckPaidConversationBizOrigin=c,l.parseAckPaidConversationBizPricing=d,l.parseAckPaidConversationMixin=m}),98);
__d("WASmaxInMessagePublishAckPaidGroupConversationMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"ack");if(!t.success)return t;var n=o("WASmaxParseUtils").flattenedChildWithTag(e,"biz");if(!n.success)return n;var r=o("WASmaxParseUtils").flattenedChildWithTag(n.value,"pricing");if(!r.success)return r;var a=o("WASmaxParseUtils").optional(o("WASmaxParseUtils").attrString,r.value,"business_country_code");return a.success?o("WAResultOrError").makeResult({bizPricingBusinessCountryCode:a.value}):a}l.parseAckPaidGroupConversationMixin=e}),98);
__d("WASmaxInMessagePublishAckPaidAckPaidConversationOrAckPaidGroupConversationConversationMixinGroup",["WAResultOrError","WASmaxInMessagePublishAckPaidConversationMixin","WASmaxInMessagePublishAckPaidGroupConversationMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxInMessagePublishAckPaidConversationMixin").parseAckPaidConversationMixin(e);if(t.success)return o("WAResultOrError").makeResult({name:"AckPaidConversation",value:t.value});var n=o("WASmaxInMessagePublishAckPaidGroupConversationMixin").parseAckPaidGroupConversationMixin(e);return n.success?o("WAResultOrError").makeResult({name:"AckPaidGroupConversation",value:n.value}):o("WASmaxParseUtils").errorMixinDisjunction(e,["AckPaidConversation","AckPaidGroupConversation"],[t,n])}l.parseAckPaidAckPaidConversationOrAckPaidGroupConversationConversationMixinGroup=e}),98);
__d("WASmaxInMessagePublishAckRevokeMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"ack");if(!t.success)return t;var n=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"edit","7");return n.success?o("WAResultOrError").makeResult({edit:n.value}):n}l.parseAckRevokeMixin=e}),98);
__d("WASmaxInMessagePublishServerFrankingTagMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").flattenedChildWithTag(e,"franking");if(!t.success)return t;var n=o("WASmaxParseUtils").flattenedChildWithTag(t.value,"reporting_tag");if(!n.success)return n;var r=o("WASmaxParseUtils").contentBytesRange(n.value,9,128);return r.success?o("WAResultOrError").makeResult({frankingReportingTagElementValue:r.value}):r}l.parseServerFrankingTagMixin=e}),98);
__d("WASmaxInMessagePublishAckMixin",["WAResultOrError","WASmaxInMessagePublishAckAdminEditMixin","WASmaxInMessagePublishAckAdminRevokeMixin","WASmaxInMessagePublishAckMessageEditMixin","WASmaxInMessagePublishAckMessagePinMixin","WASmaxInMessagePublishAckPaidAckPaidConversationOrAckPaidGroupConversationConversationMixinGroup","WASmaxInMessagePublishAckRevokeMixin","WASmaxInMessagePublishServerFrankingTagMixin","WASmaxParseReference","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"ack");if(!n.success)return n;var r=o("WASmaxParseReference").attrStringFromReference(t,["to"]);if(!r.success)return r;var a=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"from",r.value);if(!a.success)return a;var i=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"class","message");if(!i.success)return i;var l=o("WASmaxParseReference").attrStringFromReference(t,["id"]);if(!l.success)return l;var s=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"id",l.value);if(!s.success)return s;var u=o("WASmaxParseUtils").attrIntRange(e,"t",0,void 0);if(!u.success)return u;var c=o("WASmaxInMessagePublishAckMessageEditMixin").parseAckMessageEditMixin(e),d=o("WASmaxInMessagePublishAckAdminEditMixin").parseAckAdminEditMixin(e),m=o("WASmaxInMessagePublishAckMessagePinMixin").parseAckMessagePinMixin(e),p=o("WASmaxInMessagePublishAckAdminRevokeMixin").parseAckAdminRevokeMixin(e),_=o("WASmaxInMessagePublishAckRevokeMixin").parseAckRevokeMixin(e),f=o("WASmaxInMessagePublishServerFrankingTagMixin").parseServerFrankingTagMixin(e),g=o("WASmaxInMessagePublishAckPaidAckPaidConversationOrAckPaidGroupConversationConversationMixinGroup").parseAckPaidAckPaidConversationOrAckPaidGroupConversationConversationMixinGroup(e);return o("WAResultOrError").makeResult({class:i.value,t:u.value,ackMessageEditMixin:c.success?c.value:null,ackAdminEditMixin:d.success?d.value:null,ackMessagePinMixin:m.success?m.value:null,ackAdminRevokeMixin:p.success?p.value:null,ackRevokeMixin:_.success?_.value:null,serverFrankingTagMixin:f.success?f.value:null,ackPaidAckPaidConversationOrAckPaidGroupConversationConversationMixinGroup:g.success?g.value:null})}l.parseAckMixin=e}),98);
__d("WASmaxInMessagePublishApplicationNegativeAckMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"ack");if(!t.success)return t;var n=o("WASmaxParseUtils").attrIntRange(e,"application_error",0,void 0);return n.success?o("WAResultOrError").makeResult({applicationError:n.value}):n}l.parseApplicationNegativeAckMixin=e}),98);
__d("WASmaxInMessagePublishMessageNackRetryAttributesMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"ack");if(!t.success)return t;var n=o("WASmaxParseUtils").attrIntRange(e,"backoff",0,86400);return n.success?o("WAResultOrError").makeResult({backoff:n.value}):n}l.parseMessageNackRetryAttributesMixin=e}),98);
__d("WASmaxInMessagePublishNegativeAckMixin",["WAResultOrError","WASmaxInMessagePublishAckMixin","WASmaxInMessagePublishApplicationNegativeAckMixin","WASmaxInMessagePublishMessageNackRetryAttributesMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"ack");if(!n.success)return n;var r=o("WASmaxParseUtils").attrString(e,"error");if(!r.success)return r;var a=o("WASmaxInMessagePublishAckMixin").parseAckMixin(e,t);if(!a.success)return a;var i=o("WASmaxInMessagePublishApplicationNegativeAckMixin").parseApplicationNegativeAckMixin(e),l=o("WASmaxInMessagePublishMessageNackRetryAttributesMixin").parseMessageNackRetryAttributesMixin(e);return o("WAResultOrError").makeResult(babelHelpers.extends({error:r.value},a.value,{applicationNegativeAckMixin:i.success?i.value:null,messageNackRetryAttributesMixin:l.success?l.value:null}))}l.parseNegativeAckMixin=e}),98);
__d("WASmaxInPreKeysDeviceIdentityMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").flattenedChildWithTag(e,"device-identity");if(!t.success)return t;var n=o("WASmaxParseUtils").contentBytes(t.value);return n.success?o("WAResultOrError").makeResult({deviceIdentityElementValue:n.value}):n}l.parseDeviceIdentityMixin=e}),98);
__d("WASmaxInPreKeysEnums",["WAJids"],(function(t,n,r,o,a,i,l){var e,s={validators:[(e=o("WAJids")).validateDeviceJid,e.validateDeviceJid],typeName:"DeviceJid|DeviceJid"},u={validators:[e.validateDeviceJid,e.validateDeviceJid,e.validateInteropDeviceJid,e.validateInteropDeviceJid],typeName:"DeviceJid|DeviceJid|InteropDeviceJid|InteropDeviceJid"},c={validators:[e.validateDeviceJid,e.validateDomainJid],typeName:"DeviceJid|DomainJid"},d={validators:[e.validateUserJid,e.validateUserJid],typeName:"UserJid|UserJid"};l.DEVICEJID_DEVICEJID=s,l.DEVICEJID_DEVICEJID_INTEROPDEVICEJID_INTEROPDEVICEJID=u,l.DEVICEJID_DOMAINJID=c,l.USERJID_USERJID=d}),98);
__d("WASmaxInPreKeysIQErrorResponseMixin",["WAResultOrError","WASmaxParseReference","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxParseReference").attrStringFromReference(t,["id"]);if(!r.success)return r;var a=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"id",r.value);if(!a.success)return a;var i=o("WASmaxParseReference").attrStringFromReference(t,["to"]);if(!i.success)return i;var l=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"from",i.value);if(!l.success)return l;var s=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"type","error");return s.success?o("WAResultOrError").makeResult({type:s.value}):s}l.parseIQErrorResponseMixin=e}),98);
__d("WASmaxInPreKeysIQErrorBadRequestMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"error");if(!t.success)return t;var n=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"text","bad-request");if(!n.success)return n;var r=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrInt,e,"code",400);return r.success?o("WAResultOrError").makeResult({text:n.value,code:r.value}):r}l.parseIQErrorBadRequestMixin=e}),98);
__d("WASmaxInPreKeysIQErrorFallbackClientMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"error");if(!t.success)return t;var n=o("WASmaxParseUtils").attrString(e,"text");if(!n.success)return n;var r=o("WASmaxParseUtils").attrIntRange(e,"code",400,499);return r.success?o("WAResultOrError").makeResult({text:n.value,code:r.value}):r}l.parseIQErrorFallbackClientMixin=e}),98);
__d("WASmaxInPreKeysIQErrorNoValidJIDMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"error");if(!t.success)return t;var n=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"text","not-acceptable");if(!n.success)return n;var r=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrInt,e,"code",406);return r.success?o("WAResultOrError").makeResult({text:n.value,code:r.value}):r}l.parseIQErrorNoValidJIDMixin=e}),98);
__d("WASmaxInPreKeysRequestErrorsFetch",["WAResultOrError","WASmaxInPreKeysIQErrorBadRequestMixin","WASmaxInPreKeysIQErrorFallbackClientMixin","WASmaxInPreKeysIQErrorNoValidJIDMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxInPreKeysIQErrorBadRequestMixin").parseIQErrorBadRequestMixin(e);if(t.success)return o("WAResultOrError").makeResult({name:"IQErrorBadRequest",value:t.value});var n=o("WASmaxInPreKeysIQErrorNoValidJIDMixin").parseIQErrorNoValidJIDMixin(e);if(n.success)return o("WAResultOrError").makeResult({name:"IQErrorNoValidJID",value:n.value});var r=o("WASmaxInPreKeysIQErrorFallbackClientMixin").parseIQErrorFallbackClientMixin(e);return r.success?o("WAResultOrError").makeResult({name:"IQErrorFallbackClient",value:r.value}):o("WASmaxParseUtils").errorMixinDisjunction(e,["IQErrorBadRequest","IQErrorNoValidJID","IQErrorFallbackClient"],[t,n,r])}l.parseRequestErrorsFetch=e}),98);
__d("WASmaxInPreKeysFetchKeyBundlesResponseRequestError",["WAResultOrError","WASmaxInPreKeysIQErrorResponseMixin","WASmaxInPreKeysRequestErrorsFetch","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxParseUtils").flattenedChildWithTag(e,"error");if(!r.success)return r;var a=o("WASmaxInPreKeysIQErrorResponseMixin").parseIQErrorResponseMixin(e,t);if(!a.success)return a;var i=o("WASmaxInPreKeysRequestErrorsFetch").parseRequestErrorsFetch(r.value);return i.success?o("WAResultOrError").makeResult(babelHelpers.extends({},a.value,{errorRequestErrorsFetch:i.value})):i}l.parseFetchKeyBundlesResponseRequestError=e}),98);
__d("WASmaxInPreKeysIQErrorFallbackServerMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"error");if(!t.success)return t;var n=o("WASmaxParseUtils").attrString(e,"text");if(!n.success)return n;var r=o("WASmaxParseUtils").attrIntRange(e,"code",500,599);return r.success?o("WAResultOrError").makeResult({text:n.value,code:r.value}):r}l.parseIQErrorFallbackServerMixin=e}),98);
__d("WASmaxInPreKeysIQErrorServiceUnavailableMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"error");if(!t.success)return t;var n=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"text","service-unavailable");if(!n.success)return n;var r=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrInt,e,"code",503);return r.success?o("WAResultOrError").makeResult({text:n.value,code:r.value}):r}l.parseIQErrorServiceUnavailableMixin=e}),98);
__d("WASmaxInPreKeysServerErrors",["WAResultOrError","WASmaxInPreKeysIQErrorFallbackServerMixin","WASmaxInPreKeysIQErrorServiceUnavailableMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxInPreKeysIQErrorServiceUnavailableMixin").parseIQErrorServiceUnavailableMixin(e);if(t.success)return o("WAResultOrError").makeResult({name:"IQErrorServiceUnavailable",value:t.value});var n=o("WASmaxInPreKeysIQErrorFallbackServerMixin").parseIQErrorFallbackServerMixin(e);return n.success?o("WAResultOrError").makeResult({name:"IQErrorFallbackServer",value:n.value}):o("WASmaxParseUtils").errorMixinDisjunction(e,["IQErrorServiceUnavailable","IQErrorFallbackServer"],[t,n])}l.parseServerErrors=e}),98);
__d("WASmaxInPreKeysFetchKeyBundlesResponseServerError",["WAResultOrError","WASmaxInPreKeysIQErrorResponseMixin","WASmaxInPreKeysServerErrors","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxParseUtils").flattenedChildWithTag(e,"error");if(!r.success)return r;var a=o("WASmaxInPreKeysIQErrorResponseMixin").parseIQErrorResponseMixin(e,t);if(!a.success)return a;var i=o("WASmaxInPreKeysServerErrors").parseServerErrors(r.value);return i.success?o("WAResultOrError").makeResult(babelHelpers.extends({},a.value,{errorServerErrors:i.value})):i}l.parseFetchKeyBundlesResponseServerError=e}),98);
__d("WASmaxInPreKeysIQResultResponseMixin",["WAResultOrError","WASmaxParseReference","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxParseReference").attrStringFromReference(t,["id"]);if(!r.success)return r;var a=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"id",r.value);if(!a.success)return a;var i=o("WASmaxParseReference").attrStringFromReference(t,["to"]);if(!i.success)return i;var l=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"from",i.value);if(!l.success)return l;var s=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"type","result");return s.success?o("WAResultOrError").makeResult({type:s.value}):s}l.parseIQResultResponseMixin=e}),98);
__d("WASmaxInPreKeysResponsePaddingMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"iq");if(!t.success)return t;var n=o("WASmaxParseUtils").flattenedChildWithTag(e,"padding");if(!n.success)return n;var r=o("WASmaxParseUtils").contentBytesRange(n.value,0,524288);return r.success?o("WAResultOrError").makeResult({paddingElementValue:r.value}):r}l.parseResponsePaddingMixin=e}),98);
__d("WASmaxInPreKeysFetchKeyBundlesUserErrorFallbackMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"user");if(!t.success)return t;var n=o("WASmaxParseUtils").flattenedChildWithTag(e,"error");if(!n.success)return n;var r=o("WASmaxParseUtils").attrString(n.value,"text");if(!r.success)return r;var a=o("WASmaxParseUtils").attrIntRange(n.value,"code",500,599);return a.success?o("WAResultOrError").makeResult({errorText:r.value,errorCode:a.value}):a}l.parseFetchKeyBundlesUserErrorFallbackMixin=e}),98);
__d("WASmaxInPreKeysFetchKeyBundlesUserErrorMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"user");if(!t.success)return t;var n=o("WASmaxParseUtils").flattenedChildWithTag(e,"error");if(!n.success)return n;var r=o("WASmaxParseUtils").attrString(n.value,"text");if(!r.success)return r;var a=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrInt,n.value,"code",500);return a.success?o("WAResultOrError").makeResult({errorText:r.value,errorCode:a.value}):a}l.parseFetchKeyBundlesUserErrorMixin=e}),98);
__d("WASmaxInPreKeysKeyDataMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").contentBytesRange(e,32,32);return t.success?o("WAResultOrError").makeResult({elementValue:t.value}):t}l.parseKeyDataMixin=e}),98);
__d("WASmaxInPreKeysIdentityKeyMixin",["WASmaxInPreKeysKeyDataMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").flattenedChildWithTag(e,"identity");if(!t.success)return t;var n=o("WASmaxInPreKeysKeyDataMixin").parseKeyDataMixin(t.value);return n.success,n}l.parseIdentityKeyMixin=e}),98);
__d("WASmaxInPreKeysKeyTypeMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").flattenedChildWithTag(e,"type");if(!t.success)return t;var n=o("WASmaxParseUtils").contentLiteralBytes(t.value,new Uint8Array([5]));return n.success?o("WAResultOrError").makeResult({typeElementValue:n.value}):n}l.parseKeyTypeMixin=e}),98);
__d("WASmaxInPreKeysKeyIDMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"id");if(!t.success)return t;var n=o("WASmaxParseUtils").contentBytesRange(e,3,3);return n.success?o("WAResultOrError").makeResult({elementValue:n.value}):n}l.parseKeyIDMixin=e}),98);
__d("WASmaxInPreKeysPreKeyMixin",["WAResultOrError","WASmaxInPreKeysKeyDataMixin","WASmaxInPreKeysKeyIDMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").flattenedChildWithTag(e,"key");if(!t.success)return t;var n=o("WASmaxParseUtils").flattenedChildWithTag(t.value,"id");if(!n.success)return n;var r=o("WASmaxParseUtils").flattenedChildWithTag(t.value,"value");if(!r.success)return r;var a=o("WASmaxInPreKeysKeyIDMixin").parseKeyIDMixin(n.value);if(!a.success)return a;var i=o("WASmaxInPreKeysKeyDataMixin").parseKeyDataMixin(r.value);return i.success?o("WAResultOrError").makeResult({keyIdKeyIDMixin:a.value,keyValueKeyDataMixin:i.value}):i}l.parsePreKeyMixin=e}),98);
__d("WASmaxInPreKeysRegistrationIDMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").flattenedChildWithTag(e,"registration");if(!t.success)return t;var n=o("WASmaxParseUtils").contentBytesRange(t.value,4,4);return n.success?o("WAResultOrError").makeResult({registrationElementValue:n.value}):n}l.parseRegistrationIDMixin=e}),98);
__d("WASmaxInPreKeysSignedPreKeyMixin",["WAResultOrError","WASmaxInPreKeysKeyDataMixin","WASmaxInPreKeysKeyIDMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").flattenedChildWithTag(e,"skey");if(!t.success)return t;var n=o("WASmaxParseUtils").flattenedChildWithTag(t.value,"id");if(!n.success)return n;var r=o("WASmaxParseUtils").flattenedChildWithTag(t.value,"value");if(!r.success)return r;var a=o("WASmaxParseUtils").flattenedChildWithTag(t.value,"signature");if(!a.success)return a;var i=o("WASmaxParseUtils").contentBytesRange(a.value,64,64);if(!i.success)return i;var l=o("WASmaxInPreKeysKeyIDMixin").parseKeyIDMixin(n.value);if(!l.success)return l;var s=o("WASmaxInPreKeysKeyDataMixin").parseKeyDataMixin(r.value);return s.success?o("WAResultOrError").makeResult({skeySignatureElementValue:i.value,skeyIdKeyIDMixin:l.value,skeyValueKeyDataMixin:s.value}):s}l.parseSignedPreKeyMixin=e}),98);
__d("WASmaxInPreKeysFetchKeyBundlesUserSuccessMixin",["WAResultOrError","WASmaxInPreKeysDeviceIdentityMixin","WASmaxInPreKeysIdentityKeyMixin","WASmaxInPreKeysKeyTypeMixin","WASmaxInPreKeysPreKeyMixin","WASmaxInPreKeysRegistrationIDMixin","WASmaxInPreKeysSignedPreKeyMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"user");if(!t.success)return t;var n=o("WASmaxParseUtils").optional(o("WASmaxParseUtils").attrIntRange,e,"t",0,void 0);if(!n.success)return n;var r=o("WASmaxParseUtils").optionalLiteral(o("WASmaxParseUtils").attrString,e,"is_cloud_api","true");if(!r.success)return r;var a=o("WASmaxInPreKeysRegistrationIDMixin").parseRegistrationIDMixin(e);if(!a.success)return a;var i=o("WASmaxInPreKeysKeyTypeMixin").parseKeyTypeMixin(e),l=o("WASmaxInPreKeysIdentityKeyMixin").parseIdentityKeyMixin(e);if(!l.success)return l;var s=o("WASmaxInPreKeysPreKeyMixin").parsePreKeyMixin(e),u=o("WASmaxInPreKeysSignedPreKeyMixin").parseSignedPreKeyMixin(e);if(!u.success)return u;var c=o("WASmaxInPreKeysDeviceIdentityMixin").parseDeviceIdentityMixin(e);return o("WAResultOrError").makeResult(babelHelpers.extends({t:n.value,isCloudApi:r.value},a.value,{keyTypeMixin:i.success?i.value:null},l.value,{preKeyMixin:s.success?s.value:null},u.value,{deviceIdentityMixin:c.success?c.value:null}))}l.parseFetchKeyBundlesUserSuccessMixin=e}),98);
__d("WASmaxInPreKeysUserFetchKeyBundlesSuccessOrFetchKeyBundlesErrorOrFetchKeyBundlesErrorFallbackMixinGroup",["WAResultOrError","WASmaxInPreKeysFetchKeyBundlesUserErrorFallbackMixin","WASmaxInPreKeysFetchKeyBundlesUserErrorMixin","WASmaxInPreKeysFetchKeyBundlesUserSuccessMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxInPreKeysFetchKeyBundlesUserSuccessMixin").parseFetchKeyBundlesUserSuccessMixin(e);if(t.success)return o("WAResultOrError").makeResult({name:"FetchKeyBundlesUserSuccess",value:t.value});var n=o("WASmaxInPreKeysFetchKeyBundlesUserErrorMixin").parseFetchKeyBundlesUserErrorMixin(e);if(n.success)return o("WAResultOrError").makeResult({name:"FetchKeyBundlesUserError",value:n.value});var r=o("WASmaxInPreKeysFetchKeyBundlesUserErrorFallbackMixin").parseFetchKeyBundlesUserErrorFallbackMixin(e);return r.success?o("WAResultOrError").makeResult({name:"FetchKeyBundlesUserErrorFallback",value:r.value}):o("WASmaxParseUtils").errorMixinDisjunction(e,["UserSuccess","UserError","UserErrorFallback"],[t,n,r])}l.parseUserFetchKeyBundlesSuccessOrFetchKeyBundlesErrorOrFetchKeyBundlesErrorFallbackMixinGroup=e}),98);
__d("WASmaxInPreKeysFetchKeyBundlesResponseSuccess",["WAResultOrError","WASmaxInPreKeysEnums","WASmaxInPreKeysIQResultResponseMixin","WASmaxInPreKeysResponsePaddingMixin","WASmaxInPreKeysUserFetchKeyBundlesSuccessOrFetchKeyBundlesErrorOrFetchKeyBundlesErrorFallbackMixinGroup","WASmaxParseJid","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"user");if(!t.success)return t;var n=o("WASmaxParseJid").attrJidEnum(e,"jid",o("WASmaxInPreKeysEnums").DEVICEJID_DEVICEJID);if(!n.success)return n;var r=o("WASmaxInPreKeysUserFetchKeyBundlesSuccessOrFetchKeyBundlesErrorOrFetchKeyBundlesErrorFallbackMixinGroup").parseUserFetchKeyBundlesSuccessOrFetchKeyBundlesErrorOrFetchKeyBundlesErrorFallbackMixinGroup(e);return r.success?o("WAResultOrError").makeResult({jid:n.value,userFetchKeyBundlesSuccessOrFetchKeyBundlesErrorOrFetchKeyBundlesErrorFallbackMixinGroup:r.value}):r}function s(t,n){var r=o("WASmaxParseUtils").assertTag(t,"iq");if(!r.success)return r;var a=o("WASmaxParseUtils").flattenedChildWithTag(t,"list");if(!a.success)return a;var i=o("WASmaxInPreKeysIQResultResponseMixin").parseIQResultResponseMixin(t,n);if(!i.success)return i;var l=o("WASmaxInPreKeysResponsePaddingMixin").parseResponsePaddingMixin(t),s=o("WASmaxParseUtils").mapChildrenWithTag(a.value,"user",0,1e5,e);return s.success?o("WAResultOrError").makeResult(babelHelpers.extends({},i.value,{responsePaddingMixin:l.success?l.value:null,listUser:s.value})):s}l.parseFetchKeyBundlesResponseSuccessListUser=e,l.parseFetchKeyBundlesResponseSuccess=s}),98);
__d("WASmaxInProfilePictureEnums",["WAJids"],(function(t,n,r,o,a,i,l){var e,s={false:"false",true:"true"},u={image:"image",preview:"preview"},c={lid:"lid",pn:"pn"},d={validators:[(e=o("WAJids")).validateDomainJid,e.validateGroupJid,e.validateUserJid,e.validateUserJid],typeName:"DomainJid|GroupJid|UserJid|UserJid"},m={validators:[e.validateGroupJid,e.validateUserJid],typeName:"GroupJid|UserJid"},p={validators:[e.validateUserJid,e.validateUserJid],typeName:"UserJid|UserJid"};l.ENUM_FALSE_TRUE=s,l.ENUM_IMAGE_PREVIEW=u,l.ENUM_LID_PN=c,l.DOMAINJID_GROUPJID_USERJID_USERJID=d,l.GROUPJID_USERJID=m,l.USERJID_USERJID=p}),98);
__d("WASmaxInProfilePictureIQErrorResponseMixin",["WAResultOrError","WASmaxParseReference","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxParseReference").attrStringFromReference(t,["id"]);if(!r.success)return r;var a=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"id",r.value);if(!a.success)return a;var i=o("WASmaxParseReference").attrStringFromReference(t,["to"]);if(!i.success)return i;var l=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"from",i.value);if(!l.success)return l;var s=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"type","error");return s.success?o("WAResultOrError").makeResult({type:s.value}):s}l.parseIQErrorResponseMixin=e}),98);
__d("WASmaxInProfilePictureIQErrorBadRequestMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"error");if(!t.success)return t;var n=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"text","bad-request");if(!n.success)return n;var r=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrInt,e,"code",400);return r.success?o("WAResultOrError").makeResult({text:n.value,code:r.value}):r}l.parseIQErrorBadRequestMixin=e}),98);
__d("WASmaxInProfilePictureIQErrorFeatureNotImplementedMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"error");if(!t.success)return t;var n=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"text","feature-not-implemented");if(!n.success)return n;var r=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrInt,e,"code",501);return r.success?o("WAResultOrError").makeResult({text:n.value,code:r.value}):r}l.parseIQErrorFeatureNotImplementedMixin=e}),98);
__d("WASmaxInProfilePictureIQErrorInternalServerErrorMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"error");if(!t.success)return t;var n=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"text","internal-server-error");if(!n.success)return n;var r=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrInt,e,"code",500);return r.success?o("WAResultOrError").makeResult({text:n.value,code:r.value}):r}l.parseIQErrorInternalServerErrorMixin=e}),98);
__d("WASmaxInProfilePictureIQErrorItemNotFoundMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"error");if(!t.success)return t;var n=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"text","item-not-found");if(!n.success)return n;var r=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrInt,e,"code",404);return r.success?o("WAResultOrError").makeResult({text:n.value,code:r.value}):r}l.parseIQErrorItemNotFoundMixin=e}),98);
__d("WASmaxInProfilePictureIQErrorNotAuthorizedMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"error");if(!t.success)return t;var n=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"text","not-authorized");if(!n.success)return n;var r=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrInt,e,"code",401);return r.success?o("WAResultOrError").makeResult({text:n.value,code:r.value}):r}l.parseIQErrorNotAuthorizedMixin=e}),98);
__d("WASmaxInProfilePictureIQErrorRateOverlimitMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"error");if(!t.success)return t;var n=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"text","rate-overlimit");if(!n.success)return n;var r=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrInt,e,"code",429);return r.success?o("WAResultOrError").makeResult({text:n.value,code:r.value}):r}l.parseIQErrorRateOverlimitMixin=e}),98);
__d("WASmaxInProfilePictureIQErrorServiceUnavailableMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"error");if(!t.success)return t;var n=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"text","service-unavailable");if(!n.success)return n;var r=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrInt,e,"code",503);return r.success?o("WAResultOrError").makeResult({text:n.value,code:r.value}):r}l.parseIQErrorServiceUnavailableMixin=e}),98);
__d("WASmaxInProfilePictureProfilePictureGetErrors",["WAResultOrError","WASmaxInProfilePictureIQErrorBadRequestMixin","WASmaxInProfilePictureIQErrorFeatureNotImplementedMixin","WASmaxInProfilePictureIQErrorInternalServerErrorMixin","WASmaxInProfilePictureIQErrorItemNotFoundMixin","WASmaxInProfilePictureIQErrorNotAuthorizedMixin","WASmaxInProfilePictureIQErrorRateOverlimitMixin","WASmaxInProfilePictureIQErrorServiceUnavailableMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxInProfilePictureIQErrorBadRequestMixin").parseIQErrorBadRequestMixin(e);if(t.success)return o("WAResultOrError").makeResult({name:"IQErrorBadRequest",value:t.value});var n=o("WASmaxInProfilePictureIQErrorNotAuthorizedMixin").parseIQErrorNotAuthorizedMixin(e);if(n.success)return o("WAResultOrError").makeResult({name:"IQErrorNotAuthorized",value:n.value});var r=o("WASmaxInProfilePictureIQErrorItemNotFoundMixin").parseIQErrorItemNotFoundMixin(e);if(r.success)return o("WAResultOrError").makeResult({name:"IQErrorItemNotFound",value:r.value});var a=o("WASmaxInProfilePictureIQErrorRateOverlimitMixin").parseIQErrorRateOverlimitMixin(e);if(a.success)return o("WAResultOrError").makeResult({name:"IQErrorRateOverlimit",value:a.value});var i=o("WASmaxInProfilePictureIQErrorInternalServerErrorMixin").parseIQErrorInternalServerErrorMixin(e);if(i.success)return o("WAResultOrError").makeResult({name:"IQErrorInternalServerError",value:i.value});var l=o("WASmaxInProfilePictureIQErrorFeatureNotImplementedMixin").parseIQErrorFeatureNotImplementedMixin(e);if(l.success)return o("WAResultOrError").makeResult({name:"IQErrorFeatureNotImplemented",value:l.value});var s=o("WASmaxInProfilePictureIQErrorServiceUnavailableMixin").parseIQErrorServiceUnavailableMixin(e);return s.success?o("WAResultOrError").makeResult({name:"IQErrorServiceUnavailable",value:s.value}):o("WASmaxParseUtils").errorMixinDisjunction(e,["IQErrorBadRequest","IQErrorNotAuthorized","IQErrorItemNotFound","IQErrorRateOverlimit","IQErrorInternalServerError","IQErrorFeatureNotImplemented","IQErrorServiceUnavailable"],[t,n,r,a,i,l,s])}l.parseProfilePictureGetErrors=e}),98);
__d("WASmaxInProfilePictureGetResponseError",["WAResultOrError","WASmaxInProfilePictureIQErrorResponseMixin","WASmaxInProfilePictureProfilePictureGetErrors","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxParseUtils").flattenedChildWithTag(e,"error");if(!r.success)return r;var a=o("WASmaxInProfilePictureIQErrorResponseMixin").parseIQErrorResponseMixin(e,t);if(!a.success)return a;var i=o("WASmaxInProfilePictureProfilePictureGetErrors").parseProfilePictureGetErrors(r.value);return i.success?o("WAResultOrError").makeResult(babelHelpers.extends({},a.value,{errorProfilePictureGetErrors:i.value})):i}l.parseGetResponseError=e}),98);
__d("WASmaxInProfilePictureIQResultResponseMixin",["WAResultOrError","WASmaxParseReference","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxParseReference").attrStringFromReference(t,["id"]);if(!r.success)return r;var a=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"id",r.value);if(!a.success)return a;var i=o("WASmaxParseReference").attrStringFromReference(t,["to"]);if(!i.success)return i;var l=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"from",i.value);if(!l.success)return l;var s=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"type","result");return s.success?o("WAResultOrError").makeResult({type:s.value}):s}l.parseIQResultResponseMixin=e}),98);
__d("WASmaxInProfilePictureGetResponseSuccessAvatarURLs",["WAResultOrError","WASmaxInProfilePictureIQResultResponseMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"avatar");if(!t.success)return t;var n=o("WASmaxParseUtils").attrString(e,"url");if(!n.success)return n;var r=o("WASmaxParseUtils").attrString(e,"pose_id");if(!r.success)return r;var a=o("WASmaxParseUtils").optional(o("WASmaxParseUtils").attrString,e,"hash");return a.success?o("WAResultOrError").makeResult({url:n.value,poseId:r.value,hash:a.value}):a}function s(t,n){var r=o("WASmaxParseUtils").assertTag(t,"iq");if(!r.success)return r;var a=o("WASmaxInProfilePictureIQResultResponseMixin").parseIQResultResponseMixin(t,n);if(!a.success)return a;var i=o("WASmaxParseUtils").mapChildrenWithTag(t,"avatar",1,4,e);return i.success?o("WAResultOrError").makeResult(babelHelpers.extends({},a.value,{avatar:i.value})):i}l.parseGetResponseSuccessAvatarURLsAvatar=e,l.parseGetResponseSuccessAvatarURLs=s}),98);
__d("WASmaxInProfilePictureGetResponseSuccessNoData",["WASmaxInProfilePictureIQResultResponseMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxInProfilePictureIQResultResponseMixin").parseIQResultResponseMixin(e,t);return r.success,r}l.parseGetResponseSuccessNoData=e}),98);
__d("WASmaxInProfilePictureGetResponseSuccessPictureBlob",["WAResultOrError","WASmaxInProfilePictureEnums","WASmaxInProfilePictureIQResultResponseMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxParseUtils").flattenedChildWithTag(e,"picture");if(!r.success)return r;var a=o("WASmaxParseUtils").attrString(r.value,"id");if(!a.success)return a;var i=o("WASmaxParseUtils").attrStringEnum(r.value,"type",o("WASmaxInProfilePictureEnums").ENUM_IMAGE_PREVIEW);if(!i.success)return i;var l=o("WASmaxParseUtils").optional(o("WASmaxParseUtils").attrStringEnum,r.value,"has_staging",o("WASmaxInProfilePictureEnums").ENUM_FALSE_TRUE);if(!l.success)return l;var s=o("WASmaxParseUtils").contentBytesRange(r.value,1,void 0);if(!s.success)return s;var u=o("WASmaxInProfilePictureIQResultResponseMixin").parseIQResultResponseMixin(e,t);return u.success?o("WAResultOrError").makeResult(babelHelpers.extends({pictureId:a.value,pictureType:i.value,pictureHasStaging:l.value,pictureElementValue:s.value},u.value)):u}l.parseGetResponseSuccessPictureBlob=e}),98);
__d("WASmaxInProfilePictureGetResponseSuccessPictureURL",["WAResultOrError","WASmaxInProfilePictureEnums","WASmaxInProfilePictureIQResultResponseMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxParseUtils").flattenedChildWithTag(e,"picture");if(!r.success)return r;var a=o("WASmaxParseUtils").attrString(r.value,"id");if(!a.success)return a;var i=o("WASmaxParseUtils").attrStringEnum(r.value,"type",o("WASmaxInProfilePictureEnums").ENUM_IMAGE_PREVIEW);if(!i.success)return i;var l=o("WASmaxParseUtils").attrString(r.value,"url");if(!l.success)return l;var s=o("WASmaxParseUtils").attrString(r.value,"direct_path");if(!s.success)return s;var u=o("WASmaxParseUtils").optional(o("WASmaxParseUtils").attrString,r.value,"hash");if(!u.success)return u;var c=o("WASmaxParseUtils").optional(o("WASmaxParseUtils").attrStringEnum,r.value,"has_staging",o("WASmaxInProfilePictureEnums").ENUM_FALSE_TRUE);if(!c.success)return c;var d=o("WASmaxInProfilePictureIQResultResponseMixin").parseIQResultResponseMixin(e,t);return d.success?o("WAResultOrError").makeResult(babelHelpers.extends({pictureId:a.value,pictureType:i.value,pictureUrl:l.value,pictureDirectPath:s.value,pictureHash:u.value,pictureHasStaging:c.value},d.value)):d}l.parseGetResponseSuccessPictureURL=e}),98);
__d("WASmaxInSpamEnums",["WAJids"],(function(t,n,r,o,a,i,l){var e={validators:[o("WAJids").validateDomainJid,o("WAJids").validateUserJid],typeName:"DomainJid|UserJid"};l.DOMAINJID_USERJID=e}),98);
__d("WASmaxInSpamIQErrorBadRequestMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"error");if(!t.success)return t;var n=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"text","bad-request");if(!n.success)return n;var r=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrInt,e,"code",400);return r.success?o("WAResultOrError").makeResult({text:n.value,code:r.value}):r}l.parseIQErrorBadRequestMixin=e}),98);
__d("WASmaxInSpamIQErrorFeatureNotImplementedMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"error");if(!t.success)return t;var n=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"text","feature-not-implemented");if(!n.success)return n;var r=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrInt,e,"code",501);return r.success?o("WAResultOrError").makeResult({text:n.value,code:r.value}):r}l.parseIQErrorFeatureNotImplementedMixin=e}),98);
__d("WASmaxInSpamIQErrorForbiddenMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"error");if(!t.success)return t;var n=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"text","forbidden");if(!n.success)return n;var r=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrInt,e,"code",403);return r.success?o("WAResultOrError").makeResult({text:n.value,code:r.value}):r}l.parseIQErrorForbiddenMixin=e}),98);
__d("WASmaxInSpamIQErrorInternalServerErrorMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"error");if(!t.success)return t;var n=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"text","internal-server-error");if(!n.success)return n;var r=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrInt,e,"code",500);return r.success?o("WAResultOrError").makeResult({text:n.value,code:r.value}):r}l.parseIQErrorInternalServerErrorMixin=e}),98);
__d("WASmaxInSpamIQErrorRateOverlimitMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"error");if(!t.success)return t;var n=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"text","rate-overlimit");if(!n.success)return n;var r=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrInt,e,"code",429);return r.success?o("WAResultOrError").makeResult({text:n.value,code:r.value}):r}l.parseIQErrorRateOverlimitMixin=e}),98);
__d("WASmaxInSpamIQErrorReportTokenValidationFailMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"error");if(!t.success)return t;var n=o("WASmaxParseUtils").attrString(e,"text");if(!n.success)return n;var r=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrInt,e,"code",548);return r.success?o("WAResultOrError").makeResult({text:n.value,code:r.value}):r}l.parseIQErrorReportTokenValidationFailMixin=e}),98);
__d("WASmaxInSpamSpamIqErrors",["WAResultOrError","WASmaxInSpamIQErrorBadRequestMixin","WASmaxInSpamIQErrorFeatureNotImplementedMixin","WASmaxInSpamIQErrorForbiddenMixin","WASmaxInSpamIQErrorInternalServerErrorMixin","WASmaxInSpamIQErrorRateOverlimitMixin","WASmaxInSpamIQErrorReportTokenValidationFailMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxInSpamIQErrorInternalServerErrorMixin").parseIQErrorInternalServerErrorMixin(e);if(t.success)return o("WAResultOrError").makeResult({name:"IQErrorInternalServerError",value:t.value});var n=o("WASmaxInSpamIQErrorBadRequestMixin").parseIQErrorBadRequestMixin(e);if(n.success)return o("WAResultOrError").makeResult({name:"IQErrorBadRequest",value:n.value});var r=o("WASmaxInSpamIQErrorForbiddenMixin").parseIQErrorForbiddenMixin(e);if(r.success)return o("WAResultOrError").makeResult({name:"IQErrorForbidden",value:r.value});var a=o("WASmaxInSpamIQErrorRateOverlimitMixin").parseIQErrorRateOverlimitMixin(e);if(a.success)return o("WAResultOrError").makeResult({name:"IQErrorRateOverlimit",value:a.value});var i=o("WASmaxInSpamIQErrorReportTokenValidationFailMixin").parseIQErrorReportTokenValidationFailMixin(e);if(i.success)return o("WAResultOrError").makeResult({name:"IQErrorReportTokenValidationFail",value:i.value});var l=o("WASmaxInSpamIQErrorFeatureNotImplementedMixin").parseIQErrorFeatureNotImplementedMixin(e);return l.success?o("WAResultOrError").makeResult({name:"IQErrorFeatureNotImplemented",value:l.value}):o("WASmaxParseUtils").errorMixinDisjunction(e,["IQErrorInternalServerError","IQErrorBadRequest","IQErrorForbidden","IQErrorRateOverlimit","IQErrorReportTokenValidationFail","IQErrorFeatureNotImplemented"],[t,n,r,a,i,l])}l.parseSpamIqErrors=e}),98);
__d("WASmaxInSpamIndividualReportResponseError",["WAResultOrError","WASmaxInSpamEnums","WASmaxInSpamSpamIqErrors","WASmaxParseJid","WASmaxParseReference","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxParseUtils").flattenedChildWithTag(e,"error");if(!r.success)return r;var a=o("WASmaxParseReference").attrStringFromReference(t,["id"]);if(!a.success)return a;var i=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"id",a.value);if(!i.success)return i;var l=o("WASmaxParseUtils").optional(o("WASmaxParseJid").attrJidEnum,e,"from",o("WASmaxInSpamEnums").DOMAINJID_USERJID);if(!l.success)return l;var s=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"type","error");if(!s.success)return s;var u=o("WASmaxInSpamSpamIqErrors").parseSpamIqErrors(r.value);return u.success?o("WAResultOrError").makeResult({from:l.value,type:s.value,errorSpamIqErrors:u.value}):u}l.parseIndividualReportResponseError=e}),98);
__d("WASmaxInSpamReportIdMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"iq");if(!t.success)return t;var n=o("WASmaxParseUtils").flattenedChildWithTag(e,"report");if(!n.success)return n;var r=o("WASmaxParseUtils").attrString(n.value,"id");return r.success?o("WAResultOrError").makeResult({reportId:r.value}):r}l.parseReportIdMixin=e}),98);
__d("WASmaxInSpamIndividualReportResponseSuccess",["WAResultOrError","WASmaxInSpamEnums","WASmaxInSpamReportIdMixin","WASmaxParseJid","WASmaxParseReference","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxParseReference").attrStringFromReference(t,["id"]);if(!r.success)return r;var a=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"id",r.value);if(!a.success)return a;var i=o("WASmaxParseUtils").optional(o("WASmaxParseJid").attrJidEnum,e,"from",o("WASmaxInSpamEnums").DOMAINJID_USERJID);if(!i.success)return i;var l=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"type","result");if(!l.success)return l;var s=o("WASmaxInSpamReportIdMixin").parseReportIdMixin(e);return o("WAResultOrError").makeResult({from:i.value,type:l.value,reportIdMixin:s.success?s.value:null})}l.parseIndividualReportResponseSuccess=e}),98);
__d("WASmaxInStatsIQErrorBadRequestMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"error");if(!t.success)return t;var n=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"text","bad-request");if(!n.success)return n;var r=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrInt,e,"code",400);return r.success?o("WAResultOrError").makeResult({text:n.value,code:r.value}):r}l.parseIQErrorBadRequestMixin=e}),98);
__d("WASmaxInStatsIQErrorFeatureNotImplementedMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"error");if(!t.success)return t;var n=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"text","feature-not-implemented");if(!n.success)return n;var r=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrInt,e,"code",501);return r.success?o("WAResultOrError").makeResult({text:n.value,code:r.value}):r}l.parseIQErrorFeatureNotImplementedMixin=e}),98);
__d("WASmaxInStatsIQErrorNotAcceptableMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"field");if(!t.success)return t;var n=o("WASmaxParseUtils").attrString(e,"name");if(!n.success)return n;var r=o("WASmaxParseUtils").attrString(e,"reason");return r.success?o("WAResultOrError").makeResult({name:n.value,reason:r.value}):r}function s(t){var n=o("WASmaxParseUtils").assertTag(t,"error");if(!n.success)return n;var r=o("WASmaxParseUtils").optionalChildWithTag(t,"field",e);if(!r.success)return r;var a=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,t,"text","not-acceptable");if(!a.success)return a;var i=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrInt,t,"code",406);return i.success?o("WAResultOrError").makeResult({text:a.value,code:i.value,field:r.value}):i}l.parseIQErrorNotAcceptableField=e,l.parseIQErrorNotAcceptableMixin=s}),98);
__d("WASmaxInStatsIQErrorResponseMixin",["WAResultOrError","WASmaxParseReference","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxParseReference").attrStringFromReference(t,["id"]);if(!r.success)return r;var a=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"id",r.value);if(!a.success)return a;var i=o("WASmaxParseReference").attrStringFromReference(t,["to"]);if(!i.success)return i;var l=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"from",i.value);if(!l.success)return l;var s=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"type","error");return s.success?o("WAResultOrError").makeResult({type:s.value}):s}l.parseIQErrorResponseMixin=e}),98);
__d("WASmaxInStatsIQErrorServiceUnavailableMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"error");if(!t.success)return t;var n=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"text","service-unavailable");if(!n.success)return n;var r=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrInt,e,"code",503);return r.success?o("WAResultOrError").makeResult({text:n.value,code:r.value}):r}l.parseIQErrorServiceUnavailableMixin=e}),98);
__d("WASmaxInStatsIQResultResponseMixin",["WAResultOrError","WASmaxParseReference","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxParseReference").attrStringFromReference(t,["id"]);if(!r.success)return r;var a=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"id",r.value);if(!a.success)return a;var i=o("WASmaxParseReference").attrStringFromReference(t,["to"]);if(!i.success)return i;var l=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"from",i.value);if(!l.success)return l;var s=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"type","result");return s.success?o("WAResultOrError").makeResult({type:s.value}):s}l.parseIQResultResponseMixin=e}),98);
__d("WASmaxInStatsSendBufferNoRetryError",["WAResultOrError","WASmaxInStatsIQErrorBadRequestMixin","WASmaxInStatsIQErrorFeatureNotImplementedMixin","WASmaxInStatsIQErrorNotAcceptableMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxInStatsIQErrorBadRequestMixin").parseIQErrorBadRequestMixin(e);if(t.success)return o("WAResultOrError").makeResult({name:"IQErrorBadRequest",value:t.value});var n=o("WASmaxInStatsIQErrorNotAcceptableMixin").parseIQErrorNotAcceptableMixin(e);if(n.success)return o("WAResultOrError").makeResult({name:"IQErrorNotAcceptable",value:n.value});var r=o("WASmaxInStatsIQErrorFeatureNotImplementedMixin").parseIQErrorFeatureNotImplementedMixin(e);return r.success?o("WAResultOrError").makeResult({name:"IQErrorFeatureNotImplemented",value:r.value}):o("WASmaxParseUtils").errorMixinDisjunction(e,["IQErrorBadRequest","IQErrorNotAcceptable","IQErrorFeatureNotImplemented"],[t,n,r])}l.parseSendBufferNoRetryError=e}),98);
__d("WASmaxInStatsSendBufferResponseErrorNoRetry",["WAResultOrError","WASmaxInStatsIQErrorResponseMixin","WASmaxInStatsSendBufferNoRetryError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxParseUtils").flattenedChildWithTag(e,"error");if(!r.success)return r;var a=o("WASmaxInStatsIQErrorResponseMixin").parseIQErrorResponseMixin(e,t);if(!a.success)return a;var i=o("WASmaxInStatsSendBufferNoRetryError").parseSendBufferNoRetryError(r.value);return i.success?o("WAResultOrError").makeResult(babelHelpers.extends({},a.value,{errorSendBufferNoRetryError:i.value})):i}l.parseSendBufferResponseErrorNoRetry=e}),98);
__d("WASmaxInStatsSendBufferResponseErrorRetry",["WAResultOrError","WASmaxInStatsIQErrorResponseMixin","WASmaxInStatsIQErrorServiceUnavailableMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxParseUtils").flattenedChildWithTag(e,"error");if(!r.success)return r;var a=o("WASmaxInStatsIQErrorServiceUnavailableMixin").parseIQErrorServiceUnavailableMixin(r.value);if(!a.success)return a;var i=o("WASmaxInStatsIQErrorResponseMixin").parseIQErrorResponseMixin(e,t);return i.success?o("WAResultOrError").makeResult(babelHelpers.extends({errorIQErrorServiceUnavailableMixin:a.value},i.value)):i}l.parseSendBufferResponseErrorRetry=e}),98);
__d("WASmaxInStatsSendBufferResponseSuccess",["WASmaxInStatsIQResultResponseMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxInStatsIQResultResponseMixin").parseIQResultResponseMixin(e,t);return r.success,r}l.parseSendBufferResponseSuccess=e}),98);
__d("WASmaxOutMdBaseIQSetRequestMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(t,n,r,o,a,i,l){function e(){var e=o("WASmaxJsx").smax("iq",{id:o("WAWap").generateId(),type:"set"});return e}function s(t){var n=e();return o("WASmaxMixins").mergeStanzas(t,n)}l.mergeBaseIQSetRequestMixin=s}),98);
__d("WASmaxOutMdCompanionFinishRequest",["WASmaxJsx","WASmaxOutMdBaseIQSetRequestMixin","WAWap"],(function(t,n,r,o,a,i,l){function e(e){var t,n=e.linkCodeCompanionRegJid,r=e.linkCodePairingWrappedKeyBundleElementValue,a=e.companionIdentityPublicElementValue,i=e.linkCodePairingRefElementValue,l=o("WASmaxOutMdBaseIQSetRequestMixin").mergeBaseIQSetRequestMixin((t=o("WASmaxJsx")).smax("iq",{xmlns:"md",to:o("WAWap").S_WHATSAPP_NET},t.smax("link_code_companion_reg",{jid:o("WAWap").USER_JID(n),stage:"companion_finish"},t.smax("link_code_pairing_wrapped_key_bundle",null,r),t.smax("companion_identity_public",null,a),t.smax("link_code_pairing_ref",null,i))));return l}l.makeCompanionFinishRequest=e}),98);
__d("WASmaxMdCompanionFinishRPC",["WAComms","WASmaxInMdCompanionFinishResponseError","WASmaxInMdCompanionFinishResponseSuccess","WASmaxOutMdCompanionFinishRequest","WASmaxParsingFailure","WASmaxRpcUtils","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){function e(e,t){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=o("WASmaxOutMdCompanionFinishRequest").makeCompanionFinishRequest(e),r=yield o("WAComms").sendSmaxStanza(n,t),a=o("WASmaxInMdCompanionFinishResponseSuccess").parseCompanionFinishResponseSuccess(r,n);if(a.success)return{name:"CompanionFinishResponseSuccess",value:a.value};var i=o("WASmaxInMdCompanionFinishResponseError").parseCompanionFinishResponseError(r,n);if(i.success)return{name:"CompanionFinishResponseError",value:i.value};throw new(o("WASmaxParsingFailure")).SmaxParsingFailure(o("WASmaxRpcUtils").errorMessageRpcParsing("CompanionFinish",{Success:a,Error:i}))}),s.apply(this,arguments)}l.sendCompanionFinishRPC=e}),98);
__d("WASmaxOutMdCompanionPlatformDisplayElMixin",["WASmaxJsx","WASmaxMixins"],(function(t,n,r,o,a,i,l){function e(e){var t=e.companionPlatformDisplayElementValue,n=o("WASmaxJsx").smax("companion_platform_display",null,t);return n}function s(t,n){var r=e(n);return o("WASmaxMixins").mergeStanzas(t,r)}l.mergeCompanionPlatformDisplayElMixin=s}),98);
__d("WASmaxOutMdCompanionPlatformIdElMixin",["WASmaxJsx","WASmaxMixins"],(function(t,n,r,o,a,i,l){function e(e){var t=e.companionPlatformIdElementValue,n=o("WASmaxJsx").smax("companion_platform_id",null,t);return n}function s(t,n){var r=e(n);return o("WASmaxMixins").mergeStanzas(t,r)}l.mergeCompanionPlatformIdElMixin=s}),98);
__d("WASmaxOutMdCompanionHelloRequest",["WASmaxAttrs","WASmaxChildren","WASmaxJsx","WASmaxOutMdBaseIQSetRequestMixin","WASmaxOutMdCompanionPlatformDisplayElMixin","WASmaxOutMdCompanionPlatformIdElMixin","WAWap"],(function(t,n,r,o,a,i,l){function e(e){var t=e.linkCodePairingNonceElementValue,n=o("WASmaxJsx").smax("link_code_pairing_nonce",null,t);return n}function s(t){var n,r=t.linkCodePairingNonceArgs,a=t.linkCodeCompanionRegJid,i=t.linkCodeCompanionRegShouldShowPushNotification,l=t.linkCodePairingWrappedCompanionEphemeralPubElementValue,s=t.companionServerAuthKeyPubElementValue,u=t.companionPlatformIdElMixinArgs,c=t.companionPlatformDisplayElMixinArgs,d=o("WASmaxOutMdBaseIQSetRequestMixin").mergeBaseIQSetRequestMixin((n=o("WASmaxJsx")).smax("iq",{xmlns:"md",to:o("WAWap").S_WHATSAPP_NET},n.smax("link_code_companion_reg",{jid:o("WAWap").USER_JID(a),stage:"companion_hello",should_show_push_notification:o("WASmaxAttrs").OPTIONAL(o("WAWap").CUSTOM_STRING,i)},n.smax("link_code_pairing_wrapped_companion_ephemeral_pub",null,l),n.smax("companion_server_auth_key_pub",null,s),o("WASmaxOutMdCompanionPlatformIdElMixin").mergeCompanionPlatformIdElMixin(n.smax("companion_platform_id",null),u),o("WASmaxOutMdCompanionPlatformDisplayElMixin").mergeCompanionPlatformDisplayElMixin(n.smax("companion_platform_display",null),c),o("WASmaxChildren").OPTIONAL_CHILD(e,r))));return d}l.makeCompanionHelloRequestLinkCodeCompanionRegLinkCodePairingNonce=e,l.makeCompanionHelloRequest=s}),98);
__d("WASmaxMdCompanionHelloRPC",["WAComms","WASmaxInMdCompanionHelloResponseError","WASmaxInMdCompanionHelloResponseNotifyCompanion","WASmaxOutMdCompanionHelloRequest","WASmaxParsingFailure","WASmaxRpcUtils","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){function e(e,t){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=o("WASmaxOutMdCompanionHelloRequest").makeCompanionHelloRequest(e),r=yield o("WAComms").sendSmaxStanza(n,t),a=o("WASmaxInMdCompanionHelloResponseNotifyCompanion").parseCompanionHelloResponseNotifyCompanion(r,n);if(a.success)return{name:"CompanionHelloResponseNotifyCompanion",value:a.value};var i=o("WASmaxInMdCompanionHelloResponseError").parseCompanionHelloResponseError(r,n);if(i.success)return{name:"CompanionHelloResponseError",value:i.value};throw new(o("WASmaxParsingFailure")).SmaxParsingFailure(o("WASmaxRpcUtils").errorMessageRpcParsing("CompanionHello",{NotifyCompanion:a,Error:i}))}),s.apply(this,arguments)}l.sendCompanionHelloRPC=e}),98);
__d("WASmaxOutMdRegularCompanionSetRegResponseBundleMixin",["WASmaxAttrs","WASmaxChildren","WASmaxJsx","WASmaxMixins","WAWap"],(function(t,n,r,o,a,i,l){function e(e){var t=e.keyAttestationKeyId,n=e.keyAttestationElementValue,r=o("WASmaxJsx").smax("key_attestation",{key_id:o("WASmaxAttrs").OPTIONAL(o("WAWap").CUSTOM_STRING,t)},n);return r}function s(e){var t=e.gpiaElementValue,n=o("WASmaxJsx").smax("gpia",null,t);return n}function u(t){var n=t.keyAttestationArgs,r=t.gpiaArgs,a=t.deviceIdentityKeyIndex,i=t.deviceIdentityElementValue,l=o("WASmaxJsx").smax("smax$any",null,o("WASmaxJsx").smax("pair-device-sign",null,o("WASmaxJsx").smax("device-identity",{"key-index":o("WAWap").INT(a)},i),o("WASmaxChildren").OPTIONAL_CHILD(e,n),o("WASmaxChildren").OPTIONAL_CHILD(s,r)));return l}function c(e,t){var n=u(t);return o("WASmaxMixins").mergeStanzas(e,n)}l.makeRegularCompanionSetRegResponseBundlePairDeviceSignKeyAttestation=e,l.makeRegularCompanionSetRegResponseBundlePairDeviceSignGpia=s,l.mergeRegularCompanionSetRegResponseBundleMixin=c}),98);
__d("WASmaxOutMdSetRegResponseClientResponse",["WASmaxJsx","WASmaxOutMdRegularCompanionSetRegResponseBundleMixin","WASmaxParseReference","WASmaxParseUtils","WASmaxParsingFailure","WAWap"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseReference").attrFromReference(o("WASmaxParseUtils").attrStanzaId,t,["id"]);if(!n.success)throw new(o("WASmaxParsingFailure")).SmaxParsingFailure(n.error);var r=o("WASmaxOutMdRegularCompanionSetRegResponseBundleMixin").mergeRegularCompanionSetRegResponseBundleMixin(o("WASmaxJsx").smax("iq",{id:o("WAWap").STANZA_ID(n.value),to:o("WAWap").S_WHATSAPP_NET,type:"result"}),e);return r}l.makeSetRegResponseClientResponse=e}),98);
__d("WASmaxOutMdIQErrorNotAuthorizedMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(t,n,r,o,a,i,l){function e(){var e=o("WASmaxJsx").smax("error",{text:"not-authorized",code:o("WAWap").INT(401)});return e}function s(t){var n=e();return o("WASmaxMixins").mergeStanzas(t,n)}l.mergeIQErrorNotAuthorizedMixin=s}),98);
__d("WASmaxOutMdSetRegResponseError",["WASmaxJsx","WASmaxOutMdIQErrorNotAuthorizedMixin","WASmaxParseReference","WASmaxParseUtils","WASmaxParsingFailure","WAWap"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseReference").attrFromReference(o("WASmaxParseUtils").attrStanzaId,e,["id"]);if(!t.success)throw new(o("WASmaxParsingFailure")).SmaxParsingFailure(t.error);var n=o("WASmaxJsx").smax("iq",{id:o("WAWap").STANZA_ID(t.value),to:o("WAWap").S_WHATSAPP_NET,type:"error"},o("WASmaxOutMdIQErrorNotAuthorizedMixin").mergeIQErrorNotAuthorizedMixin(o("WASmaxJsx").smax("error",null)));return n}l.makeSetRegResponseError=e}),98);
__d("WASmaxOutMdHostedCompanionSetRegResponseBundleMixin",["WASmaxJsx","WASmaxMixins"],(function(t,n,r,o,a,i,l){function e(e){var t=e.deviceIdentityElementValue,n=o("WASmaxJsx").smax("smax$any",null,o("WASmaxJsx").smax("hosted-pair-set",null,o("WASmaxJsx").smax("device-identity",null,t)));return n}function s(t,n){var r=e(n);return o("WASmaxMixins").mergeStanzas(t,r)}l.mergeHostedCompanionSetRegResponseBundleMixin=s}),98);
__d("WASmaxOutMdSetRegResponseHostedClientResponse",["WASmaxJsx","WASmaxOutMdHostedCompanionSetRegResponseBundleMixin","WASmaxParseReference","WASmaxParseUtils","WASmaxParsingFailure","WAWap"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseReference").attrFromReference(o("WASmaxParseUtils").attrStanzaId,t,["id"]);if(!n.success)throw new(o("WASmaxParsingFailure")).SmaxParsingFailure(n.error);var r=o("WASmaxOutMdHostedCompanionSetRegResponseBundleMixin").mergeHostedCompanionSetRegResponseBundleMixin(o("WASmaxJsx").smax("iq",{id:o("WAWap").STANZA_ID(n.value),to:o("WAWap").S_WHATSAPP_NET,type:"result"}),e);return r}l.makeSetRegResponseHostedClientResponse=e}),98);
__d("WASmaxMdSetRegRPC",["WASmaxInMdSetRegRequest","WASmaxOutMdSetRegResponseClientResponse","WASmaxOutMdSetRegResponseError","WASmaxOutMdSetRegResponseHostedClientResponse","WASmaxParsingFailure","WASmaxRpcUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxInMdSetRegRequest").parseSetRegRequest(e);if(!t.success)throw new(o("WASmaxParsingFailure")).SmaxParsingFailure(o("WASmaxRpcUtils").errorMessageRpcParsing("SetReg",{Request:t}));return{parsedRequest:t.value,makeSetRegResponseClientResponse:function(n){return o("WASmaxOutMdSetRegResponseClientResponse").makeSetRegResponseClientResponse(n,e)},makeSetRegResponseHostedClientResponse:function(n){return o("WASmaxOutMdSetRegResponseHostedClientResponse").makeSetRegResponseHostedClientResponse(n,e)},makeSetRegResponseError:function(){return o("WASmaxOutMdSetRegResponseError").makeSetRegResponseError(e)}}}l.receiveSetRegRPC=e}),98);
__d("WASmaxOutMdSetToCompanionResponseClientResponse",["WASmaxJsx","WASmaxParseJid","WASmaxParseReference","WASmaxParseUtils","WASmaxParsingFailure","WAWap"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseReference").attrFromReference(o("WASmaxParseUtils").attrStanzaId,e,["id"]);if(!t.success)throw new(o("WASmaxParsingFailure")).SmaxParsingFailure(t.error);var n=o("WASmaxParseReference").attrFromReference(o("WASmaxParseJid").attrDomainJid,e,["from"]);if(!n.success)throw new(o("WASmaxParsingFailure")).SmaxParsingFailure(n.error);var r=o("WASmaxJsx").smax("iq",{id:o("WAWap").STANZA_ID(t.value),to:o("WAWap").DOMAIN_JID(n.value),type:"result"});return r}l.makeSetToCompanionResponseClientResponse=e}),98);
__d("WASmaxMdSetToCompanionRPC",["WASmaxInMdSetToCompanionRequest","WASmaxOutMdSetToCompanionResponseClientResponse","WASmaxParsingFailure","WASmaxRpcUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxInMdSetToCompanionRequest").parseSetToCompanionRequest(e);if(!t.success)throw new(o("WASmaxParsingFailure")).SmaxParsingFailure(o("WASmaxRpcUtils").errorMessageRpcParsing("SetToCompanion",{Request:t}));return{parsedRequest:t.value,makeSetToCompanionResponseClientResponse:function(){return o("WASmaxOutMdSetToCompanionResponseClientResponse").makeSetToCompanionResponseClientResponse(e)}}}l.receiveSetToCompanionRPC=e}),98);
__d("WASmaxOutMessageDeliverCommonAckMixin",["WASmaxJsx","WASmaxMixins","WASmaxParseJid","WASmaxParseReference","WASmaxParseUtils","WASmaxParsingFailure","WAWap"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseReference").attrFromReference(o("WASmaxParseJid").attrNewsletterJid,e,["from"]);if(!t.success)throw new(o("WASmaxParsingFailure")).SmaxParsingFailure(t.error);var n=o("WASmaxParseReference").attrFromReference(o("WASmaxParseUtils").attrStanzaId,e,["id"]);if(!n.success)throw new(o("WASmaxParsingFailure")).SmaxParsingFailure(n.error);var r=o("WASmaxParseReference").attrFromReference(o("WASmaxParseUtils").attrString,e,["type"]);if(!r.success)throw new(o("WASmaxParsingFailure")).SmaxParsingFailure(r.error);var a=o("WASmaxJsx").smax("ack",{to:o("WAWap").JID(t.value),class:"message",id:o("WAWap").STANZA_ID(n.value),type:o("WAWap").CUSTOM_STRING(r.value)});return a}function s(t,n){var r=e(n);return o("WASmaxMixins").mergeStanzas(t,r)}l.mergeCommonAckMixin=s}),98);
__d("WASmaxOutMessageDeliverNewsletterResponseError",["WASmaxJsx","WASmaxOutMessageDeliverCommonAckMixin"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxOutMessageDeliverCommonAckMixin").mergeCommonAckMixin(o("WASmaxJsx").smax("ack",{error:"406"}),e);return t}l.makeNewsletterResponseError=e}),98);
__d("WASmaxOutMessageDeliverNewsletterResponseSuccess",["WASmaxJsx","WASmaxOutMessageDeliverCommonAckMixin"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxOutMessageDeliverCommonAckMixin").mergeCommonAckMixin(o("WASmaxJsx").smax("ack",null),e);return t}l.makeNewsletterResponseSuccess=e}),98);
__d("WASmaxMessageDeliverNewsletterRPC",["WASmaxInMessageDeliverNewsletterRequest","WASmaxOutMessageDeliverNewsletterResponseError","WASmaxOutMessageDeliverNewsletterResponseSuccess","WASmaxParsingFailure","WASmaxRpcUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxInMessageDeliverNewsletterRequest").parseNewsletterRequest(e);if(!t.success)throw new(o("WASmaxParsingFailure")).SmaxParsingFailure(o("WASmaxRpcUtils").errorMessageRpcParsing("Newsletter",{Request:t}));return{parsedRequest:t.value,makeNewsletterResponseError:function(){return o("WASmaxOutMessageDeliverNewsletterResponseError").makeNewsletterResponseError(e)},makeNewsletterResponseSuccess:function(){return o("WASmaxOutMessageDeliverNewsletterResponseSuccess").makeNewsletterResponseSuccess(e)}}}l.receiveNewsletterRPC=e}),98);
__d("WASmaxOutGroupsParentGroupMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(t,n,r,o,a,i,l){function e(e){var t=e.anyParentGroupJid,n=o("WASmaxJsx").smax("smax$any",{parent_group_jid:o("WAWap").GROUP_JID(t)});return n}function s(t,n){var r=e(n);return o("WASmaxMixins").mergeStanzas(t,r)}l.mergeParentGroupMixin=s}),98);
__d("WASmaxOutMessageFallbackDeliverResponseBadStanza",["WASmaxAttrs","WASmaxInMessageFallbackEnums","WASmaxJsx","WASmaxParseJid","WASmaxParseReference","WASmaxParseUtils","WASmaxParsingFailure","WAWap"],(function(t,n,r,o,a,i,l){function e(e,t){var n=e.ackError,r=o("WASmaxParseReference").attrFromReference(o("WASmaxParseUtils").attrStanzaId,t,["id"]);if(!r.success)throw new(o("WASmaxParsingFailure")).SmaxParsingFailure(r.error);var a=o("WASmaxParseReference").attrFromReference(o("WASmaxParseJid").attrJidEnum,t,["from"],o("WASmaxInMessageFallbackEnums").BROADCASTJID_CALLJID_DEVICEJID_DOMAINJID_GROUPJID_STATUSJID_USERJID);if(!a.success)throw new(o("WASmaxParsingFailure")).SmaxParsingFailure(a.error);var i=o("WASmaxParseReference").optionalAttrFromReference(o("WASmaxParseJid").attrJidEnum,t,["participant"],o("WASmaxInMessageFallbackEnums").BROADCASTJID_CALLJID_DEVICEJID_DOMAINJID_GROUPJID_STATUSJID_USERJID);if(!i.success)throw new(o("WASmaxParsingFailure")).SmaxParsingFailure(i.error);var l=o("WASmaxParseReference").optionalAttrFromReference(o("WASmaxParseUtils").attrString,t,["type"]);if(!l.success)throw new(o("WASmaxParsingFailure")).SmaxParsingFailure(l.error);var s=o("WASmaxJsx").smax("ack",{class:"message",id:o("WAWap").STANZA_ID(r.value),to:o("WAWap").JID(a.value),participant:o("WASmaxAttrs").OPTIONAL(o("WAWap").JID,i.value),type:o("WASmaxAttrs").OPTIONAL(o("WAWap").CUSTOM_STRING,l.value),error:o("WAWap").INT(n)});return s}l.makeDeliverResponseBadStanza=e}),98);
__d("WASmaxOutMessagePublishClickToWhatsAppAttributionMixin",["WASmaxJsx","WASmaxMixins"],(function(t,n,r,o,a,i,l){function e(e){var t=e.ctwaAttributionElementValue,n=o("WASmaxJsx").smax("ctwa_attribution",null,t);return n}function s(t,n){var r=e(n);return o("WASmaxMixins").mergeStanzas(t,r)}l.mergeClickToWhatsAppAttributionMixin=s}),98);
__d("WASmaxOutMessagePublishContentTypeMediaMixin",["WASmaxJsx","WASmaxMixins"],(function(t,n,r,o,a,i,l){function e(){var e=o("WASmaxJsx").smax("message",{type:"media"});return e}function s(t){var n=e();return o("WASmaxMixins").mergeStanzas(t,n)}l.mergeContentTypeMediaMixin=s}),98);
__d("WASmaxOutMessagePublishContentTypePollCreationMixin",["WASmaxAttrs","WASmaxJsx","WASmaxMixins","WAWap"],(function(t,n,r,o,a,i,l){function e(e){var t=e.metaContenttype,n=o("WASmaxJsx").smax("message",{type:"poll"},o("WASmaxJsx").smax("meta",{polltype:"creation",contenttype:o("WASmaxAttrs").OPTIONAL(o("WAWap").CUSTOM_STRING,t)}));return n}function s(t,n){var r=e(n);return o("WASmaxMixins").mergeStanzas(t,r)}l.mergeContentTypePollCreationMixin=s}),98);
__d("WASmaxOutMessagePublishContentTypePollResultSnapshotMixin",["WASmaxJsx","WASmaxMixins"],(function(t,n,r,o,a,i,l){function e(){var e=o("WASmaxJsx").smax("message",{type:"poll"},o("WASmaxJsx").smax("meta",{polltype:"result_snapshot"}));return e}function s(t){var n=e();return o("WASmaxMixins").mergeStanzas(t,n)}l.mergeContentTypePollResultSnapshotMixin=s}),98);
__d("WASmaxOutMessagePublishContentTypePollVoteMixin",["WASmaxAttrs","WASmaxJsx","WASmaxMixins","WAWap"],(function(t,n,r,o,a,i,l){function e(e){var t=e.metaContenttype,n=o("WASmaxJsx").smax("message",{type:"poll"},o("WASmaxJsx").smax("meta",{polltype:"vote",contenttype:o("WASmaxAttrs").OPTIONAL(o("WAWap").CUSTOM_STRING,t)}));return n}function s(t,n){var r=e(n);return o("WASmaxMixins").mergeStanzas(t,r)}l.mergeContentTypePollVoteMixin=s}),98);
__d("WASmaxOutMessagePublishContentTypeReactionMixin",["WASmaxJsx","WASmaxMixins"],(function(t,n,r,o,a,i,l){function e(){var e=o("WASmaxJsx").smax("message",{type:"reaction"});return e}function s(t){var n=e();return o("WASmaxMixins").mergeStanzas(t,n)}l.mergeContentTypeReactionMixin=s}),98);
__d("WASmaxOutMessagePublishContentTypeTextMixin",["WASmaxJsx","WASmaxMixins"],(function(t,n,r,o,a,i,l){function e(){var e=o("WASmaxJsx").smax("message",{type:"text"});return e}function s(t){var n=e();return o("WASmaxMixins").mergeStanzas(t,n)}l.mergeContentTypeTextMixin=s}),98);
__d("WASmaxOutMessagePublishCtwaAttributionMixin",["WASmaxChildren","WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishClickToWhatsAppAttributionMixin"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxOutMessagePublishClickToWhatsAppAttributionMixin").mergeClickToWhatsAppAttributionMixin(o("WASmaxJsx").smax("ctwa_attribution",null),e);return t}function s(t){var n=t.ctwaAttributionArgs,r=o("WASmaxJsx").smax("message",null,o("WASmaxChildren").OPTIONAL_CHILD(e,n));return r}function u(e,t){var n=s(t);return o("WASmaxMixins").mergeStanzas(e,n)}l.makeCtwaAttributionCtwaAttribution=e,l.mergeCtwaAttributionMixin=u}),98);
__d("WASmaxOutMessagePublishMessageAssociationTypeMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(t,n,r,o,a,i,l){function e(e){var t=e.metaMessageAssociationType,n=o("WASmaxJsx").smax("message",null,o("WASmaxJsx").smax("meta",{message_association_type:o("WAWap").CUSTOM_STRING(t)}));return n}function s(t,n){var r=e(n);return o("WASmaxMixins").mergeStanzas(t,r)}l.mergeMessageAssociationTypeMixin=s}),98);
__d("WASmaxOutMessagePublishMsgMetaOriginMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(t,n,r,o,a,i,l){function e(e){var t=e.metaOrigin,n=o("WASmaxJsx").smax("message",null,o("WASmaxJsx").smax("meta",{origin:o("WAWap").CUSTOM_STRING(t)}));return n}function s(t,n){var r=e(n);return o("WASmaxMixins").mergeStanzas(t,r)}l.mergeMsgMetaOriginMixin=s}),98);
__d("WASmaxOutMessagePublishRevokeMixin",["WASmaxJsx","WASmaxMixins"],(function(t,n,r,o,a,i,l){function e(){var e=o("WASmaxJsx").smax("message",{edit:"7"});return e}function s(t){var n=e();return o("WASmaxMixins").mergeStanzas(t,n)}l.mergeRevokeMixin=s}),98);
__d("WASmaxOutPreKeysClientRequestMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(t,n,r,o,a,i,l){function e(){var e=o("WASmaxJsx").smax("iq",{id:o("WAWap").generateId(),xmlns:"encrypt",to:o("WAWap").S_WHATSAPP_NET});return e}function s(t){var n=e();return o("WASmaxMixins").mergeStanzas(t,n)}l.mergeClientRequestMixin=s}),98);
__d("WASmaxOutPreKeysFetchKeyBundlesRequest",["WASmaxAttrs","WASmaxChildren","WASmaxJsx","WASmaxOutPreKeysClientRequestMixin","WAWap"],(function(t,n,r,o,a,i,l){function e(e){var t=e.userJid,n=e.hasUserReasonIdentity,r=o("WASmaxJsx").smax("user",{jid:o("WAWap").JID(t),reason:o("WASmaxAttrs").OPTIONAL_LITERAL("identity",n)});return r}function s(t){var n=t.userArgs,r=o("WASmaxOutPreKeysClientRequestMixin").mergeClientRequestMixin(o("WASmaxJsx").smax("iq",{type:"get"},o("WASmaxJsx").smax("key",null,o("WASmaxChildren").REPEATED_CHILD(e,n,1,1e5))));return r}l.makeFetchKeyBundlesRequestKeyUser=e,l.makeFetchKeyBundlesRequest=s}),98);
__d("WASmaxOutPreKeysRegistrationIDMixin",["WASmaxJsx","WASmaxMixins"],(function(t,n,r,o,a,i,l){function e(e){var t=e.registrationElementValue,n=o("WASmaxJsx").smax("smax$any",null,o("WASmaxJsx").smax("registration",null,t));return n}function s(t,n){var r=e(n);return o("WASmaxMixins").mergeStanzas(t,r)}l.mergeRegistrationIDMixin=s}),98);
__d("WASmaxOutProfilePictureAddRequestMixin",["WASmaxAttrs","WASmaxJsx","WASmaxMixins","WAWap"],(function(t,n,r,o,a,i,l){function e(e){var t=e.addRequestCode,n=e.addRequestAdmin,r=e.addRequestExpiration,a=o("WASmaxJsx").smax("picture",null,o("WASmaxJsx").smax("add_request",{code:o("WAWap").CUSTOM_STRING(t),admin:o("WASmaxAttrs").OPTIONAL(o("WAWap").USER_JID,n),expiration:o("WAWap").INT(r)}));return a}function s(t,n){var r=e(n);return o("WASmaxMixins").mergeStanzas(t,r)}l.mergeAddRequestMixin=s}),98);
__d("WASmaxOutProfilePictureAvatarMixin",["WASmaxChildren","WASmaxJsx","WASmaxMixins","WAWap"],(function(t,n,r,o,a,i,l){function e(e){var t=e.avatarPoseId,n=o("WASmaxJsx").smax("avatar",{pose_id:o("WAWap").CUSTOM_STRING(t)});return n}function s(t){var n=t.avatarArgs,r=o("WASmaxJsx").smax("picture",{type:"avatar"},o("WASmaxChildren").REPEATED_CHILD(e,n,0,4));return r}function u(e,t){var n=s(t);return o("WASmaxMixins").mergeStanzas(e,n)}l.makeAvatarAvatar=e,l.mergeAvatarMixin=u}),98);
__d("WASmaxOutProfilePictureBaseIQGetRequestMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(t,n,r,o,a,i,l){function e(){var e=o("WASmaxJsx").smax("iq",{id:o("WAWap").generateId(),type:"get"});return e}function s(t){var n=e();return o("WASmaxMixins").mergeStanzas(t,n)}l.mergeBaseIQGetRequestMixin=s}),98);
__d("WASmaxOutProfilePictureBaseGetIQMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutProfilePictureBaseIQGetRequestMixin"],(function(t,n,r,o,a,i,l){function e(){var e=o("WASmaxOutProfilePictureBaseIQGetRequestMixin").mergeBaseIQGetRequestMixin(o("WASmaxJsx").smax("iq",{xmlns:"w:profile:picture"}));return e}function s(t){var n=e();return o("WASmaxMixins").mergeStanzas(t,n)}l.mergeBaseGetIQMixin=s}),98);
__d("WASmaxOutProfilePictureServerDomainIQMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(t,n,r,o,a,i,l){function e(){var e=o("WASmaxJsx").smax("iq",{to:o("WAWap").S_WHATSAPP_NET});return e}function s(t){var n=e();return o("WASmaxMixins").mergeStanzas(t,n)}l.mergeServerDomainIQMixin=s}),98);
__d("WASmaxOutProfilePictureGetIQMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutProfilePictureServerDomainIQMixin","WAWap"],(function(t,n,r,o,a,i,l){function e(e){var t=e.iqTarget,n=o("WASmaxOutProfilePictureServerDomainIQMixin").mergeServerDomainIQMixin(o("WASmaxJsx").smax("iq",{target:o("WAWap").JID(t)}));return n}function s(t,n){var r=e(n);return o("WASmaxMixins").mergeStanzas(t,r)}l.mergeGetIQMixin=s}),98);
__d("WASmaxOutProfilePicturePrivacyTokenContentsMixin",["WASmaxJsx","WASmaxMixins"],(function(t,n,r,o,a,i,l){function e(e){var t=e.anyElementValue,n=o("WASmaxJsx").smax("smax$any",null,t);return n}function s(t,n){var r=e(n);return o("WASmaxMixins").mergeStanzas(t,r)}l.mergePrivacyTokenContentsMixin=s}),98);
__d("WASmaxOutProfilePictureTCTokenMixin",["WASmaxAttrs","WASmaxJsx","WASmaxMixins","WASmaxOutProfilePicturePrivacyTokenContentsMixin","WAWap"],(function(t,n,r,o,a,i,l){function e(e){var t=e.tctokenT,n=e.privacyTokenContentsMixinArgs,r=o("WASmaxJsx").smax("smax$any",null,o("WASmaxOutProfilePicturePrivacyTokenContentsMixin").mergePrivacyTokenContentsMixin(o("WASmaxJsx").smax("tctoken",{t:o("WASmaxAttrs").OPTIONAL(o("WAWap").INT,t)}),n));return r}function s(t,n){var r=e(n);return o("WASmaxMixins").mergeStanzas(t,r)}l.mergeTCTokenMixin=s}),98);
__d("WASmaxOutProfilePictureGetRequest",["WASmaxAttrs","WASmaxJsx","WASmaxMixins","WASmaxOutProfilePictureAddRequestMixin","WASmaxOutProfilePictureAvatarMixin","WASmaxOutProfilePictureBaseGetIQMixin","WASmaxOutProfilePictureGetIQMixin","WASmaxOutProfilePictureTCTokenMixin","WAWap"],(function(t,n,r,o,a,i,l){function e(e){var t,n,r=e.pictureType,a=e.pictureId,i=e.pictureQuery,l=e.pictureInvite,s=e.picturePersonaId,u=e.pictureCommonGid,c=e.addRequestMixinArgs,d=e.tCTokenMixinArgs,m=e.avatarMixinArgs,p=o("WASmaxOutProfilePictureGetIQMixin").mergeGetIQMixin(o("WASmaxOutProfilePictureBaseGetIQMixin").mergeBaseGetIQMixin(o("WASmaxJsx").smax("iq",null,o("WASmaxMixins").optionalMerge(o("WASmaxOutProfilePictureAvatarMixin").mergeAvatarMixin,o("WASmaxMixins").optionalMerge(o("WASmaxOutProfilePictureTCTokenMixin").mergeTCTokenMixin,o("WASmaxMixins").optionalMerge(o("WASmaxOutProfilePictureAddRequestMixin").mergeAddRequestMixin,o("WASmaxJsx").smax("picture",{type:(t=o("WASmaxAttrs")).OPTIONAL((n=o("WAWap")).CUSTOM_STRING,r),id:t.OPTIONAL(n.CUSTOM_STRING,a),query:t.OPTIONAL(n.CUSTOM_STRING,i),invite:t.OPTIONAL(n.CUSTOM_STRING,l),persona_id:t.OPTIONAL(n.CUSTOM_STRING,s),common_gid:t.OPTIONAL(n.GROUP_JID,u)}),c),d),m))),e);return p}l.makeGetRequest=e}),98);
__d("WASmaxOutSpamAdminRevokeMixin",["WASmaxJsx","WASmaxMixins"],(function(t,n,r,o,a,i,l){function e(){var e=o("WASmaxJsx").smax("message",{edit:"8"});return e}function s(t){var n=e();return o("WASmaxMixins").mergeStanzas(t,n)}l.mergeAdminRevokeMixin=s}),98);
__d("WASmaxOutSpamAutomatedMixin",["WASmaxJsx","WASmaxMixins"],(function(t,n,r,o,a,i,l){function e(){var e=o("WASmaxJsx").smax("message",null,o("WASmaxJsx").smax("automated",null));return e}function s(t){var n=e();return o("WASmaxMixins").mergeStanzas(t,n)}l.mergeAutomatedMixin=s}),98);
__d("WASmaxOutSpamBaseIQSetRequestMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(t,n,r,o,a,i,l){function e(){var e=o("WASmaxJsx").smax("iq",{id:o("WAWap").generateId(),type:"set"});return e}function s(t){var n=e();return o("WASmaxMixins").mergeStanzas(t,n)}l.mergeBaseIQSetRequestMixin=s}),98);
__d("WASmaxOutSpamBaseReportMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(t,n,r,o,a,i,l){function e(e){var t=e.spamListSpamFlow,n=o("WASmaxJsx").smax("iq",{to:o("WAWap").S_WHATSAPP_NET,xmlns:"spam"},o("WASmaxJsx").smax("spam_list",{spam_flow:o("WAWap").CUSTOM_STRING(t)}));return n}function s(t,n){var r=e(n);return o("WASmaxMixins").mergeStanzas(t,r)}l.mergeBaseReportMixin=s}),98);
__d("WASmaxOutSpamBizOptOutMixin",["WASmaxAttrs","WASmaxChildren","WASmaxJsx","WASmaxMixins","WAWap"],(function(t,n,r,o,a,i,l){function e(e){var t,n,r=e.bizOptOutReason,a=e.bizOptOutBusinessDiscoveryEntryPoint,i=e.bizOptOutBusinessDiscoveryTimestamp,l=e.bizOptOutFirstMessage,s=e.bizOptOutBusinessDiscoveryId,u=o("WASmaxJsx").smax("biz_opt_out",{reason:(t=o("WASmaxAttrs")).OPTIONAL((n=o("WAWap")).CUSTOM_STRING,r),business_discovery_entry_point:t.OPTIONAL(n.CUSTOM_STRING,a),business_discovery_timestamp:t.OPTIONAL(n.INT,i),first_message:t.OPTIONAL(n.CUSTOM_STRING,l),business_discovery_id:t.OPTIONAL(n.CUSTOM_STRING,s)});return u}function s(t){var n=t.bizOptOutArgs,r=o("WASmaxJsx").smax("spam_list",null,o("WASmaxChildren").OPTIONAL_CHILD(e,n));return r}function u(e,t){var n=s(t);return o("WASmaxMixins").mergeStanzas(e,n)}l.makeBizOptOutBizOptOut=e,l.mergeBizOptOutMixin=u}),98);
__d("WASmaxOutSpamBizReportMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(t,n,r,o,a,i,l){function e(e){var t=e.bizApiReportKnownAccount,n=e.bizApiReportMessageReport,r=o("WASmaxJsx").smax("spam_list",null,o("WASmaxJsx").smax("biz_api_report",{known_account:o("WAWap").CUSTOM_STRING(t),message_report:o("WAWap").CUSTOM_STRING(n)}));return r}function s(t,n){var r=e(n);return o("WASmaxMixins").mergeStanzas(t,r)}l.mergeBizReportMixin=s}),98);
__d("WASmaxOutSpamCallReportMixin",["WASmaxAttrs","WASmaxJsx","WASmaxMixins","WAWap"],(function(t,n,r,o,a,i,l){function e(e){var t,n,r=e.callTo,a=e.callFrom,i=e.callId,l=e.callInfoDuration,s=e.callInfoTerminateReason,u=e.callInfoReason,c=e.callInfoTerminator,d=e.callInfoStartTime,m=e.callInfoAdder,p=e.callInfoCreator,_=e.callInfoMediatype,f=o("WASmaxJsx").smax("call",{to:(t=o("WAWap")).JID(r),from:t.USER_JID(a),id:t.STANZA_ID(i)},o("WASmaxJsx").smax("call_info",{duration:t.INT(l),terminate_reason:(n=o("WASmaxAttrs")).OPTIONAL(t.CUSTOM_STRING,s),reason:n.OPTIONAL(t.CUSTOM_STRING,u),terminator:n.OPTIONAL(t.USER_JID,c),start_time:n.OPTIONAL(t.INT,d),adder:n.OPTIONAL(t.USER_JID,m),creator:n.OPTIONAL(t.USER_JID,p),mediatype:n.OPTIONAL(t.CUSTOM_STRING,_)}));return f}function s(t,n){var r=e(n);return o("WASmaxMixins").mergeStanzas(t,r)}l.mergeCallReportMixin=s}),98);
__d("WASmaxOutSpamClientFrankingTagMixin",["WASmaxJsx","WASmaxMixins"],(function(t,n,r,o,a,i,l){function e(e){var t=e.frankingTagElementValue,n=o("WASmaxJsx").smax("smax$any",null,o("WASmaxJsx").smax("franking",null,o("WASmaxJsx").smax("franking_tag",null,t)));return n}function s(t,n){var r=e(n);return o("WASmaxMixins").mergeStanzas(t,r)}l.mergeClientFrankingTagMixin=s}),98);
__d("WASmaxOutSpamClientReportingContentValidationMixin",["WASmaxAttrs","WASmaxChildren","WASmaxJsx","WASmaxMixins","WAWap"],(function(t,n,r,o,a,i,l){function e(e){var t=e.reportingContentArgs,n=e.contentValidationArgs,r=e.reportingAdditionalInfoArgs,a=e.reportingTagId,i=e.reportingTagTsS,l=e.reportingTagElementValue,d=o("WASmaxJsx").smax("reporting_validation",null,o("WASmaxJsx").smax("reporting_tag",{id:o("WAWap").STANZA_ID(a),ts_s:o("WAWap").INT(i)},l),o("WASmaxChildren").OPTIONAL_CHILD(s,t),o("WASmaxChildren").OPTIONAL_CHILD(u,n),o("WASmaxChildren").OPTIONAL_CHILD(c,r));return d}function s(e){var t=e.reportingContentElementValue,n=o("WASmaxJsx").smax("reporting_content",null,t);return n}function u(e){var t=e.contentValidationType,n=e.reportingTokenV,r=e.reportingTokenElementValue,a=e.reportingTokenKeyElementValue,i=o("WASmaxJsx").smax("content_validation",{type:o("WASmaxAttrs").OPTIONAL(o("WAWap").CUSTOM_STRING,t)},o("WASmaxJsx").smax("reporting_token",{v:o("WAWap").INT(n)},r),o("WASmaxJsx").smax("reporting_token_key",null,a));return i}function c(e){var t=e.reportingAdditionalInfoText,n=o("WASmaxJsx").smax("reporting_additional_info",{text:o("WAWap").CUSTOM_STRING(t)});return n}function d(t){var n=t.reportingValidationArgs,r=o("WASmaxJsx").smax("smax$any",null,o("WASmaxJsx").smax("reporting",null,o("WASmaxChildren").REPEATED_CHILD(e,n,0,1e3)));return r}function m(e,t){var n=d(t);return o("WASmaxMixins").mergeStanzas(e,n)}l.makeClientReportingContentValidationReportingReportingValidation=e,l.makeClientReportingContentValidationReportingReportingValidationReportingContent=s,l.makeClientReportingContentValidationReportingReportingValidationContentValidation=u,l.makeClientReportingContentValidationReportingReportingValidationReportingAdditionalInfo=c,l.mergeClientReportingContentValidationMixin=m}),98);
__d("WASmaxOutSpamContentTypeMediaMixin",["WASmaxJsx","WASmaxMixins"],(function(t,n,r,o,a,i,l){function e(){var e=o("WASmaxJsx").smax("message",{type:"media"});return e}function s(t){var n=e();return o("WASmaxMixins").mergeStanzas(t,n)}l.mergeContentTypeMediaMixin=s}),98);
__d("WASmaxOutSpamContentTypePayMixin",["WASmaxJsx","WASmaxMixins"],(function(t,n,r,o,a,i,l){function e(){var e=o("WASmaxJsx").smax("message",{type:"pay"});return e}function s(t){var n=e();return o("WASmaxMixins").mergeStanzas(t,n)}l.mergeContentTypePayMixin=s}),98);
__d("WASmaxOutSpamContentTypePollCreationMixin",["WASmaxAttrs","WASmaxJsx","WASmaxMixins","WAWap"],(function(t,n,r,o,a,i,l){function e(e){var t=e.metaContenttype,n=o("WASmaxJsx").smax("message",{type:"poll"},o("WASmaxJsx").smax("meta",{polltype:"creation",contenttype:o("WASmaxAttrs").OPTIONAL(o("WAWap").CUSTOM_STRING,t)}));return n}function s(t,n){var r=e(n);return o("WASmaxMixins").mergeStanzas(t,r)}l.mergeContentTypePollCreationMixin=s}),98);
__d("WASmaxOutSpamContentTypeTextMixin",["WASmaxJsx","WASmaxMixins"],(function(t,n,r,o,a,i,l){function e(){var e=o("WASmaxJsx").smax("message",{type:"text"});return e}function s(t){var n=e();return o("WASmaxMixins").mergeStanzas(t,n)}l.mergeContentTypeTextMixin=s}),98);
__d("WASmaxOutSpamContentTypeTextOrMediaMixinGroup",["WASmaxMixinGroupExhaustiveError","WASmaxOutSpamContentTypeMediaMixin","WASmaxOutSpamContentTypeTextMixin"],(function(t,n,r,o,a,i,l){function e(e,t){if(t.isContentTypeText)return o("WASmaxOutSpamContentTypeTextMixin").mergeContentTypeTextMixin(e);if(t.isContentTypeMedia)return o("WASmaxOutSpamContentTypeMediaMixin").mergeContentTypeMediaMixin(e);throw new(o("WASmaxMixinGroupExhaustiveError")).SmaxMixinGroupExhaustiveError}l.mergeContentTypeTextOrMediaMixinGroup=e}),98);
__d("WASmaxOutSpamExtensionScreenMixin",["WASmaxAttrs","WASmaxJsx","WASmaxMixins","WAWap"],(function(t,n,r,o,a,i,l){function e(e){var t,n=e.extensionScreenExtensionId,r=e.extensionScreenSessionId,a=e.extensionScreenT,i=e.extensionScreenName,l=e.extensionScreenEntryPoint,s=e.dataElementValue,u=o("WASmaxJsx").smax("extension_screen",{extension_id:(t=o("WAWap")).CUSTOM_STRING(n),session_id:t.CUSTOM_STRING(r),t:t.INT(a),name:t.CUSTOM_STRING(i),entry_point:o("WASmaxAttrs").OPTIONAL(t.CUSTOM_STRING,l)},o("WASmaxJsx").smax("data",null,s));return u}function s(t,n){var r=e(n);return o("WASmaxMixins").mergeStanzas(t,r)}l.mergeExtensionScreenMixin=s}),98);
__d("WASmaxOutSpamExtensionScreenDataMixin",["WASmaxChildren","WASmaxJsx","WASmaxMixins","WASmaxOutSpamExtensionScreenMixin"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxOutSpamExtensionScreenMixin").mergeExtensionScreenMixin(o("WASmaxJsx").smax("extension_screen",null),e);return t}function s(t){var n=t.extensionScreenArgs,r=o("WASmaxJsx").smax("message",null,o("WASmaxChildren").REPEATED_CHILD(e,n,1,100));return r}function u(e,t){var n=s(t);return o("WASmaxMixins").mergeStanzas(e,n)}l.makeExtensionScreenDataExtensionScreen=e,l.mergeExtensionScreenDataMixin=u}),98);
__d("WASmaxOutSpamFRXMixin",["WASmaxChildren","WASmaxJsx","WASmaxMixins","WAWap"],(function(t,n,r,o,a,i,l){function e(e){var t=e.tagValue,n=o("WASmaxJsx").smax("tag",{value:o("WAWap").CUSTOM_STRING(t)});return n}function s(e){var t=e.parametersElementValue,n=o("WASmaxJsx").smax("parameters",null,t);return n}function u(t){var n,r=t.tagArgs,a=t.parametersArgs,i=t.spamListReportee,l=t.contextElementValue,u=(n=o("WASmaxJsx")).smax("iq",null,n.smax("spam_list",{reportee:o("WAWap").USER_JID(i)}),n.smax("frx",null,n.smax("tagset",null,o("WASmaxChildren").REPEATED_CHILD(e,r,0,20)),n.smax("context",null,l),o("WASmaxChildren").OPTIONAL_CHILD(s,a)));return u}function c(e,t){var n=u(t);return o("WASmaxMixins").mergeStanzas(e,n)}l.makeFRXFrxTagsetTag=e,l.makeFRXFrxParameters=s,l.mergeFRXMixin=c}),98);
__d("WASmaxOutSpamIABReportLinkMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(t,n,r,o,a,i,l){function e(e){var t=e.iabReportedLink,n=o("WASmaxJsx").smax("message",null,o("WASmaxJsx").smax("iab",{reported_link:o("WAWap").CUSTOM_STRING(t)}));return n}function s(t,n){var r=e(n);return o("WASmaxMixins").mergeStanzas(t,r)}l.mergeIABReportLinkMixin=s}),98);
__d("WASmaxOutSpamMessageEditMixin",["WASmaxJsx","WASmaxMixins"],(function(t,n,r,o,a,i,l){function e(){var e=o("WASmaxJsx").smax("message",{edit:"1"});return e}function s(t){var n=e();return o("WASmaxMixins").mergeStanzas(t,n)}l.mergeMessageEditMixin=s}),98);
__d("WASmaxOutSpamRawV3Mixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(t,n,r,o,a,i,l){function e(e){var t=e.rawProtocolV,n=o("WASmaxJsx").smax("raw",{v:o("WAWap").INT(3),protocol_v:o("WAWap").INT(t)});return n}function s(t,n){var r=e(n);return o("WASmaxMixins").mergeStanzas(t,r)}l.mergeRawV3Mixin=s}),98);
__d("WASmaxOutSpamServerFrankingTagMixin",["WASmaxJsx","WASmaxMixins"],(function(t,n,r,o,a,i,l){function e(e){var t=e.reportingTagElementValue,n=o("WASmaxJsx").smax("smax$any",null,o("WASmaxJsx").smax("franking",null,o("WASmaxJsx").smax("reporting_tag",null,t)));return n}function s(t,n){var r=e(n);return o("WASmaxMixins").mergeStanzas(t,r)}l.mergeServerFrankingTagMixin=s}),98);
__d("WASmaxOutSpamMessageFrankingMixin",["WASmaxChildren","WASmaxJsx","WASmaxMixins","WASmaxOutSpamClientFrankingTagMixin","WASmaxOutSpamRawV3Mixin","WASmaxOutSpamServerFrankingTagMixin"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxOutSpamRawV3Mixin").mergeRawV3Mixin(o("WASmaxJsx").smax("raw",null),e);return t}function s(t){var n=t.rawArgs,r=t.clientFrankingTagMixinArgs,a=o("WASmaxOutSpamServerFrankingTagMixin").mergeServerFrankingTagMixin(o("WASmaxMixins").optionalMerge(o("WASmaxOutSpamClientFrankingTagMixin").mergeClientFrankingTagMixin,o("WASmaxJsx").smax("message",null,o("WASmaxChildren").OPTIONAL_CHILD(e,n)),r),t);return a}function u(e,t){var n=s(t);return o("WASmaxMixins").mergeStanzas(e,n)}l.makeMessageFrankingRaw=e,l.mergeMessageFrankingMixin=u}),98);
__d("WASmaxOutSpamMessageParticipantMixin",["WASmaxAttrs","WASmaxJsx","WASmaxMixins","WAWap"],(function(t,n,r,o,a,i,l){function e(e){var t=e.messageParticipant,n=e.messageParticipantType,r=o("WASmaxJsx").smax("message",{participant:o("WAWap").USER_JID(t),participant_type:o("WASmaxAttrs").OPTIONAL(o("WAWap").CUSTOM_STRING,n)});return r}function s(t,n){var r=e(n);return o("WASmaxMixins").mergeStanzas(t,r)}l.mergeMessageParticipantMixin=s}),98);
__d("WASmaxOutSpamReportPayNodeMixin",["WASmaxAttrs","WASmaxJsx","WASmaxMixins","WAWap"],(function(t,n,r,o,a,i,l){function e(e){var t,n=e.payType,r=e.payId,a=e.paySender,i=e.payReceiver,l=o("WASmaxJsx").smax("pay",{type:(t=o("WAWap")).CUSTOM_STRING(n),id:o("WASmaxAttrs").OPTIONAL(t.CUSTOM_STRING,r),sender:o("WASmaxAttrs").OPTIONAL(t.USER_JID,a),receiver:o("WASmaxAttrs").OPTIONAL(t.USER_JID,i)});return l}function s(t,n){var r=e(n);return o("WASmaxMixins").mergeStanzas(t,r)}l.mergeReportPayNodeMixin=s}),98);
__d("WASmaxOutSpamMessageWithPaymentReportMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutSpamContentTypePayMixin","WASmaxOutSpamReportPayNodeMixin"],(function(t,n,r,o,a,i,l){function e(e){var t=e.reportPayNodeMixinArgs,n=o("WASmaxOutSpamContentTypePayMixin").mergeContentTypePayMixin(o("WASmaxJsx").smax("message",null,o("WASmaxOutSpamReportPayNodeMixin").mergeReportPayNodeMixin(o("WASmaxJsx").smax("pay",null),t)));return n}function s(t,n){var r=e(n);return o("WASmaxMixins").mergeStanzas(t,r)}l.mergeMessageWithPaymentReportMixin=s}),98);
__d("WASmaxOutSpamMessageWithPollMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutSpamContentTypePollCreationMixin"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxOutSpamContentTypePollCreationMixin").mergeContentTypePollCreationMixin(o("WASmaxJsx").smax("message",null),e);return t}function s(t,n){var r=e(n);return o("WASmaxMixins").mergeStanzas(t,r)}l.mergeMessageWithPollMixin=s}),98);
__d("WASmaxOutSpamMessageWithTypeMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutSpamContentTypeTextOrMediaMixinGroup"],(function(t,n,r,o,a,i,l){function e(e){var t=e.contentTypeTextOrMediaMixinGroupArgs,n=o("WASmaxOutSpamContentTypeTextOrMediaMixinGroup").mergeContentTypeTextOrMediaMixinGroup(o("WASmaxJsx").smax("message",null),t);return n}function s(t,n){var r=e(n);return o("WASmaxMixins").mergeStanzas(t,r)}l.mergeMessageWithTypeMixin=s}),98);
__d("WASmaxOutSpamMessagePayloadTypes",["WASmaxMixinGroupExhaustiveError","WASmaxOutSpamMessageWithPaymentReportMixin","WASmaxOutSpamMessageWithPollMixin","WASmaxOutSpamMessageWithTypeMixin"],(function(t,n,r,o,a,i,l){function e(e,t){if(t.messageWithPaymentReport)return o("WASmaxOutSpamMessageWithPaymentReportMixin").mergeMessageWithPaymentReportMixin(e,t.messageWithPaymentReport);if(t.messageWithType)return o("WASmaxOutSpamMessageWithTypeMixin").mergeMessageWithTypeMixin(e,t.messageWithType);if(t.messageWithPoll)return o("WASmaxOutSpamMessageWithPollMixin").mergeMessageWithPollMixin(e,t.messageWithPoll);throw new(o("WASmaxMixinGroupExhaustiveError")).SmaxMixinGroupExhaustiveError}l.mergeMessagePayloadTypes=e}),98);
__d("WASmaxOutSpamMessagePlaceholderMixin",["WASmaxJsx","WASmaxMixins"],(function(t,n,r,o,a,i,l){function e(){var e=o("WASmaxJsx").smax("message",null,o("WASmaxJsx").smax("meta",{placeholder_type:"call"}));return e}function s(t){var n=e();return o("WASmaxMixins").mergeStanzas(t,n)}l.mergeMessagePlaceholderMixin=s}),98);
__d("WASmaxOutSpamMessageWithHsmTemplateMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(t,n,r,o,a,i,l){function e(e){var t=e.hsmTid,n=o("WASmaxJsx").smax("message",null,o("WASmaxJsx").smax("hsm",{tid:o("WAWap").CUSTOM_STRING(t)}));return n}function s(t,n){var r=e(n);return o("WASmaxMixins").mergeStanzas(t,r)}l.mergeMessageWithHsmTemplateMixin=s}),98);
__d("WASmaxOutSpamMessageWithNewsletterQuestionResponseMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(t,n,r,o,a,i,l){function e(e){var t=e.messageServerId,n=e.messageResponseServerId,r=o("WASmaxJsx").smax("message",{server_id:o("WAWap").INT(t),response_server_id:o("WAWap").CUSTOM_STRING(n)});return r}function s(t,n){var r=e(n);return o("WASmaxMixins").mergeStanzas(t,r)}l.mergeMessageWithNewsletterQuestionResponseMixin=s}),98);
__d("WASmaxOutSpamMulticastMixin",["WASmaxJsx","WASmaxMixins"],(function(t,n,r,o,a,i,l){function e(){var e=o("WASmaxJsx").smax("message",null,o("WASmaxJsx").smax("multicast",null));return e}function s(t){var n=e();return o("WASmaxMixins").mergeStanzas(t,n)}l.mergeMulticastMixin=s}),98);
__d("WASmaxOutSpamPreFilledNumberMixin",["WASmaxJsx","WASmaxMixins"],(function(t,n,r,o,a,i,l){function e(){var e=o("WASmaxJsx").smax("message",null,o("WASmaxJsx").smax("url_number",null));return e}function s(t){var n=e();return o("WASmaxMixins").mergeStanzas(t,n)}l.mergePreFilledNumberMixin=s}),98);
__d("WASmaxOutSpamPreFilledTextMixin",["WASmaxJsx","WASmaxMixins"],(function(t,n,r,o,a,i,l){function e(){var e=o("WASmaxJsx").smax("message",null,o("WASmaxJsx").smax("url_text",null));return e}function s(t){var n=e();return o("WASmaxMixins").mergeStanzas(t,n)}l.mergePreFilledTextMixin=s}),98);
__d("WASmaxOutSpamRawV2Mixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(t,n,r,o,a,i,l){function e(){var e=o("WASmaxJsx").smax("raw",{v:o("WAWap").INT(2)});return e}function s(t){var n=e();return o("WASmaxMixins").mergeStanzas(t,n)}l.mergeRawV2Mixin=s}),98);
__d("WASmaxOutSpamRawMixins",["WASmaxMixinGroupExhaustiveError","WASmaxOutSpamRawV2Mixin","WASmaxOutSpamRawV3Mixin"],(function(t,n,r,o,a,i,l){function e(e,t){if(t.isRawV2)return o("WASmaxOutSpamRawV2Mixin").mergeRawV2Mixin(e);if(t.rawV3)return o("WASmaxOutSpamRawV3Mixin").mergeRawV3Mixin(e,t.rawV3);throw new(o("WASmaxMixinGroupExhaustiveError")).SmaxMixinGroupExhaustiveError}l.mergeRawMixins=e}),98);
__d("WASmaxOutSpamRevokeMixin",["WASmaxJsx","WASmaxMixins"],(function(t,n,r,o,a,i,l){function e(){var e=o("WASmaxJsx").smax("message",{edit:"7"});return e}function s(t){var n=e();return o("WASmaxMixins").mergeStanzas(t,n)}l.mergeRevokeMixin=s}),98);
__d("WASmaxOutSpamSMBBroadcastSourceMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(t,n,r,o,a,i,l){function e(e){var t=e.metaBizSource,n=o("WASmaxJsx").smax("message",null,o("WASmaxJsx").smax("meta",{biz_source:o("WAWap").CUSTOM_STRING(t)}));return n}function s(t,n){var r=e(n);return o("WASmaxMixins").mergeStanzas(t,r)}l.mergeSMBBroadcastSourceMixin=s}),98);
__d("WASmaxOutSpamServerReportingTokenMixin",["WASmaxJsx","WASmaxMixins"],(function(t,n,r,o,a,i,l){function e(e){var t=e.reportingTagElementValue,n=o("WASmaxJsx").smax("smax$any",null,o("WASmaxJsx").smax("reporting",null,o("WASmaxJsx").smax("reporting_tag",null,t)));return n}function s(t,n){var r=e(n);return o("WASmaxMixins").mergeStanzas(t,r)}l.mergeServerReportingTokenMixin=s}),98);
__d("WASmaxOutSpamWaMessageReportingMixin",["WASmaxChildren","WASmaxJsx","WASmaxMixins","WASmaxOutSpamClientReportingContentValidationMixin","WASmaxOutSpamRawV2Mixin","WASmaxOutSpamServerReportingTokenMixin"],(function(t,n,r,o,a,i,l){function e(){var e=o("WASmaxOutSpamRawV2Mixin").mergeRawV2Mixin(o("WASmaxJsx").smax("raw",null));return e}function s(t){var n=t.hasRaw,r=t.clientReportingContentValidationMixinArgs,a=t.serverReportingTokenMixinArgs,i=o("WASmaxMixins").optionalMerge(o("WASmaxOutSpamServerReportingTokenMixin").mergeServerReportingTokenMixin,o("WASmaxMixins").optionalMerge(o("WASmaxOutSpamClientReportingContentValidationMixin").mergeClientReportingContentValidationMixin,o("WASmaxJsx").smax("message",null,o("WASmaxChildren").HAS_OPTIONAL_CHILD(e,n)),r),a);return i}function u(e,t){var n=s(t);return o("WASmaxMixins").mergeStanzas(e,n)}l.makeWaMessageReportingRaw=e,l.mergeWaMessageReportingMixin=u}),98);
__d("WASmaxOutSpamMessageMixin",["WASmaxAttrs","WASmaxChildren","WASmaxJsx","WASmaxMixins","WASmaxOutSpamAdminRevokeMixin","WASmaxOutSpamAutomatedMixin","WASmaxOutSpamExtensionScreenDataMixin","WASmaxOutSpamIABReportLinkMixin","WASmaxOutSpamMessageEditMixin","WASmaxOutSpamMessageFrankingMixin","WASmaxOutSpamMessageParticipantMixin","WASmaxOutSpamMessagePayloadTypes","WASmaxOutSpamMessagePlaceholderMixin","WASmaxOutSpamMessageWithHsmTemplateMixin","WASmaxOutSpamMessageWithNewsletterQuestionResponseMixin","WASmaxOutSpamMulticastMixin","WASmaxOutSpamPreFilledNumberMixin","WASmaxOutSpamPreFilledTextMixin","WASmaxOutSpamRawMixins","WASmaxOutSpamRevokeMixin","WASmaxOutSpamSMBBroadcastSourceMixin","WASmaxOutSpamWaMessageReportingMixin","WAWap"],(function(t,n,r,o,a,i,l){function e(e){var t=e.rawMediatype,n=e.rawLocalMessageType,r=e.rawElementValue,a=e.rawMixinsArgs,i=o("WASmaxOutSpamRawMixins").mergeRawMixins(o("WASmaxJsx").smax("raw",{mediatype:o("WASmaxAttrs").OPTIONAL(o("WAWap").CUSTOM_STRING,t),local_message_type:o("WASmaxAttrs").OPTIONAL(o("WAWap").INT,n)},r),a);return i}function s(){var e=o("WASmaxJsx").smax("enc",null);return e}function u(t){var n,r,a=t.rawArgs,i=t.messageT,l=t.messageId,s=t.messageSelected,u=t.messageUnsent,c=t.messageDeletedReason,d=t.hasRevoke,m=t.hasAdminRevoke,p=t.hasMessageEdit,_=t.hasMulticast,f=t.hasPreFilledNumber,g=t.hasPreFilledText,h=t.hasAutomated,y=t.messageWithHsmTemplateMixinArgs,C=t.extensionScreenDataMixinArgs,b=t.messageParticipantMixinArgs,v=t.messageFrankingMixinArgs,S=t.waMessageReportingMixinArgs,R=t.sMBBroadcastSourceMixinArgs,L=t.iABReportLinkMixinArgs,E=t.messageWithNewsletterQuestionResponseMixinArgs,k=t.hasMessagePlaceholder,I=t.messagePayloadTypesArgs,T=o("WASmaxOutSpamMessagePayloadTypes").mergeMessagePayloadTypes((n=o("WASmaxMixins")).optionalMerge(o("WASmaxOutSpamMessagePlaceholderMixin").mergeMessagePlaceholderMixin,n.optionalMerge(o("WASmaxOutSpamMessageWithNewsletterQuestionResponseMixin").mergeMessageWithNewsletterQuestionResponseMixin,n.optionalMerge(o("WASmaxOutSpamIABReportLinkMixin").mergeIABReportLinkMixin,n.optionalMerge(o("WASmaxOutSpamSMBBroadcastSourceMixin").mergeSMBBroadcastSourceMixin,n.optionalMerge(o("WASmaxOutSpamWaMessageReportingMixin").mergeWaMessageReportingMixin,n.optionalMerge(o("WASmaxOutSpamMessageFrankingMixin").mergeMessageFrankingMixin,n.optionalMerge(o("WASmaxOutSpamMessageParticipantMixin").mergeMessageParticipantMixin,n.optionalMerge(o("WASmaxOutSpamExtensionScreenDataMixin").mergeExtensionScreenDataMixin,n.optionalMerge(o("WASmaxOutSpamMessageWithHsmTemplateMixin").mergeMessageWithHsmTemplateMixin,n.optionalMerge(o("WASmaxOutSpamAutomatedMixin").mergeAutomatedMixin,n.optionalMerge(o("WASmaxOutSpamPreFilledTextMixin").mergePreFilledTextMixin,n.optionalMerge(o("WASmaxOutSpamPreFilledNumberMixin").mergePreFilledNumberMixin,n.optionalMerge(o("WASmaxOutSpamMulticastMixin").mergeMulticastMixin,n.optionalMerge(o("WASmaxOutSpamMessageEditMixin").mergeMessageEditMixin,n.optionalMerge(o("WASmaxOutSpamAdminRevokeMixin").mergeAdminRevokeMixin,n.optionalMerge(o("WASmaxOutSpamRevokeMixin").mergeRevokeMixin,o("WASmaxJsx").smax("message",{t:(r=o("WAWap")).INT(i),id:r.STANZA_ID(l),selected:o("WASmaxAttrs").OPTIONAL(r.CUSTOM_STRING,s),unsent:o("WASmaxAttrs").OPTIONAL(r.CUSTOM_STRING,u),deleted_reason:o("WASmaxAttrs").OPTIONAL(r.CUSTOM_STRING,c)},o("WASmaxChildren").OPTIONAL_CHILD(e,a)),d),m),p),_),f),g),h),y),C),b),v),S),R),L),E),k),I);return T}function c(e,t){var n=u(t);return o("WASmaxMixins").mergeStanzas(e,n)}l.makeMessageRaw=e,l.makeMessageEnc=s,l.mergeMessageMixin=c}),98);
__d("WASmaxOutSpamMessageRecipientMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(t,n,r,o,a,i,l){function e(e){var t=e.messageTo,n=o("WASmaxJsx").smax("message",{to:o("WAWap").JID(t)});return n}function s(t,n){var r=e(n);return o("WASmaxMixins").mergeStanzas(t,r)}l.mergeMessageRecipientMixin=s}),98);
__d("WASmaxOutSpamMessageSenderMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(t,n,r,o,a,i,l){function e(e){var t=e.messageFrom,n=o("WASmaxJsx").smax("message",{from:o("WAWap").JID(t)});return n}function s(t,n){var r=e(n);return o("WASmaxMixins").mergeStanzas(t,r)}l.mergeMessageSenderMixin=s}),98);
__d("WASmaxOutSpamMessageSenderOrRecipientMixinGroup",["WASmaxMixinGroupExhaustiveError","WASmaxOutSpamMessageRecipientMixin","WASmaxOutSpamMessageSenderMixin"],(function(t,n,r,o,a,i,l){function e(e,t){if(t.messageSender)return o("WASmaxOutSpamMessageSenderMixin").mergeMessageSenderMixin(e,t.messageSender);if(t.messageRecipient)return o("WASmaxOutSpamMessageRecipientMixin").mergeMessageRecipientMixin(e,t.messageRecipient);throw new(o("WASmaxMixinGroupExhaustiveError")).SmaxMixinGroupExhaustiveError}l.mergeMessageSenderOrRecipientMixinGroup=e}),98);
__d("WASmaxOutSpamPrivacyTokenContentsMixin",["WASmaxJsx","WASmaxMixins"],(function(t,n,r,o,a,i,l){function e(e){var t=e.anyElementValue,n=o("WASmaxJsx").smax("smax$any",null,t);return n}function s(t,n){var r=e(n);return o("WASmaxMixins").mergeStanzas(t,r)}l.mergePrivacyTokenContentsMixin=s}),98);
__d("WASmaxOutSpamTCTokenMixin",["WASmaxAttrs","WASmaxJsx","WASmaxMixins","WASmaxOutSpamPrivacyTokenContentsMixin","WAWap"],(function(t,n,r,o,a,i,l){function e(e){var t=e.tctokenT,n=e.privacyTokenContentsMixinArgs,r=o("WASmaxJsx").smax("smax$any",null,o("WASmaxOutSpamPrivacyTokenContentsMixin").mergePrivacyTokenContentsMixin(o("WASmaxJsx").smax("tctoken",{t:o("WASmaxAttrs").OPTIONAL(o("WAWap").INT,t)}),n));return r}function s(t,n){var r=e(n);return o("WASmaxMixins").mergeStanzas(t,r)}l.mergeTCTokenMixin=s}),98);
__d("WASmaxOutSpamUIStateSetMixin",["WASmaxChildren","WASmaxJsx","WASmaxMixins"],(function(t,n,r,o,a,i,l){function e(){var e=o("WASmaxJsx").smax("uistate",{value:"spam_banner"});return e}function s(t){var n=t.hasUistate,r=o("WASmaxJsx").smax("spam_list",null,o("WASmaxJsx").smax("uistateset",null,o("WASmaxChildren").HAS_OPTIONAL_CHILD(e,n)));return r}function u(e,t){var n=s(t);return o("WASmaxMixins").mergeStanzas(e,n)}l.makeUIStateSetUistatesetUistate=e,l.mergeUIStateSetMixin=u}),98);
__d("WASmaxOutSpamUserInitiatedExtensionMixin",["WASmaxChildren","WASmaxJsx","WASmaxMixins","WASmaxOutSpamExtensionScreenMixin"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxOutSpamExtensionScreenMixin").mergeExtensionScreenMixin(o("WASmaxJsx").smax("extension_screen",null),e);return t}function s(t){var n=t.extensionScreenArgs,r=o("WASmaxJsx").smax("user_initiated_extension",null,o("WASmaxChildren").REPEATED_CHILD(e,n,1,100));return r}function u(e,t){var n=s(t);return o("WASmaxMixins").mergeStanzas(e,n)}l.makeUserInitiatedExtensionExtensionScreen=e,l.mergeUserInitiatedExtensionMixin=u}),98);
__d("WASmaxOutSpamIndividualReportRequest",["WASmaxAttrs","WASmaxChildren","WASmaxJsx","WASmaxMixins","WASmaxOutSpamBaseIQSetRequestMixin","WASmaxOutSpamBaseReportMixin","WASmaxOutSpamBizOptOutMixin","WASmaxOutSpamBizReportMixin","WASmaxOutSpamCallReportMixin","WASmaxOutSpamFRXMixin","WASmaxOutSpamMessageMixin","WASmaxOutSpamMessageSenderOrRecipientMixinGroup","WASmaxOutSpamTCTokenMixin","WASmaxOutSpamUIStateSetMixin","WASmaxOutSpamUserInitiatedExtensionMixin","WAWap"],(function(t,n,r,o,a,i,l){function e(e){var t=e.messageSenderOrRecipientMixinGroupArgs,n=o("WASmaxOutSpamMessageSenderOrRecipientMixinGroup").mergeMessageSenderOrRecipientMixinGroup(o("WASmaxOutSpamMessageMixin").mergeMessageMixin(o("WASmaxJsx").smax("message",null),e),t);return n}function s(e){var t=o("WASmaxOutSpamCallReportMixin").mergeCallReportMixin(o("WASmaxJsx").smax("call",null),e);return t}function u(e){var t=o("WASmaxOutSpamUserInitiatedExtensionMixin").mergeUserInitiatedExtensionMixin(o("WASmaxJsx").smax("user_initiated_extension",null),e);return t}function c(t){var n,r=t.messageArgs,a=t.callArgs,i=t.userInitiatedExtensionArgs,l=t.fRXMixinArgs,c=t.spamListJid,d=t.bizOptOutMixinArgs,m=t.uIStateSetMixinArgs,p=t.bizReportMixinArgs,_=t.tCTokenMixinArgs,f=(n=o("WASmaxMixins")).optionalMerge(o("WASmaxOutSpamFRXMixin").mergeFRXMixin,o("WASmaxOutSpamBaseReportMixin").mergeBaseReportMixin(o("WASmaxOutSpamBaseIQSetRequestMixin").mergeBaseIQSetRequestMixin(o("WASmaxJsx").smax("iq",null,n.optionalMerge(o("WASmaxOutSpamTCTokenMixin").mergeTCTokenMixin,n.optionalMerge(o("WASmaxOutSpamBizReportMixin").mergeBizReportMixin,n.optionalMerge(o("WASmaxOutSpamUIStateSetMixin").mergeUIStateSetMixin,n.optionalMerge(o("WASmaxOutSpamBizOptOutMixin").mergeBizOptOutMixin,o("WASmaxJsx").smax("spam_list",{jid:o("WASmaxAttrs").OPTIONAL(o("WAWap").JID,c)},[].concat(o("WASmaxChildren").REPEATED_CHILD(e,r,0,210),o("WASmaxChildren").REPEATED_CHILD(s,a,0,5),o("WASmaxChildren").REPEATED_CHILD(u,i,0,5))),d),m),p),_))),t),l);return f}l.makeIndividualReportRequestSpamListMessage=e,l.makeIndividualReportRequestSpamListCall=s,l.makeIndividualReportRequestSpamListUserInitiatedExtension=u,l.makeIndividualReportRequest=c}),98);
__d("WASmaxOutStatsBaseIQSetRequestMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(t,n,r,o,a,i,l){function e(){var e=o("WASmaxJsx").smax("iq",{id:o("WAWap").generateId(),type:"set"});return e}function s(t){var n=e();return o("WASmaxMixins").mergeStanzas(t,n)}l.mergeBaseIQSetRequestMixin=s}),98);
__d("WASmaxOutStatsSendBufferRequest",["WASmaxJsx","WASmaxOutStatsBaseIQSetRequestMixin","WAWap"],(function(t,n,r,o,a,i,l){function e(e){var t=e.addT,n=e.addElementValue,r=o("WASmaxOutStatsBaseIQSetRequestMixin").mergeBaseIQSetRequestMixin(o("WASmaxJsx").smax("iq",{xmlns:"w:stats",to:o("WAWap").S_WHATSAPP_NET},o("WASmaxJsx").smax("add",{t:o("WAWap").INT(t)},n)));return r}l.makeSendBufferRequest=e}),98);
__d("WASmaxPreKeysFetchKeyBundlesRPC",["WAComms","WASmaxInPreKeysFetchKeyBundlesResponseRequestError","WASmaxInPreKeysFetchKeyBundlesResponseServerError","WASmaxInPreKeysFetchKeyBundlesResponseSuccess","WASmaxOutPreKeysFetchKeyBundlesRequest","WASmaxParsingFailure","WASmaxRpcUtils","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){function e(e,t){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=o("WASmaxOutPreKeysFetchKeyBundlesRequest").makeFetchKeyBundlesRequest(e),r=yield o("WAComms").sendSmaxStanza(n,t),a=o("WASmaxInPreKeysFetchKeyBundlesResponseSuccess").parseFetchKeyBundlesResponseSuccess(r,n);if(a.success)return{name:"FetchKeyBundlesResponseSuccess",value:a.value};var i=o("WASmaxInPreKeysFetchKeyBundlesResponseRequestError").parseFetchKeyBundlesResponseRequestError(r,n);if(i.success)return{name:"FetchKeyBundlesResponseRequestError",value:i.value};var l=o("WASmaxInPreKeysFetchKeyBundlesResponseServerError").parseFetchKeyBundlesResponseServerError(r,n);if(l.success)return{name:"FetchKeyBundlesResponseServerError",value:l.value};throw new(o("WASmaxParsingFailure")).SmaxParsingFailure(o("WASmaxRpcUtils").errorMessageRpcParsing("FetchKeyBundles",{Success:a,RequestError:i,ServerError:l}))}),s.apply(this,arguments)}l.sendFetchKeyBundlesRPC=e}),98);
__d("WASmaxProfilePictureGetRPC",["WAComms","WASmaxInProfilePictureGetResponseError","WASmaxInProfilePictureGetResponseSuccessAvatarURLs","WASmaxInProfilePictureGetResponseSuccessNoData","WASmaxInProfilePictureGetResponseSuccessPictureBlob","WASmaxInProfilePictureGetResponseSuccessPictureURL","WASmaxOutProfilePictureGetRequest","WASmaxParsingFailure","WASmaxRpcUtils","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){function e(e,t){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=o("WASmaxOutProfilePictureGetRequest").makeGetRequest(e),r=yield o("WAComms").sendSmaxStanza(n,t),a=o("WASmaxInProfilePictureGetResponseSuccessPictureURL").parseGetResponseSuccessPictureURL(r,n);if(a.success)return{name:"GetResponseSuccessPictureURL",value:a.value};var i=o("WASmaxInProfilePictureGetResponseSuccessAvatarURLs").parseGetResponseSuccessAvatarURLs(r,n);if(i.success)return{name:"GetResponseSuccessAvatarURLs",value:i.value};var l=o("WASmaxInProfilePictureGetResponseSuccessPictureBlob").parseGetResponseSuccessPictureBlob(r,n);if(l.success)return{name:"GetResponseSuccessPictureBlob",value:l.value};var s=o("WASmaxInProfilePictureGetResponseSuccessNoData").parseGetResponseSuccessNoData(r,n);if(s.success)return{name:"GetResponseSuccessNoData",value:s.value};var u=o("WASmaxInProfilePictureGetResponseError").parseGetResponseError(r,n);if(u.success)return{name:"GetResponseError",value:u.value};throw new(o("WASmaxParsingFailure")).SmaxParsingFailure(o("WASmaxRpcUtils").errorMessageRpcParsing("Get",{SuccessPictureURL:a,SuccessAvatarURLs:i,SuccessPictureBlob:l,SuccessNoData:s,Error:u}))}),s.apply(this,arguments)}l.sendGetRPC=e}),98);
__d("WASmaxSpamIndividualReportRPC",["WAComms","WASmaxInSpamIndividualReportResponseError","WASmaxInSpamIndividualReportResponseSuccess","WASmaxOutSpamIndividualReportRequest","WASmaxParsingFailure","WASmaxRpcUtils","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){function e(e,t){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=o("WASmaxOutSpamIndividualReportRequest").makeIndividualReportRequest(e),r=yield o("WAComms").sendSmaxStanza(n,t),a=o("WASmaxInSpamIndividualReportResponseSuccess").parseIndividualReportResponseSuccess(r,n);if(a.success)return{name:"IndividualReportResponseSuccess",value:a.value};var i=o("WASmaxInSpamIndividualReportResponseError").parseIndividualReportResponseError(r,n);if(i.success)return{name:"IndividualReportResponseError",value:i.value};throw new(o("WASmaxParsingFailure")).SmaxParsingFailure(o("WASmaxRpcUtils").errorMessageRpcParsing("IndividualReport",{Success:a,Error:i}))}),s.apply(this,arguments)}l.sendIndividualReportRPC=e}),98);
__d("WASmaxStatsSendBufferRPC",["WAComms","WASmaxInStatsSendBufferResponseErrorNoRetry","WASmaxInStatsSendBufferResponseErrorRetry","WASmaxInStatsSendBufferResponseSuccess","WASmaxOutStatsSendBufferRequest","WASmaxParsingFailure","WASmaxRpcUtils","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){function e(e,t){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=o("WASmaxOutStatsSendBufferRequest").makeSendBufferRequest(e),r=yield o("WAComms").sendSmaxStanza(n,t),a=o("WASmaxInStatsSendBufferResponseSuccess").parseSendBufferResponseSuccess(r,n);if(a.success)return{name:"SendBufferResponseSuccess",value:a.value};var i=o("WASmaxInStatsSendBufferResponseErrorNoRetry").parseSendBufferResponseErrorNoRetry(r,n);if(i.success)return{name:"SendBufferResponseErrorNoRetry",value:i.value};var l=o("WASmaxInStatsSendBufferResponseErrorRetry").parseSendBufferResponseErrorRetry(r,n);if(l.success)return{name:"SendBufferResponseErrorRetry",value:l.value};throw new(o("WASmaxParsingFailure")).SmaxParsingFailure(o("WASmaxRpcUtils").errorMessageRpcParsing("SendBuffer",{Success:a,ErrorNoRetry:i,ErrorRetry:l}))}),s.apply(this,arguments)}l.sendSendBufferRPC=e}),98);
__d("WASocketTransport",["Promise","WABinary","WALogger","err"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c,d=1,m=(function(){function t(t){var n=this;this.$2=!1,this.onData=null,this.onClose=null,this.onError=null,this.dataToSend=new(o("WABinary")).Binary,this.$3=function(t){if(!n.$2){var r=new Uint8Array(t.data);n.onData?n.onData(r):o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["WebSocket #"," dropped "," bytes"])),n.id,r.length)}},this.$4=function(e){n.$2||n.$6(e)},this.$5=function(e){if(o("WALogger").DEV(s||(s=babelHelpers.taggedTemplateLiteralLoose(["WebSocket #"," errored: ",""])),n.id,e),!n.$2){var t=n.onError;t&&t(String(e))}};var r=d++;this.id=r,this.$1=t,t.onmessage=this.$3,t.onclose=this.$4,t.onerror=this.$5}var n=t.prototype;return n.close=function(){this.$2||(this.$1.close(),this.$6())},n.requestSend=function(){if(this.$2){o("WALogger").ERROR(u||(u=babelHelpers.taggedTemplateLiteralLoose(["WebSocket #"," not opened"])),this.id);return}this.dataToSend.size()&&this.$1.send(this.dataToSend.readBuffer())},n.$6=function(t){this.$2=!0,this.onClose&&this.onClose(t)},t})();function p(e,t,o,a){var i=new WebSocket(e);return i.binaryType="arraybuffer",new(c||(c=n("Promise")))(function(e,n){i.onopen=function(){a==null||a(),e()},i.onclose=function(e){t==null||t(e),o==null||o(null,e),n(r("err")("WebSocket closed after microtask delay}: "+e.reason+" "+e.code))}}).then(function(){var e=new m(i);return o!=null&&(e.onClose=function(t){t!=null&&o(e.id,t)}),e})}l.WebSocketTransport=m,l.openWebSocket=p}),98);
__d("WASyncdKeyManagementUtils",["WASyncdKeyTypes"],(function(t,n,r,o,a,i,l){"use strict";function e(e){return new DataView(o("WASyncdKeyTypes").fromSyncKeyId(e)).getUint16(0)}function s(e){return new DataView(o("WASyncdKeyTypes").fromSyncKeyId(e)).getUint32(2)}function u(e){return s(e)+1}l.getKeyDeviceId=e,l.getKeyEpoch=s,l.generateNewKeyEpoch=u}),98);
__d("WATaskScheduler",["Promise","WALogger","WAPromiseBackoffs","WAResolvable","WATimeUtils","err"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c,d,m,p,_,f,g,h,y="no_reschedule",C=(function(){function t(e){this.$1=!1,this.$2={},this.$3={},this.$4={},this.$5=new Map,this.$6=e.scheduledTimeResolver}var r=t.prototype;return r.$7=function(r){var t=this,a=this.$5.get(r);if(a==null){o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["Tried to start task "," before registering its implementation"])),r).devConsole("start-task-without-impl");return}this.$6.get(r).then(function(e){var i=e==null,l=!i&&e===o("WATimeUtils").DEFAULT_UNIXTIME;if(l){o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["Task "," deactivated"])),r);return}var f=e==null?0:e*1e3-o("WATimeUtils").unixTimeMs();f=Math.max(0,f),f=Math.min(f,2147483647),o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["Scheduling task "," in ","ms"])),r,f),t.$4[r]=setTimeout(function(){delete t.$4[r],o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["Firing task ",""])),r),a(i).then(function(e){if(e==="no_reschedule")return new(h||(h=n("Promise")))(function(){});var a;return e===o("WATimeUtils").DEFAULT_UNIXTIME?(o("WALogger").LOG(d||(d=babelHelpers.taggedTemplateLiteralLoose(["Task "," complete, deactivating"])),r),delete t.$3[r],a=o("WATimeUtils").DEFAULT_UNIXTIME):e>=0?(o("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["Task "," complete, waiting ",""])),r,e),delete t.$3[r],a=o("WATimeUtils").futureUnixTime(e)):(o("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["Task "," will try again later"])),r),a=t.$8(r)),t.$6.set(r,a)}).then(function(){t.$7(r),t.$2[r]&&(t.$2[r].forEach(function(e){return e()}),delete t.$2[r])}).catch(function(e){return o("WALogger").LOG(_||(_=babelHelpers.taggedTemplateLiteralLoose(["Task "," failed, try again later: ",""])),r,e),t.$6.set(r,t.$8(r)).then(function(){t.$7(r)})})},f)})},r.$8=function(t){return this.$3[t]||(this.$3[t]=o("WAPromiseBackoffs").createTimer({jitter:.1,max:o("WATimeUtils").HOUR_SECONDS*1e3,algo:{type:"fibonacci",first:1e3,second:2e3}})),o("WATimeUtils").futureUnixTime(Math.round(this.$3[t]()/1e3))},r.$9=function(t,n){this.$2[t]||(this.$2[t]=[]),this.$2[t].push(n)},r.awaitTaskPromise=function(t){var e=this;return new(h||(h=n("Promise")))(function(n){e.$9(t,n)})},r.reschedule=function(t,n){this.$1?(this.$6.set(t,n),this.$4[t]!=null&&clearTimeout(this.$4[t]),this.$7(t)):this.$6.set(t,n)},r.registerTask=function(t,n){this.$1||(this.$1=!0),this.$5.set(t,n),this.$7(t)},r.getScheduledTime=function(t){return this.$6.get(t)},t})(),b=null,v=new(o("WAResolvable")).Resolvable;function S(e){o("WALogger").LOG(f||(f=babelHelpers.taggedTemplateLiteralLoose(["startScheduler invoked"]))),b||(b=new C(e),v.resolve())}function R(e){var t=x("awaitTaskPromise");return t.awaitTaskPromise(e)}function L(e,t){var n=x("reschedule");n.reschedule(e,t)}function E(e,t){v.resolveWasCalled()?L(e,t):v.promise.then(function(){L(e,t)}).catch(function(t){o("WALogger").ERROR(g||(g=babelHelpers.taggedTemplateLiteralLoose(["taskScheduler: reschedule eventually failed for task ",""])),e).devConsole(t).sendLogs("task-scheduler-reschedule-failed")})}function k(e){E(e,o("WATimeUtils").unixTime())}function I(e){E(e,o("WATimeUtils").DEFAULT_UNIXTIME)}function T(e){var t=x("getScheduledTime");return t.getScheduledTime(e)}function D(e,t){var n=x("registerTask");n.registerTask(e,t)}function x(e){if(b)return b;throw r("err")("TaskScheduler::"+e+" called before startScheduler")}l.DO_NOT_RESCHEDULE=y,l.startScheduler=S,l.awaitTaskPromise=R,l._doReschedule=L,l.reschedule=E,l.rescheduleNow=k,l.deactivate=I,l.getScheduledTime=T,l.registerTask=D}),98);
__d("WAVerifyChainCertificateWA6",["WACert.pb","WACryptoUtils","WAHex","WALogger","WAResultOrError","WASignalKeys","WASignalOther","WASignalSignatures","decodeProtobuf"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c,d,m,p,_,f,g,h,y,C,b,v,S,R="142375574d0a587166aae71ebe516437c4a28b73e3695c6ce1f7f9545da8ee6b",L={SERIAL:0,ISSUER:"WhatsAppLongTerm1",PUBLIC_KEY:o("WASignalKeys").serializeIdentity(new Uint8Array(o("WAHex").parseHex(R)))};function E(t,n){o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["verifyChainCertificateWA6: extract leaf and intermediate certificate"])));var r=o("decodeProtobuf").decodeProtobuf(o("WACert.pb").CertChainSpec,t),a=r.intermediate,i=r.leaf;if(a==null||i==null)return o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["verifyChainCertificateWA6: missing leaf and/or intermediate certificate"]))),o("WAResultOrError").makeError("missing-certificate");o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["verifying intermediate certificate"])));var l=k(a);if(!l.success)return o("WALogger").ERROR(c||(c=babelHelpers.taggedTemplateLiteralLoose(["verifyChainCertificateWA6: invalid intermediate certificate"]))),o("WAResultOrError").makeError("invalid-certificate");if(l.value.issuerSerial!==L.SERIAL)return o("WALogger").ERROR(d||(d=babelHelpers.taggedTemplateLiteralLoose(["verifyChainCertificateWA6 intermediate certificate was not issued by RootCA"]))),o("WAResultOrError").makeError("invalid-certificate");if(!I(l.value,L.PUBLIC_KEY))return o("WALogger").ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["verifyChainCertificateWA6: intermediate certificate is poorly signed"]))),o("WAResultOrError").makeError("invalid-certificate");o("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["verifying leaf certificate"])));var y=k(i);if(!y.success)return o("WALogger").ERROR(_||(_=babelHelpers.taggedTemplateLiteralLoose(["verifyChainCertificateWA6: invalid leaf certificate"]))),o("WAResultOrError").makeError("invalid-certificate");if(y.value.issuerSerial!==l.value.serial)return o("WALogger").ERROR(f||(f=babelHelpers.taggedTemplateLiteralLoose(["verifyChainCertificateWA6 leaf certificate was not issued by RootCA"]))),o("WAResultOrError").makeError("invalid-certificate");var C=o("WASignalKeys").serializeIdentity(new Uint8Array(l.value.key));return I(y.value,C)?o("WACryptoUtils").arrayBuffersEqual(y.value.key,n)?o("WAResultOrError").makeResult({leaf:y.value,intermediate:l.value}):(o("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["verifyChainCertificateWA6 leafCert.key does not match handshake server.hello.static"]))),o("WAResultOrError").makeError("invalid-certificate")):(o("WALogger").ERROR(g||(g=babelHelpers.taggedTemplateLiteralLoose(["verifyChainCertificateWA6: leaf certificate is poorly signed"]))),o("WAResultOrError").makeError("invalid-certificate"))}function k(e){var t=e.details,n=e.signature;if(!t)return o("WALogger").ERROR(y||(y=babelHelpers.taggedTemplateLiteralLoose(['parseCertificateWA6 certificate is missing "details"']))),o("WAResultOrError").makeError("invalid-certificate");if(!n)return o("WALogger").ERROR(C||(C=babelHelpers.taggedTemplateLiteralLoose(['parseCertificateWA6 certificate is missing "signature"']))),o("WAResultOrError").makeError("invalid-certificate");var r=o("decodeProtobuf").decodeProtobuf(o("WACert.pb").CertChain$NoiseCertificate$DetailsSpec,t),a=r.issuerSerial,i=r.serial,l=r.key,s=r.notAfter,u=r.notBefore;if(a==null)return o("WALogger").ERROR(b||(b=babelHelpers.taggedTemplateLiteralLoose(['parseCertificateWA6 certificate is missing "issuer_serial"']))),o("WAResultOrError").makeError("invalid-certificate");if(i==null)return o("WALogger").ERROR(v||(v=babelHelpers.taggedTemplateLiteralLoose(['parseCertificateWA6 certificate is missing "serial"']))),o("WAResultOrError").makeError("invalid-certificate");if(l==null)return o("WALogger").ERROR(S||(S=babelHelpers.taggedTemplateLiteralLoose(['parseCertificateWA6 certificate is missing "key"']))),o("WAResultOrError").makeError("invalid-certificate");var c=o("WASignalOther").ensureSize(new Uint8Array(n),64);return o("WAResultOrError").makeResult({serial:i,issuerSerial:a,key:l,notBefore:u,notAfter:s,details:t,signature:c})}function I(e,t){return o("WASignalSignatures").verifyMsgSignalVariant(t,new Uint8Array(e.details),e.signature)}l.ROOT_CA=L,l.verifyChainCertificateWA6=E,l.parseCertificateWA6=k}),98);
__d("WAWamTypes",[],(function(t,n,r,o,a,i){"use strict";var e={INT:0,BOOL:1,STRING:2,FLOAT:3};i.TYPES=e}),66);
__d("WAWamBuffer",["WABinary","WAWamTypes","err"],(function(t,n,r,o,a,i,l){"use strict";var e=5,s=47,u=0,c=1,d=2,m=1,p=2,_=0,f=4,g=8,h=(function(){function t(t,n,r,a){var i=this;this.$5=!1,this.$6=!1;var l=new(o("WABinary")).Binary(void 0,!0);switch(l.writeString("WAM"),l.writeUint8(e),l.writeUint8(n),l.writeUint16(r),t){case"regular":l.writeUint8(u);break;case"realtime":l.writeUint8(c);break;default:l.writeUint8(d)}this.$1=t,this.$2=l,this.$3=r,this.$4=n,a.forEach(function(e,t){return void i.writeGlobal(t,e)})}var n=t.prototype;return n.writeGlobal=function(t,n){if(n==null){v(this.$2,t,_);return}if(typeof n=="string")b(this.$2,t,_,n);else if(typeof n=="number")y(this.$2,t,_,n);else if(typeof n=="boolean")y(this.$2,t,_,n?1:0);else throw r("err")("Incorrect value type "+typeof n)},n.writeEvent=function(t,n,r,a){var e=this.$2;y(e,s,_,Math.floor(t/1e3));var i=S(r),l=i===-1?m|f:m;y(e,n,l,a);for(var u=0;u<=i;u+=3){var c=r[u+2];if(c!=null){var d=r[u],g=r[u+1],h=u===i?p|f:p;g===o("WAWamTypes").TYPES.INT?y(e,d,h,c):g===o("WAWamTypes").TYPES.BOOL?y(e,d,h,c?1:0):g===o("WAWamTypes").TYPES.STRING?b(e,d,h,c):C(e,d,h,c)}}this.$6=!0},n.getKey=function(){return{streamId:this.$4,sequenceNumber:this.$3,channel:this.$1}},n.getSize=function(){return this.$2.size()},n.peek=function(){return this.$2.peek(function(e){return e.readByteArrayView()})},n.getBuffer__INTERNAL=function(){return this.$2},n.isFinalized=function(){return this.$5},n.finalize=function(){this.$5=!0},n.hasEvents=function(){return this.$6},t})();function y(e,t,n,r){r===0?v(e,t,n|16):r===1?v(e,t,n|32):-128<=r&&r<128?(v(e,t,n|48),e.writeInt8(r)):-32768<=r&&r<32768?(v(e,t,n|64),e.writeInt16(r)):-2147483648<=r&&r<2147483648?(v(e,t,n|80),e.writeInt32(r)):(v(e,t,n|96),e.writeInt64(r))}function C(e,t,n,r){v(e,t,n|112),e.writeFloat64(r)}function b(e,t,n,r){var a=o("WABinary").numUtf8Bytes(r);a<256?(v(e,t,n|128),e.writeUint8(a)):a<65536?(v(e,t,n|144),e.writeUint16(a)):(v(e,t,n|160),e.writeUint32(a)),e.writeString(r)}function v(e,t,n){t<256?(e.writeUint8(n),e.writeUint8(t)):(e.writeUint8(n|g),e.writeUint16(t))}function S(e){for(var t=-1,n=0;n<e.length;n+=3)e[n+2]!=null&&(t=n);return t}function R(e){for(var t=S(e),n=0;n<=t;n+=3){var r=e[n+2];if(r!=null){var a=e[n+1];if(a===o("WAWamTypes").TYPES.INT&&isNaN(r))return!1}}return!0}function L(e){return typeof e=="number"?!isNaN(e):!0}l.WamBuffer=h,l.canWriteEvent=R,l.canWriteGlobal=L}),98);
__d("WAWam",["Promise","WALogger","WAPromiseEach","WAShiftTimer","WAWamBuffer"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c,d,m,p,_,f,g,h,y=65536,C=300*1e3,b=3e3,v=1,S=2,R=6005,L=113760892,E=0,k="none",I={putBuffer:function(t,r,o){return(h||(h=n("Promise"))).resolve()}},T=(function(){function t(t){var n=this;this.$2=[],this.$3=new Map,this.$4=!1,this.$5=new Map,this.$8=-1,this.$9=I,this.$10=null,this.deinitialize=function(){n.$4=!1,n.$2=[],n.$3.clear(),n.$5=new Map,n.$8=-1,n.$9=I,n.serializePending.cancel(),n.finalizeBuffers.cancel()},this.enqueueEvent=function(e,t,r,o,a,i){var l=v;n.$2.push({type:l,id:e,commitTime:t,psIdIntValue:r,weight:a,fields:o,resolve:i}),n.$4&&n.serializePending.onOrBefore(b)},this.enqueueAttributesUpdate=function(t){var r={type:S,delta:[]};t.forEach(function(e,t){e!==void 0&&r.delta.push([t,e])}),r.delta.length>0&&(o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["WAM: Enqueued "," attribute keys for update"])),r.delta.length),n.$2.push(r))},this.finalizeBuffers=new(o("WAShiftTimer")).ShiftTimer(function(){n.finalizeBuffers__INTERNAL()}),this.serializePending=new(o("WAShiftTimer")).ShiftTimer(function(){n.serializePending__INTERNAL()}),this.forceSerializePending=function(){n.$4&&n.$11()&&n.serializePending.forceRunNow()},this.$1=t}var n=t.prototype;return n.initialize=function(t,n,r,a){if(this.$4){o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["WAM: Failed to initialize already initialized WAM"]))).sendLogs("wam-initialize");return}this.$7=a,this.$8=t,this.$9=r,this.$10=n,this.$11()&&this.serializePending.forceRunNow(),this.$4=!0,o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["WAM: Initialized with stream id ",""])),this.$8)},n.finalizeBuffers__INTERNAL=function(){this.$5.forEach(function(e){e.finalize()}),this.$5.size>0&&this.serializePending.onOrBefore(b)},n.$12=function(t){var e;return(e=this.$7)!=null&&e.multipleSequences?t===E?"null-psid":t:"regular"},n.$13=function(t){var e=this.$5.get(t);if(e)return e;var n=this.$12(t);if(this.$10==null){o("WALogger").ERROR(c||(c=babelHelpers.taggedTemplateLiteralLoose(["WAM: Sequence number generator not initialised for channel ",""])),this.$1).sendLogs("wam-serializePending");return}var r=this.$10(n);if(e=new(o("WAWamBuffer")).WamBuffer(this.$1,this.$8,r,this.$3),this.$5.set(t,e),t!=="regular")if(this.$6==null)o("WALogger").ERROR(d||(d=babelHelpers.taggedTemplateLiteralLoose(["WAM: Tried to create a private buffer without setting private stats ids"]))).sendLogs("wam-serializePending");else{var a=t===E?k:this.$6.get(t);a==null?o("WALogger").ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["WAM: Tried to create a private buffer without setting private stats id"]))).sendLogs("wam-serializePending"):e.writeGlobal(R,a)}return e},n.serializePending__INTERNAL=function(){var e=this,t=[];this.finalizeBuffers.onOrBefore(C);var n=new Map,r=-1;this.$2.forEach(function(a,i){if(a.type===v){var l=!0;n.forEach(function(e){o("WAWamBuffer").canWriteGlobal(e)||(l=!1)});var s=o("WAWamBuffer").canWriteEvent(a.fields);if(s&&l){var u;switch(e.$1){case"regular":case"realtime":{u=e.$13("regular");break}default:e.$1,a.psIdIntValue==null?o("WALogger").ERROR(p||(p=babelHelpers.taggedTemplateLiteralLoose(["A WAM event in channel private was dropped before serialization. Reason: missing psIdIntValue in the event payload"]))).sendLogs("wam-serializePending"):u=e.$13(a.psIdIntValue)}u!=null&&(n.forEach(function(t,n){var r=e.$3.get(n);(r===void 0||r!==t)&&(e.$5.forEach(function(e){return e.writeGlobal(n,t)}),e.$3.set(n,t))}),n.clear(),u.writeEvent(a.commitTime,a.id,a.fields,a.weight))}else o("WALogger").WARN(_||(_=babelHelpers.taggedTemplateLiteralLoose(["A WAM event in channel "," was dropped before serialization. Event correct: ",", pending attributes correct: ",""])),e.$1,s,l).devConsole("pending attributes",n,"pending event action",a);a.resolve!=null&&t.push(a.resolve),r=i}else{a.type;for(var c=0;c<a.delta.length;++c){var d=a.delta[c],m=d[0],f=d[1];n.set(m,f)}}});var a=!1;this.$5.forEach(function(e){(e.isFinalized()||e.getSize()>y)&&(a=!0)});var i=[];this.$5.forEach(function(t,n){t.hasEvents()?i.push([t.getKey(),t.peek(),e.$12(n)]):o("WALogger").WARN(f||(f=babelHelpers.taggedTemplateLiteralLoose(["Skipping putting buffer to sink, as it does not contain any events"])))});var l=o("WAPromiseEach").promiseEach(i,function(t){var n=t[0],r=t[1],o=t[2];return e.$9.putBuffer(n,r,a,o)}).then(function(){t.forEach(function(e){return void e()})});return this.$2=this.$2.slice(r+1),a&&(this.$5=new Map,this.finalizeBuffers.cancel()),l},n.$11=function(){return this.$2.length>0&&this.$2.some(function(e){return e.type===v})},n.isInitialized=function(){return this.$4},n.getStreamId=function(){return this.$8},n.getPendingActions=function(){return this.$2},n.getBuffers__INTERNAL=function(){return this.$5},n.getGlobals__INTERNAL=function(){return this.$3},n.setGlobals__INTERNAL=function(t){this.$3=t},n.getSink__INTERNAL=function(){return this.$9},n.updatePrivateStatsIds=function(t){if(this.$1!=="private"){o("WALogger").ERROR(g||(g=babelHelpers.taggedTemplateLiteralLoose(["WAM: Tried to set private stats ids on a non-private channel"]))).sendLogs("wam-updatePrivateStatsIds");return}this.$6=t},t})();l.PRIVATE_STATS_DEFAULT_PS_ID_KEY_HASH_INT=L,l.Wam=T}),98);
__d("WAWamChannelManager",[],(function(t,n,r,o,a,i){"use strict";var e=(function(){function e(){this.$1=new Map,this.$2=new Map}var t=e.prototype;return t.getChannelInitialized=function(t){return this.$2.get(t)||!1},t.setChannelInitialized=function(t){this.$2.set(t,!0)},t.isSinkBusy=function(t){return this.$1.get(t)||!1},t.setSinkBusy=function(t,n){this.$1.set(t,n)},t.close=function(){var e=this;this.$1.forEach(function(t,n){e.$1.set(n,!1)}),this.$2.forEach(function(t,n){e.$2.set(n,!1)})},e})(),l;function s(){return l==null&&(l=new e),l}function u(){l!=null&&l.close()}i.getChannelManager=s,i.closeChannelManager=u}),66);
__d("WAWamManager",["WALogger","WAWam"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c=65535,d=(function(){function t(e){this.$1=new Map,this.$2=e}var n=t.prototype;return n.$3=function(t,n){n==null||n===0?this.$1.set(t,"uninitialized"):n<0?this.$1.set(t,"uninitialized"):this.$1.set(t,n)},n.getSequenceNumber__INTERNAL=function(){return this.$1},n.initializeForChannel=function(n,r){var t=this;r.forEach(function(r,a){var i;if(n==="regular"&&a==="regular")t.$3(a,r);else if(n==="realtime"&&a==="realtime")t.$3(a,r);else if(n==="private"&&a!=="regular"&&a!=="realtime")t.$3(a,r);else if(n==="private"&&!((i=t.$2)!=null&&i.multipleSequences))t.$3(a,r);else{var l;o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["SequenceNumberGenerator::initializeForChannel: Incorrect combination of parameters: "," "," ",""])),n,a,(l=t.$2)==null?void 0:l.multipleSequences)}})},n.next=function(t){var e=this.$1.get(t),n;return e==null||e==="uninitialized"?n=1:(n=e+1,n>c&&(n=1)),this.$1.set(t,n),n},t})(),m=(function(){function e(){this.$1=new Map,this.$2=null}var t=e.prototype;return t.getWamInstance=function(t){var e=this.$1.get(t);return e||(e=new(o("WAWam")).Wam(t),this.$1.set(t,e)),e},t.initialize=function(t,n,r,a,i){var e=this.getWamInstance(t);if(e.isInitialized()){o("WALogger").WARN(s||(s=babelHelpers.taggedTemplateLiteralLoose(["WAM instance for channel "," has already been initialized"])),t);return}this.$2==null&&(this.$2=new d(i));var l=this.$2;this.$2.initializeForChannel(t,r),e.initialize(n,function(e){return l.next(e)},a,i)},t.deinitialize=function(){this.$1.forEach(function(e,t){e.isInitialized()&&(o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["WamManager: Deinitializing WAM Channel ",""])),t),e.deinitialize())}),this.$2=null},t.enqueueEvent=function(t,n,r,o,a,i,l){var e=this.getWamInstance(t);e.enqueueEvent(n,r,o,a,i,l)},t.enqueueAttributesUpdate=function(t,n){var e=this.getWamInstance(t);e.enqueueAttributesUpdate(n)},t.updatePrivateStatsIds=function(t){var e=this.getWamInstance("private");e.updatePrivateStatsIds(t)},t.forceFlushBuffers=function(){this.$1.forEach(function(e){e.forceSerializePending()})},t.rotateBuffers=function(){this.$1.forEach(function(e){e.finalizeBuffers.forceRunNow()})},t.getSequenceNumberGenerator__INTERNAL=function(){return this.$2},e})();l.WamManager=m}),98);
__d("WAWamUtils",["WABase64","WALogger","WAWamTypes","err"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c=(e={},e[(u=o("WAWamTypes")).TYPES.INT]="number",e[u.TYPES.FLOAT]="number",e[u.TYPES.STRING]="string",e[u.TYPES.BOOL]="boolean",e);function d(e,t){if(t==null||t.length===0)return e;for(var n=new Map,r=0;r<e.length;r+=3){var o=e[r];n.set(o,r)}for(var a=0;a<t.length;++a){var i=t[a],l=i[0],s=i[1],u=i[2];if(u!=null){var d=n.get(l);if(d!=null){var m=e[d+2];if(m!==void 0)continue}var p=c[s];p===typeof u&&(d==null?(n.set(l,e.length),e.push(l,s,u)):e[d+2]=u)}}return e}function m(e){for(var t=new Map,n=new Map,a=0;a<e.length;a+=4){var i=e[a],l=e[a+1],u=e[a+2],c=e[a+3];if(u===o("WAWamTypes").TYPES.FLOAT)throw r("err")("Float attributes are currently not supported in runtime");if(!Array.isArray(i)){o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["logAttributes WAM channel is not an array"]))).sendLogs("wam-log-attributes");return}i.includes("regular")&&t.set(l,c),i.includes("private")&&n.set(l,c)}return{deltaRegular:t,deltaPrivate:n}}function p(e,t){var n=[];return t.forEach(function(t){var r=t.channel;if(r==null){if(e!=="regular")return}else if(r!==e)return;if(t.finished){var a=new Uint8Array(o("WABase64").decodeB64(t.buffer)),i=t.key;n.push({key:i,content:a})}}),n}function _(e){return JSON.stringify([e.streamId,e.sequenceNumber,e.channel])}function f(e,t,n,r,a){var i=_(e);return{bufferKey:i,meta:{streamId:e.streamId,sequenceNumber:e.sequenceNumber},bufferRow:{key:i,channel:t,streamId:n,buffer:o("WABase64").encodeB64(r),finished:a}}}function g(e){var t=null;return e&&(t=e.sequenceNumber),t}l.appendRawFields=d,l.getDeltaFromAttributes=m,l.getFinishedBuffers=p,l.asBufferEntry=f,l.getSequenceNumber=g}),98);
__d("WAWamEntrypoint",["Promise","WALogger","WAWamManager","WAWamUtils"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c,d=1,m=!1,p=null;function _(){return p||(p=new(o("WAWamManager")).WamManager),p}function f(){m=!0}function g(e,t,n,r,o){_().initialize(n,e,t,r,o)}function h(){_().deinitialize()}function y(t,n,r,a,i,l,s){l===void 0&&(l=d);var u=Date.now();m&&s!=null&&o("WALogger").DEV(e||(e=babelHelpers.taggedTemplateLiteralLoose(["wamEntrypoint: log"]))).devConsole(babelHelpers.extends({},s,{id:n,arrayFields:a,rawFields:i,weight:l})),_().enqueueEvent(t,n,u,r,o("WAWamUtils").appendRawFields(a,i),l)}function C(e,t,r,a,i,l,u){l===void 0&&(l=d);var p=Date.now();return m&&u!=null&&o("WALogger").DEV(s||(s=babelHelpers.taggedTemplateLiteralLoose(["wamEntrypoint: logAsync"]))).devConsole(babelHelpers.extends({},u,{id:t,arrayFields:a,rawFields:i,weight:l})),new(c||(c=n("Promise")))(function(n){_().enqueueEvent(e,t,p,r,o("WAWamUtils").appendRawFields(a,i),l,n)})}function b(e,t){var n=o("WAWamUtils").getDeltaFromAttributes(e);if(n!=null){var r=n.deltaRegular,a=n.deltaPrivate;m&&t!=null&&o("WALogger").DEV(u||(u=babelHelpers.taggedTemplateLiteralLoose(["wamEntrypoint: logAttributes"]))).devConsole(babelHelpers.extends({},t,{attributes:e,deltaRegular:r,deltaPrivate:a})),r.size>0&&_().enqueueAttributesUpdate("regular",r),a.size>0&&_().enqueueAttributesUpdate("private",a)}}function v(e){_().updatePrivateStatsIds(e)}function S(){_().forceFlushBuffers()}function R(){_().rotateBuffers()}l.enableDebugMode=f,l.initializeWAM=g,l.deinitializeWAM=h,l.log=y,l.logAsync=C,l.logAttributes=b,l.updatePrivateStatsIds=v,l.forceFlushBuffers=S,l.rotateBuffers=R}),98);
__d("WAWamStorage",["Promise","WALogger","WATimeUtils","WAWamChannelManager","WAWamEntrypoint","WAWamUtils","err"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c,d,m,p,_=null,f=null;function g(e){if(f)return f;throw r("err")("WamStorage::"+e+" called before startWamStorage")}function h(t){f==null?f=t:o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[wam] startWamStorage: called again"]))).sendLogs("startWamStorage")}function y(){o("WAWamEntrypoint").deinitializeWAM(),o("WAWamChannelManager").closeChannelManager(),f=null,_=null}function C(e,t,a,i){var l=g("initializeWAMSink"),d=o("WAWamChannelManager").getChannelManager();if(d.getChannelInitialized(t))return(p||(p=n("Promise"))).resolve();d.setChannelInitialized(t);var m=l.getStreamId(e),f={putBuffer:function(r,i,_,f){if(d.isSinkBusy(t))return o("WALogger").WARN(s||(s=babelHelpers.taggedTemplateLiteralLoose(["WamStorage: Sink flush did not happen within timeout, buffer is not saved"]))),(p||(p=n("Promise"))).resolve();d.setSinkBusy(t,!0);var e=o("WAWamUtils").asBufferEntry(r,t,m,i,_),g=e.bufferKey,h=e.meta,y=e.bufferRow;return l.saveBuffer(h,y,f).then(function(){var e=[r.streamId,r.sequenceNumber];o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["WamStorage: Successfully put buffer "," to sink"])),e),_&&(a(),o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["WamStorage: Buffer "," is scheduled for send"])),g))}).finally(function(){d.setSinkBusy(t,!1)})}};return _==null&&(_=l.finishBuffer(m)),_.then(function(){if(l.getStartingSequenceNumbers)return l.getStartingSequenceRow,l.getStartingSequenceNumbers(t,m);if(l.getStartingSequenceRow,i!=null&&i.multipleSequences)throw r("err")("getStartingSequenceRow must not used when enabling support for multiple sequences");return l.getStartingSequenceRow(m).then(function(e){var t=o("WAWamUtils").getSequenceNumber(e),n=new Map;return n.set("regular",t),n})}).then(function(e){o("WAWamEntrypoint").initializeWAM(m,e,t,f,i),t==="private"&&l.updatePrivateStatsIds&&l.updatePrivateStatsIds().then(o("WAWamEntrypoint").updatePrivateStatsIds)})}function b(e){return g("getFinishedStreamBuffers").getBuffers().then(function(t){return o("WAWamUtils").getFinishedBuffers(e,t)})}var v=64,S=function(t,n){var e=(n==null?void 0:n.maxRedeemCount)!=null&&n.maxRedeemCount!==0?n.maxRedeemCount:v,r=(n==null?void 0:n.maxExpirySeconds)!=null&&n.maxExpirySeconds!==0?n.maxExpirySeconds:o("WATimeUtils").DAY_SECONDS,a={maxRedeemCount:e,maxExpirySeconds:r};return o("WATimeUtils").happenedWithin(t.creationTs,a.maxExpirySeconds)?t.redeemCount>=a.maxRedeemCount?(o("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["The private stats token was redeemed maximum number of time. The client shall re-issue a new one"]))),!1):!0:(o("WALogger").LOG(d||(d=babelHelpers.taggedTemplateLiteralLoose(["The private stats token expired. The client shall re-issue a new one"]))),!1)};function R(){var e=g("getPrivateStatsToken");if(!e.redeemPrivateStatsToken)throw r("err")("redeemPrivateStatsToken not implemented for WAM DB");return e.redeemPrivateStatsToken(S)}function L(e){var t=g("savePrivateStatsToken");if(!t.savePrivateStatsToken)throw r("err")("savePrivateStatsToken not implemented for WAM DB");return t.savePrivateStatsToken(e)}function E(){var e=g("privateStatsKillSwitchGetBlockedToken");if(!e.privateStatsKillSwitchGetBlockedToken)throw r("err")("privateStatsKillSwitchGetBlockedToken not implemented for WAM DB");return e.privateStatsKillSwitchGetBlockedToken()}function k(e){var t=g("privateStatsKillSwitchSet");if(!t.privateStatsKillSwitchSet)throw r("err")("privateStatsKillSwitchSet not implemented for WAM DB");return t.privateStatsKillSwitchSet(e)}function I(e){return g("removeBufferByKey").removeBufferByKey(e)}function T(){return g("nukeMetrics").nukeMetrics()}l.startWamStorage=h,l.closeWamStorage=y,l.initializeWAMSink=C,l.getFinishedStreamBuffers=b,l.redeemPrivateStatsToken=R,l.savePrivateStatsToken=L,l.privateStatsKillSwitchGetBlockedToken=E,l.privateStatsKillSwitchSet=k,l.removeBufferByKey=I,l.nukeMetrics=T}),98);
__d("WAWebClientExposureGatingUtils",["WAWebABProps"],(function(t,n,r,o,a,i,l){"use strict";function e(){return o("WAWebABProps").getABPropConfigValue("enable_wefr_client_expo_pulse")}l.clientExposurePulseLoggingEnabled=e}),98);
__d("WAWebWefrClientExposureWamEvent",["WAWebWamCodegenUtils"],(function(t,n,r,o,a,i,l){var e,s=(e=o("WAWebWamCodegenUtils")).defineEvents({WefrClientExposure:[5504,{deviceExpId:[5,e.TYPES.STRING],exposureKey:[1,e.TYPES.STRING],isCanonicalEntPresent:[6,e.TYPES.BOOLEAN],sentWithDaily:[3,e.TYPES.BOOLEAN],userLid:[4,e.TYPES.INTEGER]},[1,1,1],"realtime"]},{WefrClientExposure:[]});l.WefrClientExposureWamEvent=s}),98);
__d("WAWebABPropsGlobals",["WAWebABProps","WAWebClientExposureGatingUtils","WAWebDebounce","WAWebNetworkStatus","WAWebWamGlobals","WAWebWefrClientExposureWamEvent","justknobx"],(function(t,n,r,o,a,i,l){var e=1e3,s=new Set,u=new Set,c="";function d(){if(o("WAWebABProps").getABPropConfigValue("wam_disable_expokey_attribute"))o("WAWebWamGlobals").Global.set({expoKey:null});else{var e=g();c!==e&&o("WAWebClientExposureGatingUtils").clientExposurePulseLoggingEnabled()&&(f(e),c=e),o("WAWebWamGlobals").Global.set({expoKey:e})}}function m(e){o("WAWebABProps").getABPropConfigValue("wam_disable_abkey_attribute")?o("WAWebWamGlobals").Global.set({abKey2:null}):e!=null&&o("WAWebWamGlobals").Global.set({abKey2:e})}function p(e){r("justknobx")._("1964")?r("WAWebNetworkStatus").waitIfOffline().then(function(){new(o("WAWebWefrClientExposureWamEvent")).WefrClientExposureWamEvent(e).commit()}):new(o("WAWebWefrClientExposureWamEvent")).WefrClientExposureWamEvent(e).commit()}function _(){if(o("WAWebClientExposureGatingUtils").clientExposurePulseLoggingEnabled()){var e=g();p({exposureKey:e,sentWithDaily:!0})}}var f=r("WAWebDebounce")(function(e){p({exposureKey:e,sentWithDaily:!1})},e);function g(){return Array.from(u).join(",")}l.CLIENT_EXPOSURE_PULSE_DEBOUNCE_MS=e,l.accessedConfigs=s,l.exposureKeys=u,l.updateGlobalExpoKey=d,l.updateGlobalABKey=m,l.logClientExposurePulseEventFromDailyStatsTask=_,l.combineExposuresIntoExpoKey=g}),98);
__d("WAWebApiAbPropConfig",["Promise","WALogger","WAWebABPropsConfigs","WAWebABPropsGlobals","WAWebModelStorageInitialize","WAWebModelStorageUtils","WAWebSchemaAbPropConfig","asyncToGeneratorRuntime","cr:21223","err"],(function(t,n,r,o,a,i,l){var e,s,u;function c(){return o("WAWebModelStorageInitialize").initializeWithoutGKs().then(function(){return o("WAWebSchemaAbPropConfig").getAbpropConfigsTable().all().then(function(e){return e})})}function d(e,t,n){return e==null||t==null?n:t==="bool"?e==="1"||e==="True"||e==="true":t==="int"?parseInt(e,10):t==="float"?parseFloat(e):e}function m(t){var a=o("WAWebABPropsConfigs").ABPropConfigs[t];if(a==null)return o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["invalid ABProps config name"]))).verbose().sendLogs("invalid ABProps config name: "+t),(u||(u=n("Promise"))).reject(r("err")("invalid ABProps config name"));var i=a[0],l=a[1],s=a[2],c=a[3],m=s;return o("WAWebModelStorageInitialize").initializeWithoutGKs().then(function(){return o("WAWebSchemaAbPropConfig").getAbpropConfigsTable().get(String(i)).then(function(e){var t=e?d(e.configValue,l,m):m;return t})})}function p(e,t){return o("WAWebModelStorageUtils").getStorage().lock(["abpropConfigs"],(function(){var r=n("asyncToGeneratorRuntime").asyncToGenerator(function*(n){var r=n[0],a=yield r.all(),i=new Map;a.forEach(function(e){(e.configExpoKey!=null||e.overriddenConfigValue!=null)&&i.set(e.configCode,{configCode:e.configCode,configValue:e.configValue,configExpoKey:e.configExpoKey,hasAccessed:e.hasAccessed,overriddenConfigValue:e.overriddenConfigValue})});var l=!1,s=[];return e.forEach(function(e,t){var n=!1,r=i.get(String(t));if(r){var a=r.configExpoKey;a!=null&&e.configExpoKey!==a?(o("WAWebABPropsGlobals").exposureKeys.delete(a),l=!0,o("WAWebABPropsGlobals").accessedConfigs.delete(t)):a!=null&&(n=r.hasAccessed)}s.push({configCode:String(t),configValue:e.configValue,configExpoKey:e.configExpoKey,hasAccessed:n,overriddenConfigValue:r==null?void 0:r.overriddenConfigValue})}),l&&o("WAWebABPropsGlobals").updateGlobalExpoKey(),t?yield r.bulkCreateOrReplace(s):(yield r.clear(),yield r.bulkCreate(s)),a});return function(e){return r.apply(this,arguments)}})()).then((function(){var r=n("asyncToGeneratorRuntime").asyncToGenerator(function*(r){if(n("cr:21223")&&!t)try{yield n("cr:21223")==null?void 0:n("cr:21223").processAbpropChangelog(r,e)}catch(e){o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["Failed to record ABProp diff ",""])),e)}});return function(e){return r.apply(this,arguments)}})())}function _(e){return f.apply(this,arguments)}function f(){return f=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=yield o("WAWebSchemaAbPropConfig").getAbpropConfigsTable().get(String(e));t==null||(t==null?void 0:t.hasAccessed)===!0||(yield o("WAWebSchemaAbPropConfig").getAbpropConfigsTable().merge(String(e),{hasAccessed:!0}))}),f.apply(this,arguments)}l.getABPropConfigs=c,l.parseConfigValue=d,l.getConfigValue=m,l.updateABPropConfigs=p,l.setConfigAccessed=_}),98);
__d("WAWebABPropsCache",["WALogger","WAResolvable","WAWebABProps","WAWebABPropsConfigs","WAWebABPropsGlobals","WAWebApiAbPropConfig","WAWebRuntimeEnvironmentUtils","cr:4941","gkx"],(function(t,n,r,o,a,i,l){var e,s=new Map,u=new(o("WAResolvable")).Resolvable,c;function d(e){return c==null&&(c={},Object.keys(o("WAWebABPropsConfigs").ABPropConfigs).forEach(function(e){var t=o("WAWebABPropsConfigs").ABPropConfigs[e],n=t[0];c[n]=e}),Object.freeze(c)),c[e]}function m(){o("WAWebABProps").setGetABPropConfigValueImpl(p)}function p(t){var a=o("WAWebABPropsConfigs").ABPropConfigs[t],i=a[0],l=a[1],s=a[2],c=a[3],d=s;if(!r("gkx")("26258")&&!o("WAWebRuntimeEnvironmentUtils").isWorker()&&n("cr:4941")){var m=new(n("cr:4941"))(window.location.search),p=m.get(t);if(p!=null&&p!=="")return o("WAWebApiAbPropConfig").parseConfigValue(p,l,d)}return u.resolveWasCalled()?f(i):(o("WAWebABProps").usedBeforeInitializationConfigs.includes(t)||o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[abprops] configs need to be initialized before its first access, config name: ",""])),t),d)}function _(e){if(s.get(e)&&!o("WAWebABPropsGlobals").accessedConfigs.has(e)){var t,n=(t=s.get(e))==null?void 0:t.configExpoKey;n!=null&&!o("WAWebABPropsGlobals").exposureKeys.has(n)&&(o("WAWebABPropsGlobals").exposureKeys.add(n),o("WAWebABPropsGlobals").updateGlobalExpoKey()),o("WAWebABPropsGlobals").accessedConfigs.add(e),self.setTimeout(function(){return o("WAWebApiAbPropConfig").setConfigAccessed(e)},0)}}function f(e){_(e);var t=s.get(e);return!r("gkx")("26258")&&(t==null?void 0:t.overriddenConfigValue)!=null?t.overriddenConfigValue:t==null?void 0:t.configValue}function g(){return Array.from(s.values())}function h(){return s}function y(e){var t=!1;e.forEach(function(e){s.set(e.configCode,e),e.hasAccessed===!0&&(o("WAWebABPropsGlobals").accessedConfigs.add(e.configCode),e.configExpoKey!=null&&(o("WAWebABPropsGlobals").exposureKeys.add(e.configExpoKey),t=!0))}),t&&o("WAWebABPropsGlobals").updateGlobalExpoKey(),u.resolve()}function C(){return u.promise}function b(){s.clear(),o("WAWebABPropsGlobals").accessedConfigs.clear(),o("WAWebABPropsGlobals").exposureKeys.clear(),u=new(o("WAResolvable")).Resolvable}l.getABPropConfigNameFromCode=d,l.initializeABPropsCache=m,l.saveExposure=_,l.getAllABPropConfigs=g,l.getAllABPropsMap=h,l.bulkCreateOrReplaceABPropConfigs=y,l.waitForABPropConfigsReady=C,l.clearABPropConfigs=b}),98);
__d("WAWebABPropsUpdateFromStorage",["WALogger","WAWebABPropsCache","WAWebABPropsConfigs","WAWebABPropsGlobals","WAWebApiAbPropConfig","WAWebUserPrefsGeneral","asyncToGeneratorRuntime","gkx"],(function(t,n,r,o,a,i,l){var e,s,u,c;function d(){return m.apply(this,arguments)}function m(){return m=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){try{var t=!1,n=t;if(!r("gkx")("26258")){var a=yield o("WAWebUserPrefsGeneral").getWhatsAppWebExternalBetaJoinedIdb();r("gkx")("26259")&&a?(o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[abprops][intern] Web Beta joined, using DEBUG default AB prop values"]))),n=!0):t&&a&&(o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[abprops][dev] Web Beta joined, using NON-DEBUG default AB prop values (to simulate intern env)"]))),n=!1)}var i=yield o("WAWebApiAbPropConfig").getABPropConfigs(),l=i.map(function(e){var t=o("WAWebABPropsCache").getABPropConfigNameFromCode(Number(e.configCode));if(t==null)o("WALogger").WARN(u||(u=babelHelpers.taggedTemplateLiteralLoose(["[abprops] ABProp (code: ",") exists in storage but no longer available for this client version"])),e.configCode);else{var a=o("WAWebABPropsConfigs").ABPropConfigs[t],i=a[0],l=a[1],s=a[2],c=a[3],d=n?c:s,m=o("WAWebApiAbPropConfig").parseConfigValue(e.configValue,l,d),p;return!r("gkx")("26258")&&e.overriddenConfigValue!=null&&(p=o("WAWebApiAbPropConfig").parseConfigValue(e.overriddenConfigValue,l,d)),{configCode:i,configValue:m,configExpoKey:e.configExpoKey,hasAccessed:e.hasAccessed,overriddenConfigValue:p}}}).filter(Boolean);o("WAWebABPropsCache").bulkCreateOrReplaceABPropConfigs(l),o("WAWebABPropsGlobals").updateGlobalExpoKey(),o("WAWebABPropsGlobals").updateGlobalABKey()}catch(e){o("WALogger").ERROR(c||(c=babelHelpers.taggedTemplateLiteralLoose(["[abprops] Failed to update ABProps configs cache from storage: ",""])),e).verbose().sendLogs("[abprops] Failed to update ABProps configs cache from storage: "+e)}}),m.apply(this,arguments)}l.updateABPropsFromStorage=d}),98);
__d("WAWebABPropsWamGlobals",["WAWebABProps","WAWebWamGlobals"],(function(t,n,r,o,a,i,l){function e(){o("WAWebWamGlobals").Global.set({serviceImprovementOptOut:o("WAWebABProps").getABPropConfigValue("service_improvement_opt_out_flag")})}l.setAbPropDependingGlobalWamAttributes=e}),98);
__d("WAWebAbPropsParsingJob",["WAWebABPropsConfigs"],(function(t,n,r,o,a,i,l){function e(e,t){var n=new Map;e.forEach(function(e){var t=e.configCode,r=e.configValue,o=e.configExpoKey;n.set(t,{configValue:r,configExpoKey:o})});var r=new Map;return Object.keys(o("WAWebABPropsConfigs").ABPropConfigs).map(function(e){var a=o("WAWebABPropsConfigs").ABPropConfigs[e][0],i=n.get(a);if(!(i==null&&t)){var l=i==null?void 0:i.configValue,s=i==null?void 0:i.configExpoKey;r.set(a,{configValue:l,configExpoKey:s==null?null:s.toString()})}}),r}l.parseABProps=e}),98);
__d("WAWebApiAbPropEventSamplingConfig",["Promise","WAWebModelStorageInitialize","WAWebModelStorageUtils","WAWebSchemaAbPropEventSamplingConfig"],(function(t,n,r,o,a,i,l){var e;function s(){return o("WAWebModelStorageInitialize").initializeWithoutGKs().then(function(){return o("WAWebSchemaAbPropEventSamplingConfig").getAbpropEventSamplingConfigsTable().all().then(function(e){return e})})}function u(e){return o("WAWebModelStorageInitialize").initializeWithoutGKs().then(function(){return o("WAWebSchemaAbPropEventSamplingConfig").getAbpropEventSamplingConfigsTable().get(e).then(function(e){return e==null?void 0:e.samplingWeight})})}function c(t){if(t==null||t.length===0)return(e||(e=n("Promise"))).resolve(!1);var r=[];return t.forEach(function(e){r.push({eventCode:e.eventCode,samplingWeight:e.samplingWeight})}),o("WAWebModelStorageUtils").getStorage().lock(["abprop-event-sampling-configs"],function(e){var t=e[0];return t.clear().then(function(){return t.bulkCreate(r).then(function(){return!0})})})}l.getEventSamplingConfigs=s,l.getEventSamplingWeight=u,l.updateEventSamplingConfigs=c}),98);
__d("WAWebEncryptedRid",["WABase64","WAWebUserPrefsIndexedDBStorage","WAWebUserPrefsMultiDevice"],(function(t,n,r,o,a,i,l){function e(e){return o("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.set("WAWebEncryptedRid",o("WABase64").encodeB64(e))}function s(){return o("WAWebUserPrefsMultiDevice").isRegistered()?o("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.get("WAWebEncryptedRid"):null}l.setEncryptedRid=e,l.getEncryptedRid=s}),98);
__d("WAWebEventSampling",["WALogger"],(function(t,n,r,o,a,i,l){"use strict";var e,s=null;function u(e){return s==null?null:s(e)}function c(t){var n=u(t);return n!=null?(o("WALogger").DEV(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[EventSampling] override event sampling weight for ",": ",""])),t,n),Math.abs(n)):null}function d(e){s=e}l.getClientEventSamplingWeight=c,l.setGetEventSamplingConfigValueImpl=d}),98);
__d("WAWebEventSamplingCache",["WAWebApiAbPropEventSamplingConfig","WAWebEventSampling","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){"use strict";var e=new Map,s=!1;function u(t){return s?e.get(t):null}function c(){o("WAWebEventSampling").setGetEventSamplingConfigValueImpl(u)}function d(){return m.apply(this,arguments)}function m(){return m=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var t=yield o("WAWebApiAbPropEventSamplingConfig").getEventSamplingConfigs();t.forEach(function(t){e.set(t.eventCode,t.samplingWeight)}),s=!0}),m.apply(this,arguments)}l.initializeEventSamplingCache=c,l.updateEventSamplingFromStorage=d}),98);
__d("WAWebStoreSpecialAbProps",["WALogger","WAWebABProps","WAWebLocalStorage","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s=["web_apply_latest_db_schema_optimization_enabled","wa_web_favicons_update_m1","web_ui_refresh_m1","web_retry_quota_exceeded_idb_writes"],u="abprops_needed_early";function c(){return d.apply(this,arguments)}function d(){return d=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){try{var t=s.reduce(function(e,t){var n=o("WAWebABProps").getABPropConfigValue(t);return n!=null&&(e[t]=n),e},{});r("WAWebLocalStorage")==null||r("WAWebLocalStorage").setItem(u,JSON.stringify(t))}catch(t){o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["Failed to store special early abprops"]))).sendLogs(t)}}),d.apply(this,arguments)}l.storeSpecialAbProps=c}),98);
__d("WAWebUserPrefsUiRefresh",["WALogger","WAWebUserPrefsKeys","WAWebUserPrefsStore"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u;function c(e){r("WAWebUserPrefsStore").set(o("WAWebUserPrefsKeys").UserPrefs.WebUiRefreshNuxAcknowledged,e)}function d(){return r("WAWebUserPrefsStore").get(o("WAWebUserPrefsKeys").UserPrefs.WebUiRefreshNuxAcknowledged)===!0}function m(){var t=p();r("WAWebUserPrefsStore").set(o("WAWebUserPrefsKeys").UserPrefs.WebUiRefreshNuxViewsCount,t+1),o("WALogger").DEV(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[ui-refresh] Incremented nux view count: "," -> ",""])),t,t+1)}function p(){var e=r("WAWebUserPrefsStore").get(o("WAWebUserPrefsKeys").UserPrefs.WebUiRefreshNuxViewsCount);if(e==null)return 0;var t=parseInt(e,10);return isNaN(t)||t<0?(o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[ui-refresh] Invalid nux view count - returning 0"]))),0):t}function _(){r("WAWebUserPrefsStore").set(o("WAWebUserPrefsKeys").UserPrefs.WebUiRefreshNuxViewsCount,0),o("WALogger").DEV(u||(u=babelHelpers.taggedTemplateLiteralLoose(["[ui-refresh] Reset nux view count to 0"])))}l.setUiRefreshNuxAcked=c,l.getUiRefreshNuxAcked=d,l.incrementNuxViewCount=m,l.getNuxViewCount=p,l.resetNuxViewCount=_}),98);
__d("WAWebSyncOnABProps",["WALogger","WAWebABProps","WAWebABPropsWamGlobals","WAWebProtobufsE2E.pb","WAWebStoreSpecialAbProps","WAWebUserPrefsAppStateSync","WAWebUserPrefsCTWA","WAWebUserPrefsTypes","WAWebUserPrefsUiRefresh","asyncToGeneratorRuntime","cr:254"],(function(t,n,r,o,a,i,l){var e,s,u=(e=n("cr:254"))!=null?e:{},c=u.sendPeerDataOperationRequest;function d(e){e!==o("WAWebABProps").getABPropConfigValue("service_improvement_opt_out_flag")&&o("WAWebABPropsWamGlobals").setAbPropDependingGlobalWamAttributes()}function m(){return p.apply(this,arguments)}function p(){return p=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=yield o("WAWebUserPrefsAppStateSync").getNonCriticalDataSyncStatus();(e==null?void 0:e[o("WAWebUserPrefsTypes").NonCriticalDataSyncStatusType.RECENT_STICKER_INITIALIZED])===o("WAWebUserPrefsTypes").RecentStickerInitializedStatusType.NEED_REQUEST_BOOTSTRAP&&(o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["Recent Stickers: request peer message for recent sticker bootstrap."]))),yield c==null?void 0:c(o("WAWebProtobufsE2E.pb").Message$PeerDataOperationRequestType.SEND_RECENT_STICKER_BOOTSTRAP,{}))}),p.apply(this,arguments)}function _(e){var t=o("WAWebABProps").getABPropConfigValue("ctwa_ad_account_token_storage_kill_switch_web");t===!0&&e===!1&&o("WAWebUserPrefsCTWA").clearAdAccountToken()}function f(e){var t=o("WAWebABProps").getABPropConfigValue("web_ui_refresh_m1");e===!0&&t===!1&&(o("WAWebUserPrefsUiRefresh").resetNuxViewCount(),o("WAWebUserPrefsUiRefresh").setUiRefreshNuxAcked(!1),o("WAWebStoreSpecialAbProps").storeSpecialAbProps())}l.handleServiceImprovementOptOutFlagABPropConfigValueChange=d,l.ensureNonCriticalDataSyncIsInitialized=m,l.handleAdAccountTokenStorageKillSwitchABPropConfigValueChange=_,l.handleUIRefreshNuxOnABPropConfigValueChange=f}),98);
__d("WAWebAbPropsSyncJob",["Promise","WAGetAbPropsProtocol","WALogger","WAPromiseDelays","WAWebABProps","WAWebABPropsGlobals","WAWebABPropsLocalStorage","WAWebABPropsUpdateFromStorage","WAWebAbPropsParsingJob","WAWebApiAbPropConfig","WAWebApiAbPropEventSamplingConfig","WAWebCmd","WAWebEncryptedRid","WAWebEventSamplingCache","WAWebSyncOnABProps","WAWebWorkerSafeBackendApi","asyncToGeneratorRuntime","justknobx"],(function(t,n,r,o,a,i,l){var e,s,u,c,d;o("WAWebCmd").Cmd.on("on_ab_props_update",(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t,n=e.partialPreviousABPropsValues,r=e.isInitialSync,a=n.service_improvement_opt_out_flag,i=n.ctwa_ad_account_token_storage_kill_switch_web,l=n.web_ui_refresh_m1;yield(t=o("WAWebSyncOnABProps")).ensureNonCriticalDataSyncIsInitialized(),t.handleServiceImprovementOptOutFlagABPropConfigValueChange(a),t.handleAdAccountTokenStorageKillSwitchABPropConfigValueChange(i),t.handleUIRefreshNuxOnABPropConfigValueChange(l),r&&(yield o("WAWebWorkerSafeBackendApi").workerSafeSendAndReceive("checkOrphanFavoriteStickers"))});return function(t){return e.apply(this,arguments)}})());var m={shouldSendHash:!0};function p(e){return _.apply(this,arguments)}function _(){return _=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var a=t.shouldSendHash,i=t.localRefreshId,l=r("justknobx")._("3330")&&i!=null,c=l?{propsRefreshId:i}:{propsHash:a?o("WAWebABPropsLocalStorage").getHash():void 0},m=yield o("WAGetAbPropsProtocol").getAbPropsProtocol(c);if(!m.success)return!1;var p=m.value,_=p.abKey,f=p.hash,g=p.refresh,h=p.refreshId,y=p.props,C=p.samplingConfigs,b=p.erid,v=p.isDeltaUpdate,S=b==null?(d||(d=n("Promise"))).resolve():o("WAWebEncryptedRid").setEncryptedRid(b);if(v&&!l?o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["syncABProps: received delta update response without responding to emergency push request"]))).sendLogs("abprops-requested-regular-received-delta"):!v&&l&&o("WALogger").WARN(s||(s=babelHelpers.taggedTemplateLiteralLoose(["syncABProps: received regular update response when responding to emergency push request"]))),!v){o("WAWebABPropsGlobals").updateGlobalABKey(_!=null?_:"");var R=Date.now();o("WAWebABPropsLocalStorage").updateAttributesLocalStorage(_,f,g,R)}if(h!=null&&o("WAWebABPropsLocalStorage").setRefreshId(h),f==null&&!v)return!1;try{return yield(d||(d=n("Promise"))).all([!v&&o("WAWebApiAbPropEventSamplingConfig").updateEventSamplingConfigs(C),o("WAWebApiAbPropConfig").updateABPropConfigs(o("WAWebAbPropsParsingJob").parseABProps(y,v),v),S]),!0}catch(e){o("WALogger").ERROR(u||(u=babelHelpers.taggedTemplateLiteralLoose(["update ABProps config table failed"]))).verbose().devConsole(e).sendLogs("update ABProps config table failed when syncing ABProps")}return!1}),_.apply(this,arguments)}function f(e){return g.apply(this,arguments)}function g(){return g=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){for(var t=o("WAWebABPropsLocalStorage").isABPropsAfterFirstSync(),r=3;r-- >0;)try{var a,i={service_improvement_opt_out_flag:(a=o("WAWebABProps")).getABPropConfigValue("service_improvement_opt_out_flag"),ctwa_ad_account_token_storage_kill_switch_web:a.getABPropConfigValue("ctwa_ad_account_token_storage_kill_switch_web"),web_ui_refresh_m1:a.getABPropConfigValue("web_ui_refresh_m1"),single_e2ee_session_migration_state_outgoing:a.getABPropConfigValue("single_e2ee_session_migration_state_outgoing")},l=e?babelHelpers.extends({},e):babelHelpers.extends({},m);l.localRefreshId==null&&(l.shouldSendHash=t&&l.shouldSendHash!==!1);var s=yield p(l);if(s){yield(d||(d=n("Promise"))).all([o("WAWebABPropsUpdateFromStorage").updateABPropsFromStorage(),o("WAWebEventSamplingCache").updateEventSamplingFromStorage()]),o("WAWebCmd").Cmd.onAbPropsUpdate({partialPreviousABPropsValues:i,isInitialSync:!t});return}}catch(e){r===0&&o("WALogger").ERROR(c||(c=babelHelpers.taggedTemplateLiteralLoose(["failed to sync ABProps"]))).verbose().devConsole(e).sendLogs("failed to sync ABProps"),yield o("WAPromiseDelays").delayMs(10*1e3*Math.random())}}),g.apply(this,arguments)}l.syncABProps=p,l.syncABPropsTask=f}),98);
__d("WAWebAccessibility.react",["react"],(function(t,n,r,o,a,i,l){var e,s,u=s||(s=o("react")),c=e||(e=r("react")),d=u.useEffect,m=u.useState;function p(e){var t=e.children;return c.jsx("span",{"aria-label":t})}p.displayName=p.name+" [from "+i.id+"]";function _(e){var t=e.assertive,n=t===void 0?!1:t,r=e.startWithText,o=r===void 0?!1:r,a=e.text,i=m(o?a:""),l=i[0],s=i[1];return d(function(){window.setTimeout(function(){s(a)},10)},[a]),c.jsx("span",{"aria-live":n?"assertive":"polite","aria-atomic":"true",className:"xzpqnlu x1hyvwdk xjm9jq1 x6ikm8r x10wlt62 x10l6tqk x1i1rx1s",children:l})}_.displayName=_.name+" [from "+i.id+"]";var f=function(t){var e=t.onClick,n=t.disabled,r=function(n){return e==null?void 0:e(n)},o=function(t){n!==!0&&r(t)},a=function(t){var e=t.key==="Enter"||t.key===" "||t.key==="Spacebar"||t.which===13||t.which===32;e&&(t.preventDefault(),r(t))};return{onClick:o,onKeyPress:a,disabled:n,tabIndex:n===!0?-1:0,role:"button"}};l.InvisibleLabel=p,l.InvisibleAnnouncement=_,l.accessibleClickableButtonProps=f}),98);
__d("WAWebAltDeviceLinkingBase32Encode",[],(function(t,n,r,o,a,i){var e="123456789ABCDEFGHJKLMNPQRSTVWXYZ";function l(t){for(var n=new DataView(t.buffer,t.byteOffset,t.byteLength),r=0,o=0,a="",i=0;i<n.byteLength;i++)for(o=o<<8|n.getUint8(i),r+=8;r>=5;)a+=e[o>>>r-5&31],r-=5;return r>0&&(a+=e[o<<5-r&31]),a}i.bytesToCrockford=l}),66);
__d("WAWebAltDeviceLinkingAlgorithm",["WAArrayBufferUtils","WABinary","WAByteArray","WACryptoHkdf","WALogger","WAWebAltDeviceLinkingApi","WAWebAltDeviceLinkingBase32Encode","WAWebCryptoCurve25519","WAWebSignalStoreApi","asyncToGeneratorRuntime","err"],(function(t,n,r,o,a,i,l){var e,s,u,c,d;function m(){o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["alt pairing: generate random code"])));var t=new Uint8Array(5);return self.crypto.getRandomValues(t),o("WAWebAltDeviceLinkingBase32Encode").bytesToCrockford(t)}function p(e,t){return _.apply(this,arguments)}function _(){return _=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){try{return yield e()}catch(e){var n;throw(n=o("WAWebAltDeviceLinkingApi").getCurrentMarker())==null||n.addPoint(t),e}}),_.apply(this,arguments)}function f(e,t,n){return g.apply(this,arguments)}function g(){return g=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n){n===void 0&&(n=!1);var r=new(o("WABinary")).Binary(t),a=yield self.crypto.subtle.deriveKey({name:"PBKDF2",hash:"SHA-256",salt:r.readBuffer(),iterations:2<<16},e,{name:"AES-CTR",length:256},n,["encrypt","decrypt"]);return a}),g.apply(this,arguments)}function h(e,t,n){return y.apply(this,arguments)}function y(){return y=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n){o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["alt pairing: encrypt companion hello"])));var r={name:"AES-CTR",length:64,counter:t},a=yield self.crypto.subtle.encrypt(r,n,e);return a}),y.apply(this,arguments)}function C(e,t,n){return b.apply(this,arguments)}function b(){return b=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n){o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["alt pairing: decrypt primary hello"])));var r={name:"AES-CTR",length:64,counter:t},a=yield p(function(){return self.crypto.subtle.decrypt(r,n,e)},"fail decrypt primary ephemeral pub");return a}),b.apply(this,arguments)}function v(){return S.apply(this,arguments)}function S(){return S=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=m(),t=yield o("WAWebCryptoCurve25519").keyPair(),n=new Uint8Array(32);self.crypto.getRandomValues(n);var r=new Uint8Array(16);self.crypto.getRandomValues(r);var a=yield R(e,t,n,r);return babelHelpers.extends({},a,{linkCodePairingSecret:e})}),S.apply(this,arguments)}function R(e,t,n,r){return L.apply(this,arguments)}function L(){return L=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n,r){var a=yield self.crypto.subtle.importKey("raw",new TextEncoder().encode(e),{name:"PBKDF2"},!1,["deriveKey"]),i=yield f(a,n),l=yield p(function(){return h(t.pubKey,r,i)},"fail encrypt companion hello"),s=new(o("WABinary")).Binary;s.writeByteArray(n),s.writeByteArray(r),s.writeByteArray(new Uint8Array(l));var u=s.readBuffer();return{linkCodePairingWrappedCompanionEphemeralPub:u,linkCodeKey:a,linkCodePairingCompanionADVEphemeralKeyPair:t}}),L.apply(this,arguments)}function E(e,t){return k.apply(this,arguments)}function k(){return k=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=yield o("WACryptoHkdf").extractWithSaltAndExpand(e,t,"link_code_pairing_key_bundle_encryption_key",32);return n}),k.apply(this,arguments)}function I(e,t,n){return o("WAArrayBufferUtils").concatBuffers([e,t,o("WAByteArray").uint8ArrayToBuffer(n)])}function T(e,t,n){return D.apply(this,arguments)}function D(){return D=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n){o("WALogger").LOG(d||(d=babelHelpers.taggedTemplateLiteralLoose(["alt pairing: encrypt key bundle"])));var r=yield self.crypto.subtle.importKey("raw",e,{name:"AES-GCM"},!1,["encrypt"]),a={name:"AES-GCM",iv:t},i=yield p(function(){return self.crypto.subtle.encrypt(a,r,n)},"fail encrypt wrapped key bundle");return i}),D.apply(this,arguments)}function x(e,t,n){o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["alt pairing: create adv secret material"])));var r=o("WAArrayBufferUtils").concatBuffers([e,t,o("WAByteArray").uint8ArrayToBuffer(n)]);return r}function $(e){return P.apply(this,arguments)}function P(){return P=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=yield o("WACryptoHkdf").extractWithSaltAndExpand(e,null,"adv_secret",32);return t}),P.apply(this,arguments)}function N(e,t,n,r){return M.apply(this,arguments)}function M(){return M=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n,a){var i=yield o("WAWebSignalStoreApi").waSignalStore.getRegistrationInfo();if(i==null)throw r("err")("alt pairing: Did not find registration info");var l=new Uint8Array(32);self.crypto.getRandomValues(l);var s=new Uint8Array(32);self.crypto.getRandomValues(s);var u=new Uint8Array(12);return self.crypto.getRandomValues(u),w(e,t,n,a,i.identityKeyPair.pubKey,i.identityKeyPair.privKey,l,s,u)}),M.apply(this,arguments)}function w(e,t,n,r,o,a,i,l,s){return A.apply(this,arguments)}function A(){return A=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n,a,i,l,s,u,c){var d=new(o("WABinary")).Binary(e),m=d.readByteArrayView(32),_=d.readByteArrayView(16),g=d.readByteArrayView(),h=yield f(n,m),y=yield p(function(){return C(g,_,h)},"fail decrypt primary ephemeral pub");if(y.byteLength===0)throw r("err")("alt pairing: linkCodePairingDecryptedPrimaryEphemeralPub is an empty buffer");var b=yield p(function(){return o("WAWebCryptoCurve25519").sharedSecret(y,a.privKey)},"fail generate ephemeral shared secret"),v=yield E(b,u),S=I(i,t,s),R=yield T(v,c,S),L=new(o("WABinary")).Binary;L.writeByteArray(u),L.writeByteArray(c),L.writeBuffer(R);var k=yield p(function(){return o("WAWebCryptoCurve25519").sharedSecret(t,l)},"fail generate identity shared secret"),D=o("WAArrayBufferUtils").concatBuffers([b,k,o("WAByteArray").uint8ArrayToBuffer(s)]),x=yield o("WACryptoHkdf").extractWithSaltAndExpand(D,null,"adv_secret",32),$=L.readBuffer();return{companionIdentityPublic:i,linkCodePairingWrappedKeyBundle:$,advSecret:x}}),A.apply(this,arguments)}l.generateRandomCode=m,l.deriveKey=f,l.encryptCompanionHello=h,l.decryptPrimaryHello=C,l.companionHello=v,l.companionHelloInternal=R,l.getBundleEncryptionKey=E,l.getKeyBundle=I,l.encryptKeyBundle=T,l.createAdvSecretMaterial=x,l.createAdvSecret=$,l.companionFinish=N,l.companionFinishInternal=w}),98);
__d("WAWebCompanionRegClientUtils",["$InternalEnum","WAWebMiscBrowserUtils"],(function(t,n,r,o,a,i,l){var e,s=n("$InternalEnum")({UNKNOWN:0,CHROME:1,EDGE:2,FIREFOX:3,IE:4,OPERA:5,SAFARI:6,ELECTRON:7,UWP:8,OTHER_WEB_CLIENT:9}),u=(e={},e[s.UNKNOWN]="0",e[s.CHROME]="1",e[s.EDGE]="2",e[s.FIREFOX]="3",e[s.IE]="4",e[s.OPERA]="5",e[s.SAFARI]="6",e[s.ELECTRON]="7",e[s.UWP]="8",e[s.OTHER_WEB_CLIENT]="9",e),c=u[d()];function d(){var e=r("WAWebMiscBrowserUtils").info().name;if(!e)return s.UNKNOWN;switch(e){case"Chrome":return s.CHROME;case"Firefox":return s.FIREFOX;case"IE":return s.IE;case"Opera":return s.OPERA;case"Safari":return s.SAFARI;case"Edge":return s.EDGE;default:return s.OTHER_WEB_CLIENT}}l.DEVICE_PLATFORM=c}),98);
__d("WAWebAltDeviceLinkingIq",["WASmaxMdCompanionFinishRPC","WASmaxMdCompanionHelloRPC","WAWebCompanionRegClientUtils","WAWebMiscBrowserUtils","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(t,n){var r;return r=e.call(this,t)||this,r.name="CompanionHelloError",r.type=n,r}return babelHelpers.inheritsLoose(t,e),t})(babelHelpers.wrapNativeSuper(Error)),s=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return t=e.call.apply(e,[this].concat(r))||this,t.name="CompanionFinishError",babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}return babelHelpers.inheritsLoose(t,e),t})(babelHelpers.wrapNativeSuper(Error));function u(e,t,n,r){return c.apply(this,arguments)}function c(){return c=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,n,a,i){var l=yield o("WASmaxMdCompanionHelloRPC").sendCompanionHelloRPC({linkCodePairingNonceArgs:{linkCodePairingNonceElementValue:new Uint8Array(1)},linkCodeCompanionRegJid:t,linkCodePairingWrappedCompanionEphemeralPubElementValue:new Uint8Array(n),companionServerAuthKeyPubElementValue:new Uint8Array(a),companionPlatformIdElMixinArgs:{companionPlatformIdElementValue:o("WAWebCompanionRegClientUtils").DEVICE_PLATFORM},companionPlatformDisplayElMixinArgs:{companionPlatformDisplayElementValue:r("WAWebMiscBrowserUtils").info().name+" ("+r("WAWebMiscBrowserUtils").info().os+")"},linkCodeCompanionRegShouldShowPushNotification:i?"true":"false"});if(l.name==="CompanionHelloResponseNotifyCompanion")return l.value.linkCodeCompanionRegLinkCodePairingRefElementValue;throw l.name==="CompanionHelloResponseError"?new e("alt pairing: Got an error from alt paring: companion hello: "+l.value.errorIqMixinErrors.name,l.value.errorIqMixinErrors):new e("alt pairing: Got an unknown error from alt paring: companion hello")}),c.apply(this,arguments)}function d(e,t,n,r){return m.apply(this,arguments)}function m(){return m=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n,r){var a=yield o("WASmaxMdCompanionFinishRPC").sendCompanionFinishRPC({linkCodeCompanionRegJid:r,linkCodePairingWrappedKeyBundleElementValue:new Uint8Array(e),companionIdentityPublicElementValue:new Uint8Array(t),linkCodePairingRefElementValue:n});if(a.name!=="CompanionFinishResponseSuccess")throw new s("alt pairing: Got an error from alt paring: companion finish")}),m.apply(this,arguments)}l.CompanionHelloError=e,l.CompanionFinishError=s,l.sendCompanionHello=u,l.sendCompanionFinish=d}),98);
__d("WAWebSocketConstants",[],(function(t,n,r,o,a,i){var e={OPENING:"OPENING",PAIRING:"PAIRING",UNPAIRED:"UNPAIRED",UNPAIRED_IDLE:"UNPAIRED_IDLE",CONNECTED:"CONNECTED",CONFLICT:"CONFLICT",UNLAUNCHED:"UNLAUNCHED",PROXYBLOCK:"PROXYBLOCK",TOS_BLOCK:"TOS_BLOCK",SMB_TOS_BLOCK:"SMB_TOS_BLOCK",DEPRECATED_VERSION:"DEPRECATED_VERSION",SCREEN_LOCKED:"SCREEN_LOCKED"},l={DISCONNECTED:"DISCONNECTED",SYNCING:"SYNCING",RESUMING:"RESUMING",CONNECTED:"CONNECTED"};i.SOCKET_STATE=e,i.SOCKET_STREAM=l}),66);
__d("WAWebDirectConnectionX509",["JSResourceForInteraction","Promise","WALogger","WAWebDirectConnectionUtils","asyncToGeneratorRuntime","filterNulls","pvutils-1.0.17","requireDeferred"],(function(t,n,r,o,a,i,l){var e,s,u,c,d=r("requireDeferred")("asn1js-2.1.1").__setRef("WAWebDirectConnectionX509"),m="-----BEGIN CERTIFICATE-----",p="-----END CERTIFICATE-----",_="(?:"+m+")((?:.|\n)*?)(?:"+p+")",f="2.5.4.3";function g(){return r("JSResourceForInteraction")("pkijs").__setRef("WAWebDirectConnectionX509").load()}function h(t){var n="";try{n=atob(t)}catch(t){o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[direct-connection] base64 decoding failed with ",""])),t.toString())}return C(n)}function y(e){return btoa(b(e))}function C(e){for(var t=e.length,n=new Uint8Array(t),r=0;r<t;r++)n[r]=e.charCodeAt(r);return n.buffer}function b(e){return String.fromCharCode.apply(String,Array.from(new Uint8Array(e)))}function v(e,t){return S.apply(this,arguments)}function S(){return S=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=yield g(),r=n.CertificateChainValidationEngine;return new r({trustedCerts:t,certs:e})}),S.apply(this,arguments)}function R(e,t){return e.flat().reduce(function(e,n){return e.every(function(e){return!o("pvutils-1.0.17").isEqualBuffer(e.tbs,n.tbs)})&&t.includes(n)?[].concat(e,[n]):e},[])}function L(){return E.apply(this,arguments)}function E(){return E=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=yield r("JSResourceForInteraction")("WAWebDirectConnectionCaBundle").__setRef("WAWebDirectConnectionX509").load(),t=e.CA_BUNDLE;return k(t)}),E.apply(this,arguments)}function k(e){return I.apply(this,arguments)}function I(){return I=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=yield g(),a=t.Certificate,i=yield new(c||(c=n("Promise")))(function(e){d.onReady(function(t){e(t().fromBER)})});return r("filterNulls")(Array.from(e.matchAll(new RegExp(_,"gm"))).map(function(e){var t=e[0],n=e[1],r=i(h(n)),l=r.result,u;try{u=l.error?null:new a({schema:l})}catch(e){o("WALogger").WARN(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[direct-connection] certificate chain parsing from Get Public Key IQ failed with ",""])),e.toString())}return u}))}),I.apply(this,arguments)}function T(e,t){return D.apply(this,arguments)}function D(){return D=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){return(yield v(e,t)).verify()}),D.apply(this,arguments)}function x(e,t){return $.apply(this,arguments)}function $(){return $=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var r=yield v(e,t),a=R(yield(c||(c=n("Promise"))).all(e.map(function(e){return r.findIssuer(e,r)})),t);return a.length===0?(o("WALogger").WARN(u||(u=babelHelpers.taggedTemplateLiteralLoose(["[direct-connection] no trusted root certificates could be found for ",""])),P(e[0])),null):a}),$.apply(this,arguments)}function P(e){var t;return(t=e.issuer.typesAndValues.find(function(e){var t=e.type;return t===f}))==null?void 0:t.value.valueBlock.value}function N(e){return o("WAWebDirectConnectionUtils").stringToCertificateString(e.map(function(e){var t=y(e.toSchema(!0).toBER(!1)).split(/(.{0,64})/g).filter(function(e){return e!==""}).join("\n");return m+"\n"+t+"\n"+p}).join("\n"))}function M(){return w.apply(this,arguments)}function w(){return w=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=yield g(),t=e.getEngine;return t()}),w.apply(this,arguments)}function A(e){return F.apply(this,arguments)}function F(){return F=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=yield g(),n=t.getRandomValues;return n(e)}),F.apply(this,arguments)}function O(e,t){return B.apply(this,arguments)}function B(){return B=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=yield e.getPublicKey({algorithm:{algorithm:{name:"RSA-OAEP",hash:{name:"SHA-256"}},usages:["encrypt"]}}),r=yield M(),o=yield r.subtle.encrypt({name:"RSA-OAEP"},n,t);return y(o)}),B.apply(this,arguments)}l.base64ToArrayBuffer=h,l.arrayBufferToBase64=y,l.stringToArrayBuffer=C,l.arrayBufferToString=b,l.fetchFromCABundle=L,l.extractCertificates=k,l.validateCertificates=T,l.genRootIssuers=x,l.encodeToString=N,l.getEngine=M,l.getRandomValues=A,l.encryptWithPublicKey=O}),98);
__d("WAWebUserPrefsScreenLock",["WAArrayBufferUtils","WABase64","WABinary","WAWebDbEncryptionKey","WAWebDirectConnectionX509","WAWebPermanentStorage","WAWebUserPrefsKeys","WAWebUserPrefsStore","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){function e(){var e;T(o("WAWebUserPrefsKeys").MD_KEYS.SCREEN_LOCK_DURATION_SECONDS);var t=parseInt((e=r("WAWebUserPrefsStore").getUser(o("WAWebUserPrefsKeys").MD_KEYS.SCREEN_LOCK_DURATION_SECONDS))!=null?e:0,10);return t!==0}function s(){return T(o("WAWebUserPrefsKeys").MD_KEYS.SCREEN_LOCK_DURATION_SECONDS),r("WAWebUserPrefsStore").getUser(o("WAWebUserPrefsKeys").MD_KEYS.SCREEN_LOCK_DURATION_SECONDS)}function u(){var e;return T(o("WAWebUserPrefsKeys").MD_KEYS.SCREEN_LOCK_DURATION_SECONDS),(e=r("WAWebUserPrefsStore").getUser(o("WAWebUserPrefsKeys").MD_KEYS.SCREEN_LOCK_DURATION_SECONDS))!=null?e:0}function c(e){r("WAWebUserPrefsStore").setUser(o("WAWebUserPrefsKeys").MD_KEYS.SCREEN_LOCK_DURATION_SECONDS,e)}function d(e){r("WAWebUserPrefsStore").setUser(o("WAWebUserPrefsKeys").MD_KEYS.SCREEN_LOCK_IV,e)}function m(){return T(o("WAWebUserPrefsKeys").MD_KEYS.SCREEN_LOCK_IV),r("WAWebUserPrefsStore").getUser(o("WAWebUserPrefsKeys").MD_KEYS.SCREEN_LOCK_IV)}function p(e){return r("WAWebUserPrefsStore").setUser(o("WAWebUserPrefsKeys").MD_KEYS.SCREEN_LOCK_SALT,e,{shouldWriteToIdb:!1})}function _(){return T(o("WAWebUserPrefsKeys").MD_KEYS.SCREEN_LOCK_SALT,!1),r("WAWebUserPrefsStore").getUser(o("WAWebUserPrefsKeys").MD_KEYS.SCREEN_LOCK_SALT)}function f(e){return g.apply(this,arguments)}function g(){return g=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=I(),n=yield R(String(e),t);return r("WAWebUserPrefsStore").setUser(o("WAWebUserPrefsKeys").MD_KEYS.SCREEN_LOCK_ITERATIONS,n+"_"+t)}),g.apply(this,arguments)}function h(){return y.apply(this,arguments)}function y(){return y=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){T(o("WAWebUserPrefsKeys").MD_KEYS.SCREEN_LOCK_ITERATIONS);var e=r("WAWebUserPrefsStore").getUser(o("WAWebUserPrefsKeys").MD_KEYS.SCREEN_LOCK_ITERATIONS);if(e==null)return null;if(typeof e=="number")return parseInt(e,10);var t=e.split("_"),n=t[0],a=t[1];if(n==null||a==null)return null;var i=yield E(n,a);return parseInt(i,10)}),y.apply(this,arguments)}function C(){return b.apply(this,arguments)}function b(){return b=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){T(o("WAWebUserPrefsKeys").MD_KEYS.SCREEN_UNLOCK_TRY_COUNT);var e=r("WAWebUserPrefsStore").getUser(o("WAWebUserPrefsKeys").MD_KEYS.SCREEN_UNLOCK_TRY_COUNT);if(e==null)return 0;if(typeof e=="number")return parseInt(e,10);var t=e.split("_"),n=t[0],a=t[1],i=yield E(n,a);return parseInt(i,10)}),b.apply(this,arguments)}function v(e,t){return S.apply(this,arguments)}function S(){return S=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=I(),a=yield R(String(e),n);t.aborted||r("WAWebUserPrefsStore").setUser(o("WAWebUserPrefsKeys").MD_KEYS.SCREEN_UNLOCK_TRY_COUNT,a+"_"+n)}),S.apply(this,arguments)}function R(e,t){return L.apply(this,arguments)}function L(){return L=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=new Uint8Array(o("WABase64").decodeB64(t)),r=o("WAWebDbEncryptionKey").DbEncKeyStore.getEncKeys()[0],a=yield self.crypto.subtle.encrypt({iv:n,name:"AES-CBC"},r.key,o("WAArrayBufferUtils").stringToArrayBuffer(e));return o("WABase64").encodeB64(a)}),L.apply(this,arguments)}function E(e,t){return k.apply(this,arguments)}function k(){return k=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=new Uint8Array(o("WABase64").decodeB64(t));yield o("WAWebDbEncryptionKey").DbEncKeyStore.waitForInit();var r=o("WAWebDbEncryptionKey").DbEncKeyStore.getEncKeys()[0],a=yield self.crypto.subtle.decrypt({iv:n,name:"AES-CBC"},r.key,o("WABase64").decodeB64(e));return o("WAWebDirectConnectionX509").arrayBufferToString(a)}),k.apply(this,arguments)}function I(){var e=new Uint8Array(16);self.crypto.getRandomValues(e);var t=new(o("WABinary")).Binary(e).readByteArrayView(16);return o("WABase64").encodeB64(t)}function T(e,t){var n=r("WAWebUserPrefsStore").get(e);if(n!=null){var o=t!=null?{shouldWriteToIdb:t}:null;r("WAWebUserPrefsStore").setUser(e,n,o!=null?o:{}),r("WAWebPermanentStorage").removeItem(e)}}l.getScreenLockEnabled=e,l.getScreenLockDurationForLogging=s,l.getScreenLockDurationInSeconds=u,l.setScreenLockDurationInSeconds=c,l.setScreenLockIvString=d,l.getScreenLockIvString=m,l.setScreenLockSalt=p,l.getScreenLockSalt=_,l.setScreenLockIterations=f,l.getScreenLockIterations=h,l.getScreenUnlockTryCount=C,l.setScreenUnlockTryCount=v}),98);
__d("WAWebUserPrefsInfoStore",["Promise","WAArrayBufferUtils","WABase64","WABinary","WALogger","WAWebCmd","WAWebCryptoCurve25519","WAWebDbEncryptionKey","WAWebL10N","WAWebLogoutReasonConstants","WAWebSocketConstants","WAWebSocketLogoutJob","WAWebUserPrefsMultiDevice","WAWebUserPrefsScreenLock","asyncToGeneratorRuntime","cr:1234","gkx"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p,_,f,g,h,y,C,b,v,S,R,L,E,k,I=(e=n("cr:1234"))!=null?e:{},T=I.LockScreenResolvable,D=(function(){function e(){this.$1=null}var t=e.prototype;return t.get=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){return this.$1==null&&(this.$1=yield this.getOsRelease()),{osVersion:this.$1,osBuild:"0.1",hardware:"desktop",manufacturer:"",device:"Desktop",lg:r("WAWebL10N").getLanguage(),lc:r("WAWebL10N").getRegion()||"",mcc:"000",mnc:"000",sim_mnc:"000",sim_mcc:"000"}});function t(){return e.apply(this,arguments)}return t})(),t.getOsRelease=function(){var e="0.1";return(k||(k=n("Promise"))).resolve(e)},e})(),x=new D,$=128,P="AES-GCM",N="PBKDF2",M=r("gkx")("26256")?1e4:6e5,w=(function(){function e(){this.cachedPasscodeDerivedKey=null}var t=e.prototype;return t.resetCachedPasscodeDerivedKey=function(){this.cachedPasscodeDerivedKey=null},t.getCertficateChain=function(t){var e=o("WAArrayBufferUtils").arrayBufferToString(t);try{var n=JSON.parse(e),r=n.intermediate,a=n.leaf;return{intermediate:{key:o("WABase64").decodeB64(r.key),notAfter:Number(r.notAfter),notBefore:Number(r.notBefore)},leaf:{key:o("WABase64").decodeB64(a.key),notAfter:Number(a.notAfter),notBefore:Number(a.notBefore)}}}catch(e){return o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["Error parsing certificate chain: ",""])),e),null}},t.get=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=o("WAWebUserPrefsMultiDevice").getNoiseInfo();if(!e)return o("WALogger").DEV(u||(u=babelHelpers.taggedTemplateLiteralLoose(["Noise encryptedNoiseInfo: "," is null"])),!e).tags("info-store"),null;var t=this.$1();if(!t)return o("WALogger").DEV(c||(c=babelHelpers.taggedTemplateLiteralLoose(["Noise ivArray : "," is null"])),!t).tags("info-store"),null;if(e=yield this.$2(e,t),o("WAWebUserPrefsScreenLock").getScreenLockEnabled()){o("WAWebCmd").Cmd.setSocketState(o("WAWebSocketConstants").SOCKET_STATE.SCREEN_LOCKED);var n=yield this.passcodeUnlockNoiseInfo(e);n&&(e=n)}var r=yield this.$3(e);return r?e:(o("WALogger").LOG(d||(d=babelHelpers.taggedTemplateLiteralLoose(["Decrypted noise key was invalid."]))).tags("info-store"),null)});function t(){return e.apply(this,arguments)}return t})(),t.setCertificateChain=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=yield this.get();if(t)try{var n=babelHelpers.extends({},e.intermediate,{key:o("WABase64").encodeB64(e.intermediate.key)}),r=babelHelpers.extends({},e.leaf,{key:o("WABase64").encodeB64(e.leaf.key)}),a=JSON.stringify({intermediate:n,leaf:r});return t.certificateChainBuffer=o("WAArrayBufferUtils").stringToArrayBuffer(a),this.set(t)}catch(e){o("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["Error serializing certificate chain: ",""])),e).sendLogs("handshake-serialization-failed")}});function t(t){return e.apply(this,arguments)}return t})(),t.set=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=this,r=e;if(this.cachedPasscodeDerivedKey!=null){var a=this.cachedPasscodeDerivedKey,i=r,l=i.recoveryToken,s=i.staticKeyPair,u=s.pubKey,c=s.privKey,d=i.certificateChainBuffer;try{var m=yield(k||(k=n("Promise"))).all([l,u,c,d].map(function(e){return t.encryptNoiseWithPasscodeDerivedKey(e,a)}));m[0]&&m[1]&&m[2]&&(r={recoveryToken:m[0],staticKeyPair:{pubKey:m[1],privKey:m[2]},certificateChainBuffer:m[3]})}catch(e){o("WALogger").DEV(p||(p=babelHelpers.taggedTemplateLiteralLoose(["Failed to lock noise info: ",""])),e)}}var _=new Uint8Array(64);self.crypto.getRandomValues(_);var f=this.$4(_);yield this.$5(f);var g=yield(k||(k=n("Promise"))).all([this.$6(r.recoveryToken,f[0]),this.$6(r.staticKeyPair.pubKey,f[1]),this.$6(r.staticKeyPair.privKey,f[2]),r.certificateChainBuffer?this.$6(r.certificateChainBuffer,f[3]):(k||(k=n("Promise"))).resolve(void 0)]),h=g[0],y=g[1],C=g[2],b=g[3];return r.recoveryToken=h,r.staticKeyPair.pubKey=y,r.staticKeyPair.privKey=C,r.certificateChainBuffer=b,o("WAWebUserPrefsMultiDevice").setNoiseInfo(r)});function t(t){return e.apply(this,arguments)}return t})(),t.$5=function(t){return o("WAWebUserPrefsMultiDevice").setNoiseInfoIv(t.map(o("WABase64").encodeB64))},t.$1=function(){var e=o("WAWebUserPrefsMultiDevice").getNoiseInfoIv();return e?e.map(function(e){return new Uint8Array(o("WABase64").decodeB64(e))}):null},t.$4=function(t){var e=new(o("WABinary")).Binary(t);return[e.readByteArrayView(16),e.readByteArrayView(16),e.readByteArrayView(16),e.readByteArrayView(16)]},t.$6=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=o("WAWebDbEncryptionKey").DbEncKeyStore.getEncKeys()[0],r=yield self.crypto.subtle.encrypt({iv:t,name:"AES-CBC"},n.key,e);return r});function t(t,n){return e.apply(this,arguments)}return t})(),t.$2=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var r=yield(k||(k=n("Promise"))).all([this.$7(e.recoveryToken,t[0]),this.$7(e.staticKeyPair.pubKey,t[1]),this.$7(e.staticKeyPair.privKey,t[2]),e.certificateChainBuffer!=null?this.$7(e.certificateChainBuffer,t[3]):(k||(k=n("Promise"))).resolve(void 0)]),o=r[0],a=r[1],i=r[2],l=r[3];return e.certificateChainBuffer=l,e.recoveryToken=o,e.staticKeyPair.pubKey=a,e.staticKeyPair.privKey=i,e});function t(t,n){return e.apply(this,arguments)}return t})(),t.$7=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=o("WAWebDbEncryptionKey").DbEncKeyStore.getEncKeys()[0],r=yield self.crypto.subtle.decrypt({iv:t,name:"AES-CBC"},n.key,e);return r});function t(t,n){return e.apply(this,arguments)}return t})(),t.$3=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=!0;try{for(var n=yield o("WAWebCryptoCurve25519").keyPair(e.staticKeyPair.privKey),r=n.pubKey,a=new Uint8Array(r),i=new Uint8Array(e.staticKeyPair.pubKey),l=0;l<a.length;l++)if(a[l]!==i[l]){t=!1;break}}catch(e){o("WALogger").LOG(_||(_=babelHelpers.taggedTemplateLiteralLoose(["Decrypted noise key failed validation."]))).tags("info-store"),t=!1}return t});function t(t){return e.apply(this,arguments)}return t})(),t.lockNoiseInfo=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=yield this.deriveKeyFromPasscode(e);this.createScreenLockIv();var n=yield this.get();if(!n||!n.staticKeyPair)return o("WALogger").DEV(f||(f=babelHelpers.taggedTemplateLiteralLoose(["Empty noiseInfo when trying to lock noise info with passcode."]))).tags("info-store"),!1;try{return this.cachedPasscodeDerivedKey=t,yield this.set(n),!0}catch(e){this.cachedPasscodeDerivedKey=null,o("WALogger").DEV(g||(g=babelHelpers.taggedTemplateLiteralLoose(["Failed to lock noise info: ",""])),e)}return!1});function t(t){return e.apply(this,arguments)}return t})(),t.passcodeUnlockNoiseInfo=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){if(t===void 0&&(t=!1),T==null)return null;var n;if(this.cachedPasscodeDerivedKey==null){var r;t?r=yield T.waitForPasscodeAfterIncorrectAttempt():r=yield T.waitForPasscode(),n=yield this.deriveKeyFromPasscode(r)}else n=this.cachedPasscodeDerivedKey;var a=yield this.getUnlockedNoiseInfo(e,n);return!a||!(yield this.$3(a))?(o("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Decrypted noise key was invalid."]))).tags("info-store"),this.passcodeUnlockNoiseInfo(e,!0)):(T.correctPasscodeEntered(n),o("WAWebCmd").Cmd.setSocketState(o("WAWebSocketConstants").SOCKET_STATE.OPENING),a)});function t(t,n){return e.apply(this,arguments)}return t})(),t.getUnlockedNoiseInfo=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var r=this,a=e.recoveryToken,i=e.staticKeyPair,l=i.pubKey,s=i.privKey,u=e.certificateChainBuffer;try{var c=yield(k||(k=n("Promise"))).all([a,l,s,u].map(function(e){return r.decryptNoiseWithPasscodeDerivedKey(e,t)}));if(c[0]&&c[1]&&c[2])return this.cachedPasscodeDerivedKey=t,{recoveryToken:c[0],staticKeyPair:{pubKey:c[1],privKey:c[2]},certificateChainBuffer:c[3]}}catch(e){return o("WALogger").DEV(y||(y=babelHelpers.taggedTemplateLiteralLoose(["Error with decrypting the noise with the passcode derived key: ",""])),e),null}});function t(t,n){return e.apply(this,arguments)}return t})(),t.removeLockOnNoiseInfo=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=o("WAWebUserPrefsMultiDevice").getNoiseInfo();if(!t)return o("WALogger").DEV(C||(C=babelHelpers.taggedTemplateLiteralLoose(["Noise Info: "," is null, so there is no lock to remove."])),!t).tags("info-store"),!1;var n=this.$1();if(!n)return o("WALogger").DEV(b||(b=babelHelpers.taggedTemplateLiteralLoose(["Noise ivArray : "," is null"])),!n).tags("info-store"),!1;t=yield this.$2(t,n);var r=yield this.deriveKeyFromPasscode(e),a=yield this.getUnlockedNoiseInfo(t,r);if(a!=null){var i=yield this.$3(a);return i?(this.cachedPasscodeDerivedKey=null,yield this.set(a),o("WAWebUserPrefsScreenLock").setScreenLockSalt(null),o("WAWebUserPrefsScreenLock").setScreenLockIvString(""),yield o("WAWebUserPrefsScreenLock").setScreenLockIterations(null),!0):(o("WALogger").LOG(v||(v=babelHelpers.taggedTemplateLiteralLoose(["Decrypted noise key was invalid."]))).tags("info-store"),!1)}return o("WALogger").DEV(S||(S=babelHelpers.taggedTemplateLiteralLoose(["Removing lock on Noise info failed."]))),!1});function t(t){return e.apply(this,arguments)}return t})(),t.deriveKeyFromPasscode=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=new TextEncoder().encode(e),n=yield self.crypto.subtle.importKey("raw",t,{name:N},!1,["deriveKey"]),r=yield this.getOrGenScreenLockSalt(),o=yield self.crypto.subtle.deriveKey({name:N,hash:"SHA-256",salt:r,iterations:yield this.getScreenLockIterationCount()},n,{name:P,length:$},!1,["encrypt","decrypt"]);return o});function t(t){return e.apply(this,arguments)}return t})(),t.getOrGenScreenLockSalt=function(){var e=null;return o("WAWebUserPrefsScreenLock").getScreenLockEnabled()||(e=new Uint8Array($),self.crypto.getRandomValues(e),e=btoa(String.fromCharCode.apply(String,Array.from(new Uint8Array(e)))),o("WAWebUserPrefsScreenLock").setScreenLockSalt(e)),e=o("WAWebUserPrefsScreenLock").getScreenLockSalt(),e==null&&(o("WALogger").DEV(R||(R=babelHelpers.taggedTemplateLiteralLoose(["[DB ENC CRITICAL ERROR] null returned for local app lock salt"]))),o("WAWebSocketLogoutJob").socketLogout(o("WAWebLogoutReasonConstants").LogoutReason.MissingScreenLockSalt)),e=Uint8Array.from(atob(e),function(e){return e.charCodeAt(0)}),(k||(k=n("Promise"))).resolve(e)},t.createScreenLockIv=function(){var e=new Uint8Array(16);self.crypto.getRandomValues(e);var t=new(o("WABinary")).Binary(e).readByteArrayView(16);o("WAWebUserPrefsScreenLock").setScreenLockIvString(o("WABase64").encodeB64(t))},t.getScreenLockIvArray=function(){var e=o("WAWebUserPrefsScreenLock").getScreenLockIvString();return e?new Uint8Array(o("WABase64").decodeB64(e)):null},t.encryptNoiseWithPasscodeDerivedKey=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){if(e==null)return null;var n=this.getScreenLockIvArray();if(!n)return o("WALogger").DEV(L||(L=babelHelpers.taggedTemplateLiteralLoose(["App lock iv array: "," is null"])),!n).tags("info-store"),null;var r=yield self.crypto.subtle.encrypt({iv:n,name:P},t,e);return r});function t(t,n){return e.apply(this,arguments)}return t})(),t.decryptNoiseWithPasscodeDerivedKey=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){if(e==null)return null;var n=this.getScreenLockIvArray();if(!n)return o("WALogger").DEV(E||(E=babelHelpers.taggedTemplateLiteralLoose(["App lock iv array: "," is null"])),!n).tags("info-store"),null;var r=yield self.crypto.subtle.decrypt({iv:n,name:P},t,e);return r});function t(t,n){return e.apply(this,arguments)}return t})(),t.calculatePBKDF2Iterations=function(){var e=navigator.hardwareConcurrency;return M*Math.max(1,Number.isNaN(e)?1:e)},t.getScreenLockIterationCount=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=yield o("WAWebUserPrefsScreenLock").getScreenLockIterations();return(!o("WAWebUserPrefsScreenLock").getScreenLockEnabled()||e==null)&&(e=this.calculatePBKDF2Iterations(),yield o("WAWebUserPrefsScreenLock").setScreenLockIterations(e)),e});function t(){return e.apply(this,arguments)}return t})(),e})(),A=new w;l.deviceInfo=x,l.waNoiseInfo=A}),98);
__d("WAWebAltDeviceLinkingApi",["invariant","$InternalEnum","Promise","WABase64","WAByteArray","WACryptoUtils","WAJids","WALogger","WAQplTypes","WATimeUtils","WAWebAdvSignatureApi","WAWebAltDeviceLinkingAlgorithm","WAWebAltDeviceLinkingIq","WAWebBackendApi","WAWebQplQuickPerformanceLoggerMarkerIds","WAWebQplQuickPerformanceLoggerModule","WAWebUserPrefsInfoStore","WAWebUserPrefsMultiDevice","asyncToGeneratorRuntime","err","gkx"],(function(t,n,r,o,a,i,l,s){var e,u,c,d,m,p,_,f,g,h,y,C=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return t=e.call.apply(e,[this].concat(r))||this,t.name="MissingCachedRefError",babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}return babelHelpers.inheritsLoose(t,e),t})(babelHelpers.wrapNativeSuper(Error)),b=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return t=e.call.apply(e,[this].concat(r))||this,t.name="NoiseInfoIsNullError",babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}return babelHelpers.inheritsLoose(t,e),t})(babelHelpers.wrapNativeSuper(Error)),v=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return t=e.call.apply(e,[this].concat(r))||this,t.name="InvalidRefError",babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}return babelHelpers.inheritsLoose(t,e),t})(babelHelpers.wrapNativeSuper(Error)),S=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return t=e.call.apply(e,[this].concat(r))||this,t.name="OldCodeError",babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}return babelHelpers.inheritsLoose(t,e),t})(babelHelpers.wrapNativeSuper(Error)),R=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return t=e.call.apply(e,[this].concat(r))||this,t.name="MaxPrimaryHelloError",babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}return babelHelpers.inheritsLoose(t,e),t})(babelHelpers.wrapNativeSuper(Error)),L=n("$InternalEnum").Mirrored(["QR_CODE","ALT_DEVICE_LINKING"]),E=n("$InternalEnum").Mirrored(["NotStarted","Initialized","AfterSendCompanionHello","AfterSendCompanionFinish"]),k=(function(){function e(){this.clear()}var t=e.prototype;return t.clear=function(){this.helloCached=null,this.ref=null,this.phone=null,this.stage=E.NotStarted,this.codeGenerationTs=null,this.primaryHelloAttemptCount=0,this.marker!=null&&(this.marker.end(o("WAQplTypes").QuickLogActionType.ABORTED),this.marker=null)},e})(),I=180,T=3,D=new k,x=L.QR_CODE;function $(){return x}function P(e){x=e}function N(){return D.ref}function M(){return D.marker}function w(){return A.apply(this,arguments)}function A(){return A=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["alt pairing: initialize alt linking"]))),D.clear(),D.marker=o("WAWebQplQuickPerformanceLoggerModule").QPL.markerStart(o("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.ALTERNATIVE_DEVICE_LINKING),yield o("WAWebUserPrefsMultiDevice").setADVSecretKey(),D.stage=E.Initialized,P(L.ALT_DEVICE_LINKING)}),A.apply(this,arguments)}function F(){return O.apply(this,arguments)}function O(){return O=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["alt pairing: initialize QR linking"]))),$()===L.ALT_DEVICE_LINKING){var e;(e=M())==null||e.addPoint("switch_to_qr")}D.clear(),yield o("WAWebAdvSignatureApi").generateADVSecretKey(),D.stage=E.NotStarted,P(L.QR_CODE)}),O.apply(this,arguments)}function B(e,t){return W.apply(this,arguments)}function W(){return W=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["alt pairing: start linking flow"])));var n=yield o("WAWebUserPrefsInfoStore").waNoiseInfo.get();if(n==null)throw new b("alt pairing: noise info is null");return D.phone=e,D.codeGenerationTs=o("WATimeUtils").unixTime(),q(D,n,t)}),W.apply(this,arguments)}function q(e,t,n){return U.apply(this,arguments)}function U(){return U=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n){var a,i,l,u;if(!r("gkx")("26258")){var c;(c=D.marker)==null||c.annotate({string:{phone:e.phone}})}e.stage===E.Initialized||s(0,75727,e.stage),(a=D.marker)==null||a.addPoint("generate_code_start");var _=yield o("WAWebAltDeviceLinkingAlgorithm").companionHello();if(e.helloCached=_,(i=D.marker)==null||i.addPoint("generate_code_end"),o("WALogger").LOG(d||(d=babelHelpers.taggedTemplateLiteralLoose(["alt pairing: completed companion hello generation"]))),(l=D.marker)==null||l.addPoint("send_companion_hello_start"),e.phone!=null||s(0,67482),e.ref=yield o("WAWebAltDeviceLinkingIq").sendCompanionHello(o("WAJids").toPhoneUserJid(e.phone),_.linkCodePairingWrappedCompanionEphemeralPub,t.staticKeyPair.pubKey,n),(u=D.marker)==null||u.addPoint("send_companion_hello_end"),o("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["alt pairing: sent companion hello"]))),e.ref==null)throw new C("alt pairing:could not get ref from companion hello");return r("gkx")("26258")||o("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["alt pairing: companion hello ref received: ",""])),e.ref),e.stage=E.AfterSendCompanionHello,_.linkCodePairingSecret}),U.apply(this,arguments)}function V(e){return H.apply(this,arguments)}function H(){return H=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){o("WALogger").LOG(_||(_=babelHelpers.taggedTemplateLiteralLoose(["alt pairing: handling primary hello"]))),o("WAWebBackendApi").frontendFireAndForget("primaryHelloReceivedAltLinking",{});try{return yield j(e,D,o("WATimeUtils").unixTime())}catch(e){return o("WAWebBackendApi").frontendFireAndForget("errorAltLinking",{}),(y||(y=n("Promise"))).reject(e)}}),H.apply(this,arguments)}function G(e){return z.apply(this,arguments)}function z(){return z=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){yield o("WAWebAdvSignatureApi").generateADVSecretKey(),e.stage=E.AfterSendCompanionHello}),z.apply(this,arguments)}function j(e,t,n){return K.apply(this,arguments)}function K(){return K=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n){var a,i;if((a=D.marker)==null||a.addPoint("handle_primary_hello_start"),t.primaryHelloAttemptCount++,t.stage===E.AfterSendCompanionFinish)if(t.primaryHelloAttemptCount<=T)yield G(t);else throw new R("alt pairing: reached max allowed primary hello attempts per code");if(t.stage===E.AfterSendCompanionHello||s(0,75728,t.stage),r("gkx")("26258")||o("WALogger").LOG(f||(f=babelHelpers.taggedTemplateLiteralLoose(["alt pairing: cached companion hello ref: ",""])),t.ref),t.ref==null)throw new C("alt pairing:could not get ref from companion hello");if(!o("WACryptoUtils").uint8ArraysEqual(t.ref,e.linkCodeCompanionRegLinkCodePairingRefElementValue))throw new v("alt pairing: handle primary hello: received unexpected ref");if(t.helloCached==null)throw r("err")("alt pairing: cannot find cached hello data");if(t.codeGenerationTs==null)throw r("err")("alt pairing: cannot find codeGenerationTs");if(n-t.codeGenerationTs>I)throw new S("alt pairing: cannot process primaryHello for an old code");var l=t.helloCached,u=yield o("WAWebAltDeviceLinkingAlgorithm").companionFinish(o("WAByteArray").uint8ArrayToBuffer(e.linkCodeCompanionRegLinkCodePairingWrappedPrimaryEphemeralPubElementValue),o("WAByteArray").uint8ArrayToBuffer(e.linkCodeCompanionRegPrimaryIdentityPubElementValue),l.linkCodeKey,l.linkCodePairingCompanionADVEphemeralKeyPair);o("WALogger").LOG(g||(g=babelHelpers.taggedTemplateLiteralLoose(["alt pairing: completed companion finish local algorithm"]))),yield o("WAWebUserPrefsMultiDevice").setADVSecretKey(o("WABase64").encodeB64(u.advSecret));var c=t.ref;if(c==null)throw new C("alt pairing: cannot find cached ref");var d=t.phone;if(d==null)throw new C("alt pairing: phone is empty");yield o("WAWebAltDeviceLinkingIq").sendCompanionFinish(u.linkCodePairingWrappedKeyBundle,u.companionIdentityPublic,c,o("WAJids").toPhoneUserJid(d)),o("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["alt pairing: sent companion finish to server"]))),t.stage=E.AfterSendCompanionFinish,(i=D.marker)==null||i.addPoint("handle_primary_hello_end")}),K.apply(this,arguments)}l.InvalidRefError=v,l.OldCodeError=S,l.MaxPrimaryHelloError=R,l.PairingType=L,l.AltPairingStage=E,l.PairingState=k,l.getPairingType=$,l.setPairingType=P,l.getCurrentRef=N,l.getCurrentMarker=M,l.initializeAltDeviceLinking=w,l.initializeQRLinking=F,l.startAltLinkingFlow=B,l.handlePrimaryHello=V,l.handlePrimaryHelloInternal=j}),98);
__d("WAWebWamEnumClientGroupSizeBucket",[],(function(t,n,r,o,a,i){var e=Object.freeze({SMALL:1,MEDIUM:2,LARGE:3,EXTRA_LARGE:4,XX_LARGE:5,XXX_LARGE:6,LT1024:16,LT1500:7,LT2000:8,LT2500:9,LT3000:10,LT3500:11,LT4000:12,LT4500:13,LT5000:14,LARGEST_BUCKET:15});i.CLIENT_GROUP_SIZE_BUCKET=e}),66);
__d("WAWebWamEnumClientMessageSendStage",[],(function(t,n,r,o,a,i){var e=Object.freeze({CLIENT_RENDERED:1,CLIENT_SAVED:2,CLIENT_WRITTEN_WIRE:3,CLIENT_QUEUED:4,CLIENT_WAITING_TO_ENCRYPT:5,CLIENT_READY_TO_SEND:6,CLIENT_ENCRYPT:7,CLIENT_PREKEYS_FETCH:8});i.CLIENT_MESSAGE_SEND_STAGE=e}),66);
__d("WAWebAndroidMessageSendPerfWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumAgentEngagementEnumType","WAWebWamEnumBotType","WAWebWamEnumClientGroupSizeBucket","WAWebWamEnumClientMessageSendStage","WAWebWamEnumEditType","WAWebWamEnumInvisibleMessageCategoryType","WAWebWamEnumMediaType","WAWebWamEnumMessageType","WAWebWamEnumSizeBucket","WAWebWamEnumTypeOfGroupEnum"],(function(t,n,r,o,a,i,l){var e,s=(e=o("WAWebWamCodegenUtils")).defineEvents({AndroidMessageSendPerf:[1994,{agentEngagementType:[47,o("WAWebWamEnumAgentEngagementEnumType").AGENT_ENGAGEMENT_ENUM_TYPE],appRestart:[16,e.TYPES.BOOLEAN],botType:[48,o("WAWebWamEnumBotType").BOT_TYPE],bucketedSenderKeyDistributionCountPercentage:[32,e.TYPES.INTEGER],bucketedSenderKeyDistributionHashTime:[35,e.TYPES.INTEGER],deviceCount:[36,e.TYPES.INTEGER],deviceSizeBucket:[26,o("WAWebWamEnumSizeBucket").SIZE_BUCKET],durationAbs:[11,e.TYPES.TIMER],durationRelative:[12,e.TYPES.TIMER],durationT:[1,e.TYPES.TIMER],editType:[42,o("WAWebWamEnumEditType").EDIT_TYPE],fetchPrekeys:[15,e.TYPES.BOOLEAN],fetchPrekeysPercentage:[21,e.TYPES.INTEGER],groupSizeBucket:[17,o("WAWebWamEnumClientGroupSizeBucket").CLIENT_GROUP_SIZE_BUCKET],invisibleMessageCategory:[45,o("WAWebWamEnumInvisibleMessageCategoryType").INVISIBLE_MESSAGE_CATEGORY_TYPE],isDirectedMessage:[33,e.TYPES.BOOLEAN],isE2eBackfill:[27,e.TYPES.BOOLEAN],isLid:[41,e.TYPES.BOOLEAN],isMessageFanout:[9,e.TYPES.BOOLEAN],isMessageForward:[8,e.TYPES.BOOLEAN],isPq:[49,e.TYPES.BOOLEAN],isRevokeMessage:[24,e.TYPES.BOOLEAN],isViewOnce:[29,e.TYPES.BOOLEAN],jobsInQueue:[18,e.TYPES.INTEGER],mediaType:[3,o("WAWebWamEnumMediaType").MEDIA_TYPE],messageIsFirstUserMessage:[30,e.TYPES.BOOLEAN],messageIsInvisible:[31,e.TYPES.BOOLEAN],messageType:[4,o("WAWebWamEnumMessageType").MESSAGE_TYPE],networkWasDisconnected:[14,e.TYPES.BOOLEAN],participantCount:[37,e.TYPES.INTEGER],phoneCores:[34,e.TYPES.INTEGER],prekeysEligibleForPrallelProcessing:[28,e.TYPES.BOOLEAN],receiverDeviceCount:[39,e.TYPES.INTEGER],runningTasks:[44,e.TYPES.STRING],sendCount:[13,e.TYPES.INTEGER],sendRetryCount:[10,e.TYPES.INTEGER],sendStage:[2,o("WAWebWamEnumClientMessageSendStage").CLIENT_MESSAGE_SEND_STAGE],senderDeviceCount:[40,e.TYPES.INTEGER],senderKeyDistributionCountPercentage:[23,e.TYPES.INTEGER],sessionsMissingWhenComposing:[25,e.TYPES.BOOLEAN],targetDeviceGroupSizeBucket:[20,o("WAWebWamEnumClientGroupSizeBucket").CLIENT_GROUP_SIZE_BUCKET],threadsInExecution:[19,e.TYPES.INTEGER],typeOfGroup:[38,o("WAWebWamEnumTypeOfGroupEnum").TYPE_OF_GROUP_ENUM],userToDeviceSizeBucket:[46,e.TYPES.STRING]},[1,1,2e3],"regular"]},{AndroidMessageSendPerf:[]});l.AndroidMessageSendPerfWamEvent=s}),98);
__d("WAWebApiBusinessProfile",["invariant","Promise","WALogger","WAWebBizGatingUtils","WAWebBotTypes","WAWebLidMigrationUtils","WAWebSchemaBusinessProfile","WAWebWidFactory","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l,s){var e,u,c,d,m;function p(e){return _.apply(this,arguments)}function _(){return _=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){return o("WAWebSchemaBusinessProfile").getBusinessProfileTable().get(e)}),_.apply(this,arguments)}function f(e){return g.apply(this,arguments)}function g(){return g=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=o("WAWebWidFactory").createWid(e);t.isLid()||s(0,86986);var n=yield p(e);if(n==null){var r=o("WAWebLidMigrationUtils").toPn(t);if(r!=null){var a=r.toString(),i=yield p(a);if(i!=null)return babelHelpers.extends({},i,{id:e})}}return n}),g.apply(this,arguments)}function h(e){return y.apply(this,arguments)}function y(){return y=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=o("WAWebWidFactory").createWid(e),n=o("WAWebLidMigrationUtils").toLid(t);if(n!=null){var r=yield p(n.toString());if(r!=null)return babelHelpers.extends({},r,{id:e})}return p(e)}),y.apply(this,arguments)}function C(e){return b.apply(this,arguments)}function b(){return b=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){return o("WAWebBizGatingUtils").isLidMigrationForBusinessProfileEnabled()?o("WAWebWidFactory").createWid(e).isLid()?f(e):h(e):p(e)}),b.apply(this,arguments)}function v(e){return S.apply(this,arguments)}function S(){return S=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=yield p(e);return t?N(t):null}),S.apply(this,arguments)}function R(e){return L.apply(this,arguments)}function L(){return L=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=yield v(e);if(t==null){var n=o("WAWebWidFactory").createWid(e),r=o("WAWebLidMigrationUtils").toPn(n);if(r!=null){var a=yield v(r.toString());if(a!=null)return babelHelpers.extends({},a,{id:n})}}return t}),L.apply(this,arguments)}function E(e){return k.apply(this,arguments)}function k(){return k=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=o("WAWebWidFactory").createWid(e),n=o("WAWebLidMigrationUtils").toLid(t);if(n!=null){var r=yield v(n.toString());if(r!=null)return babelHelpers.extends({},r,{id:t})}return v(e)}),k.apply(this,arguments)}function I(e){return T.apply(this,arguments)}function T(){return T=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){if(!o("WAWebBizGatingUtils").isLidMigrationForBusinessProfileEnabled())return v(e);var t=o("WAWebWidFactory").createWid(e);return t.isLid()?R(e):E(e)}),T.apply(this,arguments)}function D(e){return x.apply(this,arguments)}function x(){return x=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=M(e);yield o("WAWebSchemaBusinessProfile").getBusinessProfileTable().createOrMerge(t.id,t)}),x.apply(this,arguments)}function $(e){return P.apply(this,arguments)}function P(){return P=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e.id,r=o("WAWebBizGatingUtils").isLidMigrationForBusinessProfileEnabled()?o("WAWebLidMigrationUtils").getPnAndLidToUpdate(t):[t];return(m||(m=n("Promise"))).all(r.map(function(t){return D(babelHelpers.extends({},e,{id:t}))}))}),P.apply(this,arguments)}function N(t){var n=t.commandsDescription,r=o("WAWebWidFactory").createWid(t.id),a=o("WAWebBotTypes").BizBotAutomatedType.cast(t.automatedType),i=o("WAWebBotTypes").BotWelcomeMsgProtocolModeType.cast(t.welcomeMsgProtocolMode),l;if(t.prompts!=null)try{l=JSON.parse(t.prompts),Array.isArray(l)||(l=null,o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["businessProfileFromDbRow: prompts are not an array"]))).sendLogs("businessProfileFromDbRow: prompts are not an array"))}catch(e){o("WALogger").ERROR(u||(u=babelHelpers.taggedTemplateLiteralLoose(["businessProfileFromDbRow: prompts parsing failed"]))).sendLogs("businessProfileFromDbRow: prompts parsing failed")}var s;if(t.commands!=null)try{s=JSON.parse(t.commands),Array.isArray(s)||(s=null,o("WALogger").ERROR(c||(c=babelHelpers.taggedTemplateLiteralLoose(["businessProfileFromDbRow: commands are not an array"]))).sendLogs("businessProfileFromDbRow: commands are not an array"))}catch(e){o("WALogger").ERROR(d||(d=babelHelpers.taggedTemplateLiteralLoose(["businessProfileFromDbRow: commands parsing failed"]))).sendLogs("businessProfileFromDbRow: commands parsing failed")}return{id:r,automatedType:a,welcomeMsgProtocolMode:i,prompts:l,commands:s,commandsDescription:n}}function M(e){var t=e.commandsDescription,n=e.id.toString(),r;e.automatedType&&(r=e.automatedType);var o;e.welcomeMsgProtocolMode&&(o=e.welcomeMsgProtocolMode);var a=e.prompts?JSON.stringify(e.prompts):void 0,i=e.commands?JSON.stringify(e.commands):void 0;return{id:n,automatedType:r,welcomeMsgProtocolMode:o,prompts:a,commandsDescription:t,commands:i}}l.getBusinessProfileRow=p,l.getBusinessProfileRowLidAware=C,l.getBusinessProfileRecord=v,l.getBusinessProfileRecordLidAware=I,l.createOrMergeBusinessProfileRecordLidAware=$,l.businessProfileFromDbRow=N}),98);
__d("WAWebWorkerStorageUtils",["invariant","Promise","WAWebIdb","WAWebStorage","err"],(function(t,n,r,o,a,i,l,s){var e,u="worker-storage",c=null;function d(){var e=new(r("WAWebIdb"))(u);c=new(o("WAWebStorage")).Storage(e)}function m(){return c!=null||s(0,56324),c}function p(){return c==null?(e||(e=n("Promise"))).reject(r("err")("[worker-storage] Storage should be created first before being destroyed")):c.purge().then(function(){c=null}).catch(function(e){throw c=null,e})}l.DATABASE_NAME=u,l.createStorage=d,l.getStorage=m,l.destroyStorage=p}),98);
__d("WAWebWorkerStorageVersions",["WAWebWorkerStorageUtils"],(function(t,n,r,o,a,i,l){function e(){return o("WAWebWorkerStorageUtils").getStorage().versions.version(0)}function s(){return o("WAWebWorkerStorageUtils").getStorage().versions.version(1)}l.localStorageCreateTable=e,l.deferredMessagesStorageCreateTable=s}),98);
__d("WAWebSchemaDeferredMessagesStorage",["WAWebStorageMutationBuilder","WAWebStorageSchema","WAWebWorkerStorageUtils","WAWebWorkerStorageVersions"],(function(t,n,r,o,a,i,l){var e=o("WAWebStorageMutationBuilder").columnBuilder(),s=e.addColumn,u=e.addEncryptedColumn,c=e.addUserDefinedPrimaryKey;function d(){o("WAWebWorkerStorageUtils").getStorage().add("deferred_messages").version(o("WAWebWorkerStorageVersions").deferredMessagesStorageCreateTable(),[c("id"),s("type"),u("plaintext",o("WAWebStorageSchema").EncryptedValueType.ARRAY_BUFFER),s("info"),s("paymentInfo"),s("bizInfo")]).view(function(e){return{id:e.id,type:e.type,plaintext:e.plaintext,info:e.info,paymentInfo:e.paymentInfo,bizInfo:e.bizInfo}}).useDbMsgEncKeyForEncryptedCol(!0)}function m(){return o("WAWebWorkerStorageUtils").getStorage().table("deferred_messages")}l.addTable=d,l.getTable=m}),98);
__d("WAWebApiDeferredMessagesStorage",["WAWebSchemaDeferredMessagesStorage","WAWebWorkerStorageUtils","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){function e(){return o("WAWebSchemaDeferredMessagesStorage").getTable().all().then(function(e){return e.map(function(e){return{id:e.id,type:e.type,plaintext:e.plaintext,info:e.info,paymentInfo:e.paymentInfo,bizInfo:e.bizInfo}})})}function s(e){var t=e.map(function(e){return{id:e.id,type:e.type,plaintext:e.plaintext,info:e.info,paymentInfo:e.paymentInfo,bizInfo:e.bizInfo}});return o("WAWebWorkerStorageUtils").getStorage().lock(["deferred_messages"],(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var n=e[0];yield n.bulkCreateOrReplace(t)});return function(t){return e.apply(this,arguments)}})())}function u(e){return o("WAWebSchemaDeferredMessagesStorage").getTable().remove(e)}function c(){return o("WAWebSchemaDeferredMessagesStorage").getTable().clear()}var d={getDeferredMessages:e,updateDeferredMessages:s,deleteDeferredMessage:u,clearDeferredMessages:c};l.default=d}),98);
__d("WAWebSchemaLocalStorage",["WAWebStorageMutationBuilder","WAWebWorkerStorageUtils","WAWebWorkerStorageVersions"],(function(t,n,r,o,a,i,l){var e=o("WAWebStorageMutationBuilder").columnBuilder(),s=e.addColumn,u=e.addUserDefinedPrimaryKey;function c(){o("WAWebWorkerStorageUtils").getStorage().add("local_storage").version(o("WAWebWorkerStorageVersions").localStorageCreateTable(),[u("key"),s("value")]).view(function(e){return{key:e.key,value:e.value}})}function d(){return o("WAWebWorkerStorageUtils").getStorage().table("local_storage")}l.addTable=c,l.getTable=d}),98);
__d("WAWebApiLocalStorage",["WAWebSchemaLocalStorage","WAWebWorkerStorageUtils","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){function e(e){return o("WAWebSchemaLocalStorage").getTable().get(e).then(function(e){return e==null?void 0:e.value})}function s(e){var t=e.map(function(e){return{key:e.key,value:e.value}});return o("WAWebWorkerStorageUtils").getStorage().lock(["local_storage"],(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var n=e[0];yield n.clear(),yield n.bulkCreateOrReplace(t)});return function(t){return e.apply(this,arguments)}})())}function u(){return o("WAWebSchemaLocalStorage").getTable().clear()}l.getLocalStorageValue=e,l.updateLocalStorage=s,l.clearLocalStorage=u}),98);
__d("WAWebApiOrphanTcToken",["Promise","WAWebLidMigrationUtils","WAWebSchemaOrphanTcToken","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e;function s(e){return u.apply(this,arguments)}function u(){return u=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){if(t.isUser()){var r=o("WAWebSchemaOrphanTcToken").getOrphanTcTokenTable(),a=o("WAWebLidMigrationUtils").toPn(t),i=o("WAWebLidMigrationUtils").toLid(t),l=[];a!=null&&l.push(r.remove(a.toString())),i!=null&&l.push(r.remove(i.toString())),yield(e||(e=n("Promise"))).all(l)}}),u.apply(this,arguments)}function c(e){return d.apply(this,arguments)}function d(){return d=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var r,a;if(!t.isUser())return null;var i=o("WAWebSchemaOrphanTcToken").getOrphanTcTokenTable(),l=o("WAWebLidMigrationUtils").toPn(t),s=o("WAWebLidMigrationUtils").toLid(t),u=[];l!=null&&u.push(i.get(l.toString())),s!=null&&u.push(i.get(s.toString()));var c=yield(e||(e=n("Promise"))).all(u),d=c[0],m=c[1],p=(r=d==null?void 0:d.tcTokenTimestamp)!=null?r:0,_=(a=m==null?void 0:m.tcTokenTimestamp)!=null?a:0;return p>_||m==null?d:m}),d.apply(this,arguments)}function m(e,t){return p.apply(this,arguments)}function p(){return p=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n;if(e.isUser()){var r=(n=o("WAWebLidMigrationUtils").toLid(e))!=null?n:e,a=r.toString();return o("WAWebSchemaOrphanTcToken").getOrphanTcTokenTable().createOrMerge(a,babelHelpers.extends({chatId:a},t))}}),p.apply(this,arguments)}l.removeOrphanTcToken=s,l.getOrphanTcToken=c,l.createOrUpdateOrphanTcToken=m}),98);
__d("WAWebApiPeerMessageStore",["WAWebMsgKey","WAWebSchemaPeerMessage","WAWebUserPrefsMeUser"],(function(t,n,r,o,a,i,l){var e=["kind"];function s(t){var n=t.map(function(t){var n=t.kind,r=babelHelpers.objectWithoutPropertiesLoose(t,e);return babelHelpers.extends({},r,{id:String(t.id),to:String(t.to),subtype:String(t.subtype)})});return o("WAWebSchemaPeerMessage").getPeerMessageTable().bulkCreate(n)}function u(e){var t=o("WAWebSchemaPeerMessage").getPeerMessageTable(),n=new(r("WAWebMsgKey"))({fromMe:!0,remote:o("WAWebUserPrefsMeUser").getMePnUserOrThrow(),id:e});return t.remove(n.toString())}l.storePeerMessages=s,l.deletePeerMessage=u}),98);
__d("WAWebArkoseExpUtils",["$InternalEnum","WAWebAutoLogoutGating","gkx","justknobx"],(function(t,n,r,o,a,i,l){"use strict";var e=n("$InternalEnum")({NONE:-1,CONTROL:0,TEST:1,DEV:2});function s(){if(!r("justknobx")._("5007"))return u();if(o("WAWebAutoLogoutGating").isRunningInAutoLogoutIframe()){var t=window.parent.arkoseVariant,n=e.cast(t);return n!=null?n:u()}var a=u();return window.arkoseVariant=a,a}function u(){return r("gkx")("26256")||!r("gkx")("18518")?e.NONE:r("gkx")("26258")?r("gkx")("19648")?e.TEST:e.CONTROL:r("gkx")("7634")?e.DEV:e.NONE}function c(){return s()===e.TEST||s()===e.DEV}l.ArkoseVariantType=e,l.getArkoseVariant=s,l.isArkoseAllowedToRun=c}),98);
__d("WAWebArrowForwardIcon.react",["WAWebSvgComponentBase","react","stylex"],(function(t,n,r,o,a,i,l){var e=["iconXstyle","height","width","name","viewBox"],s,u,c=s||(s=r("react")),d="arrow-forward";function m(t){var n=t.iconXstyle,a=t.height,i=t.width,l=t.name,s=t.viewBox,m=babelHelpers.objectWithoutPropertiesLoose(t,e),p;if(s){var _=s.x,f=_===void 0?0:_,g=s.y,h=g===void 0?0:g,y=s.width,C=y===void 0?0:y,b=s.height,v=b===void 0?0:b;p=[f,h,C,v].join(" ")}var S=30,R=30;return(a!=null||i!=null)&&(S=a,R=i),c.jsx(o("WAWebSvgComponentBase").BaseSvgSpan,babelHelpers.extends({name:l!=null?l:d},m,{children:c.jsxs("svg",{viewBox:p!=null?p:"0 0 30 30",height:S,width:R,preserveAspectRatio:"xMidYMid meet",className:(u||(u=r("stylex")))(n),version:"1.1",x:"0px",y:"0px",enableBackground:"new 0 0 30 30",children:[c.jsx("title",{children:l!=null?l:d}),c.jsx("path",{fill:"currentColor",d:"M15,7l-1.4,1.4l5.6,5.6H7v2h12.2l-5.6,5.6L15,23l8-8L15,7z"})]})}))}m.displayName=m.name+" [from "+i.id+"]",l.ArrowForwardIcon=m}),98);
__d("WAWebAssetLoaderDpiChangeDispatch",[],(function(t,n,r,o,a,i){var e={LOW:"low",HIGH:"high"},l=window.matchMedia("\n    only screen and (-webkit-min-device-pixel-ratio: 2),\n    only screen and (min-device-pixel-ratio: 2),\n    only screen and (min-resolution: 2dppx)\n"),s={RES:e,currentRes:l.matches?e.HIGH:e.LOW},u=function(n){var t=n.matches?e.HIGH:e.LOW;if(t!==s.currentRes){s.currentRes=t;var r=document.createEvent("Event");r.initEvent("dpichange",!0,!0),window.dispatchEvent(r)}};l.addListener(u);var c=s;i.default=c}),66);
__d("WAWebAssetLoaderDynamicStyle",["WACamelCase","lodash","uniqueID"],(function(t,n,r,o,a,i,l){var e=(function(){function e(e){this.rules={},this.styleSheet=this.createStyleSheet(e)}var t=e.prototype;return t.createStyleSheet=function(t){var e=t||r("uniqueID")("dynamic-style-"),n=document.createElement("style");return n.id=e,n.type="text/css",document.head&&document.head.appendChild(n),n=n.sheet,n},t.addRule=function(t,n){var e=this.styleSheet.cssRules.length,r=Object.entries(n).map(function(e){var t=e[0],n=e[1];return t+": "+n+";"}).join(" ");return this.styleSheet.insertRule(t+" { "+r+" }",e),this.rules[t]=this.styleSheet.cssRules[e],this.rules[t]},t.updateRule=function(t,n){var e=this.rules[t];return r("lodash").forOwn(n,function(t,n){e.style[r("WACamelCase")(n)]=t}),e},t.setRule=function(t,n){var e=this.rules[t];return e?this.updateRule(t,n):this.addRule(t,n)},e})();l.default=e}),98);
__d("WAWebAssetToLoad",[],(function(t,n,r,o,a,i){var e=(function(){function e(e,t,n){this.retryCount=0,this.asset=e,this.resolution=t,this.priority=n}var t=e.prototype;return t.getLoadUrlPromise=function(){return this.$3},t.setLoadUrlPromise=function(t,n){this.$3=t,this.$5=n},t.abortLoadUrlPromise=function(){var e;(e=this.$5)==null||e.abort()},t.getConsumerPromise=function(){return this.$1},t.setConsumerPromise=function(t){this.$1=t},t.getConsumerPromiseResolve=function(){return this.$2},t.setConsumerPromiseResolve=function(t,n){this.$2=t,this.$4=n},t.abortConsumerPromise=function(){var e;(e=this.$4)==null||e.abort()},e})();i.default=e}),66);
__d("distinctArray",[],(function(t,n,r,o,a,i){function e(e){if(e==null)return[];if(Array.isArray(e)){var t=e.length;if(t<=200){for(var n=[],r=0;r<t;r++){var o=e[r];n.indexOf(o)===-1&&n.push(o)}return n}}return Array.from(new Set(e).values())}i.default=e}),66);
__d("WAWebEmojiAssetLoader",["WAWebEmoji","WAWebEmojiConst","WAWebMobilePlatforms","distinctArray","lodash"],(function(t,n,r,o,a,i,l){var e,s=r("lodash").memoize(function(t,n){for(var a=new Map,i=u(t),l=n[i],s=l.SELECTOR,c=Math.ceil((e||(e=r("distinctArray")))(r("lodash").values(l.UNICODE_TO_EMOJI)).length/o("WAWebEmojiConst").BUCKET_SIZE),d=0;d<c;d+=1){var m,p="emoji-"+s+"-b"+d,_=40;a.set(p,{id:p,selectors:[".emoji."+s+".b"+d,".emojik."+s+".b"+d],low:{webp:(m=o("WAWebEmoji")).EmojiUtil.getSpritesPath(i,d,_,"webp"),default:m.EmojiUtil.getSpritesPath(i,d,40,"png")},high:{default:m.EmojiUtil.getSpritesPath(i,d,64,"png"),webp:m.EmojiUtil.getSpritesPath(i,d,64,"webp")}})}return a});function u(e){switch(e){case o("WAWebMobilePlatforms").PLATFORMS.IPHONE:case o("WAWebMobilePlatforms").PLATFORMS.SMBI:case o("WAWebMobilePlatforms").PLATFORMS.IPAD:return o("WAWebEmojiConst").EMOJI_TYPE.APPLE;default:return o("WAWebEmojiConst").EMOJI_TYPE.WHATSAPP}}function c(e){return function(t){return s(t,e)}}l.getEmojiTypeFromPlatform=u,l.emojiAssetMapCreator=c}),98);
__d("WAWebPonyfillsMediaError",[],(function(t,n,r,o,a,i){var e=window.MediaError||{MEDIA_ERR_ABORTED:1,MEDIA_ERR_NETWORK:2,MEDIA_ERR_DECODE:3,MEDIA_ERR_SRC_NOT_SUPPORTED:4},l=e;i.default=l}),66);
__d("WAWebWamEnumWebcMediaLoadResultCode",[],(function(t,n,r,o,a,i){var e=Object.freeze({SUCCESS:0,SILENCE:1,ZEROWIDTH:2});i.WEBC_MEDIA_LOAD_RESULT_CODE=e}),66);
__d("WAWebWebcMediaLoadWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumWebcMediaLoadResultCode"],(function(t,n,r,o,a,i,l){var e=o("WAWebWamCodegenUtils").defineEvents({WebcMediaLoad:[1202,{webcMediaLoadResult:[2,o("WAWebWamEnumWebcMediaLoadResultCode").WEBC_MEDIA_LOAD_RESULT_CODE],webcMediaLoadT:[1,o("WAWebWamCodegenUtils").TYPES.TIMER]},[1,1,1],"regular"]},{WebcMediaLoad:[]});l.WebcMediaLoadWamEvent=e}),98);
__d("WAWebMediaLoad",["Promise","WACustomError","WAFilteredCatch","WALogger","WAOpusRecorderPlayer","WAPromiseDelays","WAPromiseTimeout","WAWebMimeTypes","WAWebMiscErrors","WAWebNoop","WAWebPonyfillsMediaError","WAWebUA","WAWebWamEnumWebcMediaLoadResultCode","WAWebWebcMediaLoadWamEvent","err"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p,_,f,g,h,y=6e5,C=new Audio().canPlayType("audio/ogg"),b=0,v=(h||(h=n("Promise"))).resolve();function S(e){var t;if(!e||!e.error)return null;var n=e.error,o=Object.keys(r("WAWebPonyfillsMediaError")),a=(t=o.find(function(e){return r("WAWebPonyfillsMediaError")[e]===n.code}))!=null?t:"UNKNOWN CODE "+n.code,i=n.message,l=i!=null&&~i.indexOf(":")?i.split(":")[0]:"";return l?a+": "+l:a}function R(e,t){t===void 0&&(t=!0);var a;return new(h||(h=n("Promise")))(function(n,i){a=new Image;var l=/^(?:data|blob):/.test(e);t&&!l&&a.setAttribute("crossOrigin","anonymous"),a.onload=n,a.onabort=function(){i(r("err")("loadImage onabort"))},a.onerror=function(e){i(new(o("WAWebMiscErrors")).InvalidImageFileType("Image tag load error"))},a.src=e}).then(function(){return a})}function L(e){return R(e).then(function(e){if(e&&e.naturalWidth>0)return{img:e,fullWidth:e.naturalWidth,fullHeight:e.naturalHeight};throw new(o("WAWebMiscErrors")).MediaLoadError("image loaded with zero width")}).catch(function(){throw new(o("WAWebMiscErrors")).MediaLoadError("unable to render image")})}function E(e){var t=v.then(function(){return k(e)});return v=o("WAPromiseTimeout").promiseTimeout(t,1e3).then(r("WAWebNoop"),r("WAWebNoop")),t}function k(t){var r=new(o("WAWebWebcMediaLoadWamEvent")).WebcMediaLoadWamEvent,a=null,i,l,f=++b;function g(){i&&a&&(document.body&&document.body.removeChild(a),a=null)}var y=!0,C=new(h||(h=n("Promise")))(function(n,r){o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["MediaLoad:video called (#",")"])),f);var d=!1,m=!1;i=document.createElement("video"),i.setAttribute("crossOrigin","anonymous"),i.volume=0,i.muted=!0,i.playsinline=!0;var p=function(){m&&d&&n()};if(i.onloadedmetadata=function(){o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["MediaLoad:video.onloadedmetadata #",". Video ready: ",". Video width: ",""])),f,m,i.videoWidth),i.onloadedmetadata=null,d=!0,p()},i.oncanplaythrough=function(){o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["MediaLoad:video.oncanplaythrough #",". Metadata loaded: ",". Video width: ",""])),f,d,i.videoWidth),i.oncanplaythrough=null,i.onseeked=function(){m=!0,i.onseeked=null,p()},i.currentTime=0},i.onerror=function(){var e=i.error?i.error.message:"no error message";o("WALogger").WARN(c||(c=babelHelpers.taggedTemplateLiteralLoose(["MediaLoad:video.onerror #",": ","\n Blob info -> size:",", type: ",""],["MediaLoad:video.onerror #",": ","\\n Blob info -> size:",", type: ",""])),f,String(e),t.size,t.type);var n=S(i);r(new(o("WAWebMiscErrors")).UnableToPlayVideoError(n))},i.src=l=window.URL.createObjectURL(t),o("WAWebUA").UA.isSafari){a=document.createElement("div");var _=a;_.style="opacity: 0.004",_.appendChild(i),document.body&&document.body.appendChild(_)}i.load(),i.currentTime=1}).finally(function(){y=!1});self.setTimeout(function(){g(),y&&(o("WALogger").WARN(d||(d=babelHelpers.taggedTemplateLiteralLoose(["unable to load video #"," ("," bytes)"])),f,t.size),new(o("WAWebWebcMediaLoadWamEvent")).WebcMediaLoadWamEvent({webcMediaLoadResult:o("WAWebWamEnumWebcMediaLoadResultCode").WEBC_MEDIA_LOAD_RESULT_CODE.SILENCE}).commit())},8e3);var v=2e4,R=10,L=o("WAPromiseTimeout").promiseTimeout(C,v).then(function(){return o("WAPromiseDelays").delayMs(R)}).then(function(){if(r.markWebcMediaLoadT(),o("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["MediaLoad:video #"," successful"])),f),i.pause(),i.videoWidth>0)return r.webcMediaLoadResult=o("WAWebWamEnumWebcMediaLoadResultCode").WEBC_MEDIA_LOAD_RESULT_CODE.SUCCESS,r.commit(),{video:i,fullWidth:i.videoWidth,fullHeight:i.videoHeight,duration:i.duration};throw i.duration>0?(o("WALogger").WARN(p||(p=babelHelpers.taggedTemplateLiteralLoose(["MediaLoad:video #"," dimensions are not defined. Video readyState: ",". Video width: ",""])),f,i.readyState,i.videoWidth),new(o("WAWebMiscErrors")).MediaUnsupportedError("video loaded with duration but no dims")):(r.webcMediaLoadResult=o("WAWebWamEnumWebcMediaLoadResultCode").WEBC_MEDIA_LOAD_RESULT_CODE.ZEROWIDTH,r.commit(),new(o("WAWebMiscErrors")).MediaLoadError("video loaded with zero width"))}).catch(o("WAFilteredCatch").filteredCatch(o("WACustomError").TimeoutError,function(e){throw o("WALogger").ERROR(_||(_=babelHelpers.taggedTemplateLiteralLoose(["MediaLoad:video load error, currentTime=",". duration=",""])),i.currentTime,i.duration).sendLogs("video-load-timeout",{sampling:.01}),e})).finally(function(){g(),i&&(i.onloadedmetadata=null,i.onloadeddata=null,i.oncanplaythrough=null,i.ontimeupdate=null,i.onerror=null),l&&window.URL.revokeObjectURL(l)});return L.catch(function(){T(i)}),L}function I(e){return E(e).then(function(e){var t=e.video,n=e.fullWidth,r=e.fullHeight,o=e.duration;return T(t),{width:n,height:r,duration:o}})}function T(e){try{e.pause(),e.src="",e.load()}catch(e){o("WALogger").ERROR(f||(f=babelHelpers.taggedTemplateLiteralLoose(["Error: ",""])),String(e)).devConsole(e).sendLogs("dispose-video-error")}}function D(e,t){var a=t||e.type;if(o("WAWebMimeTypes").isOpus(a)&&!C){if(e.size<=y){var i=new(r("WAOpusRecorderPlayer"))(e);return i.generateBlob()}return o("WALogger").WARN(g||(g=babelHelpers.taggedTemplateLiteralLoose(["MediaLoad:transcode TranscodeBlobTooLargeError blob too large = ",""])),e.size),(h||(h=n("Promise"))).reject(new(o("WAWebMiscErrors")).TranscodeBlobTooLargeError)}return(h||(h=n("Promise"))).resolve(e)}l.canPlayOgg=C,l.loadImage=R,l.image=L,l.loadVideo=E,l.videoWidthHeightDuration=I,l.disposeVideo=T,l.transcode=D}),98);
__d("WAWebFeatureDetectionDetectWebpSupport",["Promise","WAPromiseTimeout","WAWebMediaLoad","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s="data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA",u=o("WAPromiseTimeout").promiseTimeout(new(e||(e=n("Promise")))(function(e){o("WAWebMediaLoad").loadImage(s).then(function(t){return e(t.height===2)})}),5e3).catch(function(){return!1}),c=null;function d(){return m.apply(this,arguments)}function m(){return m=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(c!=null)return(e||(e=n("Promise"))).resolve(c);var t=yield u;return c=t,t}),m.apply(this,arguments)}function p(){return c}l.detectWebpSupport=d,l.getCachedWebpSupport=p}),98);
__d("WAWebHttpErrors",["WACustomError","gkx"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(){return e.apply(this,arguments)||this}return babelHelpers.inheritsLoose(t,e),t})(o("WACustomError").customError("HttpNetworkError")),s=(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return t=e.call.apply(e,[this].concat(r))||this,t.name="HttpTimedOutError",babelHelpers.assertThisInitialized(t)||babelHelpers.assertThisInitialized(t)}return babelHelpers.inheritsLoose(t,e),t})(e),u=(function(e){function t(t,n,o){var a,i=!r("gkx")("26258")&&(o==null?void 0:o.url)!=null?n+": "+t+" "+o.url:n+": "+t;return a=e.call(this,i)||this,a.status=t,a}return babelHelpers.inheritsLoose(t,e),t})(o("WACustomError").customError("HttpStatusCodeError")),c=(function(e){function t(t,n){var o=!r("gkx")("26258")&&(n==null?void 0:n.url)!=null?t+": "+n.url:t;return e.call(this,o)||this}return babelHelpers.inheritsLoose(t,e),t})(o("WACustomError").customError("HttpInvalidResponseError")),d=(function(e){function t(t){var n;return n=e.call(this,"mmsDownload: filehash mismatch",t)||this,n.name="MmsDownloadFilehashMismatchError",n}return babelHelpers.inheritsLoose(t,e),t})(c);l.HttpNetworkError=e,l.HttpTimedOutError=s,l.HttpStatusCodeError=u,l.HttpInvalidResponseError=c,l.MmsDownloadFilehashMismatchError=d}),98);
__d("WAWebHttpExtendedFetchWithStreams",["WAWebMediaGatingUtils","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e=["onHeadersReceived","onProgress","onData","timeout"];function s(e){return"fetch"in self&&"ReadableStream"in self&&(e==="get"||e==null)&&o("WAWebMediaGatingUtils").isNativeFetchEnabled()}function u(e,t){return c.apply(this,arguments)}function c(){return c=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,n){var r,o=n.onHeadersReceived,a=n.onProgress,i=n.onData,l=n.timeout,s=babelHelpers.objectWithoutPropertiesLoose(n,e),u=yield self.fetch(t,s),c=u.headers;if(o==null||o(c),a==null&&i==null||s.method!=="get"&&s.method!=null)return u;var m=c.get("Content-Length"),p=m!=null?Number.parseInt(m,10):null,_=(r=u.clone().body)==null?void 0:r.getReader();return d(_,{onProgress:a,onData:i},{contentLength:p}),u}),c.apply(this,arguments)}function d(e,t,n){if(e!=null){var r=0;return new ReadableStream({start:function(a){o();function o(){e.read().then(function(e){var i=e.done,l=e.value;if(i||!(l instanceof Uint8Array))return a.close();r+=l.byteLength;var s=new ProgressEvent("progress",{total:n.contentLength,lengthComputable:n.contentLength!=null,loaded:r});t.onData==null||t.onData(s,l.buffer),t.onProgress==null||t.onProgress(s),a.enqueue(l),o()}).catch(function(){a.close()})}}})}}l.canUseExtendedFetchWithStreams=s,l.extendedFetchWithStreams=u}),98);
__d("WAWebHttpParseHeaders",[],(function(t,n,r,o,a,i){function e(e){return(e||"").trim().toLowerCase().split("\n").reduce(function(e,t){if(!t.trim())return e;var n=t.indexOf(":"),r=t.substr(0,n).trim(),o=t.substr(n+1).trim().replace(/;$/,"");return e[r]?Array.isArray(e[r])?e[r].push(o):e[r]+=", "+o:e[r]=o,e},{})}i.default=e}),66);
__d("WAWebPonyfillsSymbol",[],(function(t,n,r,o,a,i){var e,l="Symbol"in window?Symbol:(e=function(){},e.iterator="@@iterator",e);i.default=l}),66);
__d("WAWebPonyfillsHeaders",["WAIterableOperators","WAWebPonyfillsSymbol"],(function(t,n,r,o,a,i,l){var e,s;function u(e){throw new TypeError('"'+e+'" is read-only')}var c="Headers"in window&&Headers?Headers:(s=typeof r("WAWebPonyfillsSymbol")=="function"?r("WAWebPonyfillsSymbol").iterator:"@@iterator",e=(function(){function e(t){var n=this;if(this.$1={},t instanceof e){var r=function(){var e=o[0],t=o[1],r=t.split(", ");r.forEach(function(t){n.append(e,t)})};for(var o of t.entries())r()}else if(typeof t=="object"){var a=function(r){var e=t[r],o=e.split(", ");o.forEach(function(e){n.append(r,e)})};for(var i in t)a(i)}}var t=e.prototype;return t.append=function(t,n){var e=t.toLowerCase();e in this.$1?this.$1[e].push(n):this.$1[e]=[n]},t.delete=function(t){var e=t.toLowerCase();delete this.$1[e]},t.entries=function(){var e=this,t=Object.keys(this.$1).map(function(t){return[t,e.get(t)||""]});return o("WAIterableOperators").iteratorFromArray(t)},t.get=function(t){var e=t.toLowerCase();return e in this.$1?this.$1[e].join(", "):null},t.has=function(t){var e=t.toLowerCase();return e in this.$1},t.keys=function(){return o("WAIterableOperators").mapIterator(this.entries(),function(e){var t=e[0];return t})},t.set=function(t,n){var e=t.toLowerCase();this.$1[e]=[n]},t.values=function(){return o("WAIterableOperators").mapIterator(this.entries(),function(e){var t=e[0],n=e[1];return n})},t[s]=function(){return this.entries()},t.toString=function(){return"[Object Headers]"},e})(),e);l.default=c}),98);
__d("WAWebHttpExtendedFetch",["$InternalEnum","Promise","WAAbortError","WAArrayBufferUtils","WAWebHttpErrors","WAWebHttpExtendedFetchWithStreams","WAWebHttpParseHeaders","WAWebNoop","WAWebPonyfillsHeaders","asyncToGeneratorRuntime","err","w3c-domcore-errors"],(function(t,n,r,o,a,i,l){var e,s=n("$InternalEnum")({UNSENT:0,OPENED:1,HEADERS_RECEIVED:2,LOADING:3,DONE:4});function u(e,t){return c.apply(this,arguments)}function c(){return c=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){t===void 0&&(t={});try{return o("WAWebHttpExtendedFetchWithStreams").canUseExtendedFetchWithStreams(t.method)?yield o("WAWebHttpExtendedFetchWithStreams").extendedFetchWithStreams(e,t):yield d(e,t)}catch(e){throw e.name===o("WAAbortError").ABORT_ERROR?new(o("WAAbortError")).AbortError:e instanceof o("WAWebHttpErrors").HttpNetworkError?e:new(o("WAWebHttpErrors")).HttpNetworkError(e.message)}}),c.apply(this,arguments)}function d(t,a){return a===void 0&&(a={}),new(e||(e=n("Promise")))(function(i,l){var u;if((u=a.signal)!=null&&u.aborted){l(new(o("w3c-domcore-errors")).DOMException("AbortError"));return}var c=new XMLHttpRequest;if(a.signal){var d=a.signal;d.addEventListener("abort",function e(){d.removeEventListener("abort",e),c.onreadystatechange=r("WAWebNoop"),c.abort(),l(new(o("w3c-domcore-errors")).DOMException("AbortError"))})}var m=a,p=m.onProgress,_=m.onData;if(p!=null||_){var f;(((f=a.method)==null?void 0:f.toLowerCase())==="post"&&c.upload!=null?c.upload:c).onprogress=function(e){_&&_(e,c.responseText),p&&p(e)}}var g=a,h=g.onHeadersReceived;c.onreadystatechange=function(){if(c.readyState===s.UNSENT){l(r("err")("fetch error: not sent"));return}else if(c.readyState===s.HEADERS_RECEIVED&&h!=null){h(new(r("WAWebPonyfillsHeaders"))(r("WAWebHttpParseHeaders")(c.getAllResponseHeaders())));return}else if(c.readyState===s.DONE){if(c.status==null){l(r("err")("fetch error: no status"));return}if(c.status===0||c.status>=12e3){l(r("err")("fetch error: unexpected status "+c.status));return}i(v())}},c.onerror=function(){return l(r("err")("fetch error: error"))},c.ontimeout=function(){l(new(o("WAWebHttpErrors")).HttpTimedOutError("fetch error: timedout"))},c.withCredentials=a.credentials==="include",a.timeout!=null&&(c.timeout=a.timeout),c.open(a.method||"get",t.toString(),!0);var y=new(r("WAWebPonyfillsHeaders"))(a.headers||{});for(var C of y.keys()){var b=y.get(C);b!=null&&c.setRequestHeader(C,b)}_?c.overrideMimeType("text/plain; charset=x-user-defined"):c.responseType="arraybuffer",c.send(a.body||null);function v(){var t=new(r("WAWebPonyfillsHeaders"))(r("WAWebHttpParseHeaders")(c.getAllResponseHeaders()));return babelHelpers.extends({ok:200<=c.status&&c.status<300,statusText:c.statusText,status:c.status,url:c.responseURL},S(),{blob:function(){return(e||(e=n("Promise"))).resolve(new Blob([c.response],{type:t.get("content-type")||""}))},clone:v,headers:t})}function S(){return _?{text:function(){return(e||(e=n("Promise"))).resolve(c.responseText)},json:function(){return(e||(e=n("Promise"))).resolve(JSON.parse(c.responseText))},arrayBuffer:function(){return o("WAArrayBufferUtils").largeStringToArrayBuffer(c.responseText)}}:{text:function(){return R()},json:(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=yield R();return JSON.parse(e)});function t(){return e.apply(this,arguments)}return t})(),arrayBuffer:function(){return c.response}}}function R(){return(e||(e=n("Promise"))).resolve(String.fromCharCode.apply(String,Array.from(new Uint8Array(c.response))))}})}l.extendedFetch=u,l.sharedFetch=d}),98);
__d("WAWebLoadAssetUrl",["WACustomError","WANullthrows","WAWebFeatureDetectionDetectWebpSupport","WAWebHttpExtendedFetch","WAWebNetworkStatus","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e={DEFAULT:"default",WEBP:"webp"},s=(function(e){function t(t,n,r){var o;return o=e.call(this,"Failed to load url. StatusCode: "+n+". Duration: "+r+" ms")||this,o.url=t,o.statusCode=n,o}return babelHelpers.inheritsLoose(t,e),t})(o("WACustomError").customError("LoadUrlError"));function u(e){return c.apply(this,arguments)}function c(){return c=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var n=yield o("WAWebFeatureDetectionDetectWebpSupport").detectWebpSupport(),a=t.asset,i=t.resolution,l=n&&a[i][e.WEBP]?e.WEBP:e.DEFAULT;return r("WANullthrows")(a[i][l])}),c.apply(this,arguments)}function d(e){var t=new AbortController,a=u(e).then((function(){var a=n("asyncToGeneratorRuntime").asyncToGenerator(function*(n){yield r("WAWebNetworkStatus").waitIfOffline();var a=Date.now(),i=yield o("WAWebHttpExtendedFetch").extendedFetch(n,{signal:t.signal}),l=e.getConsumerPromiseResolve();if(i.ok&&l)l(n);else throw new s(n,i.status,Date.now()-a)});return function(e){return a.apply(this,arguments)}})());return e.setLoadUrlPromise(a,t),a}l.LoadUrlError=s,l.getSupportedImageFormatUrl=u,l.loadUrl=d}),98);
__d("WAWebWamEnumWebcAssetCacheTypeCode",[],(function(t,n,r,o,a,i){var e=Object.freeze({UNCACHED:0,IDB:1,SW:2});i.WEBC_ASSET_CACHE_TYPE_CODE=e}),66);
__d("WAWebWebcAssetLoadWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumWebcAssetCacheTypeCode"],(function(t,n,r,o,a,i,l){var e,s=(e=o("WAWebWamCodegenUtils")).defineEvents({WebcAssetLoad:[1358,{webcAssetCacheType:[4,o("WAWebWamEnumWebcAssetCacheTypeCode").WEBC_ASSET_CACHE_TYPE_CODE],webcAssetFromCache:[2,e.TYPES.BOOLEAN],webcAssetLoadT:[3,e.TYPES.TIMER],webcAssetName:[1,e.TYPES.STRING],webcAssetSize:[5,e.TYPES.NUMBER]},[1,1,1],"regular"]},{WebcAssetLoad:[]});l.WebcAssetLoadWamEvent=s}),98);
__d("WAWebAssetLoader",["invariant","Promise","WAAbortError","WABackoffUtils","WALogger","WANullthrows","WAPriorityQueue","WAPromiseRaceAbort","WAWebAssetLoaderDpiChangeDispatch","WAWebAssetLoaderDynamicStyle","WAWebAssetToLoad","WAWebEmoji","WAWebEmojiAssetLoader","WAWebEmojiConst","WAWebLoadAssetUrl","WAWebNoop","WAWebWamEnumWebcAssetCacheTypeCode","WAWebWebcAssetLoadWamEvent","asyncToGeneratorRuntime","cr:5624","err","gkx","lodash"],(function(t,n,r,o,a,i,l,s){var e,u,c,d,m,p,_,f,g,h,y={INITIAL_EMOJI_LOAD:1,INITIAL_ASSET_LOAD:2,THEME_ASSET_LOAD:2,HELP_ANIMATED_DOODLE:2,LAZY_LOAD_EMOJI:2,NOTIFICATION_ICON:2},C=(function(){function t(e){var t=this;e===void 0&&(e=90),this._assetStyle=new(r("WAWebAssetLoaderDynamicStyle"))("asset-style"),this._requestedAssets={},this._loadingDataMap={},this._getEmojiForPlatform=null,this._currentResolution=r("WAWebAssetLoaderDpiChangeDispatch").currentRes,this._currentlyLoadingCount=0,this._queue=new(r("WAPriorityQueue"))(function(e){return-e.priority}),this._hasLoggedDecrementBelowZero=!1,this.loadAssetsForCurrentDpi=function(){var e=r("WAWebAssetLoaderDpiChangeDispatch").currentRes,n=t._currentResolution;e!==n&&(t._currentResolution=e,Object.keys(t._requestedAssets).forEach(function(e){t._cancelLoad(e,n)}),t._loadAssets(r("lodash").values(t._requestedAssets),y.INITIAL_EMOJI_LOAD,{forceCheck:!1}).catch(o("WAAbortError").catchAbort(r("WAWebNoop"))))},this._maxConcurrentRequests=e}var a=t.prototype;return a.initEmojiAsset=function(t){this._getEmojiForPlatform=t},a.loadInitialAssets=function(n){var t=new(o("WAWebWebcAssetLoadWamEvent")).WebcAssetLoadWamEvent({webcAssetName:"initial-assets",webcAssetFromCache:!1,webcAssetCacheType:o("WAWebWamEnumWebcAssetCacheTypeCode").WEBC_ASSET_CACHE_TYPE_CODE.UNCACHED});this._loadAssets(n,y.INITIAL_ASSET_LOAD,{estimateStorage:!0}).then(function(){t.markWebcAssetLoadT(),t.commit();var n=t.webcAssetLoadT;o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["AssetLoader:loadInitialAssets complete in ","ms"])),n)}).catch(o("WAAbortError").catchAbort(function(){o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["AssetLoader:loadInitialAssets cancelled by more recent request."])))}))},a.loadEmoji=function(t,a){if(this._getEmojiForPlatform&&this._currentPlatform){var e=this._getEmojiForPlatform(this._currentPlatform),i=o("WAWebEmoji").EmojiUtil.getBucket(t),l=this._getEmojiPrefix(),s=e.get(l+"b"+i),u=this._currentResolution;return s?this.loadAsset(s,a,!1).catch(o("WAAbortError").catchAbort(function(){o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["AssetLoader: loadEmoji Cancelled by more recent request: ","-",""])),s.id,u)})):(h||(h=n("Promise"))).reject(r("err")("The given emoji glyph id was not found"))}return(h||(h=n("Promise"))).reject(r("err")("emojiForPlatform or currentPlatform are not set"))},a.loadEmojis=function(){var e=r("WANullthrows")(this._currentPlatform);this._getEmojiForPlatform!=null||s(0,56365);var t=Array.from(this._getEmojiForPlatform(e).values()),n=new(o("WAWebWebcAssetLoadWamEvent")).WebcAssetLoadWamEvent({webcAssetName:"emojis",webcAssetFromCache:!1,webcAssetCacheType:o("WAWebWamEnumWebcAssetCacheTypeCode").WEBC_ASSET_CACHE_TYPE_CODE.UNCACHED});this._loadAssets(t,y.INITIAL_EMOJI_LOAD,{estimateStorage:!0}).then(function(){n.markWebcAssetLoadT(),n.commit();var e=n.webcAssetLoadT;o("WALogger").LOG(d||(d=babelHelpers.taggedTemplateLiteralLoose(["AssetLoader:loadEmojis complete in ","ms"])),e)}).catch(o("WAAbortError").catchAbort(function(){o("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["AssetLoader:loadEmojis cancelled by more recent request."])))}))},a.loadAsset=function(t,a,i){var e=this;i===void 0&&(i=!0);var l=t.id,s=r("WAWebAssetLoaderDpiChangeDispatch").currentRes,u=this._requestedAssets[l];if(u&&!r("lodash").isEqual(t,u)){var c=["Attempted to load an asset using an already used ID"];return(h||(h=n("Promise"))).reject(r("err")(c.join("\n")))}this._requestedAssets[l]=t,this._loadingDataMap[l]=this._loadingDataMap[l]||{};var d=s==="high"?"low":"high";this._cancelLoad(l,d);var m=this._loadingDataMap[l][s];if(m&&!i)return m.promise;var _=new(r("WAWebAssetToLoad"))(t,s,a),f=new AbortController,g=f.signal,y=this._buildPromise(_,f).then(function(n){if(g.aborted)throw new(o("WAAbortError")).AbortError;var r=t.selectors;return r&&e._assetStyle.setRule(""+r.join(", "),{"background-image":"url('"+n+"')"}),n}).catch(function(t){var n=e._loadingDataMap[l][s],r=C!==n;if(r||(e._loadingDataMap[l][s]=null),t.name===o("WAAbortError").ABORT_ERROR&&(o("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["Asset load cancelled by more recent request: ","-",""])),l,s),r&&n))return n.promise;throw t});_.setConsumerPromise(y);var C={promise:y,abort:function(n){e._abortUrlPromise(_,n)}};return this._loadingDataMap[l][s]=C,m&&m.abort(!1),this._startLoad(),y},a._buildPromise=function(t,o){var e=this,a=new(h||(h=n("Promise")))(function(n){t.setConsumerPromiseResolve(n,o),e._queue.push(t)});return r("WAPromiseRaceAbort")(a,o.signal)},a._startLoad=function(){var e=this;if(!(this._currentlyLoadingCount>=this._maxConcurrentRequests)){for(var t=function(){var t=e._queue.pull();if(!t)return{v:void 0};e._currentlyLoadingCount+=1,o("WAWebLoadAssetUrl").loadUrl(t).then(function(){e._decrementCurrentlyLoadingCount(),e._startLoad()}).catch(o("WAAbortError").catchAbort(function(){e._decrementCurrentlyLoadingCount(),e._startLoad()})).catch(function(n){if(e._decrementCurrentlyLoadingCount(),!r("gkx")("26258")&&n instanceof o("WAWebLoadAssetUrl").LoadUrlError&&(n.statusCode===404||n.statusCode===429)){o("WALogger").WARN(_||(_=babelHelpers.taggedTemplateLiteralLoose(["Dev-only: Failed to load asset "," with status ",". This might cause emojis to not show, this likely happens because emoji hashes changed. Rebuilding should fix the issue"])),n.url,n.statusCode);return}t.retryCount+=1;var a=o("WABackoffUtils").expBackoff(t.retryCount,12e4,1e3,.1);self.setTimeout(function(){e._queue.push(t),e._startLoad()},a),e._startLoad(),o("WAWebLoadAssetUrl").getSupportedImageFormatUrl(t).then(function(e){var t=e.split("/");o("WALogger").WARN(f||(f=babelHelpers.taggedTemplateLiteralLoose(["Asset: "," failed. Retrying... ",""])),t[t.length-1],n.toString()).devConsole(n)})})},n,a=0;a<this._maxConcurrentRequests-this._currentlyLoadingCount;a++)if(n=t(),n)return n.v}},a._abortUrlPromise=function(t,n){n===void 0&&(n=!0);var e=t.getLoadUrlPromise();if(e){t.abortLoadUrlPromise();var r=t.getConsumerPromise();n&&r&&t.abortConsumerPromise()}this._startLoad()},a._cancelLoad=function(t,n){var e,r=(e=this._loadingDataMap[t])==null?void 0:e[n];r&&(this._loadingDataMap[t][n]=null,r.abort(!0))},a.setPlatform=function(t){var e=this,n=this._currentPlatform;if(t!==n){this._currentPlatform=t;var r=o("WAWebEmojiAssetLoader").getEmojiTypeFromPlatform(t),a=r===o("WAWebEmojiConst").EMOJI_TYPE.APPLE?o("WAWebEmojiConst").EMOJI_TYPE.WHATSAPP:o("WAWebEmojiConst").EMOJI_TYPE.APPLE,i=a===o("WAWebEmojiConst").EMOJI_TYPE.APPLE?"emoji-apple-":"emoji-wa-";if(Object.keys(this._requestedAssets).forEach(function(t){t.startsWith(i)&&(e._cancelLoad(t,"high"),e._cancelLoad(t,"low"))}),this._getEmojiForPlatform!=null){var l=Array.from(this._getEmojiForPlatform(t).values());this._loadAssets(l,y.INITIAL_EMOJI_LOAD,{forceCheck:!1})}}},a.isAssetLoaded=function(t){return this._requestedAssets[t]!=null},a._getEmojiPrefix=function(){var e=o("WAWebEmojiAssetLoader").getEmojiTypeFromPlatform(this._currentPlatform);return e===o("WAWebEmojiConst").EMOJI_TYPE.APPLE?"emoji-apple-":"emoji-wa-"},a._loadAssets=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,o){var a=this,i=(o==null?void 0:o.forceCheck)!==!1,l=(o==null?void 0:o.estimateStorage)===!0,s=yield(h||(h=n("Promise"))).all(e.map(function(e){return a.loadAsset(e,t,i)}));return n("cr:5624")&&n("cr:5624")({keep:r("lodash").values(this._requestedAssets),estimateStorage:l}),s});function t(t,n,r){return e.apply(this,arguments)}return t})(),a._decrementCurrentlyLoadingCount=function(){this._currentlyLoadingCount<=0&&!this._hasLoggedDecrementBelowZero&&(this._hasLoggedDecrementBelowZero=!0,o("WALogger").ERROR(g||(g=babelHelpers.taggedTemplateLiteralLoose(["Assertion failed!"]))).sendLogs("Tried to decrease _loadingCount below zero, would have been negative.")),this._currentlyLoadingCount=Math.max(0,this._currentlyLoadingCount-1)},t})();l.LOAD_PRIORITY=y,l.AssetLoaderImpl=C}),98);
__d("WAWebAssetLoaderSingleton",["WAWebAssetLoader","gkx"],(function(t,n,r,o,a,i,l){var e=new(o("WAWebAssetLoader")).AssetLoaderImpl;window.addEventListener("dpichange",function(){e.loadAssetsForCurrentDpi()}),r("gkx")("26258")||(window.AssetLoader=e),l.AssetLoader=e}),98);
__d("WAWebAttachMenuGatingUtils",["WAWebABProps"],(function(t,n,r,o,a,i,l){function e(){return o("WAWebABProps").getABPropConfigValue("web_expression_panel_2")}function s(){return o("WAWebABProps").getABPropConfigValue("web_expression_panel_open")}function u(){return o("WAWebABProps").getABPropConfigValue("web_expression_panels_outside_input")}function c(){return e()&&o("WAWebABProps").getABPropConfigValue("wa_web_expression_panel_ui_v2")}l.areExpressionPanelsEnabledV2=e,l.areExpressionPanelsOpenEnabled=s,l.shouldShowExpressionPanelsOutOfInput=u,l.areExpressionPanelsUiV2Enabled=c}),98);
__d("WAWebBackIcon.react",["WAWebSvgComponentBase","react","stylex"],(function(t,n,r,o,a,i,l){var e=["iconXstyle","height","width","name","viewBox"],s,u,c=s||(s=r("react")),d="back";function m(t){var n=t.iconXstyle,a=t.height,i=t.width,l=t.name,s=t.viewBox,m=babelHelpers.objectWithoutPropertiesLoose(t,e),p;if(s){var _=s.x,f=_===void 0?0:_,g=s.y,h=g===void 0?0:g,y=s.width,C=y===void 0?0:y,b=s.height,v=b===void 0?0:b;p=[f,h,C,v].join(" ")}var S=24,R=24;return(a!=null||i!=null)&&(S=a,R=i),c.jsx(o("WAWebSvgComponentBase").BaseSvgSpan,babelHelpers.extends({name:l!=null?l:d},m,{children:c.jsxs("svg",{viewBox:p!=null?p:"0 0 24 24",height:S,width:R,preserveAspectRatio:"xMidYMid meet",className:(u||(u=r("stylex")))(n),version:"1.1",x:"0px",y:"0px",enableBackground:"new 0 0 24 24",children:[c.jsx("title",{children:l!=null?l:d}),c.jsx("path",{fill:"currentColor",d:"M12,4l1.4,1.4L7.8,11H20v2H7.8l5.6,5.6L12,20l-8-8L12,4z"})]})}))}m.displayName=m.name+" [from "+i.id+"]",l.BackIcon=m}),98);
__d("WAWebBizCatalogManagementUpdateCommerceSettingsMutation_facebookRelayOperation",[],(function(t,n,r,o,a,i){a.exports="9797519763673469"}),null);
__d("WAWebBizCatalogManagementUpdateCommerceSettingsMutation.graphql",["WAWebBizCatalogManagementUpdateCommerceSettingsMutation_facebookRelayOperation"],(function(t,n,r,o,a,i){"use strict";var e=(function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"input"}],t=[{alias:null,args:[{kind:"Variable",name:"request",variableName:"input"}],concreteType:"XFBWhatsAppCatalogCommerceSettingsResponse",kind:"LinkedField",name:"xfb_whatsapp_smb_commerce_settings",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"cart_enabled",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"WAWebBizCatalogManagementUpdateCommerceSettingsMutation",selections:t,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"WAWebBizCatalogManagementUpdateCommerceSettingsMutation",selections:t},params:{id:n("WAWebBizCatalogManagementUpdateCommerceSettingsMutation_facebookRelayOperation"),metadata:{},name:"WAWebBizCatalogManagementUpdateCommerceSettingsMutation",operationKind:"mutation",text:null}}})();a.exports=e}),null);
__d("WAWebBizCatalogManagementUpdateCommerceSettings",["Promise","WALogger","WAWebBizCatalogManagementUpdateCommerceSettingsMutation.graphql","WAWebBizGatingUtils","WAWebFetchAdAccountToken","WAWebGraphQLServerError","WAWebNetworkStatus","WAWebRelayClient"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m={type:"error"},p=e!==void 0?e:e=n("WAWebBizCatalogManagementUpdateCommerceSettingsMutation.graphql");function _(e){return o("WAWebBizGatingUtils").graphQLForCommerceSettingsEnabled()?f(e).then(function(e){return e.type==="success"?(o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["updateCommerceSettings: success"]))),e):(e.type,o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(['updateCommerceSettings: failed as "','"'])),e.type),e)}):(d||(d=n("Promise"))).resolve({type:"not-enabled"})}function f(e){return o("WAWebFetchAdAccountToken").fetchToken().then(function(t){return t.type==="success"?g(t.token,e).then(function(e){return e.type!=="success"&&e.type==="auth-failure"?o("WAWebFetchAdAccountToken").markTokenAsInvalid():e.type,e}):(t.type,t)})}function g(e,t){return r("WAWebNetworkStatus").waitIfOffline().then(function(){return o("WAWebRelayClient").commitMutation(p,{input:t},{environmentType:"facebook",accessToken:e})}).then(function(e){if(e==null)return m;var t=e.xfb_whatsapp_smb_commerce_settings;return t==null||(t==null?void 0:t.cart_enabled)==null?m:{type:"success",result:t.cart_enabled}}).catch(function(e){return o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["updateCommerceSettingsWithToken: failed with error"]))).devConsole(e),o("WAWebFetchAdAccountToken").hasGraphQLAuthError(e)?{type:"auth-failure"}:e instanceof o("WAWebGraphQLServerError").GraphQLServerError?{type:"graphql-error",error:e}:m})}l.updateCommerceSettings=_}),98);
__d("WAWebBizCoexOfflineICDCHandledCache",["WAWebCmd"],(function(t,n,r,o,a,i,l){var e=new Set;function s(t){e.add(t)}function u(t){e.delete(t)}function c(t){return e.has(t)}o("WAWebCmd").Cmd.on("offline_delivery_end",function(){e.clear()}),l.addToOfflineBizHostedSenderICDCProcessedCache=s,l.removeFromOfflineBizHostedSenderICDCProcessedCache=u,l.hasOfflineBizHostedSenderICDCProcessedForSender=c}),98);
__d("WAWebBizLogQplEvents",["WAWebQplQuickPerformanceLoggerMarkerIds","WAWebQplQuickPerformanceLoggerModule"],(function(t,n,r,o,a,i,l){function e(e){o("WAWebQplQuickPerformanceLoggerModule").QPL.markerPoint(o("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.WHATSAPP_CART_VIEW,e)}function s(e){o("WAWebQplQuickPerformanceLoggerModule").QPL.markerPoint(o("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.WHATSAPP_PROFILE_CATS_VIEW,e)}function u(e){o("WAWebQplQuickPerformanceLoggerModule").QPL.markerPoint(o("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.WHATSAPP_PROFILE_SAVE,e)}function c(e){o("WAWebQplQuickPerformanceLoggerModule").QPL.markerPoint(o("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.WHATSAPP_PRODUCT_VIEW,e)}function d(e){o("WAWebQplQuickPerformanceLoggerModule").QPL.markerPoint(o("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.WHATSAPP_PLM_DETAILS_VIEW,e)}function m(e){o("WAWebQplQuickPerformanceLoggerModule").QPL.markerPoint(o("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.WHATSAPP_ORDER_CREATE,e)}function p(e){o("WAWebQplQuickPerformanceLoggerModule").QPL.markerPoint(o("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.WHATSAPP_ORDER_VIEW,e)}l.qplPointCartView=e,l.qplPointProfileCatsView=s,l.qplPointProfileSave=u,l.qplPointProductView=c,l.qplPointPLMDetailsView=d,l.qplPointOrderCreate=m,l.qplPointOrderView=p}),98);
__d("WAWebWaitForInitialChatsSynced",["Promise","WAWebCmd","WAWebEventsWaitForBbEvent"],(function(t,n,r,o,a,i,l){var e,s=(e||(e=n("Promise"))).resolve();function u(){s=r("WAWebEventsWaitForBbEvent")(o("WAWebCmd").Cmd,"on_initial_chat_synced")}function c(){return s}l.initWaitForInitialChatsSynced=u,l.waitForInitialChatsSynced=c}),98);
__d("WAWebMessageQueue",["WACustomError","WALogger","WAPromiseQueue","WAPromiseTimeout","WAWebABProps","WAWebApiContact","WAWebEventsWaitForOfflineDeliveryEnd","WAWebEventsWaitForReadyForOffline","WAWebHandleMsgCommon","WAWebOfflineHandler","WAWebPromiseQueue","WAWebWaitForInitialChatsSynced","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u=2e4,c={allChatQueue:new(o("WAWebPromiseQueue")).PromiseQueue,chatQueue:new(o("WAPromiseQueue")).PromiseQueueMap},d={allChatQueue:new(o("WAWebPromiseQueue")).PromiseQueue,chatQueue:new(o("WAPromiseQueue")).PromiseQueueMap};function m(e){return p.apply(this,arguments)}function p(){return p=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var r=t.chatWid,a=t.isOffline,i=t.msgCategory,l=t.action,m=r.isRegularUser()&&!r.isLid()?o("WAWebApiContact").getCurrentLid(r):null,p=(m!=null?m:r).toString();return i!==o("WAWebHandleMsgCommon").CATEGORY_PEER&&o("WAWebABProps").getABPropConfigValue("web_fix_duplicated_lids_history_sync")&&(yield o("WAWebWaitForInitialChatsSynced").waitForInitialChatsSynced()),a&&!o("WAWebOfflineHandler").OfflineMessageHandler.isResumeFromRestartComplete()?d.allChatQueue.enqueue(function(){return d.chatQueue.enqueue(p,n("asyncToGeneratorRuntime").asyncToGenerator(function*(){return yield o("WAWebEventsWaitForReadyForOffline").waitForOfflineProcessReady(),o("WAPromiseTimeout").promiseTimeout(l(),u).catch(function(t){if(t instanceof o("WACustomError").TimeoutError)return o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["Offline chat queue MAX_MESSAGE_DELAY exceeded"]))).tags("messaging"),null;throw t})}))}):(yield o("WAWebEventsWaitForOfflineDeliveryEnd").waitForOfflineDeliveryEnd(),c.allChatQueue.enqueue(function(){return c.chatQueue.enqueue(p,function(){return o("WAPromiseTimeout").promiseTimeout(l(),u).catch(function(e){if(e instanceof o("WACustomError").TimeoutError)return o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["Online chat queue MAX_MESSAGE_DELAY exceeded"]))).tags("messaging"),null;throw e})})}))}),p.apply(this,arguments)}function _(){return d.allChatQueue.wait()}function f(){return c.allChatQueue.wait()}l.onMessageQueue=m,l.waitForOfflineMessageQueue=_,l.waitForOnlineMessageQueue=f}),98);
__d("WAWebOfflineResumeConst",["$InternalEnum"],(function(t,n,r,o,a,i){var e=n("$InternalEnum").Mirrored(["INIT","RESUME_ON_RESTART","RESUME_WITH_OPEN_TAB","COMPLETE"]),l=2e4,s=100,u=2e3,c=6e4,d=1e3,m=1e3;i.ResumeStatus=e,i.OFFLINE_STANZA_COUNT_CHECK_TIMEOUT_MS=l,i.OFFLINE_STANZA_COUNT_LIMIT=s,i.OFFLINE_DEVICE_SYNC_DELAY=u,i.OFFLINE_STANZA_TIMEOUT_MS=c,i.OFFLINE_PREVIEW_PERIOD_MS=d,i.UI_UPDATE_TIME_MS=m}),66);
__d("WAWebBlockingOfflineResumeManager",["WALogger","WAShiftTimer","WAWebABProps","WAWebApiPendingDeviceSync","WAWebAppTracker","WAWebBackendApi","WAWebBrokerGlobalAppState","WAWebChatThreadLogging","WAWebCmd","WAWebEnvironment","WAWebHandleMsgTypes.flow","WAWebJSHaltDetector","WAWebMessageQueue","WAWebOfflineResumeConst","WAWebOfflineResumeTypes.flow","WAWebOfflineResumeUtils","WAWebPageLoadLogging","WAWebSignalProtocolStore","WAWebUserPrefsGeneral","WAWebWamEnumWebcScenarioType","WAWebWamMemoryStat","WAWebWamOfflineResumeReporter","WAWebWorkerSafeBackendApi","asyncToGeneratorRuntime","gkx"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p,_,f,g,h,y,C,b,v,S;function R(){return S==null&&(S=new E),S}function L(){S=null}var E=(function(){function t(){var e=this;this.$7=null,this.$8=new(o("WAShiftTimer")).ShiftTimer(function(){o("WAWebCmd").Cmd.handleOfflineProgressUpdate(),e.$8.onOrAfter(o("WAWebOfflineResumeConst").UI_UPDATE_TIME_MS)}),this.$10=!1,this.resumeType=o("WAWebOfflineResumeTypes.flow").ResumeType.Blocking,this.$11()}var a=t.prototype;return a.$11=function(){this.offlineMessagePreviewCounter=-1,this.$2=0,this.$3=0,this.$4=!1,this.$5=null,this.$1=o("WAWebOfflineResumeConst").ResumeStatus.INIT},a.$12=function(n){o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[offline-resume][blocking] offline resume stage: "," -> ",""])),this.$1,n),this.$1=n},a.setStatus_TESTONLY=function(t){o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[offline-resume][blocking] offline resume stage: "," -> ",""])),this.$1,t),this.$1=t},a.processOfflinePreview=function(t){if(o("WAWebWamOfflineResumeReporter").OfflineResumeReporter.logOfflinePreviewT(),this.isResumeFromRestartComplete())o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["[offline-resume][blocking] Offline session is complete when receiving offline preview ib."]))),o("WAWebOfflineResumeUtils").exceedResumeWithOpenTabLimit(t.message,t.receipt)&&(o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["[offline-resume][blocking] restart client due to exceed the LIMIT, message: ",", receipt: ",""])),t.message,t.receipt),o("WAWebOfflineResumeUtils").refreshWindow()),o("WAWebJSHaltDetector").jsHaltDetector.restartDetection(),this.$12(o("WAWebOfflineResumeConst").ResumeStatus.RESUME_WITH_OPEN_TAB),o("WAWebBackendApi").frontendFireAndForget("updateChatSortListener",{enable:!1}),self.setTimeout(function(){o("WAWebBackendApi").frontendFireAndForget("updateChatSortListener",{enable:!0})},7e3);else if(this.$1===o("WAWebOfflineResumeConst").ResumeStatus.INIT)o("WAWebAppTracker").AppTracker.start(o("WAWebAppTracker").AppTrackerType.BlockingOR),r("WAWebBrokerGlobalAppState").initOrUpdateTracking(o("WAWebWamEnumWebcScenarioType").WEBC_SCENARIO_TYPE.OFFLINE_RESUME),o("WAWebWamOfflineResumeReporter").OfflineResumeReporter.logOfflineCount(t),this.$5=t.message>0,this.$4=t.message===0,this.offlineMessagePreviewCounter=t.message,this.$2=0,this.$9=Date.now(),o("WAWebSignalProtocolStore").enableMemSignalStore(),o("WAWebCmd").Cmd.handleOfflineProgressUpdate(),o("WAWebJSHaltDetector").jsHaltDetector.restartDetection(),this.$12(o("WAWebOfflineResumeConst").ResumeStatus.RESUME_ON_RESTART),this.$13(t.message,t.receipt),this.$8.onOrAfter(o("WAWebOfflineResumeConst").UI_UPDATE_TIME_MS),o("WAWebCmd").Cmd.readyForProcessOffline(),o("WALogger").LOG(d||(d=babelHelpers.taggedTemplateLiteralLoose(["[offline-resume][blocking] start handling offline stanza"])));else{var e=this.$9;if(e!=null){var n=Date.now()-e;n<o("WAWebOfflineResumeConst").OFFLINE_PREVIEW_PERIOD_MS?(o("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["[offline-resume][blocking] Accept multiple offline preview ibs during offline resume, delay ","."])),n),this.offlineMessagePreviewCounter+=t.message,this.$5=this.offlineMessagePreviewCounter>0,this.$4=this.offlineMessagePreviewCounter===0,o("WAWebWamOfflineResumeReporter").OfflineResumeReporter.logOfflineCount(t),o("WAWebCmd").Cmd.handleOfflineProgressUpdate()):r("gkx")("26258")?o("WALogger").LOG(_||(_=babelHelpers.taggedTemplateLiteralLoose(["[offline-resume][blocking] Reject multiple offline preview ib during offline resume, delay ","."])),n):o("WALogger").ERROR(p||(p=babelHelpers.taggedTemplateLiteralLoose(["[offline-resume][blocking] Reject multiple offline preview ibs during offline resume, delay ",""])),n).sendLogs("offline-multiple-preview")}this.$14()}},a.getOfflineDeliveryProgress=function(){return this.$4?100:this.offlineMessagePreviewCounter===-1?0:this.offlineMessagePreviewCounter===0?100:Math.min(Math.ceil(100*this.$2/this.offlineMessagePreviewCounter),100)},a.processOfflineSessionComplete=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t,n=this,r=e;if(self.setTimeout(function(){o("WAWebBackendApi").frontendFireAndForget("updateChatSortListener",{enable:!0})},3e3),(t=this.$7)==null||t.cancel(),this.$7=null,o("WAWebCmd").Cmd.readyForProcessOffline(),o("WALogger").LOG(f||(f=babelHelpers.taggedTemplateLiteralLoose(["[offline-resume][blocking] start handling offline stanza"]))),this.$1===o("WAWebOfflineResumeConst").ResumeStatus.COMPLETE){o("WAWebWamOfflineResumeReporter").OfflineResumeReporter.logLastStanzaT(),o("WAWebWamOfflineResumeReporter").OfflineResumeReporter.commit();return}else if(this.$1===o("WAWebOfflineResumeConst").ResumeStatus.RESUME_WITH_OPEN_TAB){yield o("WAWebMessageQueue").waitForOnlineMessageQueue(),yield o("WAWebApiPendingDeviceSync").doPendingDeviceSync(),this.$12(o("WAWebOfflineResumeConst").ResumeStatus.COMPLETE),o("WAWebCmd").Cmd.offlineDeliveryEnd();return}return this.$5=r>0,this.$4=r===0,this.$6=0,self.setTimeout(function(){n.$6>o("WAWebOfflineResumeConst").OFFLINE_STANZA_COUNT_LIMIT&&(o("WALogger").WARN(g||(g=babelHelpers.taggedTemplateLiteralLoose(["[offline-resume][blocking] "," received after offline completion marker. Refreshing window due to potential server issue."])),n.$6),o("WAWebOfflineResumeUtils").refreshWindow())},o("WAWebOfflineResumeConst").OFFLINE_STANZA_COUNT_CHECK_TIMEOUT_MS),o("WAWebCmd").Cmd.handleOfflineProgressUpdate(),this.$12(o("WAWebOfflineResumeConst").ResumeStatus.COMPLETE),this.$15()});function t(t){return e.apply(this,arguments)}return t})(),a.isResumeFromRestartComplete=function(){return this.$1!==o("WAWebOfflineResumeConst").ResumeStatus.RESUME_ON_RESTART&&this.$1!==o("WAWebOfflineResumeConst").ResumeStatus.INIT},a.isResumeOnSocketDisconnectInProgress=function(){return this.$1===o("WAWebOfflineResumeConst").ResumeStatus.RESUME_WITH_OPEN_TAB},a.isResumeFromRestartInProgress=function(){return this.$1!==o("WAWebOfflineResumeConst").ResumeStatus.INIT&&!o("WAWebCmd").Cmd.isOfflineDeliveryEnd},a.isResumeComplete=function(){return this.$1===o("WAWebOfflineResumeConst").ResumeStatus.COMPLETE},a.getHasMessagesToDownload=function(){return this.$5},a.getFinishedDownloading=function(){return this.getOfflineDeliveryProgress()===100},a.shouldUseOfflineResumeScreen=function(){return this.offlineMessagePreviewCounter>this.$2},a.processDecryptResult=function(t){this.$14(),this.$2+=1,t===o("WAWebHandleMsgTypes.flow").E2EProcessResult.RETRY&&(this.$3+=1)},a.offlineStanzaReceivedAfterComplete=function(){this.isResumeFromRestartComplete()&&(this.$6+=1)},a.newOfflineStanza=function(t,n){this.$14(),o("WAWebWamOfflineResumeReporter").OfflineResumeReporter.logAddOfflineSizeBytes(n),o("WAWebWamOfflineResumeReporter").OfflineResumeReporter.logOldestStanzaTime(t)},a.getResumeUIProgressBarType=function(){return o("WAWebOfflineResumeTypes.flow").ResumeUIProgressBarType.None},a.$14=function(){this.$7&&this.$7.onOrAfter(o("WAWebOfflineResumeConst").OFFLINE_STANZA_TIMEOUT_MS)},a.$13=function(t,n){var e,r=this;(e=this.$7)==null||e.cancel(),this.$7=new(o("WAShiftTimer")).ShiftTimer(function(){r.$1!==o("WAWebOfflineResumeConst").ResumeStatus.COMPLETE&&(o("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[offline-resume][blocking]: offline session completed by timeout"]))),o("WALogger").ERROR(y||(y=babelHelpers.taggedTemplateLiteralLoose(["[offline-resume][blocking]offline resume finished by timeout"]))).sendLogs("blocking-offline-resume-timeout",{sampling:.01}),r.processOfflineSessionComplete(t+n),r.$7=null,o("WAWebWamOfflineResumeReporter").OfflineResumeReporter.logMissedOfflineComplete())}),this.$7.onOrAfter(o("WAWebOfflineResumeConst").OFFLINE_STANZA_TIMEOUT_MS)},a.$15=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){o("WAWebPageLoadLogging").startPageLoadQplMeasure("waitForOfflineMessageQueue"),yield o("WAWebMessageQueue").waitForOfflineMessageQueue(),o("WAWebPageLoadLogging").endPageLoadQplMeasure("waitForOfflineMessageQueue"),this.$4=!0,o("WAWebCmd").Cmd.handleOfflineProgressUpdate(),o("WAWebWamOfflineResumeReporter").OfflineResumeReporter.logOfflineDecryptionErrorCount(this.$3),o("WALogger").LOG(C||(C=babelHelpers.taggedTemplateLiteralLoose(["[offline-resume][blocking] _onOfflineComplete: waitForOfflineMsgThread done, total decryption error: ",""])),this.$3),this.$3=0,o("WAWebPageLoadLogging").startPageLoadQplMeasure("clearOfflineSnapShot"),yield o("WAWebOfflineResumeUtils").clearOfflineSnapShot(),o("WAWebPageLoadLogging").endPageLoadQplMeasure("clearOfflineSnapShot"),o("WALogger").LOG(b||(b=babelHelpers.taggedTemplateLiteralLoose(["[offline-resume][blocking] _onOfflineComplete: clearOfflineSnapShot done."]))),o("WAWebSignalProtocolStore").enablePersistSignalStore(),o("WAWebOfflineResumeUtils").runReceiptCleanUpLoop(),o("WAWebWamOfflineResumeReporter").OfflineResumeReporter.logLastStanzaT(),o("WAWebPageLoadLogging").startPageLoadQplMeasure("loadMainScreen"),yield o("WAWebOfflineResumeUtils").loadMainScreen({shouldUpdateReceipts:!0,shouldRestoreChatsAndMsgs:!this.$10}),o("WAWebPageLoadLogging").endPageLoadQplMeasure("loadMainScreen"),o("WAWebCmd").Cmd.offlineDeliveryEnd(),o("WAWebAppTracker").AppTracker.stop(o("WAWebAppTracker").AppTrackerType.BlockingOR),o("WAWebUserPrefsGeneral").setOfflinePushCount(0),o("WAWebWamOfflineResumeReporter").OfflineResumeReporter.commit(),o("WAWebWorkerSafeBackendApi").workerSafeFireAndForget("processAllOrphanPaymentNotifications"),o("WAWebChatThreadLogging").uploadChatThreadLoggingEvents(),r("WAWebBrokerGlobalAppState").initOrUpdateTracking(o("WAWebWamEnumWebcScenarioType").WEBC_SCENARIO_TYPE.IDLE),o("WAWebWamMemoryStat").setCurrentMemoryScenario(o("WAWebWamEnumWebcScenarioType").WEBC_SCENARIO_TYPE.IDLE),self.setTimeout(function(){o("WAWebApiPendingDeviceSync").doPendingDeviceSync()},o("WAWebOfflineResumeConst").OFFLINE_DEVICE_SYNC_DELAY),(r("WAWebEnvironment").isWindows||o("WAWebABProps").getABPropConfigValue("wa_web_resume_timer_fix_enabled"))&&(o("WALogger").LOG(v||(v=babelHelpers.taggedTemplateLiteralLoose(["[offline-resume][blocking] cancel progress bar timer"]))),this.$8.forceRunNow(),this.$8.cancel())});function t(){return e.apply(this,arguments)}return t})(),t})();l.getOrCreateInstance=R,l.clearInstance=L,l.OfflineBlockingResumeStageManager=E}),98);
__d("WAWebMsmsgMsgSecretCache",["WAWebCmd"],(function(t,n,r,o,a,i,l){var e=(function(){function e(){var e=this;this.cache=new Map,o("WAWebCmd").Cmd.on("logout",function(){return e.clearCache()})}var t=e.prototype;return t.addMsmsgMsgSecretToCache=function(t,n){this.cache.set(t,n)},t.getMsmsgMsgSecretFromCache=function(t){return this.cache.get(t)},t.clearCache=function(){this.cache=new Map},e})(),s=new e;l.msmsgMsgSecretCache=s}),98);
__d("WAWebBotMessageSecret",["WABinary","WACryptoAesGcm","WACryptoHkdf","WALogger","WANullthrows","WAWebBotTypes","WAWebDBMessageSerialization","WAWebLidMigrationUtils","WAWebMsgKey","WAWebMsmsgMsgSecretCache","WAWebProtobufsE2E.pb","WAWebSchemaMessage","WAWebUserPrefsMeUser","WAWebWidToJid","asyncToGeneratorRuntime","decodeProtobuf"],(function(t,n,r,o,a,i,l){var e,s,u,c=32,d="Bot Message";function m(e){return p.apply(this,arguments)}function p(){return p=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=new(o("WABinary")).Binary(e).readByteArrayView(),n=yield o("WACryptoHkdf").extractAndExpand(new Uint8Array(t),d,c);return n}),p.apply(this,arguments)}function _(e,t){return f.apply(this,arguments)}function f(){return f=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){return t.msgInfo.author.isFbidBot()?y(e,t):g(e,t)}),f.apply(this,arguments)}function g(e,t){return h.apply(this,arguments)}function h(){return h=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,n){var a,i,l=n.msgMeta,s=n.msgInfo,u=o("decodeProtobuf").decodeProtobuf(o("WAWebProtobufsE2E.pb").MessageSecretMessageSpec,t),c=l.targetSenderJid?o("WAWebUserPrefsMeUser").isMeAccount(l.targetSenderJid):!0,d={fromMe:c,remote:(a=l.targetChatJid)!=null?a:s.chat,id:r("WANullthrows")(l.targetId,"decryptMsmsgBotMessage: targetId")};s.chat.isGroup()&&(d.participant=l.targetSenderJid);var m=yield b(d),p=o("WAWebWidToJid").widToUserJid((i=l.targetSenderJid)!=null?i:o("WAWebUserPrefsMeUser").getMePnUserOrThrow()),_=o("WAWebWidToJid").widToUserJid(r("WANullthrows")(s.author,"decryptMsmsgBotMessage: author")),f=null,g=r("WANullthrows")(u.encIv,"decryptMsmsgBotMessage: encIv"),h=r("WANullthrows")(u.encPayload,"decryptMsmsgBotMessage: encPayload");try{var y=s.externalId,C=yield S(y,p,_,m);f=yield o("WACryptoAesGcm").gcmDecrypt(C,g,h,y+"\0"+_)}catch(t){var v;o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["decryptMsmsgBotMessage: fallback to botEditTargetId: ",""])),t);var R=r("WANullthrows")((v=n.msgBotInfo)==null?void 0:v.botEditTargetId,"decryptMsmsgBotMessage: botEditTargetId"),L=yield S(R,p,_,m);f=yield o("WACryptoAesGcm").gcmDecrypt(L,g,h,R+"\0"+_)}return f}),h.apply(this,arguments)}function y(e,t){return C.apply(this,arguments)}function C(){return C=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n,a=t.msgMeta,i=t.msgInfo,l=t.msgBotInfo,u=o("WAWebUserPrefsMeUser").getMeLidUserOrThrow(),c=(n=a.targetSenderJid)!=null?n:u,d={fromMe:o("WAWebUserPrefsMeUser").isMeAccount(c),remote:i.chat,id:r("WANullthrows")(a.targetId,"decryptMsmsgFbidBotMessage: targetId")};if(i.chat.isGroup()){var m;d.participant=(m=o("WAWebLidMigrationUtils").toPn(c))!=null?m:c}var p=yield b(d),_=i.externalId;((l==null?void 0:l.botEditType)===o("WAWebBotTypes").BotMsgEditType.INNER||(l==null?void 0:l.botEditType)===o("WAWebBotTypes").BotMsgEditType.LAST)&&((l==null?void 0:l.botEditTargetId)!=null?_=l==null?void 0:l.botEditTargetId:o("WALogger").WARN(s||(s=babelHelpers.taggedTemplateLiteralLoose(['decryptMsmsgFbidBotMessage: fallback to externalId for edit="','" message'])),l==null?void 0:l.botEditType));var f=o("WAWebWidToJid").widToUserJid(r("WANullthrows")(i.author,"decryptMsmsgFbidBotMessage: author")),g=yield S(_,o("WAWebWidToJid").widToUserJid(c),f,p),h=o("decodeProtobuf").decodeProtobuf(o("WAWebProtobufsE2E.pb").MessageSecretMessageSpec,e),y=h.encIv,C=h.encPayload,v=yield o("WACryptoAesGcm").gcmDecrypt(g,r("WANullthrows")(y,"decryptMsmsgFbidBotMessage: encIv"),r("WANullthrows")(C,"decryptMsmsgFbidBotMessage: encPayload"),_+"\0"+f);return v}),C.apply(this,arguments)}function b(e){return v.apply(this,arguments)}function v(){return v=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t,n=new(r("WAWebMsgKey"))(e),a=n.toString(),i=(t=o("WAWebLidMigrationUtils").getAlternateMsgKey(n))==null?void 0:t.toString(),l=o("WAWebMsmsgMsgSecretCache").msmsgMsgSecretCache.getMsmsgMsgSecretFromCache(a);if(l==null&&i!=null&&(l=o("WAWebMsmsgMsgSecretCache").msmsgMsgSecretCache.getMsmsgMsgSecretFromCache(i)),l==null){var s=yield o("WAWebSchemaMessage").getMessageTable().bulkGet([a,i].filter(Boolean)),c=s[0],d=s[1];c==null&&d==null&&o("WALogger").WARN(u||(u=babelHelpers.taggedTemplateLiteralLoose(["getDecryptSecretForMsg: targetMsg is null, chat=",", targetMsgKey=",", altTargetMsgKey=",""])),e.remote,a,i),l=o("WAWebDBMessageSerialization").messageFromDbRow(r("WANullthrows")(c!=null?c:d,"decryptMsmsgBotMessage: targetMsg")).messageSecret}return m(r("WANullthrows")(l,"decryptMsmsgBotMessage: decryptSecretBase"))}),v.apply(this,arguments)}function S(e,t,n,r){return R.apply(this,arguments)}function R(){return R=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n,r){var a=o("WABinary").Binary.build(e,t,n).readBuffer(),i=yield o("WACryptoHkdf").extractAndExpand(new Uint8Array(r),a,c);return i}),R.apply(this,arguments)}l.genBotMsgSecretFromMsgSecret=m,l.decryptMsmsgBotMessage=_}),98);
__d("WAWebBotSystemMsg",["WATimeUtils","WAWebBackendApi","WAWebBotGating","WAWebCmd","WAWebContactSystemMsg","WAWebMsgType","WAWebSchemaChat","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e=new Map;function s(e){return o("WAWebContactSystemMsg").genNotificationMsg(e,{type:"notification_template",kind:o("WAWebMsgType").MsgKind.NotificationTemplate,subtype:"bot_init",templateParams:[]})}function u(e,t){var n;if(o("WAWebBotGating").isBotEnabled()&&!t.id.isBot()&&e.botMessageSecret!=null&&t.hasCreatedBotInvokeSystemMsg!==!0&&(n=e.invokedBotWid)!=null&&n.isBot()){var r=m(t.id);return r}return null}function c(e){return d.apply(this,arguments)}function d(){return d=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var n=t.id.remote,r=t.t;if((yield f(n))!==!0&&!n.isBot()){var o=m(n,r);return e.set(n.toJid(),!0),o}return null}),d.apply(this,arguments)}function m(e,t){return o("WAWebContactSystemMsg").genNotificationMsg(e,{type:o("WAWebMsgType").MSG_TYPE.NOTIFICATION_TEMPLATE,kind:o("WAWebMsgType").MsgKind.NotificationTemplate,subtype:"bot_invoke_disclaimer",templateParams:[],t:t!=null?t:o("WATimeUtils").unixTime()})}function p(e){return o("WAWebContactSystemMsg").genNotificationMsg(e,{type:o("WAWebMsgType").MSG_TYPE.NOTIFICATION_TEMPLATE,kind:o("WAWebMsgType").MsgKind.NotificationTemplate,subtype:"biz_bot_1p_disclosure",templateParams:[]})}function _(e){return o("WAWebContactSystemMsg").genNotificationMsg(e,{type:o("WAWebMsgType").MSG_TYPE.NOTIFICATION_TEMPLATE,kind:o("WAWebMsgType").MsgKind.NotificationTemplate,subtype:"biz_bot_3p_disclosure",templateParams:[]})}function f(e){return g.apply(this,arguments)}function g(){return g=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var n=null;if(o("WAWebCmd").Cmd.isMainStreamReadyMd){var r=yield o("WAWebBackendApi").frontendSendAndReceive("getChat",{chatId:t});return r&&(n=r.hasCreatedBotInvokeSystemMsg),n}var a=yield o("WAWebSchemaChat").getChatTable().get(t.toString());return n=a==null?void 0:a.hasCreatedBotInvokeSystemMsg,e.set(t.toJid(),n),n}),g.apply(this,arguments)}o("WAWebCmd").Cmd.on("logout",function(){e=new Map}),l.genBotInitSystemMsg=s,l.getMaybeSysMsgForBotInvoke=u,l.createSysMsgForIncomingBotInvoke=c,l.genBizBot1pDisclosureMessage=p,l.genBizBot3pDisclosureMessage=_}),98);
__d("WAWebBridgeInitialization",["WADynamicRouterAsync"],(function(t,n,r,o,a,i,l){function e(){return new(o("WADynamicRouterAsync")).DynamicRouter}l.makeBridge=e}),98);
__d("WAWebBrokerConnectionManager",["invariant","WANullthrows","WAPromiseTimeout","WAResolvable","err"],(function(t,n,r,o,a,i,l,s){var e=5e3,u=(function(){function t(){}var n=t.prototype;return n.init=function(){return this.$1=null,this.$2=new(o("WAResolvable")).Resolvable,o("WAPromiseTimeout").promiseTimeout(this.$2.promise,e)},n.isConnected=function(){return this.$1!=null},n.getPort=function(){return this.$1},n.waitForConnection=function(){var e;return r("WANullthrows")((e=this.$2)==null?void 0:e.promise,"ConnectionManager Initialization Promise")},n.connectVia=function(t){if(!this.isConnected())this.$2||s(0,56329),this.$1=t,this.$2.resolve();else throw r("err")("Connection already established")},t})(),c=new u;l.default=c}),98);
__d("WAWebBrokerProtocolTypes.flow",[],(function(t,n,r,o,a,i){var e="@@handshake",l="@@invoke",s="@@response";i.HANDSHAKE_COMMAND=e,i.INVOCATION_COMMAND=l,i.RESPONSE_COMMAND=s}),66);
__d("WAWebBrokerProtocolHandshake",["invariant","WAWebBrokerProtocolTypes.flow"],(function(t,n,r,o,a,i,l,s){function e(e){return{__command:o("WAWebBrokerProtocolTypes.flow").HANDSHAKE_COMMAND,__port:e}}function u(e){if(e!=null&&e.__command!=null&&e.__command===o("WAWebBrokerProtocolTypes.flow").HANDSHAKE_COMMAND&&e.__port!=null){e.__port instanceof MessagePort||s(0,56355);var t=e.__port;return t}}l.buildHandshakePayload=e,l.extractPortFromHandshakePayload=u}),98);
__d("WAWebInvocationId",[],(function(t,n,r,o,a,i){var e=1;function l(){return e++}function s(e){if(e!=null&&typeof e=="number")return e}i.genInvocationId=l,i.extractInvocationId=s}),66);
__d("WAWebBrokerProtocolInvocation",["invariant","WAWebBrokerProtocolTypes.flow","WAWebInvocationId"],(function(t,n,r,o,a,i,l,s){function e(e){var t=e.invocationId,n=e.method,r=e.args;return{__id:t,__command:o("WAWebBrokerProtocolTypes.flow").INVOCATION_COMMAND,__method:n,__args:r}}function u(e){if(e!=null&&e.__command===o("WAWebBrokerProtocolTypes.flow").INVOCATION_COMMAND){e.__id||s(0,56278);var t=o("WAWebInvocationId").extractInvocationId(e.__id);t!=null&&e.__method&&typeof e.__method=="string"&&e.__id&&e.__args&&Array.isArray(e.__args)||s(0,56275);var n=e,r=n.__method,a=n.__args;return{method:r,args:a,invocationId:t}}}l.buildInvocationPayload=e,l.unwrapInvocationPayload=u}),98);
__d("WAWebBrokerProtocolResponse",["invariant","WAWebBrokerProtocolTypes.flow","WAWebInvocationId"],(function(t,n,r,o,a,i,l,s){function e(e,t){return{__id:e,__command:o("WAWebBrokerProtocolTypes.flow").RESPONSE_COMMAND,__result:t}}function u(e){if(e!=null&&e.__command===o("WAWebBrokerProtocolTypes.flow").RESPONSE_COMMAND){e.__id!=null||s(0,56278);var t=o("WAWebInvocationId").extractInvocationId(e.__id);t!=null&&Object.prototype.hasOwnProperty.call(e,"__result")||s(0,56331);var n=e,r=n.__result;return{result:r,invocationId:t}}}l.buildResponsePayload=e,l.unwrapResponsePayload=u}),98);
__d("WAWebBuildType",["$InternalEnum","WAWebEnvironment","WAWebUserPrefsGeneral","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){"use strict";var e=n("$InternalEnum")({RELEASE:0,BETA:1,ALPHA:2,DEBUG:3});function s(){return u.apply(this,arguments)}function u(){return u=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var t=yield o("WAWebUserPrefsGeneral").getWhatsAppWebExternalBetaJoinedIdb(),n=r("WAWebEnvironment").getEnvironment();return(function(t){if(Array.isArray(t)&&t.length===2&&t[0]==="prod"&&t[1]===!0)return e.BETA;if(Array.isArray(t)&&t.length===2&&t[0]==="prod"&&t[1]===!1)return e.RELEASE;if(Array.isArray(t)&&t.length===2&&t[0]==="intern"&&t[1]===!0)return e.DEBUG;if(Array.isArray(t)&&t.length===2&&t[0]==="intern"&&t[1]===!1||Array.isArray(t)&&t.length===2&&t[0]==="dev"&&t[1]===!0)return e.BETA;if(Array.isArray(t)&&t.length===2&&t[0]==="dev"&&t[1]===!1)return e.DEBUG;throw Error("Match: No case succesfully matched. Make exhaustive or add a wildcard case using '_'. Argument: "+t)})([n,t])}),u.apply(this,arguments)}l.BuildType=e,l.getBuildType=s}),98);
__d("WAWebBusinessProfileJob",["WADeprecatedSendIq","WADeprecatedWapParser","WAWap","WAWapDeprecatedSmaxID","WAWebBackendErrors","WAWebBizCatalogManagementUpdateCommerceSettings","WAWebBizGatingUtils","WAWebMaybeThrowCatalogErrors","WAWebUserPrefsMeUser","asyncToGeneratorRuntime","err"],(function(t,n,r,o,a,i,l){var e=new(r("WADeprecatedWapParser"))("businessProfileResponse",function(e){e.assertTag("iq"),e.assertFromServer()}),s=new(r("WADeprecatedWapParser"))("commerceSettingsResponse",function(e){e.assertTag("iq"),e.assertFromServer();var t=e.child("commerce_settings"),n=t.child("cart").attrString("enabled");return n==="true"});function u(e){var t=e.note,n=e.timezone,r=e.config,a=[];Object.keys(r).forEach(function(e){var t=r[e];if(t!=null){var n=t.mode,o=t.hours;if(o)for(var i of o){var l=i[0],s=i[1];a.push({day_of_week:e,mode:n,open_time:l,close_time:s})}else a.push({day_of_week:e,mode:n})}});var i=[];return t!=null&&t!==""&&i.push(o("WAWap").wap("business_hours_note",null,t)),i.push.apply(i,a.map(function(e){var t=o("WAWap").wap("business_hours_config",{day_of_week:o("WAWap").CUSTOM_STRING(e.day_of_week),mode:o("WAWap").CUSTOM_STRING(e.mode),open_time:e.open_time!=null?o("WAWap").CUSTOM_STRING(e.open_time.toString()):o("WAWap").DROP_ATTR,close_time:e.close_time!=null?o("WAWap").CUSTOM_STRING(e.close_time.toString()):o("WAWap").DROP_ATTR});return t})),o("WAWap").wap("business_hours",{timezone:n?o("WAWap").CUSTOM_STRING(n):o("WAWap").DROP_ATTR},i)}function c(e){return d.apply(this,arguments)}function d(){return d=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t,n=(t=o("WAWap")).wap("iq",{to:t.S_WHATSAPP_NET,smax_id:t.SMAX_ID(r("WAWapDeprecatedSmaxID").CommerceSettingsSet),xmlns:"fb:thrift_iq",id:t.generateId(),type:"set"},t.wap("commerce_settings",null,t.wap("cart",{enabled:t.CUSTOM_STRING(e.toString())}))),a=yield o("WADeprecatedSendIq").deprecatedSendIq(n,s);if(a.success)return a.result;throw new(o("WAWebBackendErrors")).ServerStatusCodeError(a.errorCode)}),d.apply(this,arguments)}function m(e){return p.apply(this,arguments)}function p(){return p=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=o("WAWebUserPrefsMeUser").getMaybeMePnUser();if(t==null)throw r("err")("updateCartEnabledGraphQL: meUser is null");var n=yield o("WAWebBizCatalogManagementUpdateCommerceSettings").updateCommerceSettings({biz_jid:t.toJid(),cart_enabled:e});if(n.type==="success")return n.result;if(n.type==="graphql-error")o("WAWebMaybeThrowCatalogErrors").maybeThrowLocalErrorForCatalogQuery(n.error);else{if(n.type==="recovery-required")return c(e);n.type}throw r("err")("updateCartEnabledGraphQL: error handling flow not implemented for "+JSON.stringify(n))}),p.apply(this,arguments)}function _(e){return f.apply(this,arguments)}function f(){return f=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){return o("WAWebBizGatingUtils").graphQLForCommerceSettingsEnabled()?m(e):c(e)}),f.apply(this,arguments)}function g(e){return h.apply(this,arguments)}function h(){return h=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var n,r=t.address,a=t.description,i=t.categories,l=t.email,s=t.website,c=t.businessHours,d=(n=o("WAWap")).wap("iq",{to:n.S_WHATSAPP_NET,xmlns:"w:biz",id:n.generateId(),type:"set"},n.wap("business_profile",{v:"3",mutation_type:"delta"},r!==void 0?o("WAWap").wap("address",null,r):null,a!==void 0?o("WAWap").wap("description",null,a):null,l!==void 0?o("WAWap").wap("email",null,l):null,s&&s.length===0?o("WAWap").wap("website",null):null,s&&s.length>0?o("WAWap").wap("website",null,s[0].url):null,s&&s.length>1?o("WAWap").wap("website",null,s[1].url):null,i?o("WAWap").wap("categories",null,i.map(function(e){return o("WAWap").wap("category",{id:o("WAWap").CUSTOM_STRING(e.id)})})):null,c?u(c):null)),m=yield o("WADeprecatedSendIq").deprecatedSendIq(d,e);if(!m.success)throw new(o("WAWebBackendErrors")).ServerStatusCodeError(m.errorCode)}),h.apply(this,arguments)}function y(e,t,n){return C.apply(this,arguments)}function C(){return C=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,n,r){var a,i=(a=o("WAWap")).wap("iq",{to:a.S_WHATSAPP_NET,xmlns:"w:biz",id:a.generateId(),type:"set"},a.wap("business_profile",{v:"3",mutation_type:"delta"},a.wap("cover_photo",{op:"update",id:a.CUSTOM_STRING(t.toString()),ts:a.CUSTOM_STRING(n.toString()),token:a.CUSTOM_STRING(r)}))),l=yield o("WADeprecatedSendIq").deprecatedSendIq(i,e);if(!l.success)throw new(o("WAWebBackendErrors")).ServerStatusCodeError(l.errorCode)}),C.apply(this,arguments)}function b(e){return v.apply(this,arguments)}function v(){return v=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var n,r=(n=o("WAWap")).wap("iq",{to:n.S_WHATSAPP_NET,xmlns:"w:biz",id:n.generateId(),type:"set"},n.wap("business_profile",{v:"3",mutation_type:"delta"},n.wap("cover_photo",{op:"delete",id:n.CUSTOM_STRING(t)}))),a=yield o("WADeprecatedSendIq").deprecatedSendIq(r,e);if(!a.success)throw new(o("WAWebBackendErrors")).ServerStatusCodeError(a.errorCode)}),v.apply(this,arguments)}l.updateCartEnabled=_,l.editBusinessProfile=g,l.sendCoverPhoto=y,l.deleteCoverPhoto=b}),98);
__d("WAWebCRUDOperationsNewsletterMyVotes",["Promise","WALogger","WAWebModelStorageUtils","WAWebNewsletterDBUtils","WAWebSchemaNewsletterMyVotes","WAWebWid","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s;function u(t){return o("WAWebModelStorageUtils").getStorage().lock(["newsletter-my-votes"],(function(){var a=n("asyncToGeneratorRuntime").asyncToGenerator(function*(n){var a=n[0];if(!r("WAWebWid").isNewsletter(t.chatJid)){o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[createOrUpdateMyVote] Invalid newsletter jid ",""])),t.chatJid);return}var i=yield p(t.chatJid,t.msgServerId);i!=null&&i.serverTimestampMs>t.serverTimestampMs||(yield a.createOrReplace(t))});return function(e){return a.apply(this,arguments)}})())}function c(e){return o("WAWebModelStorageUtils").getStorage().lock(["newsletter-my-votes"],(function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var n=t[0],o=new Map,a=e.map(function(e){if(r("WAWebWid").isNewsletter(e.chatJid))return o.set(e.chatJid+"-"+e.msgServerId,e),[e.chatJid,e.msgServerId]}).filter(Boolean),i=yield n.anyOf(["chatJid","msgServerId"],a);i.forEach(function(e){var t=e.chatJid+"-"+e.msgServerId,n=o.get(t);n!=null&&n.serverTimestampMs<e.serverTimestampMs&&o.delete(t)}),yield n.bulkCreateOrReplace(Array.from(o.values()))});return function(e){return t.apply(this,arguments)}})())}function d(e,t){return o("WAWebSchemaNewsletterMyVotes").getTable().remove([e,t])}var m=100;function p(e,t){return!Number.isSafeInteger(t)||t<m||t>=o("WAWebNewsletterDBUtils").TEMPORARY_SERVER_ID_LOWER_BOUND?(s||(s=n("Promise"))).resolve(null):o("WAWebSchemaNewsletterMyVotes").getTable().get([e,t])}function _(e){return f.apply(this,arguments)}function f(){return f=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=yield p(e.chatJid,e.msgServerId);t!=null&&(yield u(babelHelpers.extends({},t,e)))}),f.apply(this,arguments)}l.createOrUpdateMyVote=u,l.bulkCreateOrUpdateMyVotes=c,l.deleteMyVote=d,l.getMyVote=p,l.updateMyVote=_}),98);
__d("WAWebChatEphemeralExemptionCache",[],(function(t,n,r,o,a,i){var e=(function(){function e(){this.chatEphemeralExemptionMap=new Map}var t=e.prototype;return t.has=function(t){return this.chatEphemeralExemptionMap.has(t)},t.get=function(t){var e;return(e=this.chatEphemeralExemptionMap.get(t))!=null?e:null},t.add=function(t,n){this.chatEphemeralExemptionMap.set(t,n)},t.clear=function(){this.chatEphemeralExemptionMap.clear()},e})(),l=new e;i.default=l}),66);
__d("WAWebWamEnumActionConducted",[],(function(t,n,r,o,a,i){var e=Object.freeze({MUTE:1,UNMUTE:2,EXPIRE:3});i.ACTION_CONDUCTED=e}),66);
__d("WAWebWamEnumChatMuteNotificationChoice",[],(function(t,n,r,o,a,i){var e=Object.freeze({NO_NOTIFICATIONS_WHEN_MUTED:1,YES_NOTIFICATIONS_WHEN_MUTED:2});i.CHAT_MUTE_NOTIFICATION_CHOICE=e}),66);
__d("WAWebWamEnumMuteChatType",[],(function(t,n,r,o,a,i){var e=Object.freeze({ONE_ON_ONE:1,GROUP:2,CHANNEL:3,INTEROP:4,INORGANIC_NOTIFICATION:5});i.MUTE_CHAT_TYPE=e}),66);
__d("WAWebWamEnumMuteEntryPoint",[],(function(t,n,r,o,a,i){var e=Object.freeze({CHAT_LIST_SCREEN:1,CONTACT_INFO:2,CONVERSATION_SCREEN:3,CHAT_MORE_OPTIONS:4,CHAT_LONG_PRESS_OPTIONS:5,INORGANIC_NOTIFICATION:6,LIST_BASED_MUTE:7});i.MUTE_ENTRY_POINT=e}),66);
__d("WAWebWamEnumWaOfficialAccountName",[],(function(t,n,r,o,a,i){var e=Object.freeze({WHATSAPP_CHATPSA:1});i.WA_OFFICIAL_ACCOUNT_NAME=e}),66);
__d("WAWebChatMuteWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumActionConducted","WAWebWamEnumChatMuteNotificationChoice","WAWebWamEnumMuteChatType","WAWebWamEnumMuteEntryPoint","WAWebWamEnumWaOfficialAccountName"],(function(t,n,r,o,a,i,l){var e=o("WAWebWamCodegenUtils").defineEvents({ChatMute:[2280,{actionConducted:[3,o("WAWebWamEnumActionConducted").ACTION_CONDUCTED],chatMuteNotificationChoice:[5,o("WAWebWamEnumChatMuteNotificationChoice").CHAT_MUTE_NOTIFICATION_CHOICE],muteChatType:[4,o("WAWebWamEnumMuteChatType").MUTE_CHAT_TYPE],muteDuration:[1,o("WAWebWamCodegenUtils").TYPES.TIMER],muteEntryPoint:[6,o("WAWebWamEnumMuteEntryPoint").MUTE_ENTRY_POINT],muteGroupSize:[2,o("WAWebWamCodegenUtils").TYPES.INTEGER],waOfficialAccountName:[7,o("WAWebWamEnumWaOfficialAccountName").WA_OFFICIAL_ACCOUNT_NAME]},[1,1,1],"regular"]},{ChatMute:[]});l.ChatMuteWamEvent=e}),98);
__d("WAWebChatOriginTypes",[],(function(t,n,r,o,a,i){var e=new Set(["createChat","createChatOnNewMsg","debugOpenChatFlow","debugConvertToLidChat","debugCreateChat","jest","updateDeviceTableApi","fixturesChatFactory","securityCodeApi","restoreMessagesForChat","processUnreadMessage","loadLastMessagesFromDb","processPreviewMessageInChat","historyMsgHandlerAction","updateMessageUIAction","msgCollectionFindQuery","msgCollectionGetStarred","msgCollectionGetEvents","msgCollectionGetVoipCallLogs","msgCollectionGetMessagesById","msgCollectionQueryVCard","msgCollectionIncrementalStarredUpdate","msgCollectionQueryMedia","msgCollectionSearch","msgCollectionGetContext","username_change_notification","username_contactless_search","voipCallLog"]),l=new Set(["username_change_notification","username_contactless_search"]);i.VALID_LID_ORIGINS=e,i.VALID_USERNAME_ORIGINS=l}),66);
__d("WAWebWamEnumPsaMessageActionType",[],(function(t,n,r,o,a,i){var e=Object.freeze({SAVE:1,FORWARD:2,REACT:3,LINK_CLICK:4,MEDIA_PLAY:5,DELETE:6,PUSH_NOTIFICATION_CLICK:7,PUSH_NOTIFICATION_RENDER:8});i.PSA_MESSAGE_ACTION_TYPE=e}),66);
__d("WAWebChatPsaActionWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumMediaType","WAWebWamEnumPsaMessageActionType"],(function(t,n,r,o,a,i,l){var e=o("WAWebWamCodegenUtils").defineEvents({ChatPsaAction:[3572,{messageMediaType:[1,o("WAWebWamEnumMediaType").MEDIA_TYPE],psaCampaignId:[4,o("WAWebWamCodegenUtils").TYPES.STRING],psaMessageActionType:[2,o("WAWebWamEnumPsaMessageActionType").PSA_MESSAGE_ACTION_TYPE],psaMsgId:[5,o("WAWebWamCodegenUtils").TYPES.STRING]},[1,1,1],"regular"]},{ChatPsaAction:[]});l.ChatPsaActionWamEvent=e}),98);
__d("WAWebWamEnumReadEntryPoint",[],(function(t,n,r,o,a,i){var e=Object.freeze({CHAT_LIST:1,CHAT:2});i.READ_ENTRY_POINT=e}),66);
__d("WAWebChatPsaReadWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumMediaType","WAWebWamEnumReadEntryPoint"],(function(t,n,r,o,a,i,l){var e=o("WAWebWamCodegenUtils").defineEvents({ChatPsaRead:[3574,{messageMediaType:[1,o("WAWebWamEnumMediaType").MEDIA_TYPE],psaCampaignId:[4,o("WAWebWamCodegenUtils").TYPES.STRING],psaMsgId:[5,o("WAWebWamCodegenUtils").TYPES.STRING],readEntryPoint:[3,o("WAWebWamEnumReadEntryPoint").READ_ENTRY_POINT]},[1,1,1],"regular"]},{ChatPsaRead:[]});l.ChatPsaReadWamEvent=e}),98);
__d("WAWebWamEnumPsaBlockReason",[],(function(t,n,r,o,a,i){var e=Object.freeze({OTHER:0,MESSAGES_ARENT_HELPFUL:1,TOO_MANY_MESSAGES:2,IT_LOOKS_SUSPICIOUS:3});i.PSA_BLOCK_REASON=e}),66);
__d("WAWebWamEnumPsaMessageRemoveAction",[],(function(t,n,r,o,a,i){var e=Object.freeze({BLOCK:1,UNBLOCK:2,ARCHIVE:3,UNARCHIVE:4,CLEAR:5,DELETE_ALL:6});i.PSA_MESSAGE_REMOVE_ACTION=e}),66);
__d("WAWebWamEnumPsaMessageRemoveEntryPoint",[],(function(t,n,r,o,a,i){var e=Object.freeze({BLOCK_FROM_CONTACT_INFO:1,BLOCK_FROM_CHAT:2,UNBLOCK_FROM_CONTACT_INFO:3,UNBLOCK_FROM_CHAT:4,UNBLOCK_FROM_PRIVACY_SETTINGS:5,ARCHIVE_FROM_CHAT_LIST:6,ARCHIVE_FROM_DELETE_OPTION:7,UNARCHIVE_FROM_ARCHIVED_CHAT_LIST:8,CLEAR_FROM_CONTACT_INFO:9,CLEAR_FROM_CHAT_LIST:10,DELETE_ALL_FROM_CHAT_LIST:11,DELETE_ALL_FROM_CONTACT_INFO:12,DELETE_ALL_FROM_CONVERSATION:13,CLEAR_FROM_CONVERSATION:14,BLOCK_FROM_CONSENT_MODAL:15});i.PSA_MESSAGE_REMOVE_ENTRY_POINT=e}),66);
__d("WAWebChatPsaRemoveWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumMediaType","WAWebWamEnumPsaBlockReason","WAWebWamEnumPsaMessageRemoveAction","WAWebWamEnumPsaMessageRemoveEntryPoint","WAWebWamEnumWaOfficialAccountName"],(function(t,n,r,o,a,i,l){var e,s=(e=o("WAWebWamCodegenUtils")).defineEvents({ChatPsaRemove:[3582,{lastReceivedMediaType:[2,o("WAWebWamEnumMediaType").MEDIA_TYPE],lastReceivedMessageTs:[4,e.TYPES.TIMER],lastReceivedMsgId:[8,e.TYPES.STRING],psaBlockReason:[10,o("WAWebWamEnumPsaBlockReason").PSA_BLOCK_REASON],psaCampaignId:[9,e.TYPES.STRING],psaMessageRemoveAction:[5,o("WAWebWamEnumPsaMessageRemoveAction").PSA_MESSAGE_REMOVE_ACTION],psaMessageRemoveEntryPoint:[6,o("WAWebWamEnumPsaMessageRemoveEntryPoint").PSA_MESSAGE_REMOVE_ENTRY_POINT],waOfficialAccountName:[7,o("WAWebWamEnumWaOfficialAccountName").WA_OFFICIAL_ACCOUNT_NAME]},[1,1,1],"regular"]},{ChatPsaRemove:[]});l.ChatPsaRemoveWamEvent=s}),98);
__d("WAWebEphemeralityResolver",["WALogger","WATimeUtils","WAWebEphemeralityTypes"],(function(t,n,r,o,a,i,l){var e,s,u,c;function d(t){if(!t)return o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["getDisappearingModeSettingForUser: empty contact"]))),null;var n=t.disappearingModeDuration,r=t.disappearingModeSettingTimestamp;return o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["getDisappearingModeSettingForUser: disappearing mode setting fetched for ",": duration="," settingTimestamp=",""])),t.id.toString(),n,r).tags("DM","DDM"),n==null||n===0?null:{duration:n,settingTimestamp:r!=null?r:0}}function m(e){var t=d(e);return t!=null?t.duration:null}function p(e){return e!=null?e:0}function _(e){return e!=null?e:o("WAWebEphemeralityTypes").DisappearingModeInitiator.ChangedInChat}function f(e){return e!=null?e:o("WATimeUtils").unixTime()}function g(e){return e!=null?e:o("WAWebEphemeralityTypes").DisappearingModeTrigger.ChatSettings}function h(e,t){var n=t===o("WAWebEphemeralityTypes").DisappearingModeInitiator.InitiatedByMe;return e!=null?e:n}function y(e){return e==null||e.duration==null&&e.settingTimestamp==null&&e.initiator==null?null:{duration:p(e.duration),settingTimestamp:f(e.settingTimestamp),initiator:_(e.initiator),disappearingModeTrigger:g(e.disappearingModeTrigger),initiatedByMe:h(e.initiatedByMe,e.initiator)}}function C(e,t){return(e==null?void 0:e.duration)===(t==null?void 0:t.duration)&&(e==null?void 0:e.settingTimestamp)===(t==null?void 0:t.settingTimestamp)&&(e==null?void 0:e.initiator)===(t==null?void 0:t.initiator)}function b(e,t){var n=m(e),r=m(t);if(n==null&&r==null)return o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["[DMResolve] DM setting for chat is null"]))).tags("DM","DDM"),null;var a;n!=null&&(a={duration:n,settingTimestamp:o("WATimeUtils").unixTime(),initiator:o("WAWebEphemeralityTypes").DisappearingModeInitiator.InitiatedByMe,disappearingModeTrigger:o("WAWebEphemeralityTypes").DisappearingModeTrigger.AccountSettings,initiatedByMe:!0});var i;return r!=null&&(i={duration:r,settingTimestamp:o("WATimeUtils").unixTime(),initiator:o("WAWebEphemeralityTypes").DisappearingModeInitiator.InitiatedByOther,disappearingModeTrigger:o("WAWebEphemeralityTypes").DisappearingModeTrigger.AccountSettings,initiatedByMe:!1}),a!=null&&i!=null?i.duration<a.duration?i:a:a!=null?a:i}function v(e,t){var n=y(e);if(n==null&&t==null)return null;if(n!=null&&t==null)return{duration:n.duration,settingTimestamp:n.settingTimestamp,initiator:n.initiator===o("WAWebEphemeralityTypes").DisappearingModeInitiator.InitiatedByMe?o("WAWebEphemeralityTypes").DisappearingModeInitiator.ChangedInChat:n.initiator,disappearingModeTrigger:o("WAWebEphemeralityTypes").DisappearingModeTrigger.ChatSettings,initiatedByMe:n.initiator===o("WAWebEphemeralityTypes").DisappearingModeInitiator.InitiatedByMe};if(n==null&&t!=null)return{duration:t.duration,settingTimestamp:f(t.settingTimestamp),initiator:_(t.initiator),disappearingModeTrigger:g(t.disappearingModeTrigger),initiatedByMe:t.initiatedByMe};if(n!=null&&t!=null){var r,a;return n.settingTimestamp>((r=t.settingTimestamp)!=null?r:0)?babelHelpers.extends({},n):n.settingTimestamp<((a=t.settingTimestamp)!=null?a:0)?{duration:t.duration,settingTimestamp:f(t.settingTimestamp),initiator:_(t.initiator),disappearingModeTrigger:g(t.disappearingModeTrigger),initiatedByMe:t.initiatedByMe}:babelHelpers.extends({},n,{initiator:t.initiator===o("WAWebEphemeralityTypes").DisappearingModeInitiator.ChangedInChat?o("WAWebEphemeralityTypes").DisappearingModeInitiator.ChangedInChat:n.initiator})}}function S(e,t){o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["[DMResolve] resolving new incoming chat DM settings"]))).devConsole({incomingMsgSettings:e,localDDMDuration:t});var n=y(e),r=p(t);if(n==null&&r===0)return null;if(n!=null&&r===0)return{duration:n.duration,settingTimestamp:n.settingTimestamp,initiator:n.initiator===o("WAWebEphemeralityTypes").DisappearingModeInitiator.InitiatedByMe?o("WAWebEphemeralityTypes").DisappearingModeInitiator.ChangedInChat:n.initiator,disappearingModeTrigger:n.disappearingModeTrigger,initiatedByMe:n.initiatedByMe};if(n==null&&r>0)return{duration:r,settingTimestamp:o("WATimeUtils").unixTime(),initiator:o("WAWebEphemeralityTypes").DisappearingModeInitiator.InitiatedByMe,disappearingModeTrigger:o("WAWebEphemeralityTypes").DisappearingModeTrigger.AccountSettings,initiatedByMe:!0};if(n!=null&&r>0){if(n.initiator===o("WAWebEphemeralityTypes").DisappearingModeInitiator.ChangedInChat||n.duration>0&&n.duration<r){var a=n.initiator,i=n.initiatedByMe;return a===o("WAWebEphemeralityTypes").DisappearingModeInitiator.InitiatedByMe&&(a=o("WAWebEphemeralityTypes").DisappearingModeInitiator.ChangedInChat,i=!0),{initiator:a,settingTimestamp:n.settingTimestamp,duration:n.duration,disappearingModeTrigger:n.disappearingModeTrigger,initiatedByMe:i}}return r<n.duration?{duration:r,settingTimestamp:o("WATimeUtils").unixTime(),initiator:o("WAWebEphemeralityTypes").DisappearingModeInitiator.InitiatedByMe,disappearingModeTrigger:o("WAWebEphemeralityTypes").DisappearingModeTrigger.AccountSettings,initiatedByMe:!0}:babelHelpers.extends({},n)}}l.getDisappearingModeSettingForUser=d,l.getEphemeralDurationForUser=m,l.resolveEphermalityDuration=p,l.resolveDisappearingModeInitiator=_,l.resolveSettingTimestamp=f,l.resolveDisappearingModeTrigger=g,l.resolveDisappearingModeInitiatedByMe=h,l.compareEphemeralityFields=C,l.resolveNewChatDMSettings=b,l.resolveExistingChatDMSettings=v,l.resolveNewIncomingChatDMSettings=S}),98);
__d("WAWebGetCTWAEligibilityFromConversion",["WAArrayBufferUtils"],(function(t,n,r,o,a,i,l){var e="FB_Ads";function s(t){var n=t.conversionData,r=t.conversionSource;if(n==null||r!==e)return null;try{var a=o("WAArrayBufferUtils").arrayBufferToString(n);return{data:a,source:e}}catch(e){return null}}l.SMB_DATA_SHARING_ALLOWED_SOURCE=e,l.getCTWAEligibilityFromConversion=s}),98);
__d("WAWebPrivacyModeSystemMsg",["$InternalEnum","WAWebHandleMsgTypes.flow"],(function(t,n,r,o,a,i,l){var e=n("$InternalEnum").Mirrored(["E2EE","BSP","FB","HOSTED_GROUP"]);function s(t){return t==null||t.actualActors===o("WAWebHandleMsgTypes.flow").ActualActorsEnumType.Self&&t.hostStorage===o("WAWebHandleMsgTypes.flow").HostStorageEnumType.OnPremise?e.E2EE:t.actualActors===o("WAWebHandleMsgTypes.flow").ActualActorsEnumType.Capi?e.HOSTED_GROUP:t.hostStorage===o("WAWebHandleMsgTypes.flow").HostStorageEnumType.Facebook?e.FB:e.BSP}function u(e,t){return e==null?t:t==null||e.privacyModeTs>t.privacyModeTs?e:t}function c(e,t){return e==null&&t==null?0:t==null?1:e==null?-1:e.privacyModeTs-t.privacyModeTs}function d(e){var t,n=(t=e.bizInfo)==null?void 0:t.verifiedName;return n==null?null:e.biz&&n.isApi===!0?n.privacyMode:null}l.ReducedPrivacyMode=e,l.getReducedPrivacyMode=s,l.getLatestPrivacyMode=u,l.comparePrivacyMode=c,l.getPrivacyModeFromQueryExistResponse=d}),98);
__d("WAWebInitialSystemMsg",["WALogger","WANullthrows","WAWebABProps","WAWebAdvHostedAccountTypeSystemMsg","WAWebApiDeviceList","WAWebBizCoexGatingUtils","WAWebBizCoexUtils","WAWebBotSystemMsg","WAWebBotTos","WAWebBotTypes","WAWebContactSystemMsg","WAWebMobilePlatforms","WAWebPrivacyModeSystemMsg","WAWebProtobufsAdv.pb","WAWebUserPrefsMultiDevice","WAWebWid","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e;function s(e,t,n){return u.apply(this,arguments)}function u(){return u=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,n,a){if(r("WAWebWid").isPSA(t))return[o("WAWebContactSystemMsg").genEncryptNotificationMsg(t,"chat_psa")];if(t.isBot())return[o("WAWebBotSystemMsg").genBotInitSystemMsg(t)];if(r("WAWebWid").isCAPISupportAccount(t))return o("WAWebABProps").getABPropConfigValue("support_use_dedicated_system_event")?[o("WAWebContactSystemMsg").genNonE2ENotificationMsg(t,"support_system_message")]:[o("WAWebContactSystemMsg").genNonE2ENotificationMsg(t,"biz_privacy_mode_init_fb")];if(a===o("WAWebBotTypes").BizBotAutomatedType.FULL_3P)return[o("WAWebBotSystemMsg").genBizBot3pDisclosureMessage(t)];if(o("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()&&t.isUser()){if(o("WAWebMobilePlatforms").isSMB()&&(yield o("WAWebUserPrefsMultiDevice").getIsHostedMeAccount())===!0)return o("WALogger").DEV(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[Hosted] inserting is me hosted notification msg"]))),[r("WANullthrows")(o("WAWebAdvHostedAccountTypeSystemMsg").genAdvMeAccountIsHostedNotificationMsg(t,t))];var i=o("WAWebUserPrefsMultiDevice").getHaveProcessedCoexAdv();if(i&&t.isUser()){var l=yield o("WAWebApiDeviceList").getDeviceRecord(t);if((l==null?void 0:l.advAccountType)===o("WAWebProtobufsAdv.pb").ADVEncryptionType.HOSTED||(l==null?void 0:l.deletedChangedToHost)===!0)return o("WAWebBizCoexUtils").shouldDedupInitialHostedSystemMsg(t)?[]:[r("WANullthrows")(o("WAWebAdvHostedAccountTypeSystemMsg").genAdvAccountTypeInitialSysMsg(t,t))]}}var s=[],u=o("WAWebPrivacyModeSystemMsg").getReducedPrivacyMode(n);switch(u){case o("WAWebPrivacyModeSystemMsg").ReducedPrivacyMode.E2EE:s.push(o("WAWebContactSystemMsg").genEncryptNotificationMsg(t));break;case o("WAWebPrivacyModeSystemMsg").ReducedPrivacyMode.BSP:s.push(o("WAWebContactSystemMsg").genNonE2ENotificationMsg(t,"biz_privacy_mode_init_bsp"));break;case o("WAWebPrivacyModeSystemMsg").ReducedPrivacyMode.FB:s.push(o("WAWebContactSystemMsg").genNonE2ENotificationMsg(t,"biz_privacy_mode_init_fb"));break;case o("WAWebPrivacyModeSystemMsg").ReducedPrivacyMode.HOSTED_GROUP:s.push(o("WAWebContactSystemMsg").genNonE2ENotificationMsg(t,"is_capi_hosted_group"));break}return a===o("WAWebBotTypes").BizBotAutomatedType.PARTIAL_1P&&o("WAWebBotTos").hasAcceptedBizBotTos()&&s.push(o("WAWebBotSystemMsg").genBizBot1pDisclosureMessage(t)),s}),u.apply(this,arguments)}l.default=s}),98);
__d("WAWebMsgEphemerality",["WAWebEphemeralityTypes","WAWebMsgType"],(function(t,n,r,o,a,i,l){var e;function s(e){var t;if(e.ephemeralDuration==null&&e.ephemeralSettingTimestamp==null&&e.disappearingModeInitiator==null)return null;var n=(t=e.ephemeralDuration)!=null?t:0,r=e.ephemeralSettingTimestamp,a=e.disappearingModeInitiator,i=e.disappearingModeTrigger,l=e.disappearingModeInitiatedByMe;return e.subtype==="ephemeral_setting"&&(r=e.t,a=o("WAWebEphemeralityTypes").DisappearingModeInitiator.ChangedInChat),{duration:n,settingTimestamp:r,initiator:a,disappearingModeTrigger:i,initiatedByMe:l}}var u=[(e=o("WAWebMsgType")).MSG_TYPE.CHAT,e.MSG_TYPE.IMAGE,e.MSG_TYPE.VIDEO,e.MSG_TYPE.AUDIO,e.MSG_TYPE.PTT,e.MSG_TYPE.DOCUMENT,e.MSG_TYPE.PRODUCT,e.MSG_TYPE.STICKER,e.MSG_TYPE.POLL_CREATION,e.MSG_TYPE.POLL_RESULT_SNAPSHOT,e.MSG_TYPE.NEWSLETTER_ADMIN_INVITE,e.MSG_TYPE.GROUPS_V4_INVITE,e.MSG_TYPE.CALL_LOG];function c(e){return!!u.includes(e)}l.getMsgEphemeralitySettings=s,l.ephemeralMessageTypes=u,l.messageSupportsEphemerality=c}),98);
__d("WAWebWamEnumFmxEntryPoint",[],(function(t,n,r,o,a,i){var e=Object.freeze({FMX_CARD:0,SAFETY_TOOLS:1});i.FMX_ENTRY_POINT=e}),66);
__d("WAWebWamEnumFmxEvent",[],(function(t,n,r,o,a,i){var e=Object.freeze({BLOCK:0,ADD_CONTACT:1,REPORT:2,SAFETY_TOOLS:3,COMMON_GROUPS:4,CONTACT_INFO:5,FMX_CARD_INSERTED:6,FMX_CARD_VIEWED:7,LEARN_MORE:8,HIGHLIGHT_GROUP_NAME:9,FMX_CARD_TRUST_SIGNALS_FB_IG_VIEWED:10,STOP_MARKETING_MSG_OFFERS:11,MESSAGE_PREFERENCES:12});i.FMX_EVENT=e}),66);
__d("WAWebWamEnumHighlightGroupType",[],(function(t,n,r,o,a,i){var e=Object.freeze({UNKNOWN:0,SINGLE:1,CREATOR:2,ADMIN:3,SAVED_CONTACTS:4,PARTICIPANTS:5,MORE:6});i.HIGHLIGHT_GROUP_TYPE=e}),66);
__d("WAWebPsFmxActionWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumFmxEntryPoint","WAWebWamEnumFmxEvent","WAWebWamEnumHighlightGroupType"],(function(t,n,r,o,a,i,l){var e,s=(e=o("WAWebWamCodegenUtils")).defineEvents({PsFmxAction:[7054,{commonGroupNum:[1,e.TYPES.INTEGER],countryShown:[2,e.TYPES.BOOLEAN],fmxEntryPoint:[3,o("WAWebWamEnumFmxEntryPoint").FMX_ENTRY_POINT],fmxEvent:[4,o("WAWebWamEnumFmxEvent").FMX_EVENT],highlightGroupType:[5,o("WAWebWamEnumHighlightGroupType").HIGHLIGHT_GROUP_TYPE],isSenderSmb:[6,e.TYPES.BOOLEAN],notAContactShown:[7,e.TYPES.BOOLEAN]},[1,1,1],"private",113760892]},{PsFmxAction:[]});l.PsFmxActionWamEvent=s}),98);
__d("WAWebSagaSystemMsg",["WAWebContactSystemMsg","WAWebMsgType"],(function(t,n,r,o,a,i,l){function e(e){return o("WAWebContactSystemMsg").genNotificationMsg(e,{type:"notification_template",kind:o("WAWebMsgType").MsgKind.NotificationTemplate,subtype:"saga_init",templateParams:[]})}l.genSagaInitSystemMsg=e}),98);
__d("WAWebCreateChat",["Promise","WALogger","WANullthrows","WAWebABProps","WAWebABPropsSaga","WAWebApiBusinessProfile","WAWebApiChat","WAWebApiContact","WAWebApiContactUsernameFields","WAWebApiOrphanTcToken","WAWebApiVerifiedBusinessName","WAWebBackendApi","WAWebBizGatingUtils","WAWebBotTypes","WAWebChatOriginTypes","WAWebContactSystemMsg","WAWebCountryCodeUtils","WAWebCtwaAGMUtils","WAWebEphemeralityResolver","WAWebEphemeralityTypes","WAWebFMXGatingUtils","WAWebGetCTWAEligibilityFromConversion","WAWebGetMessageCache","WAWebHandleMsgTypes.flow","WAWebHandleSingleMsg","WAWebInitialSystemMsg","WAWebLid1X1MigrationGating","WAWebLidAwareContactsDB","WAWebLidMigrationUtils","WAWebMsgEphemerality","WAWebPrivacyModeSystemMsg","WAWebPsFmxActionWamEvent","WAWebQueryBusinessProfile","WAWebSagaSystemMsg","WAWebUpdateLidMetadataJob","WAWebUserPrefsMeUser","WAWebUsernameGatingUtils","WAWebWamEnumFmxEntryPoint","WAWebWamEnumFmxEvent","WAWebWidFactory","WAWebWorkerSafeBackendApi","asyncToGeneratorRuntime","lodash"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p,_,f,g;function h(e,t,n,r){return y.apply(this,arguments)}function y(){return y=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,n,a,i){var l=i!=null?i:{},f=l.forceUsync,g=f===void 0?!1:f,h=l.firstIncomingMsg,y=l.nextPrivacyMode,b=l.createdOffline,R=b===void 0?!1:b;o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["createChat: ",""])),n);var E=t.chatId,k=E;if(E.isLid()){r("WANullthrows")(a==null?void 0:a.lidOriginType,"Origin type is missing when creating LID chat");var I=o("WAWebApiContact").getPhoneNumber(E),T=!o("WAWebChatOriginTypes").VALID_LID_ORIGINS.has(n),D=o("WAWebChatOriginTypes").VALID_USERNAME_ORIGINS.has(n)&&I!=null;D?(o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["createChat: "," trying to create new username chat when phone number is known."])),n).sendLogs("unexpected-username-lid-chat"),I!=null&&(k=I)):T&&!o("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.isLidMigrated()&&(o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["lid: ",", origin type: ",""])),t.chatId.toLogString(),a==null?void 0:a.lidOriginType),o("WALogger").ERROR(c||(c=babelHelpers.taggedTemplateLiteralLoose(["createChat: "," unexpected lid chat created"])),n).sendLogs("unexpected-lid-chat"));var x=yield o("WAWebApiContact").getContactRecord(o("WAWebUserPrefsMeUser").getMePnUserOrThrow());n==="username_contactless_search"&&(x==null?void 0:x.username)==null&&(yield o("WAWebUpdateLidMetadataJob").updateLidMetadataJob([{lid:E,data:{shareOwnPn:!0}}]))}var $=k.isUser()&&g?yield o("WAWebWorkerSafeBackendApi").workerSafeSendAndReceive("getOrQueryUsyncInfo",{wid:k}):null,P=$==null?k:$.wid;if(!k.equals(P)){var N=yield o("WAWebApiChat").getChatRecord(P);if(N!=null)return}var M=!1,w=!1,A=null;if(($==null?void 0:$.bizInfo)!=null){var F,O;M=(F=$.bizInfo)==null?void 0:F.verifiedName.isApi,w=(O=$.bizInfo)==null?void 0:O.verifiedName.isSmb,A=o("WAWebPrivacyModeSystemMsg").getPrivacyModeFromQueryExistResponse($)}else if($==null){var B=yield o("WAWebApiVerifiedBusinessName").getVerifiedBusinessNameRecordLidAware(P);B!=null&&(w=B.isSmb,M=B.isApi,A=B.privacyMode!=null?o("WAWebApiVerifiedBusinessName").convertPrivacyModeFromStorageType(B.privacyMode):null)}var W=a!=null?babelHelpers.extends({},a,{id:P}):{id:P};if(o("WAWebLidMigrationUtils").shouldHaveAccountLid(P)){var q,U,V;W.accountLid=r("WANullthrows")(t.accountLid,"account lid not provided for one on one chat creation"),o("WALogger").LOG(d||(d=babelHelpers.taggedTemplateLiteralLoose(["createChat: creating new chat with chat_id="," account_lid: ",", pn: ",""])),P.toLogString(),(q=W.accountLid)==null?void 0:q.toLogString(),(U=(V=o("WAWebLidMigrationUtils").toPn(P))==null?void 0:V.toLogString())!=null?U:"n/a")}var H=P.isUser()&&!P.isBot()?yield S(P,M,h):null;H!=null&&(o("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["[DMResolve] DM settings found for new chat"]))).devConsole(H),W.ephemeralDuration=H.duration,W.ephemeralSettingTimestamp=H.settingTimestamp,W.disappearingModeInitiator=H.initiator,o("WAWebABProps").getABPropConfigValue("dm_initiator_trigger")&&(W.disappearingModeTrigger=H.disappearingModeTrigger,W.disappearingModeInitiatedByMe=H.initiatedByMe));var G=o("WAWebPrivacyModeSystemMsg").getLatestPrivacyMode(y,A);P.isUser()&&o("WAWebBackendApi").frontendFireAndForget("updateBusinessInfo",{contactId:P,businessInfo:{privacyMode:G}});var z;(h==null?void 0:h.subtype)!=="ephemeral_setting"&&(z=v(P,H==null?void 0:H.duration,H==null?void 0:H.initiator));var j;P.isCAPISupportAccount()&&o("WAWebABPropsSaga").getIsSagaV1Enabled()&&!o("WAWebABPropsSaga").getIsSagaProtobufSystemMessageEnabled()&&(j=o("WAWebSagaSystemMsg").genSagaInitSystemMsg(P));var K=o("WAWebBizGatingUtils").getFmxAgmEnabled(),Q=(h==null?void 0:h.ctwaContext)!=null&&o("WAWebGetCTWAEligibilityFromConversion").getCTWAEligibilityFromConversion({conversionData:h.ctwaContext.conversionData,conversionSource:h.ctwaContext.conversionSource}),X=h==null?void 0:h.ctwaContext,Y=(X==null?void 0:X.sourceApp)!==o("WAWebCtwaAGMUtils").AGM_SOURCE_APP.WHATSAPP||o("WAWebBizGatingUtils").getWamoAgmEnabled(),J=yield o("WAWebContactSystemMsg").genContactInfoCardMsg(P,{isSmb:w,isEnterprise:M||(h==null?void 0:h.senderOrRecipientAccountTypeHosted)===!0,iAmStartingChat:h==null||h.id.fromMe,isWASupportStartingChat:h!=null&&P.isCAPISupportAccount(),isFromCTWA:X!=null&&Q!=null,isFMXCtWA:X!=null&&Y&&o("WAWebBizGatingUtils").getFmxAgmEnabled()});J!=null&&o("WAWebFMXGatingUtils").fmxLoggingEnabled()&&new(o("WAWebPsFmxActionWamEvent")).PsFmxActionWamEvent({fmxEntryPoint:o("WAWebWamEnumFmxEntryPoint").FMX_ENTRY_POINT.FMX_CARD,fmxEvent:o("WAWebWamEnumFmxEvent").FMX_EVENT.FMX_CARD_INSERTED,isSenderSmb:w}).commit();var Z;(w||M)&&(Z=yield L(P));var ee=yield r("WAWebInitialSystemMsg")(P,G,Z);ee.some(function(e){return e.subtype==="biz_bot_3p_disclosure"})?W.bizBotSystemMsgType=o("WAWebBotTypes").BizBotType.BIZ_3P:ee.some(function(e){return e.subtype==="biz_bot_1p_disclosure"})&&(W.bizBotSystemMsgType=o("WAWebBotTypes").BizBotType.BIZ_1P);var te=yield o("WAWebApiOrphanTcToken").getOrphanTcToken(P);if(te){var ne,re;o("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["createChat: found orphan tc token for ",""])),P.toLogString()),W.tcToken=(ne=te.tcToken)!=null?ne:null,W.tcTokenTimestamp=(re=te.tcTokenTimestamp)!=null?re:null,yield o("WAWebApiOrphanTcToken").removeOrphanTcToken(P)}yield o("WAWebBackendApi").frontendFireAndForget("chatCollectionGadd",{chat:W}),yield o("WAWebApiChat").createChatRecord(P,C(W));var oe=o("WAWebHandleMsgTypes.flow").MessageOverwriteOption.NO_OVERWRITE,ae=!1,ie=K?[].concat(ee,[J,z,j]).filter(Boolean):[J].concat(ee,[z,j]).filter(Boolean);if(R)o("WAWebGetMessageCache").getMessageCache().addMessages(ie.map(function(e){return{msg:e}}),!1);else{o("WALogger").LOG(_||(_=babelHelpers.taggedTemplateLiteralLoose(["createChat: will add "," messages to chat ",""])),ie.length,P.toLogString());for(var le of ie)yield o("WAWebHandleSingleMsg").handleSingleMsg({chatId:P,newMsg:le,handleSingleMsgOrigin:"createChat",messageOverwriteOption:oe,preserveOrder:ae})}if(t.chatId.isUser()){var se=o("WAWebWidFactory").createUserWidOrThrow(t.chatId.toString()),ue=se.toJid(),ce=o("WAWebApiContact").getContactHash(ue),de={id:ue,contactHash:ce},me;if(o("WAWebUsernameGatingUtils").usernameDisplayedEnabled()){var pe=yield o("WAWebApiContactUsernameFields").getContactUsernameCountryCode(P);pe==null&&(me=yield o("WAWebCountryCodeUtils").getUsernameCountryCodeFromPnOrServer(se),me&&(de.usernameCountryCode=me))}yield r("WAWebLidAwareContactsDB").createOrMerge(ue,de)}}),y.apply(this,arguments)}function C(e){var t,n,r,a,i,l,s={id:e.id.toString(),accountLid:(t=e.accountLid)==null?void 0:t.toString(),t:e.t,isAutoMuted:!1,unreadCount:(n=e.unreadCount)!=null?n:0,notSpam:e.notSpam,ephemeralDuration:e.ephemeralDuration,ephemeralSettingTimestamp:e.ephemeralSettingTimestamp,disappearingModeInitiator:(e.disappearingModeInitiator!=null,e.disappearingModeInitiator),tcToken:(r=e.tcToken)!=null?r:void 0,tcTokenTimestamp:(a=e.tcTokenTimestamp)!=null?a:void 0,tcTokenSenderTimestamp:(i=e.tcTokenSenderTimestamp)!=null?i:void 0,bizBotSystemMsgType:e.bizBotSystemMsgType,lidOriginType:e.lidOriginType,createdLocally:(l=e.createdLocally)!=null?l:!1};if(o("WAWebABProps").getABPropConfigValue("dm_initiator_trigger")){var u;s.disappearingModeTrigger=(e.disappearingModeTrigger!=null,e.disappearingModeTrigger),s.disappearingModeInitiatedByMe=(u=e.disappearingModeInitiatedByMe)!=null?u:void 0}return e.name!=null&&(s.name=e.name),e.isReadOnly!=null&&(s.isReadOnly=e.isReadOnly),e.muteExpiration!=null&&(s.muteExpiration=e.muteExpiration),s}function b(e){var t=C(e);return r("lodash").pickBy(t,function(e){return e!=null})}function v(e,t,n){var r=null;return t!=null&&(n===o("WAWebEphemeralityTypes").DisappearingModeInitiator.ChangedInChat?r=o("WAWebContactSystemMsg").genDisappearingModeUpdateSystemMsg(e,t,null):r=o("WAWebContactSystemMsg").genDefaultDisappearingModeSystemMsg(e,t,n===o("WAWebEphemeralityTypes").DisappearingModeInitiator.InitiatedByMe)),r}function S(e,t,n){return R.apply(this,arguments)}function R(){return R=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,r){o("WALogger").LOG(f||(f=babelHelpers.taggedTemplateLiteralLoose(["getDisappearingModeSettingForNewChat"])));var a=yield(g||(g=n("Promise"))).all([o("WAWebApiContact").getContactRecord(o("WAWebUserPrefsMeUser").getMePnUserOrThrow()),o("WAWebApiContact").getContactRecord(e)]),i=a[0],l=a[1];if(!t&&e.isUser()&&!e.isPSA()){var s=r==null||r.id.fromMe;if(s)return o("WAWebEphemeralityResolver").resolveNewChatDMSettings(i,l);var u=o("WAWebEphemeralityResolver").getEphemeralDurationForUser(i);return o("WAWebEphemeralityResolver").resolveNewIncomingChatDMSettings(r?o("WAWebMsgEphemerality").getMsgEphemeralitySettings(r):null,u)}}),R.apply(this,arguments)}function L(e){return E.apply(this,arguments)}function E(){return E=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t,n=yield o("WAWebApiBusinessProfile").getBusinessProfileRow(e.toString());if(n)return o("WAWebBotTypes").BizBotAutomatedType.cast(n.automatedType);var r=yield o("WAWebQueryBusinessProfile").queryBusinessProfile([{wid:e}]);return(t=r[0])==null||(t=t.profile)==null?void 0:t.automated_type}),E.apply(this,arguments)}l.createChat=h,l.createNewsletterObjectForStorage=b}),98);
__d("WAWebMessageLidOriginType",["WAWebUserPrefsPhoneNumberHidingThreadPromotionMigration","WAWebUsernameTypes"],(function(t,n,r,o,a,i,l){function e(e,t){if(e.isLid())return(t==null?void 0:t.origin)!=null?(t.origin,o("WAWebUserPrefsPhoneNumberHidingThreadPromotionMigration").hasPhoneNumberHidingThreadPromotionMigrationStarted()?o("WAWebUsernameTypes").LidOriginType.GENERAL:o("WAWebUsernameTypes").LidOriginType.cast(t.origin)):o("WAWebUsernameTypes").LidOriginType.GENERAL}l.determineLidOriginTypeForIncomingMessage=e}),98);
__d("WAWebCheckChatExistsOrCreate",["WALogger","WAWebApiChat","WAWebApiHydrateWidsUtil","WAWebBackendApi","WAWebCreateChat","WAWebCurrentUser","WAWebLid1X1MigrationGating","WAWebMessageLidOriginType","WAWebRuntimeEnvironmentUtils","WAWebUsernameTypes","WAWebWidFactory","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p;function _(e){return f.apply(this,arguments)}function f(){return f=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){return o("WAWebRuntimeEnvironmentUtils").isWorker()?(yield o("WAWebApiChat").getChatRecord(e))!=null:o("WAWebBackendApi").frontendSendAndReceive("hasChat",{chatId:e})}),f.apply(this,arguments)}var g=new Map;function h(e){var t=e.destinationChat,n=e.msgMeta,r=e.options,a=e.chatOriginType,i=e.initialProps,l=t.chatId,s=l.isRegularUser()?o("WAWebMessageLidOriginType").determineLidOriginTypeForIncomingMessage(o("WAWebWidFactory").asUserWidOrThrow(l),n):null;return o("WAWebCreateChat").createChat(t,a,babelHelpers.extends({createdLocally:!1,lidOriginType:s},i),r)}function y(e){return C.apply(this,arguments)}function C(){return C=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var r,a=t.destinationChat,i=a.chatId,l=i.toString();if(o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["checkChatExistsOrCreate called with chatWid=",", accountLid=",""])),i.toLogString(),(r=a.accountLid)==null?void 0:r.toLogString()),o("WAWebCurrentUser").isEmployee()){var f,y;o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["checkChatExistsOrCreate: first message id: ",""])),(f=(y=t.options.firstIncomingMsg)==null?void 0:y.id.toString())!=null?f:"not-passed")}var C=g.get(l);C!=null&&(yield C);var b=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=yield _(i);if(e!==!0){var n,r;if(i.isLid()&&!o("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.isLidMigrated()&&(t==null||(n=t.initialProps)==null?void 0:n.lidOriginType)!==o("WAWebUsernameTypes").LidOriginType.PNH_CTWA&&((r=t.msgMeta)==null?void 0:r.origin)!=="ctwa"){var a,s;o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["checkChatExistsOrCreate: chat origin: ",". lid origin ",", ",""])),t.chatOriginType,(a=t.msgMeta)==null?void 0:a.origin,t==null||(s=t.initialProps)==null?void 0:s.lidOriginType),o("WALogger").ERROR(c||(c=babelHelpers.taggedTemplateLiteralLoose(["checkChatExistsOrCreate: asked to create Lid chat ",", "," but is not migrated"])),i.toLogString(),t.chatOriginType).sendLogs("checkChatExistsOrCreate: asked to create Lid chat but is not migrated")}try{var f;o("WALogger").LOG(d||(d=babelHelpers.taggedTemplateLiteralLoose(["checkChatExistsOrCreate: chat does not exist, creating chat ",", ",""])),i.toLogString(),t==null||(f=t.initialProps)==null?void 0:f.lidOriginType),yield h(t)}catch(e){if(!o("WAWebRuntimeEnvironmentUtils").isWorker()&&e instanceof o("WAWebApiChat").CreateChatDuplicateError){var y=yield o("WAWebApiChat").getChatRecord(i);if(y!=null){yield o("WAWebBackendApi").frontendFireAndForget("chatCollectionGadd",{chat:babelHelpers.extends({},o("WAWebApiHydrateWidsUtil").hydrateWids(y),{id:i})});var C=yield _(i);return C||o("WALogger").ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["checkChatExistsOrCreate for ",", unable to restore chat from DB"])),i.toLogString()).tags("messaging").sendLogs("checkChatExistsOrCreate failed to restore chat",{sampling:.01}),C}}o("WALogger").ERROR(p||(p=babelHelpers.taggedTemplateLiteralLoose(["checkChatExistsOrCreate for ",", failed with error: ",""])),i.toLogString(),e).tags("messaging").sendLogs("checkChatExistsOrCreate failed",{sampling:.01})}}return g.delete(l),e})();return g.set(l,b),b}),C.apply(this,arguments)}l.doesChatExist=_,l.checkChatExistsOrCreate=y}),98);
__d("WAWebClickableLink.react",["WAWebClassnames","WAWebExternalLink.react","asyncToGeneratorRuntime","react","stylex","useWAWebStaticButtonA11y"],(function(t,n,r,o,a,i,l){var e,s,u=e||(e=r("react"));function c(e){var t,a=e.children,i=e.href,l=e.onClick,c=e.title,d=e.className,m=e.tabIndex,p=e.xstyle,_=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){i!=null&&(e.metaKey||e.altKey)||(e.preventDefault(),yield l(e))});return function(n){return e.apply(this,arguments)}})(),f=r("useWAWebStaticButtonA11y")(l),g=f[0],h=f[1];return u.jsx(o("WAWebExternalLink.react").ExternalLinkEl,babelHelpers.extends({},h,{ref:g,"data-testid":void 0,className:o("WAWebClassnames").classnamesConvertMeToStylexPlease(d,"x1xlr1w8 xt0b8zv xbvygy2 x17f7hit xp30eni xhmieyt",(s||(s=r("stylex")))(p)),href:i!=null?i:void 0,onClick:_,role:"button",title:c,tabIndex:m!=null?m:void 0,"data-tab":e["data-tab"],children:a}))}c.displayName=c.name+" [from "+i.id+"]",l.default=c}),98);
__d("WAWebProtobufsWa6.pb",["$InternalEnum","WAProtoConst"],(function(t,n,r,o,a,i,l){var e,s,u=(s=n("$InternalEnum"))({OFF:0,STANDARD:1}),c=s({DEFAULT:0,GUEST:1}),d=s({WHATSAPP:0,MESSENGER:1,INTEROP:2,INTEROP_MSGR:3,WHATSAPP_LID:4}),m=s({SYSTEM:0,GOOGLE:1,HARDCODED:2,OVERRIDE:3,FALLBACK:4,MNS:5}),p=s({CELLULAR_UNKNOWN:0,WIFI_UNKNOWN:1,CELLULAR_EDGE:100,CELLULAR_IDEN:101,CELLULAR_UMTS:102,CELLULAR_EVDO:103,CELLULAR_GPRS:104,CELLULAR_HSDPA:105,CELLULAR_HSUPA:106,CELLULAR_HSPA:107,CELLULAR_CDMA:108,CELLULAR_1XRTT:109,CELLULAR_EHRPD:110,CELLULAR_LTE:111,CELLULAR_HSPAP:112}),_=s({PUSH:0,USER_ACTIVATED:1,SCHEDULED:2,ERROR_RECONNECT:3,NETWORK_SWITCH:4,PING_RECONNECT:5,UNKNOWN:6}),f=s({SHARE_EXTENSION:0,SERVICE_EXTENSION:1,INTENTS_EXTENSION:2}),g=s({WEB_BROWSER:0,APP_STORE:1,WIN_STORE:2,DARWIN:3,WIN32:4,WIN_HYBRID:5}),h=s({PHONE:0,TABLET:1,DESKTOP:2,WEARABLE:3,VR:4}),y=s({RELEASE:0,BETA:1,ALPHA:2,DEBUG:3}),C=s({ANDROID:0,IOS:1,WINDOWS_PHONE:2,BLACKBERRY:3,BLACKBERRYX:4,S40:5,S60:6,PYTHON_CLIENT:7,TIZEN:8,ENTERPRISE:9,SMB_ANDROID:10,KAIOS:11,SMB_IOS:12,WINDOWS:13,WEB:14,PORTAL:15,GREEN_ANDROID:16,GREEN_IPHONE:17,BLUE_ANDROID:18,BLUE_IPHONE:19,FBLITE_ANDROID:20,MLITE_ANDROID:21,IGLITE_ANDROID:22,PAGE:23,MACOS:24,OCULUS_MSG:25,OCULUS_CALL:26,MILAN:27,CAPI:28,WEAROS:29,ARDEVICE:30,VRDEVICE:31,BLUE_WEB:32,IPAD:33,TEST:34,SMART_GLASSES:35,BLUE_VR:36,AR_WRIST:37}),b={},v={},S={},R={},L={},E={},k={},I={},T={},D={},x={},$={};b.name="HandshakeMessage",b.internalSpec={clientHello:[2,(e=o("WAProtoConst")).TYPES.MESSAGE,R],serverHello:[3,e.TYPES.MESSAGE,S],clientFinish:[4,e.TYPES.MESSAGE,v]},v.name="HandshakeMessage$ClientFinish",v.internalSpec={static:[1,e.TYPES.BYTES],payload:[2,e.TYPES.BYTES],extendedCiphertext:[3,e.TYPES.BYTES]},S.name="HandshakeMessage$ServerHello",S.internalSpec={ephemeral:[1,e.TYPES.BYTES],static:[2,e.TYPES.BYTES],payload:[3,e.TYPES.BYTES],extendedStatic:[4,e.TYPES.BYTES]},R.name="HandshakeMessage$ClientHello",R.internalSpec={ephemeral:[1,e.TYPES.BYTES],static:[2,e.TYPES.BYTES],payload:[3,e.TYPES.BYTES],useExtended:[4,e.TYPES.BOOL],extendedCiphertext:[5,e.TYPES.BYTES]},L.name="ClientPayload",L.internalSpec={username:[1,e.TYPES.UINT64],passive:[3,e.TYPES.BOOL],userAgent:[5,e.TYPES.MESSAGE,x],webInfo:[6,e.TYPES.MESSAGE,T],pushName:[7,e.TYPES.STRING],sessionId:[9,e.TYPES.SFIXED32],shortConnect:[10,e.TYPES.BOOL],connectType:[12,e.TYPES.ENUM,p],connectReason:[13,e.TYPES.ENUM,_],shards:[14,e.FLAGS.REPEATED|e.TYPES.INT32],dnsSource:[15,e.TYPES.MESSAGE,I],connectAttemptCount:[16,e.TYPES.UINT32],device:[18,e.TYPES.UINT32],devicePairingData:[19,e.TYPES.MESSAGE,k],product:[20,e.TYPES.ENUM,d],fbCat:[21,e.TYPES.BYTES],fbUserAgent:[22,e.TYPES.BYTES],oc:[23,e.TYPES.BOOL],lc:[24,e.TYPES.INT32],iosAppExtension:[30,e.TYPES.ENUM,f],fbAppId:[31,e.TYPES.UINT64],fbDeviceId:[32,e.TYPES.BYTES],pull:[33,e.TYPES.BOOL],paddingBytes:[34,e.TYPES.BYTES],yearClass:[36,e.TYPES.INT32],memClass:[37,e.TYPES.INT32],interopData:[38,e.TYPES.MESSAGE,E],trafficAnonymization:[40,e.TYPES.ENUM,u],lidDbMigrated:[41,e.TYPES.BOOL],accountType:[42,e.TYPES.ENUM,c],connectionSequenceInfo:[43,e.TYPES.SFIXED32],paaLink:[44,e.TYPES.BOOL],preacksCount:[45,e.TYPES.INT32],processingQueueSize:[46,e.TYPES.INT32]},E.name="ClientPayload$InteropData",E.internalSpec={accountId:[1,e.TYPES.UINT64],token:[2,e.TYPES.BYTES],enableReadReceipts:[3,e.TYPES.BOOL]},k.name="ClientPayload$DevicePairingRegistrationData",k.internalSpec={eRegid:[1,e.TYPES.BYTES],eKeytype:[2,e.TYPES.BYTES],eIdent:[3,e.TYPES.BYTES],eSkeyId:[4,e.TYPES.BYTES],eSkeyVal:[5,e.TYPES.BYTES],eSkeySig:[6,e.TYPES.BYTES],buildHash:[7,e.TYPES.BYTES],deviceProps:[8,e.TYPES.BYTES]},I.name="ClientPayload$DNSSource",I.internalSpec={dnsMethod:[15,e.TYPES.ENUM,m],appCached:[16,e.TYPES.BOOL]},T.name="ClientPayload$WebInfo",T.internalSpec={refToken:[1,e.TYPES.STRING],version:[2,e.TYPES.STRING],webdPayload:[3,e.TYPES.MESSAGE,D],webSubPlatform:[4,e.TYPES.ENUM,g]},D.name="ClientPayload$WebInfo$WebdPayload",D.internalSpec={usesParticipantInKey:[1,e.TYPES.BOOL],supportsStarredMessages:[2,e.TYPES.BOOL],supportsDocumentMessages:[3,e.TYPES.BOOL],supportsUrlMessages:[4,e.TYPES.BOOL],supportsMediaRetry:[5,e.TYPES.BOOL],supportsE2EImage:[6,e.TYPES.BOOL],supportsE2EVideo:[7,e.TYPES.BOOL],supportsE2EAudio:[8,e.TYPES.BOOL],supportsE2EDocument:[9,e.TYPES.BOOL],documentTypes:[10,e.TYPES.STRING],features:[11,e.TYPES.BYTES]},x.name="ClientPayload$UserAgent",x.internalSpec={platform:[1,e.TYPES.ENUM,C],appVersion:[2,e.TYPES.MESSAGE,$],mcc:[3,e.TYPES.STRING],mnc:[4,e.TYPES.STRING],osVersion:[5,e.TYPES.STRING],manufacturer:[6,e.TYPES.STRING],device:[7,e.TYPES.STRING],osBuildNumber:[8,e.TYPES.STRING],phoneId:[9,e.TYPES.STRING],releaseChannel:[10,e.TYPES.ENUM,y],localeLanguageIso6391:[11,e.TYPES.STRING],localeCountryIso31661Alpha2:[12,e.TYPES.STRING],deviceBoard:[13,e.TYPES.STRING],deviceExpId:[14,e.TYPES.STRING],deviceType:[15,e.TYPES.ENUM,h],deviceModelType:[16,e.TYPES.STRING]},$.name="ClientPayload$UserAgent$AppVersion",$.internalSpec={primary:[1,e.TYPES.UINT32],secondary:[2,e.TYPES.UINT32],tertiary:[3,e.TYPES.UINT32],quaternary:[4,e.TYPES.UINT32],quinary:[5,e.TYPES.UINT32]},l.ClientPayload$TrafficAnonymization=u,l.ClientPayload$AccountType=c,l.ClientPayload$Product=d,l.ClientPayload$DNSSource$DNSResolutionMethod=m,l.ClientPayload$ConnectType=p,l.ClientPayload$ConnectReason=_,l.ClientPayload$IOSAppExtension=f,l.ClientPayload$WebInfo$WebSubPlatform=g,l.ClientPayload$UserAgent$DeviceType=h,l.ClientPayload$UserAgent$ReleaseChannel=y,l.ClientPayload$UserAgent$Platform=C,l.HandshakeMessageSpec=b,l.HandshakeMessage$ClientFinishSpec=v,l.HandshakeMessage$ServerHelloSpec=S,l.HandshakeMessage$ClientHelloSpec=R,l.ClientPayloadSpec=L,l.ClientPayload$InteropDataSpec=E,l.ClientPayload$DevicePairingRegistrationDataSpec=k,l.ClientPayload$DNSSourceSpec=I,l.ClientPayload$WebInfoSpec=T,l.ClientPayload$WebInfo$WebdPayloadSpec=D,l.ClientPayload$UserAgentSpec=x,l.ClientPayload$UserAgent$AppVersionSpec=$}),98);
__d("WAWebClientPayloadReleaseChannel",["WALogger","WAWebBuildType","WAWebProtobufsWa6.pb","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s;function u(){return c.apply(this,arguments)}function c(){return c=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var t=yield o("WAWebBuildType").getBuildType();switch(t){case o("WAWebBuildType").BuildType.RELEASE:return o("WAWebProtobufsWa6.pb").ClientPayload$UserAgent$ReleaseChannel.RELEASE;case o("WAWebBuildType").BuildType.BETA:return o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[Web] Enabling BETA features"]))),o("WAWebProtobufsWa6.pb").ClientPayload$UserAgent$ReleaseChannel.BETA;case o("WAWebBuildType").BuildType.ALPHA:return o("WAWebProtobufsWa6.pb").ClientPayload$UserAgent$ReleaseChannel.ALPHA;case o("WAWebBuildType").BuildType.DEBUG:return o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[Web]: Enabling DEBUG features"]))),o("WAWebProtobufsWa6.pb").ClientPayload$UserAgent$ReleaseChannel.DEBUG}}),c.apply(this,arguments)}l.getReleaseChannel=u}),98);
__d("WAWebSyncdMdSession",["WABinary","WACryptoSha256","WANullthrows","WAWebCryptoCurve25519","WAWebSignalCommonUtils","WAWebSignalProtocolStore","WAWebUserPrefsMeUser","asyncToGeneratorRuntime","err"],(function(t,n,r,o,a,i,l){function e(){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=o("WAWebSignalCommonUtils").createSignalAddress(o("WAWebUserPrefsMeUser").getMePnUserOrThrow()).toString(),t=r("WANullthrows")(yield o("WAWebSignalProtocolStore").getPersistSignalProtocolStore().loadIdentityKey(e)),n=o("WAWebCryptoCurve25519").toCurveKeyPubKey(o("WAWebSignalCommonUtils").strToBuffer(t)),a=r("WANullthrows")(yield o("WAWebSignalProtocolStore").getPersistSignalProtocolStore().getIdentityKeyPair()),i=o("WAWebCryptoCurve25519").toCurveKeyPubKey(a.pubKey);return u(n,i)}),s.apply(this,arguments)}function u(e,t){return c.apply(this,arguments)}function c(){return c=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){if(e.byteLength!==32)throw r("err")("genSessionId: primary identity public key is "+e.byteLength+" bytes, should be 32!");if(t.byteLength!==32)throw r("err")("genSessionId: companion identity public key is "+e.byteLength+" bytes, should be 32!");var n=new(o("WABinary")).Binary;n.writeBuffer(e),n.write(95),n.writeBuffer(t);var a=n.readByteArrayView(),i=yield o("WACryptoSha256").sha256Base64(a);return i}),c.apply(this,arguments)}l.genCurrentSessionId=e,l.genSessionId=u}),98);
__d("WAWebSyncdMdSyncFieldstatMeta",["Promise","WAStorageEstimator","WAWebSyncdMdSession","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s=-2,u=-1,c=(function(){function t(){this.$1={mdStorageQuotaBytes:-2,mdStorageQuotaUsedBytes:-2},this.$2=null}var r=t.prototype;return r.getStorageEstimation=(function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(this.$1.mdStorageQuotaBytes!==s)return(e||(e=n("Promise"))).resolve(this.$1);var t=yield o("WAStorageEstimator").estimateStorage();return this.$1={mdStorageQuotaBytes:t.success?t.value.quota:u,mdStorageQuotaUsedBytes:t.success?t.value.usage:u},this.$1});function r(){return t.apply(this,arguments)}return r})(),r.getMdSessionId=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){return this.$2!=null?this.$2:(this.$2=yield o("WAWebSyncdMdSession").genCurrentSessionId(),this.$2)});function t(){return e.apply(this,arguments)}return t})(),t})(),d=new c;l.STORAGE_QUOTA_UNAVAILABLE=u,l.MdSyncFieldStatsMeta=d}),98);
__d("WAWebPwaDocumentMetadataUtils",["WAWebNoop","WAWebRuntimeEnvironmentUtils"],(function(t,n,r,o,a,i,l){var e="",s=-1,u;o("WAWebRuntimeEnvironmentUtils").isWorker()||(e=document.title);function c(t){t===void 0&&(t=null),t!=null&&(e=t),d(e)}function d(e){p()?document.title=" ":(self.clearTimeout(u),document.title+=" ",u=self.setTimeout(function(){document.title=e},0))}function m(e){e!=null&&(s=e),p!=null&&p()&&"setAppBadge"in navigator&&(s===-1||s===0?navigator.clearAppBadge==null||navigator.clearAppBadge().catch(r("WAWebNoop")):navigator.setAppBadge==null||navigator.setAppBadge(s).catch(r("WAWebNoop")))}function p(){return"matchMedia"in self?window.matchMedia("(display-mode: standalone)").matches:!1}l.setDocumentTitle=c,l.setAppBadge=m,l.isCurrentWebSessionInsidePwa=p}),98);
__d("WAWebWamPlatform",["WAWebEnvironment","WAWebPwaDocumentMetadataUtils"],(function(t,n,r,o,a,i,l){function e(){return r("WAWebEnvironment").isWindows===!0?"WIN_HYBRID":o("WAWebPwaDocumentMetadataUtils").isCurrentWebSessionInsidePwa()?"PWA":"WEB"}l.getWamPlatform=e}),98);
__d("WAWebClientPayload",["WABase64","WAByteArray","WAMd5","WAWebBuildConstants","WAWebClientFeatureFlags","WAWebClientPayloadReleaseChannel","WAWebEnvironment","WAWebLid1X1MigrationGating","WAWebMiscBrowserUtils","WAWebProtobufsCompanionReg.pb","WAWebProtobufsWa6.pb","WAWebSyncdMdSyncFieldstatMeta","WAWebUserPrefsInfoStore","WAWebUserPrefsMeUser","WAWebWamPlatform","asyncToGeneratorRuntime","encodeProtobuf","gkx","justknobx"],(function(t,n,r,o,a,i,l){var e=null;function s(e){return u.apply(this,arguments)}function u(){return u=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var n=o("WAWebUserPrefsMeUser").getMeDevicePnOrThrow(),r=babelHelpers.extends({},yield m(t),{username:parseInt(n.user,10),device:n.device!=null?n.device:0,lidDbMigrated:o("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.isLidMigrated()},e);return o("encodeProtobuf").encodeProtobuf(o("WAWebProtobufsWa6.pb").ClientPayloadSpec,r).readByteArrayView()}),u.apply(this,arguments)}function c(e,t,n){return d.apply(this,arguments)}function d(){return d=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n){var r=_(),a=yield f(),i=babelHelpers.extends({},yield m(n),{devicePairingData:{buildHash:r,deviceProps:a,eRegid:o("WAByteArray").intToBytes(4,e.registrationId),eKeytype:o("WAByteArray").intToBytes(1,5),eIdent:e.identityKeyPair.pubKey,eSkeyId:o("WAByteArray").intToBytes(3,t.keyId),eSkeyVal:t.keyPair.pubKey,eSkeySig:t.signature}});return o("encodeProtobuf").encodeProtobuf(o("WAWebProtobufsWa6.pb").ClientPayloadSpec,i).readByteArrayView()}),d.apply(this,arguments)}function m(e){return p.apply(this,arguments)}function p(){return p=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t,n;return{passive:(t=e==null?void 0:e.passive)!=null?t:!1,pull:(n=e==null?void 0:e.pull)!=null?n:!1,connectType:o("WAWebProtobufsWa6.pb").ClientPayload$ConnectType.WIFI_UNKNOWN,connectReason:o("WAWebProtobufsWa6.pb").ClientPayload$ConnectReason.USER_ACTIVATED,userAgent:yield y(),webInfo:{webSubPlatform:v()}}}),p.apply(this,arguments)}function _(){var e=o("WABase64").decodeB64(r("WAMd5")(o("WAWebBuildConstants").VERSION_BASE)),t=new Uint8Array(e);return t}function f(){return g.apply(this,arguments)}function g(){return g=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=r("WAWebMiscBrowserUtils").info(),t;if(e.version&&e.version!==""){var n=e.version.split(".");n.length>0&&e.version&&/^[0-9\.]+$/.test(e.version)&&(t={primary:parseInt(n[0],10),secondary:n.length>1?parseInt(n[1],10):void 0,tertiary:n.length>2?parseInt(n[2],10):void 0})}var a={inlineInitialPayloadInE2EeMsg:!0,supportBotUserAgentChatHistory:!0,supportCagReactionsAndPolls:!0,supportRecentSyncChunkMessageCountTuning:!0,supportHostedGroupMsg:!0,supportBizHostedMsg:!0,supportFbidBotChatHistory:!0,supportMessageAssociation:!0,supportCallLogHistory:r("WAWebEnvironment").isWindows,supportGroupHistory:r("gkx")("15338"),thumbnailSyncDaysLimit:r("justknobx")._("4736")},i=o("WAWebClientFeatureFlags").isFeatureEnabled("debug_1_year_history_sync");if(i)a=babelHelpers.extends({},a,{fullSyncDaysLimit:365});else{var l=yield o("WAWebSyncdMdSyncFieldstatMeta").MdSyncFieldStatsMeta.getStorageEstimation();l.mdStorageQuotaBytes!==o("WAWebSyncdMdSyncFieldstatMeta").STORAGE_QUOTA_UNAVAILABLE&&(a=babelHelpers.extends({},a,{storageQuotaMb:Math.trunc(l.mdStorageQuotaBytes/1024/1024)}))}var s=r("WAWebEnvironment").isWindows&&!r("justknobx")._("1836");s&&(a.onDemandReady=!0);var u=r("WAWebEnvironment").isWindows?o("WAWebProtobufsCompanionReg.pb").DeviceProps$PlatformType.UWP:b(e.name),c={os:e.os,version:t,platformType:u,requireFullSync:i,historySyncConfig:a},d=o("encodeProtobuf").encodeProtobuf(o("WAWebProtobufsCompanionReg.pb").DevicePropsSpec,c).readByteArrayView();return d}),g.apply(this,arguments)}function h(t){e=t}function y(){return C.apply(this,arguments)}function C(){return C=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=yield o("WAWebUserPrefsInfoStore").deviceInfo.get(),t={appVersion:{primary:Number(o("WAWebBuildConstants").VERSION_PRIMARY),secondary:Number(o("WAWebBuildConstants").VERSION_SECONDARY),tertiary:Number(o("WAWebBuildConstants").VERSION_TERTIARY)},platform:o("WAWebProtobufsWa6.pb").ClientPayload$UserAgent$Platform.WEB,releaseChannel:yield o("WAWebClientPayloadReleaseChannel").getReleaseChannel(),mcc:e.mcc,mnc:e.mnc,osVersion:e.osVersion,manufacturer:e.manufacturer,device:e.device,osBuildNumber:e.osBuild,localeLanguageIso6391:e.lg,localeCountryIso31661Alpha2:e.lc};if(r("WAWebEnvironment").isWindows){var n;t.appVersion={primary:Number((n=o("WAWebBuildConstants")).VERSION_PRIMARY),secondary:Number(n.VERSION_SECONDARY),tertiary:Number(n.VERSION_TERTIARY),quaternary:Number(n.WINDOWS_BUILD)},(o("WAWebBuildConstants").WINDOWS_BUILD==null?void 0:o("WAWebBuildConstants").WINDOWS_BUILD.length)===6&&(t.mcc=o("WAWebBuildConstants").WINDOWS_BUILD.substr(0,3),t.mnc=o("WAWebBuildConstants").WINDOWS_BUILD.substr(3,3))}return t}),C.apply(this,arguments)}function b(e){switch(e){case"Chrome":return o("WAWebProtobufsCompanionReg.pb").DeviceProps$PlatformType.CHROME;case"Firefox":return o("WAWebProtobufsCompanionReg.pb").DeviceProps$PlatformType.FIREFOX;case"IE":return o("WAWebProtobufsCompanionReg.pb").DeviceProps$PlatformType.IE;case"Opera":return o("WAWebProtobufsCompanionReg.pb").DeviceProps$PlatformType.OPERA;case"Safari":return o("WAWebProtobufsCompanionReg.pb").DeviceProps$PlatformType.SAFARI;case"Edge":return o("WAWebProtobufsCompanionReg.pb").DeviceProps$PlatformType.EDGE;case"electron":case"Desktop":return o("WAWebProtobufsCompanionReg.pb").DeviceProps$PlatformType.DESKTOP;case"ipad":case"iPad":return o("WAWebProtobufsCompanionReg.pb").DeviceProps$PlatformType.IPAD;case"tablet":case"Android tablet":return o("WAWebProtobufsCompanionReg.pb").DeviceProps$PlatformType.ANDROID_TABLET;case"Ohana":return o("WAWebProtobufsCompanionReg.pb").DeviceProps$PlatformType.OHANA;case"Aloha":return o("WAWebProtobufsCompanionReg.pb").DeviceProps$PlatformType.ALOHA;case"Catalina":return o("WAWebProtobufsCompanionReg.pb").DeviceProps$PlatformType.CATALINA;default:return o("WAWebProtobufsCompanionReg.pb").DeviceProps$PlatformType.UNKNOWN}}function v(){switch(o("WAWebWamPlatform").getWamPlatform()){case"WEB":case"PWA":return o("WAWebProtobufsWa6.pb").ClientPayload$WebInfo$WebSubPlatform.WEB_BROWSER;case"DARWIN":case"DARWIN_BETA":return o("WAWebProtobufsWa6.pb").ClientPayload$WebInfo$WebSubPlatform.DARWIN;case"MACSTORE":return o("WAWebProtobufsWa6.pb").ClientPayload$WebInfo$WebSubPlatform.APP_STORE;case"WIN_HYBRID":return o("WAWebProtobufsWa6.pb").ClientPayload$WebInfo$WebSubPlatform.WIN_HYBRID;default:return}}l.getClientPayloadForLogin=s,l.getClientPayloadForRegistration=c,l.setClientPayloadOverride=h}),98);
__d("WAWebClockSkewDifferenceTWamEvent",["WAWebWamCodegenUtils"],(function(t,n,r,o,a,i,l){var e=o("WAWebWamCodegenUtils").defineEvents({ClockSkewDifferenceT:[3178,{clockSkewHourly:[1,o("WAWebWamCodegenUtils").TYPES.INTEGER]},[1,1e3,1e4],"private",37887164]},{ClockSkewDifferenceT:[]});l.ClockSkewDifferenceTWamEvent=e}),98);
__d("WAWebCommonSocketPlatformDetails",["WALogger","WAVerifyChainCertificateWA6","WAWapDict","WAWebProtobufsWa6.pb","asyncToGeneratorRuntime","decodeProtobuf","encodeProtobuf","err"],(function(t,n,r,o,a,i,l){var e,s=new Uint8Array([87,65,6,o("WAWapDict").DICT_VERSION]);function u(e){return o("encodeProtobuf").encodeProtobuf(o("WAWebProtobufsWa6.pb").HandshakeMessageSpec,{clientHello:e}).readByteArrayView()}function c(e){return o("encodeProtobuf").encodeProtobuf(o("WAWebProtobufsWa6.pb").HandshakeMessageSpec,{clientFinish:e}).readByteArrayView()}function d(e){return o("decodeProtobuf").decodeProtobuf(o("WAWebProtobufsWa6.pb").HandshakeMessageSpec,e).serverHello}function m(e){return p.apply(this,arguments)}function p(){return p=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var n=t.certificate,a=t.serverStatic;o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["processCertificate start"])));var i=yield o("WAVerifyChainCertificateWA6").verifyChainCertificateWA6(n,a);if(!i.success)throw r("err")("verifyCertificateWA6 - "+i.error)}),p.apply(this,arguments)}function _(){return null}function f(e){if(e==null)return null;var t=e!=null?e:{},n=t.intermediate,r=t.leaf;return r&&n?r.key:null}l.WA_WEB_PROTO_HEADER=s,l.encodeHandshakeHello=u,l.encodeHandshakeFinish=c,l.decodeServerHello=d,l.processCertificate=m,l.serverInfoIfKnown=_,l.makeServerInfoIfKnown=f}),98);
__d("WAWebCommsProcessAck",["WALogger","WAWebActiveMessageRanges","WAWebDBMessageUtils","WAWebMsgKey","WAWebMsgType","WAWebSchemaMessage","WAWebUserPrefsMeUser","WAWebWidFactory","asyncToGeneratorRuntime","cr:634"],(function(t,n,r,o,a,i,l){var e,s,u=(e=n("cr:634"))!=null?e:{},c=u.MsgCollection;function d(e){var t=e.attrs,n=t.id,r=t.from,a=t.t;if(e.attrs.class==="message"){var i=o("WAWebWidFactory").createWid(String(r)),l=m(e);f(String(n),i,parseInt(a,10),l),_(l,String(n),i)}}function m(e){var t,n,r=e.content;if(!Array.isArray(r)||((t=r[0])==null?void 0:t.tag)!=="rcat")return null;var o=(n=r[0])==null?void 0:n.content;return Array.isArray(o)?null:o}function p(e,t){return t.isGroup()?new(r("WAWebMsgKey"))({fromMe:!0,remote:t,id:e,participant:o("WAWebUserPrefsMeUser").getMePnUserOrThrow()}):new(r("WAWebMsgKey"))({fromMe:!0,remote:t,id:e})}function _(e,t,n){if(e!=null){var r=c==null?void 0:c.get(p(t,n));r!=null&&(r.rcat=e)}}function f(e,t,n,r){return g.apply(this,arguments)}function g(){return g=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n,r){var a=p(e,t),i=String(a);try{var l=yield o("WAWebSchemaMessage").getMessageTable().get(i);if((l==null?void 0:l.type)===o("WAWebMsgType").MSG_TYPE.REACTION)return;var u=o("WAWebDBMessageUtils").MessagePropertyType.cast(l==null?void 0:l.messageRangeIndex.split("_")[1]);o("WAWebSchemaMessage").getMessageTable().merge(i,{messageRangeIndex:o("WAWebDBMessageUtils").craftMessageRangeIndex(t.toString(),!1,u===o("WAWebDBMessageUtils").MessagePropertyType.SystemMessage,n),rcat:r})}catch(e){throw o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["processAckForOutgoingMessage: failed to update in storage"]))).verbose().devConsole(e).sendLogs("message processAckForOutgoingMessage failed"),e}o("WAWebActiveMessageRanges").checkAndRemoveActiveMessageRanges(a,n)}),g.apply(this,arguments)}l.default=d}),98);
__d("WAWebPassiveModeManager",["Promise","WAAbortError","WALogger","WAPromiseRaceAbort","WAResolvable","WASendPassiveModeProtocol","WAWebCmd","WAWebHandleOfflineAbProps","WAWebPageLoadLogging","WAWebQplQuickPerformanceLoggerMarkerIds","WAWebQplQuickPerformanceLoggerModule","WAWebWamOfflineResumeReporter"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p,_,f,g,h,y,C,b,v,S,R,L=6e4,E=(function(){function t(){var t=this;this.$1=new AbortController,this.$2=new(o("WAResolvable")).Resolvable,this.$3=!1,this.$4=[],this.$6=L,o("WAWebCmd").Cmd.on("socket_stream_disconnected",function(){var n;o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["PassiveModeManager: trying to abort passive mode because of disconnect"]))),o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["PassiveModeManager: "," current tasks"])),t.$4.length),o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["PassiveModeManager: processing tasks finished: ",""])),t.$2.resolveWasCalled()),(n=t.$1)==null||n.abort(),t.resetState()})}var a=t.prototype;return a.passiveTimeoutTimer_TESTONLY=function(){return this.$5},a.resetState=function(){o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["PassiveModeManager: reset status"]))),this.$4=[],this.$5&&(self.clearTimeout(this.$5),this.$5=null),this.$3=!1,this.$2.resolveWasCalled()||this.$2.resolve(),this.$2=new(o("WAResolvable")).Resolvable,this.$1=new AbortController},a.registerPassiveTask=function(t){o("WALogger").LOG(d||(d=babelHelpers.taggedTemplateLiteralLoose(["PassiveModeManager: register passive task"]))),this.$4.push(t)},a.enableDebugPassiveMode=function(){},a.executePassiveTasks=function(){var e=this;if(!this.shouldConnectAsPassiveMode()){this.$2.resolve();return}o("WAWebPageLoadLogging").startPageLoadQplMeasure("passive_tasks"),o("WAWebQplQuickPerformanceLoggerModule").QPL.markerPoint(o("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.OFFLINE_RESUME,"PassiveTasks_start"),o("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["PassiveModeManager: executePassiveTasks: start to execute "," passive tasks"])),this.$4.length),r("WAPromiseRaceAbort")((R||(R=n("Promise"))).all(this.$4.map(function(t){return t(e.$1.signal).catch(function(e){if(e.name===o("WAAbortError").ABORT_ERROR)throw e;o("WALogger").ERROR(_||(_=babelHelpers.taggedTemplateLiteralLoose(["PassiveModeManager: executePassiveTasks: failed for single task with ",""])),e)})})),this.$1.signal).then(function(){o("WALogger").LOG(f||(f=babelHelpers.taggedTemplateLiteralLoose(["PassiveModeManager: executePassiveTasks: complete all tasks"]))),e.$7()}).catch(o("WAAbortError").catchAbort(function(){o("WALogger").LOG(g||(g=babelHelpers.taggedTemplateLiteralLoose(["PassiveModeManager: executePassiveTasks: abort by disconnect, skip send active"]))),e.$2.resolve()})).catch(function(t){o("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["PassiveModeManager: executePassiveTasks: end with error ",""])),t),e.$7()}).finally(function(){o("WAWebPageLoadLogging").endPageLoadQplMeasure("passive_tasks"),o("WAWebQplQuickPerformanceLoggerModule").QPL.markerPoint(o("WAWebQplQuickPerformanceLoggerMarkerIds").QuickLogMarkerId.OFFLINE_RESUME,"PassiveTasks_end"),o("WALogger").LOG(y||(y=babelHelpers.taggedTemplateLiteralLoose(["PassiveModeManager: executePassiveTasks: done"]))),e.resetState()}),this.$5=self.setTimeout(function(){var t=o("WALogger").ERROR(C||(C=babelHelpers.taggedTemplateLiteralLoose(["PassiveModeManager: executePassiveTasks: passive mode end with timeout"])));o("WAWebHandleOfflineAbProps").isNonBlockingOfflineResumeExpEnabled()&&(t=t.tags("offline-resume-experimental")),t.sendLogs("passive-timeout"),e.$7(),e.resetState()},this.$6)},a.$7=function(){o("WALogger").LOG(b||(b=babelHelpers.taggedTemplateLiteralLoose(["PassiveModeManager: _endPassiveMode"]))),this.$2.resolve(),o("WAWebWamOfflineResumeReporter").OfflineResumeReporter.logOfflinePassiveT(),this.$3||(o("WALogger").LOG(v||(v=babelHelpers.taggedTemplateLiteralLoose(["PassiveModeManager: send passive active iq"]))),o("WASendPassiveModeProtocol").sendPassiveModeProtocol("active"))},a.waitForPassiveTaskEnd=function(){return this.$2.promise},a.shouldConnectAsPassiveMode=function(){return this.$3||this.$4.length>0},a.setPassiveModeTimeout=function(t){o("WALogger").LOG(S||(S=babelHelpers.taggedTemplateLiteralLoose(["PassiveModeManager: setPassiveModeTimeout: config timeout to be ",""])),t),this.$6=t},t})(),k=new E;l.PassiveTaskManager=k}),98);
__d("WAWebOnlineDanglingReceipts",["Promise","WALogger","WATimeUtils","WAWebABProps","WAWebCommsSendPing","WAWebNetworkStatus","WAWebSchemaDanglingReceipt","WAWebSendReceiptJobCommon","WAWebWamOfflineResumeReporter","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p,_,f,g,h,y=new Map,C=null,b=120*1e3;function v(t,n,r){var a;y.has(t)||y.set(t,new Map);var i=y.get(t);i!=null&&i.has(n)||i==null||i.set(n,[]),i==null||(a=i.get(n))==null||a.push(r),C||(C=self.setTimeout(function(){o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[online-preacks] clear online dangling receipts due to timeout"]))),I(),C=null},b))}function S(){return y.size>0&&o("WAWebABProps").getABPropConfigValue("web_pre_acks_m3_receipts_enabled")}function R(){return L.apply(this,arguments)}function L(){return L=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=String(o("WATimeUtils").unixTime()),t=0,r=Array.from(y.keys()).map(function(n){var r=y.get(n);if(r)return r.forEach(function(e){t+=e.length}),o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[online-preacks]: sending online dangling grouped receipts: ",""])),r.size),o("WAWebSendReceiptJobCommon").sendAggregateReceipts({to:n,type:o("WAWebSendReceiptJobCommon").RECEIPT_TYPE.DELIVERY,t:e,groupedReceipt:r})});yield(h||(h=n("Promise"))).all(r),o("WAWebWamOfflineResumeReporter").OfflineResumeReporter.logOfflinePreackCount(t,!0),E()}),L.apply(this,arguments)}function E(){return k.apply(this,arguments)}function k(){return k=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(y.size!==0){if(!r("WAWebNetworkStatus").online){o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["[online-preacks] clearOnlineDanglingReceiptsAfterSending: skip due to offline"])));return}o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["[online-preacks] clearOnlineDanglingReceiptsAfterSending: sending ping"])));var e=yield o("WAWebCommsSendPing").blockSendPing();(e||!o("WAWebABProps").getABPropConfigValue("web_offline_resume_wait_for_ping_response_enabled"))&&(o("WALogger").LOG(d||(d=babelHelpers.taggedTemplateLiteralLoose(["[online-preacks] clearOnlineDanglingReceiptsAfterSending: clearing receipts"]))),y.clear())}}),k.apply(this,arguments)}function I(){return T.apply(this,arguments)}function T(){return T=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(y.size!==0){if(!r("WAWebNetworkStatus").online)return D();try{o("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["[online-preacks] clearOrFlushOnlineDanglingReceipts: sending ping"])));var e=yield o("WAWebCommsSendPing").blockSendPing();(e||!o("WAWebABProps").getABPropConfigValue("web_offline_resume_wait_for_ping_response_enabled"))&&(o("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["[online-preacks] clearOrFlushOnlineDanglingReceipts: clearing receipts"]))),y.clear())}catch(e){o("WALogger").LOG(_||(_=babelHelpers.taggedTemplateLiteralLoose(["[online-preacks] clearOrFlushOnlineDanglingReceipts: failed to clear receipts: ",""])),e),D()}}}),T.apply(this,arguments)}function D(){return x.apply(this,arguments)}function x(){return x=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(!(!S()||!o("WAWebABProps").getABPropConfigValue("web_pre_acks_m3_enabled"))){o("WALogger").LOG(f||(f=babelHelpers.taggedTemplateLiteralLoose(["[online-preacks]: clearOrFlushOnlineDanglingReceipts: flush due to offline."])));var e=[];y.forEach(function(t,n){t.forEach(function(t,r){t.forEach(function(t){e.push({from:String(n),author:String(r),externalId:t})})})}),e.length>0&&(o("WALogger").LOG(g||(g=babelHelpers.taggedTemplateLiteralLoose(["[online-preacks]: clearOrFlushOnlineDanglingReceipts: flush "," receipts"])),e.length),yield o("WAWebSchemaDanglingReceipt").getTable().create({receipts:e,acks:[]}),y.clear())}}),x.apply(this,arguments)}l.addOnlineDanglingReceipts=v,l.hasOnlineDanglingReceipts=S,l.sendAndClearOnlineDanglingReceipts=R}),98);
__d("WAWebUploadPrekeysForRegTask",["Promise","WAComms","WADeprecatedSendIq","WALogger","WAWap","WAWebConstantsDeprecated","WAWebSignalKeyApi","WAWebSignalStoreApi","WAWebSignalUtilsApi","WAWebUploadPreKeysJob","asyncToGeneratorRuntime","err"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p,_,f,g=(function(){function t(){}var a=t.prototype;return a.startKeyGenerationStage=function(){return this.$1||(this.$1=this.$3()),this.$1},a.startKeyUploadStage=function(){return this.$2||(this.$2=this.$4()),this.$2},a.$3=(function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["PrekeyUploadForRegistrationTask: start key generation"])));var t=yield(f||(f=n("Promise"))).all([o("WAWebSignalStoreApi").waSignalStore.getRegistrationInfo(),o("WAWebSignalStoreApi").waSignalStore.getSignedPreKey()]),a=t[0],i=t[1];if(!a||!i)throw r("err")("No signal info is available");var l=yield o("WAWebSignalStoreApi").waSignalStore.getOrGenPreKeys(o("WAWebUploadPreKeysJob").UPLOAD_KEYS_COUNT,o("WAWebSignalKeyApi").generatePreKeyPair);return o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["PrekeyUploadForRegistrationTask: successfully generated "," keys"])),l.length),{regInfo:a,signedPreKey:i,prekeys:l}});function a(){return t.apply(this,arguments)}return a})(),a.$4=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=this.$1||this.startKeyGenerationStage(),t=yield e,n=t.regInfo,a=t.signedPreKey,i=t.prekeys;o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["PrekeyUploadForRegistrationTask: start key upload"])));var l=i.length;if(l===0)throw r("err")("No preKey is available");var s=i[i.length-1].keyId,f=n.registrationId,g=n.identityKeyPair,h=o("WAWap").wap("iq",{id:o("WAWap").generateId(),xmlns:"encrypt",type:"set",to:o("WAWap").S_WHATSAPP_NET},o("WAWap").wap("registration",null,o("WAWap").BIG_ENDIAN_CONTENT(f)),o("WAWap").wap("type",null,r("WAWebConstantsDeprecated").KEY_BUNDLE_TYPE),o("WAWap").wap("identity",null,g.pubKey),o("WAWap").wap("list",null,i.map(o("WAWebSignalUtilsApi").xmppPreKey)),o("WAWebSignalUtilsApi").xmppSignedPreKey(a));try{yield o("WAComms").waitForConnection(),yield o("WAWebSignalStoreApi").waSignalStore.markKeyAsUploaded(s);var y=yield o("WADeprecatedSendIq").deprecatedSendIqWithoutRetry(h,o("WAWebUploadPreKeysJob").uploadPreKeyResParser);if(y.success)return o("WAWebSignalStoreApi").waSignalStore.setServerHasPreKeys(!0),o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["_uploadPreKeys: "," keys uploaded, raw stanza size: ","b"])),i.length,h.toString().length),{success:!0};var C=y.errorCode;return C>=500?o("WALogger").WARN(d||(d=babelHelpers.taggedTemplateLiteralLoose(["_uploadPreKeys: server requested backoff "," (count: ",", size: ","b)"])),C,l,h.toString().length):C===406?o("WALogger").WARN(m||(m=babelHelpers.taggedTemplateLiteralLoose(["_uploadPreKeys: uploaded invalid keys (count: ",", size: ","b)"])),l,h.toString().length):o("WALogger").WARN(p||(p=babelHelpers.taggedTemplateLiteralLoose(["_uploadPreKeys: unrecognized error "," (count: ",", size: ","b)"])),C,l,h.toString().length),{errorCode:y.errorCode,errorText:y.errorText}}catch(e){o("WALogger").WARN(_||(_=babelHelpers.taggedTemplateLiteralLoose(["_uploadPreKeys: disconnected, unclear if on server: "," (count: ",", size: ","b)"])),e,l,h.toString().length);return}});function t(){return e.apply(this,arguments)}return t})(),t})();function h(){return new g}l.default=h}),98);
__d("WAWebWamEnumWebcNativeUpsellCtaQrScreenExperimentGroup",[],(function(t,n,r,o,a,i){var e=Object.freeze({NONE:1,TEST_BANNER_SLIM:2,TEST_BANNER_LARGE:3,CONTROL:4});i.WEBC_NATIVE_UPSELL_CTA_QR_SCREEN_EXPERIMENT_GROUP=e}),66);
__d("WAWebDesktopUpsellQRCodeBannerExperiment",["WAWebWamEnumWebcNativeUpsellCtaQrScreenExperimentGroup"],(function(t,n,r,o,a,i,l){function e(){return o("WAWebWamEnumWebcNativeUpsellCtaQrScreenExperimentGroup").WEBC_NATIVE_UPSELL_CTA_QR_SCREEN_EXPERIMENT_GROUP.TEST_BANNER_SLIM}l.getWAWebDesktopUpsellQRCodeBannerExperiment=e}),98);
__d("WAWebDeviceFeatures",["WAWebSessionStorage"],(function(t,n,r,o,a,i,l){"use strict";function e(){return navigator.platform}function s(){return navigator.deviceMemory===void 0?"undefined":""+navigator.deviceMemory}function u(){var e=window.devicePixelRatio;return e==null||e===void 0?"undefined":e*window.outerWidth+"x"+e*window.outerHeight}function c(){var e,t;return(e=(t=navigator)==null||(t=t.connection)==null?void 0:t.rtt)!=null?e:-1}function d(){var e;return(e=r("WAWebSessionStorage")==null?void 0:r("WAWebSessionStorage").length)!=null?e:-1}function m(){return"ontouchstart"in window&&"TouchEvent"in window}function p(){return{cpuPlatform:e(),deviceMemory:s(),screenResolution:u(),connectionRoundTripTime:c(),sessionStorageLength:d(),touchPresence:m()}}l.default=p}),98);
__d("WAWebNativeCameraQRLinkedDeviceUtils",["$InternalEnum","WAWebAutoLogoutGating","gkx","justknobx"],(function(t,n,r,o,a,i,l){"use strict";var e=n("$InternalEnum")({NONE:-1,CONTROL:0,TEST:1});function s(){if(!r("justknobx")._("5007"))return u();if(o("WAWebAutoLogoutGating").isRunningInAutoLogoutIframe()){var t=window.parent.nativeCameraVariant,n=e.cast(t);return n!=null?n:u()}var a=u();return window.nativeCameraVariant=a,a}function u(){return!r("gkx")("14464")||r("gkx")("26256")?e.NONE:r("gkx")("15235")?e.TEST:e.CONTROL}function c(){return s()===e.TEST}l.NativeCameraQRLinkedDeviceVariantType=e,l.getNativeCameraQRLinkedDeviceVariant=s,l.isNativeCameraQRLinkedDeviceTest=c}),98);
__d("WAWebLinkDeviceExperience",["WABitArray","WAWebArkoseExpUtils","WAWebAutoLogoutGating","WAWebDesktopUpsellQRCodeBannerExperiment","WAWebDeviceFeatures","WAWebLinkDeviceScreenGatedUtils","WAWebNativeCameraQRLinkedDeviceUtils","WAWebWamEnumWebcNativeUpsellCtaQrScreenExperimentGroup"],(function(t,n,r,o,a,i,l){var e=(function(){function e(e){this.flag=e}var t=e.prototype;return t.getIndex=function(){return u()-1-this.flag},e})(),s={ScreenRefreshFlag:new e(0),AutoLogoutFlag:new e(1),DesktopUpsellBannerControlFlag:new e(2),DesktopUpsellBannerTestSlimBannerFlag:new e(3),DesktopUpsellBannerTestLargeBannerFlag:new e(4),PairingScreenRefreshVariant1Flag:new e(6),LinkDeviceScreenControl:new e(8),LinkDeviceScreenTest:new e(9),OptimizedRegistrationControl:new e(10),OptimizedRegistrationTest:new e(11),ArkoseControl:new e(12),ArkoseTest:new e(13),LocalizationFixControl:new e(14),LocalizationFixTest:new e(15),TouchPresence:new e(16)};function u(){return Math.max.apply(Math,Object.values(s).map(function(e){return e.flag}))+1}function c(e){var t=new(r("WABitArray"))(u());t.set(s.ScreenRefreshFlag.getIndex()),o("WAWebAutoLogoutGating").isAutoLogoutEnabled()&&t.set(s.AutoLogoutFlag.getIndex());var n=o("WAWebDesktopUpsellQRCodeBannerExperiment").getWAWebDesktopUpsellQRCodeBannerExperiment();switch(n){case o("WAWebWamEnumWebcNativeUpsellCtaQrScreenExperimentGroup").WEBC_NATIVE_UPSELL_CTA_QR_SCREEN_EXPERIMENT_GROUP.NONE:break;case o("WAWebWamEnumWebcNativeUpsellCtaQrScreenExperimentGroup").WEBC_NATIVE_UPSELL_CTA_QR_SCREEN_EXPERIMENT_GROUP.CONTROL:{t.set(s.DesktopUpsellBannerControlFlag.getIndex());break}case o("WAWebWamEnumWebcNativeUpsellCtaQrScreenExperimentGroup").WEBC_NATIVE_UPSELL_CTA_QR_SCREEN_EXPERIMENT_GROUP.TEST_BANNER_SLIM:{t.set(s.DesktopUpsellBannerTestSlimBannerFlag.getIndex());break}case o("WAWebWamEnumWebcNativeUpsellCtaQrScreenExperimentGroup").WEBC_NATIVE_UPSELL_CTA_QR_SCREEN_EXPERIMENT_GROUP.TEST_BANNER_LARGE:{t.set(s.DesktopUpsellBannerTestLargeBannerFlag.getIndex());break}}var a=o("WAWebLinkDeviceScreenGatedUtils").getLinkDeviceScreenVariant();switch(a){case o("WAWebLinkDeviceScreenGatedUtils").LinkDeviceScreenVariantType.M1_WINNER:t.set(s.PairingScreenRefreshVariant1Flag.getIndex());break}var i=o("WAWebNativeCameraQRLinkedDeviceUtils").getNativeCameraQRLinkedDeviceVariant();switch(i){case o("WAWebNativeCameraQRLinkedDeviceUtils").NativeCameraQRLinkedDeviceVariantType.NONE:break;case o("WAWebNativeCameraQRLinkedDeviceUtils").NativeCameraQRLinkedDeviceVariantType.CONTROL:t.set(s.LinkDeviceScreenControl.getIndex());break;case o("WAWebNativeCameraQRLinkedDeviceUtils").NativeCameraQRLinkedDeviceVariantType.TEST:t.set(s.LinkDeviceScreenTest.getIndex());break}var l=o("WAWebLinkDeviceScreenGatedUtils").getOptimizedRegFromWebVariant(),c=(e==null?void 0:e.resultType)==="WEB_REGISTRATION_CAMPAIGN"||l==="test";c?t.set(s.OptimizedRegistrationTest.getIndex()):l==="control"&&t.set(s.OptimizedRegistrationControl.getIndex());var d=o("WAWebArkoseExpUtils").getArkoseVariant();switch(d){case o("WAWebArkoseExpUtils").ArkoseVariantType.CONTROL:t.set(s.ArkoseControl.getIndex());break;case o("WAWebArkoseExpUtils").ArkoseVariantType.TEST:t.set(s.ArkoseTest.getIndex());break;default:break}var m=o("WAWebLinkDeviceScreenGatedUtils").getLocalizationFixVariant();switch(m){case"control":t.set(s.LocalizationFixControl.getIndex());break;case"test":t.set(s.LocalizationFixTest.getIndex());break}return r("WAWebDeviceFeatures")().touchPresence&&t.set(s.TouchPresence.getIndex()),t.toNumber()}l.getWebCompanionLinkDeviceExperienceId=c}),98);
__d("WAWebWamEnumApplicationState",[],(function(t,n,r,o,a,i){var e=Object.freeze({FOREGROUND:1,BACKGROUND:2});i.APPLICATION_STATE=e}),66);
__d("WAWebWamEnumMdLinkDeviceCompanionStage",[],(function(t,n,r,o,a,i){var e=Object.freeze({PAIR_SUCCESS_RECEIVED:1,PAIR_DEVICE_SIGN_SENT:2,FIRST_CONNECT:3,UPLOAD_PREKEYS:4,COMPLETE:5,GENERATE_PREKEYS:6,SENT_PREKEYS:7});i.MD_LINK_DEVICE_COMPANION_STAGE=e}),66);
__d("WAWebMdLinkDeviceCompanionWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumApplicationState","WAWebWamEnumMdLinkDeviceCompanionStage"],(function(t,n,r,o,a,i,l){var e,s=(e=o("WAWebWamCodegenUtils")).defineEvents({MdLinkDeviceCompanion:[2576,{appContext:[13,e.TYPES.STRING],appContextBitfield:[14,e.TYPES.INTEGER],applicationState:[12,o("WAWebWamEnumApplicationState").APPLICATION_STATE],mdCompanionRefHash:[10,e.TYPES.STRING],mdDurationS:[8,e.TYPES.INTEGER],mdLinkDeviceCompanionErrorCode:[6,e.TYPES.INTEGER],mdLinkDeviceCompanionStage:[4,o("WAWebWamEnumMdLinkDeviceCompanionStage").MD_LINK_DEVICE_COMPANION_STAGE],mdLinkDeviceExperienceId:[11,e.TYPES.INTEGER],mdRegAttemptId:[9,e.TYPES.STRING],mdSessionId:[1,e.TYPES.STRING],mdTimestampS:[7,e.TYPES.INTEGER],mdWasUpgraded:[5,e.TYPES.BOOLEAN],userLocale:[15,e.TYPES.STRING]},[1,1,1],"regular"]},{MdLinkDeviceCompanion:[]});l.MdLinkDeviceCompanionWamEvent=s}),98);
__d("WAWebWamDeviceLinkReporter",["WABase64","WABinary","WACryptoSha256","WAResolvable","WATimeUtils","WAWebAppTracker","WAWebLinkDeviceExperience","WAWebMdLinkDeviceCompanionWamEvent","WAWebWamEnumMdLinkDeviceCompanionStage","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e=null,s=null,u=null,c=null;function d(e,t,n){return m.apply(this,arguments)}function m(){return m=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,n,r){e=new(o("WAWebMdLinkDeviceCompanionWamEvent")).MdLinkDeviceCompanionWamEvent;var a=yield f(t,n);return s={regStartTime:r,sessionId:a},a}),m.apply(this,arguments)}function p(e){return _.apply(this,arguments)}function _(){return _=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var n;e&&(yield(n=c)==null?void 0:n.promise,c=new(o("WAResolvable")).Resolvable,u=t,yield h())}),_.apply(this,arguments)}function f(e,t){return g.apply(this,arguments)}function g(){return g=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=new(o("WABinary")).Binary;n.writeBuffer(e),n.write(95),n.writeBuffer(t);var r=n.readByteArrayView(),a=yield o("WACryptoSha256").sha256(r);return o("WABase64").encodeB64(a)}),g.apply(this,arguments)}function h(t){var n;if(!(!e||!s)){var r=s,a=o("WATimeUtils").unixTimeWithoutClockSkewCorrection()-r.regStartTime;if(u!=null){e=new(o("WAWebMdLinkDeviceCompanionWamEvent")).MdLinkDeviceCompanionWamEvent({mdDurationS:a,mdSessionId:r.sessionId,mdTimestampS:r.regStartTime,mdLinkDeviceCompanionErrorCode:t==null?0:t,mdLinkDeviceCompanionStage:u,mdLinkDeviceExperienceId:o("WAWebLinkDeviceExperience").getWebCompanionLinkDeviceExperienceId()});var i=e;o("WAWebAppTracker").attachWAMAppContext(i,a*1e3),i.commitAndWaitForFlush(!0),(n=c)==null||n.resolve(),(t!=null||i.mdLinkDeviceCompanionStage===o("WAWebWamEnumMdLinkDeviceCompanionStage").MD_LINK_DEVICE_COMPANION_STAGE.COMPLETE)&&(e=null,s=null,u=null)}}}l.initDeviceLinkEvent=d,l.setDeviceLinkPairStage=p,l.commitDeviceLinkEvent=h}),98);
__d("WAWebRegisterPassiveTasks",["WAAbortError","WACustomError","WALogger","WAPromiseLoop","WAPromiseTimeout","WAWebABPropsLocalStorage","WAWebABPropsWamGlobals","WAWebAbPropsSyncJob","WAWebClearDanglingReceipts","WAWebGetMessageCache","WAWebHandleOfflineAbProps","WAWebOnlineDanglingReceipts","WAWebPassiveModeManager","WAWebSchemaDanglingReceipt","WAWebSignalStoreApi","WAWebUploadPrekeysForRegTask","WAWebUserPrefsGeneral","WAWebWamDeviceLinkReporter","WAWebWamEnumMdLinkDeviceCompanionStage","asyncToGeneratorRuntime","cr:10195","gkx"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p,_,f,g,h,y,C,b,v,S,R,L=4,E=60*1e3;function k(){return I.apply(this,arguments)}function I(){return I=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var t=yield o("WAWebSignalStoreApi").waSignalStore.getServerHasPreKeys();if(!t){yield o("WAWebWamDeviceLinkReporter").setDeviceLinkPairStage(o("WAWebWamEnumMdLinkDeviceCompanionStage").MD_LINK_DEVICE_COMPANION_STAGE.UPLOAD_PREKEYS);var a=r("WAWebUploadPrekeysForRegTask")();a.startKeyGenerationStage(),o("WAWebPassiveModeManager").PassiveTaskManager.registerPassiveTask(function(t){return o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[passive] start key upload"]))),a.startKeyUploadStage().then(n("asyncToGeneratorRuntime").asyncToGenerator(function*(){o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[passive] key upload complete"]))),yield o("WAWebWamDeviceLinkReporter").setDeviceLinkPairStage(o("WAWebWamEnumMdLinkDeviceCompanionStage").MD_LINK_DEVICE_COMPANION_STAGE.COMPLETE),yield o("WAWebWamDeviceLinkReporter").commitDeviceLinkEvent()})).catch((function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){o("WALogger").ERROR(u||(u=babelHelpers.taggedTemplateLiteralLoose(["error while uploading prekeys, ",""])),e).verbose().devConsole(e).sendLogs("error while uploading prekeys"),yield o("WAWebWamDeviceLinkReporter").commitDeviceLinkEvent(-1)});return function(t){return e.apply(this,arguments)}})())})}(r("gkx")("17264")||r("gkx")("26259")||!o("WAWebABPropsLocalStorage").isABPropsAfterFirstSync()||(yield o("WAWebUserPrefsGeneral").getWhatsAppWebExternalBetaDirtyBitIdb()))&&(yield o("WAWebPassiveModeManager").PassiveTaskManager.registerPassiveTask(function(e){return o("WAWebAbPropsSyncJob").syncABPropsTask().catch(function(e){o("WALogger").WARN(c||(c=babelHelpers.taggedTemplateLiteralLoose(["error while sync ab props prekeys, ",""])),e).verbose()})}),o("WAWebUserPrefsGeneral").setWhatsAppWebExternalBetaDirtyBitIdb(!1),o("WAWebABPropsWamGlobals").setAbPropDependingGlobalWamAttributes())}),I.apply(this,arguments)}function T(){return D.apply(this,arguments)}function D(){return D=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){o("WAWebOnlineDanglingReceipts").hasOnlineDanglingReceipts()&&o("WAWebPassiveModeManager").PassiveTaskManager.registerPassiveTask(n("asyncToGeneratorRuntime").asyncToGenerator(function*(){try{o("WALogger").LOG(d||(d=babelHelpers.taggedTemplateLiteralLoose(["[passive] start sending online dangling receipts"]))),yield o("WAWebOnlineDanglingReceipts").sendAndClearOnlineDanglingReceipts(),o("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["[passive] sending online dangling receipts complete"])))}catch(e){o("WALogger").ERROR(p||(p=babelHelpers.taggedTemplateLiteralLoose(["error while sending online dangling receipts, ",""])),e).verbose().devConsole(e).sendLogs("send-online-dangling-receipts-failed")}}));var e=yield o("WAWebSchemaDanglingReceipt").getTable().all(),t=e.length>0,r=o("WAWebGetMessageCache").getMessageCache().size()>0||o("WAWebGetMessageCache").getMessageCache().checkpointQueue.size()>0;(t||r)&&o("WAWebPassiveModeManager").PassiveTaskManager.registerPassiveTask((function(){var a=n("asyncToGeneratorRuntime").asyncToGenerator(function*(n){if(t)try{o("WALogger").LOG(_||(_=babelHelpers.taggedTemplateLiteralLoose(["[passive] sending dangling receipts"]))),yield o("WAWebClearDanglingReceipts").sendAndClearDanglingReceipts(e,n),o("WALogger").LOG(f||(f=babelHelpers.taggedTemplateLiteralLoose(["[passive] sending dangling receipts: done"])))}catch(e){if(e.name===o("WAAbortError").ABORT_ERROR)throw e;o("WALogger").ERROR(g||(g=babelHelpers.taggedTemplateLiteralLoose(["[passive] sending dangling receipts failed: ",""])),e).verbose().devConsole(e).sendLogs("send-and-clear-dangling-receipts-failed")}r&&(yield $())});return function(e){return a.apply(this,arguments)}})())}),D.apply(this,arguments)}var x=null;function $(){return P.apply(this,arguments)}function P(){return P=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(x)return o("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[passive] flush message cache: skip"]))),x;try{o("WALogger").LOG(y||(y=babelHelpers.taggedTemplateLiteralLoose(["[passive] flush message cache"])));var e=o("WAPromiseLoop").promiseLoop((function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n){o("WALogger").LOG(C||(C=babelHelpers.taggedTemplateLiteralLoose(["[passive] flush message cache: size: ",", queue size: ",", generation: ",""])),o("WAWebGetMessageCache").getMessageCache().size(),o("WAWebGetMessageCache").getMessageCache().checkpointQueue.size(),n),o("WAWebGetMessageCache").getMessageCache().size()>0&&o("WAWebGetMessageCache").getMessageCache().createSnapshot(),yield o("WAWebGetMessageCache").getMessageCache().checkpointQueue.wait(),o("WAWebGetMessageCache").getMessageCache().size()===0&&o("WAWebGetMessageCache").getMessageCache().checkpointQueue.size()===0?e():n+1>=L&&(o("WALogger").WARN(b||(b=babelHelpers.taggedTemplateLiteralLoose(["[passive] flush message cache: stop after "," attempts"])),L),e())});return function(t,n,r){return e.apply(this,arguments)}})());x=o("WAPromiseTimeout").promiseTimeout(e,E),yield x,o("WALogger").LOG(v||(v=babelHelpers.taggedTemplateLiteralLoose(["[passive] flush message cache: done"])))}catch(e){if(e instanceof o("WACustomError").TimeoutError){var t=o("WALogger").ERROR(S||(S=babelHelpers.taggedTemplateLiteralLoose(["[passive] flush message cache: timeout"])));o("WAWebHandleOfflineAbProps").isNonBlockingOfflineResumeExpEnabled()&&(t=t.tags("offline-resume-experimental")),t.sendLogs("passive-flush-message-cache-timeout",{sampling:.01})}else o("WALogger").ERROR(R||(R=babelHelpers.taggedTemplateLiteralLoose(["[passive] flush message cache failed: ",""])),e).verbose().devConsole(e).sendLogs("passive-flush-message-cache-failed",{sampling:.01})}finally{x=null}}),P.apply(this,arguments)}l.registerPassiveTaskForStartUp=k,l.registerPassiveTasksForConnect=T}),98);
__d("WAWebGetClientPayloadForLogin",["WALogger","WAWebClientPayload","WAWebPassiveModeManager","WAWebRegisterPassiveTasks","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s;function u(e){return c.apply(this,arguments)}function c(){return c=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var n=t||{passive:!1,pull:!0},r=self.performance.now();yield o("WAWebRegisterPassiveTasks").registerPassiveTasksForConnect(),o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[comms] getClientPayloadForLogin registered passive tasks in ","ms"])),Math.ceil(self.performance.now()-r)).tags("launch-socket-chat"),n.passive=o("WAWebPassiveModeManager").PassiveTaskManager.shouldConnectAsPassiveMode();var a=self.performance.now(),i=yield o("WAWebClientPayload").getClientPayloadForLogin(n);return o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[comms] getClientPayloadForLogin generated payload in ","ms"])),Math.ceil(self.performance.now()-a)).tags("launch-socket-chat"),i}),c.apply(this,arguments)}l.getClientPayloadForLogin=u}),98);
__d("WAWebGetClientPayloadForRegistration",["Promise","WALogger","WAWebClientPayload","WAWebSignalStoreApi","asyncToGeneratorRuntime","err"],(function(t,n,r,o,a,i,l){var e,s,u;function c(e){return d.apply(this,arguments)}function d(){return d=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var a=self.performance.now(),i=yield(u||(u=n("Promise"))).all([o("WAWebSignalStoreApi").waSignalStore.getRegistrationInfo(),o("WAWebSignalStoreApi").waSignalStore.getSignedPreKey()]),l=i[0],c=i[1];if(o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[comms] getClientPayloadForRegistration fetched signalInfo in ","ms"])),Math.ceil(self.performance.now()-a)).tags("launch-socket-chat"),!c||!l)throw r("err")("Invalid signal credentials");var d=self.performance.now(),m=yield o("WAWebClientPayload").getClientPayloadForRegistration(l,c,t);return o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[comms] getClientPayloadForRegistration generated payload in ","ms"])),Math.ceil(self.performance.now()-d)).tags("launch-socket-chat"),m}),d.apply(this,arguments)}l.getClientPayloadForRegistration=c}),98);
__d("WAWebCookieDomain",["gkx"],(function(t,n,r,o,a,i,l){var e=".web.whatsapp.com";r("gkx")("26258")||(e=".dev-web.whatsapp.com");var s=e;l.COOKIE_DOMAIN=s}),98);
__d("WAWebEventsWaitForEvent",["Promise","WAAbortError"],(function(t,n,r,o,a,i,l){var e;function s(t,r,a,i){return a===void 0&&(a=function(){return!0}),i!=null&&i.aborted?(e||(e=n("Promise"))).reject(new(o("WAAbortError")).AbortError):new(e||(e=n("Promise")))(function(e,n){var l=function(){a.apply(this,arguments)&&(u==null||u(),e.apply(this,arguments))},s=function(){u==null||u(),n(new(o("WAAbortError")).AbortError)},u=function(){t.removeEventListener(r,l),i==null||i.removeEventListener("abort",s),u=null};i==null||i.addEventListener("abort",s),t.addEventListener(r,l)})}l.default=s}),98);
__d("WAWebEventsWaitForOffline",["WAWebEventsWaitForEvent"],(function(t,n,r,o,a,i,l){function e(e){return r("WAWebEventsWaitForEvent")(window,"offline",void 0,e)}l.default=e}),98);
__d("WAWebWatchedSocket",["WAAbortError","WABinary","WASocketTransport","WAWebEventsWaitForOffline","WAWebNoop"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(t){var n;return n=e.call(this,t)||this,n.dataToSend=new(o("WABinary")).Binary,n.wsUrl=t.url,n.$WatchedSocket$p_2=new AbortController,n.$WatchedSocket$p_1=r("WAWebEventsWaitForOffline")(n.$WatchedSocket$p_2.signal).then(function(){return n.close()}).catch(o("WAAbortError").catchAbort(r("WAWebNoop"))),n}return babelHelpers.inheritsLoose(t,e),t})(o("WASocketTransport").WebSocketTransport);l.WatchedSocket=e}),98);
__d("WAWebOpenSocket",["Promise","WAAbortError","WALogger","WANullthrows","WAPromiseRetryLoop","WAWebCookieDomain","WAWebLocalStorage","WAWebMiscErrors","WAWebWatchedSocket","gkx"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p,_,f,g,h,y=["wss://web.whatsapp.com/ws/chat","wss://web.whatsapp.com:5222/ws/chat"];function C(){if(!r("gkx")("26258")){var e,t=(e=r("WANullthrows")(r("WAWebLocalStorage")).getItem("wdev-pinning-cookie-value"))!=null?e:"";document.cookie=["sticky_routing="+t.replace(/\"/g,""),"path=/","domain="+o("WAWebCookieDomain").COOKIE_DOMAIN,"secure"].join(";")}}function b(t){t.code!==1e3&&o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[socket] Immediate socket closure: closed: "," ",""])),t.code,t.reason).tags("socket")}function v(e,t){var n=e!=null?"[socket] "+e+" closed. code: "+t.code:"[socket] closed connection during initialization. Code: "+t.code;switch(t.code){case 1e3:case 1001:o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[socket] ",""])),n).tags("socket");break;case 1006:e!=null&&o("WALogger").WARN(u||(u=babelHelpers.taggedTemplateLiteralLoose(["[socket] ",""])),n).tags("socket"),o("WALogger").COUNT(c||(c=babelHelpers.taggedTemplateLiteralLoose(["[socket] ",""])),n).tags("socket");break;case 1002:case 1003:case 1007:case 1008:case 1009:case 1010:case 1011:case 1015:o("WALogger").ERROR(d||(d=babelHelpers.taggedTemplateLiteralLoose(["[socket] ",""])),n).tags("socket");break;default:o("WALogger").ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["[socket] ",". Reason: ",", clean: ",""])),n,t.reason,t.wasClean).tags("socket");break}}function S(e){var t=new AbortController;return new(h||(h=n("Promise")))(function(n,r){var a=!1,i=[];e.forEach(function(l){o("WALogger").DEV(p||(p=babelHelpers.taggedTemplateLiteralLoose(["[socket] openWebSocketsConcurrently opening ws with ","."])),l).tags("socket"),R(l,t.signal,b,v).then(function(e){a?(o("WALogger").DEV(f||(f=babelHelpers.taggedTemplateLiteralLoose(["[socket] openWebSocketsConcurrently closing socket with "," as loser"])),l).tags("socket"),t.abort(),e.close(1e3,"loser socket")):(a=!0,o("WALogger").LOG(_||(_=babelHelpers.taggedTemplateLiteralLoose(["[socket] openWebSocketsConcurrently opened socket with "," ws."])),l).tags("socket").devConsole(e),n(e))}).catch(function(t){t.name!=="AbortError"&&(o("WALogger").WARN(g||(g=babelHelpers.taggedTemplateLiteralLoose(["[socket] openWebSocketsConcurrently socket with "," failed: ",""])),l,t).tags("socket"),i.push(t),i.length===e.length&&r(t))})})})}function R(e,t,r,a){var i=new WebSocket(e);return i.binaryType="arraybuffer",new(h||(h=n("Promise")))(function(e,n){i.onopen=e,i.onclose=function(e){if(t!=null&&t.aborted){n(new(o("WAAbortError")).AbortError);return}r==null||r(e),a==null||a(null,e),n(new(o("WAWebMiscErrors")).SocketError(e))}}).then(function(){return i})}function L(){return{jitter:.1,max:1e4,algo:{type:"fibonacci",first:1e3,second:1e3},relativeDelay:!0}}function E(){return self.navigator!=null?self.navigator.onLine:!0}function k(e){var t=y.map(function(t){return e!=null?t+"?ED="+e:t}),n=!0;C();var r=function(){E()&&n===!1&&(n=!0,a.reset())},a=new(o("WAPromiseRetryLoop")).PromiseRetryLoop({name:"socketOpener",timer:L(),code:function(r){return S(t).then(function(e){r(new(o("WAWebWatchedSocket")).WatchedSocket(e))}).catch(function(){n=E()})}});return self.addEventListener("online",r),a.start(),a.promise().finally(function(){self.removeEventListener("online",r)})}l.openWebSocket=k}),98);
__d("WAWebProcessCertificate",["WALogger","WAVerifyChainCertificateWA6","WAWebDbEncryptionKey","WAWebUserPrefsInfoStore","WAWebUserPrefsScreenLock","asyncToGeneratorRuntime","err"],(function(t,n,r,o,a,i,l){var e,s,u,c,d;function m(e){return p.apply(this,arguments)}function p(){return p=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var n=t.certificate,a=t.serverStatic,i=t.isRegistered;o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[socket] processCertificate start"]))).tags("handshake");var l=o("WAVerifyChainCertificateWA6").verifyChainCertificateWA6(n,a);if(o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[socket] processCertificate finished with success: ",""])),l.success).tags("handshake"),!l.success)throw r("err")("[socket] processCertificate error: "+l.error);if(i&&!o("WAWebUserPrefsScreenLock").getScreenLockEnabled()){var m=l.value,p=m.intermediate,_=m.leaf;_&&p&&(o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["[socket] persisting cert chain start"]))).tags("handshake"),o("WAWebDbEncryptionKey").DbEncKeyStore.waitForInit().then(function(){o("WAWebUserPrefsInfoStore").waNoiseInfo.setCertificateChain({intermediate:{key:p.key,notAfter:Number(p.notAfter),notBefore:Number(p.notBefore)},leaf:{key:_.key,notAfter:Number(_.notAfter),notBefore:Number(_.notBefore)}}).then(function(){o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["[socket] persisting cert chain finished"]))).tags("handshake")}).catch(function(e){o("WALogger").ERROR(d||(d=babelHelpers.taggedTemplateLiteralLoose(["[socket] processCertificate: failed to set cert chain: ",""])),e).sendLogs("handhshake-set-cert-chain",{sampling:.01})})}))}}),p.apply(this,arguments)}l.verifyAndProcessCertificate=m}),98);
__d("WAWebWamEnumWebcSocketConnectReasonType",[],(function(t,n,r,o,a,i){var e=Object.freeze({PAGE_LOAD:0,RECONNECT:1});i.WEBC_SOCKET_CONNECT_REASON_TYPE=e}),66);
__d("WAWebWebcSocketConnectWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumWebcSocketConnectReasonType"],(function(t,n,r,o,a,i,l){var e,s=(e=o("WAWebWamCodegenUtils")).defineEvents({WebcSocketConnect:[5450,{webcAuthHandshakeDuration:[1,e.TYPES.TIMER],webcSocketConnectDuration:[2,e.TYPES.TIMER],webcSocketConnectReason:[3,o("WAWebWamEnumWebcSocketConnectReasonType").WEBC_SOCKET_CONNECT_REASON_TYPE],webcSocketHostname:[4,e.TYPES.STRING]},[1,1,1],"regular"]},{WebcSocketConnect:[]});l.WebcSocketConnectWamEvent=s}),98);
__d("WAWebOpenChatSocket",["Promise","WABase64","WABinary","WAFrameSocket","WAHex","WALogger","WANoiseHandshake","WANullthrows","WAResultOrError","WAWapDict","WAWebCommonSocketPlatformDetails","WAWebCryptoCurve25519","WAWebGetClientPayloadForLogin","WAWebGetClientPayloadForRegistration","WAWebOpenSocket","WAWebPageLoadLogging","WAWebProcessCertificate","WAWebProtobufsWa6.pb","WAWebSocketLogoutJob","WAWebUserPrefsInfoStore","WAWebUserPrefsMultiDevice","WAWebUserPrefsScreenLock","WAWebWamEnumWebcSocketConnectReasonType","WAWebWebcSocketConnectWamEvent","asyncToGeneratorRuntime","cr:4533","decodeProtobuf","encodeProtobuf","err"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p,_,f,g,h,y,C,b,v,S,R,L,E,k,I,T,D,x,$,P,N,M,w,A,F=1,O=6,B=new Uint8Array([87,65,O,o("WAWapDict").DICT_VERSION]),W="Noise_XX_25519_AESGCM_SHA256\0\0\0\0",q="Noise_IK_25519_AESGCM_SHA256\0\0\0\0",U="Noise_XXfallback_25519_AESGCM_SHA256";function V(e){return o("WAWebOpenSocket").openWebSocket(e)}function H(e,t,n){return G.apply(this,arguments)}function G(){return G=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,r){o("WALogger").DEV(k||(k=babelHelpers.taggedTemplateLiteralLoose(["[socket] openChatSocketCommon"])));var a=yield o("WAWebUserPrefsMultiDevice").getRoutingInfo(),i=a?a.edgeRouting:null,l=i?o("WABase64").encodeB64UrlSafe(i):null,s=yield o("WAWebCryptoCurve25519").keyPair();return o("WAWebPageLoadLogging").startPageLoadQplMeasure("socket_open"),V(l).then((function(){var a=n("asyncToGeneratorRuntime").asyncToGenerator(function*(n){var a=void 0;if(o("WAWebPageLoadLogging").endPageLoadQplMeasure("socket_open"),t.markWebcSocketConnectDuration(),t.webcSocketConnectReason=o("WAWebPageLoadLogging").wasPageLoadQplLogged()?o("WAWebWamEnumWebcSocketConnectReasonType").WEBC_SOCKET_CONNECT_REASON_TYPE.RECONNECT:o("WAWebWamEnumWebcSocketConnectReasonType").WEBC_SOCKET_CONNECT_REASON_TYPE.PAGE_LOAD,i){var l=new(o("WABinary")).Binary;l.write("ED",0,1),l.writeUint8(i.byteLength>>16),l.writeUint16(i.byteLength&65535),l.writeBuffer(i),a=l.readByteArrayView(),o("WALogger").DEV(I||(I=babelHelpers.taggedTemplateLiteralLoose(["openChatSocket preIntro ",""])),a)}var u=a?o("WABinary").Binary.build(a,B).readByteArrayView():B,c=new(o("WAFrameSocket")).FrameSocket(n,u),d=e?yield te(ee):null;if(o("WAWebPageLoadLogging").startPageLoadQplMeasure("auth_handshake"),t.startWebcAuthHandshakeDuration(),d!=null){var m=yield o("WAWebUserPrefsInfoStore").waNoiseInfo.get();return j(c,r,e,s,m==null?void 0:m.staticKeyPair,d)}return z(c,s,e,r)});return function(e){return a.apply(this,arguments)}})())}),G.apply(this,arguments)}function z(t,n,r,a){var i=new(o("WANoiseHandshake")).NoiseHandshake(t);i.start(W,B),o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[socket] doFullHandshake: openChatSocket send hello"]))).tags("handshake"),i.authenticate(n.pubKey);var l={clientHello:{ephemeral:n.pubKey}};return i.sendAndReceive(o("encodeProtobuf").encodeProtobuf(o("WAWebProtobufsWa6.pb").HandshakeMessageSpec,l).readByteArrayView()).then(function(e){return X(i,e,n,r,a)})}function j(e,t,a,i,l,v){if(l==null)return(A||(A=n("Promise"))).reject("resumeNoiseHandshake authKeyPair is null");var S=new(o("WANoiseHandshake")).NoiseHandshake(e);o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[socket] resumeNoiseHandshake started"]))).tags("handshake"),S.start(q,B),o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["[socket] resumeNoiseHandshake authenticate with server static key"]))).tags("handshake"),S.authenticate(v),o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["[socket] resumeNoiseHandshake authenticate with client ephemeral key"]))).tags("handshake"),S.authenticate(i.pubKey),o("WALogger").LOG(d||(d=babelHelpers.taggedTemplateLiteralLoose(["[socket] resumeNoiseHandshake EC Agreement 1"]))).tags("handshake"),S.mixIntoKey(o("WAWebCryptoCurve25519").sharedSecret(v,i.privKey)),o("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["[socket] resumeNoiseHandshake encrypt client static key"]))).tags("handshake");var R=S.encrypt((A||(A=n("Promise"))).resolve(l.pubKey)).catch(function(e){return o("WALogger").ERROR(p||(p=babelHelpers.taggedTemplateLiteralLoose(["resumeNoiseHandshake failed to encrypt client static key: ",""])),e),(A||(A=n("Promise"))).reject(e)});o("WALogger").LOG(_||(_=babelHelpers.taggedTemplateLiteralLoose(["[socket] resumeNoiseHandshake EC Agreement 2"]))).tags("handshake"),S.mixIntoKey(o("WAWebCryptoCurve25519").sharedSecret(v,l.privKey));var L=a?o("WAWebGetClientPayloadForLogin").getClientPayloadForLogin(t):o("WAWebGetClientPayloadForRegistration").getClientPayloadForRegistration(t),E=S.encrypt(A.resolve(L)).catch(function(e){return o("WALogger").ERROR(f||(f=babelHelpers.taggedTemplateLiteralLoose(["resumeNoiseHandshake failed to encrypt client login props: ",""])),e),(A||(A=n("Promise"))).reject(e)});return A.all([i.pubKey,E,R]).then(function(n){var s=n[0],u=n[1],c=n[2];o("WALogger").LOG(g||(g=babelHelpers.taggedTemplateLiteralLoose(["[socket] resumeNoiseHandshake send hello"]))).tags("handshake");var d={clientHello:{ephemeral:s,payload:u,static:c}};return S.sendAndReceive(o("encodeProtobuf").encodeProtobuf(o("WAWebProtobufsWa6.pb").HandshakeMessageSpec,d).readByteArrayView()).then(function(n){o("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[socket] resumeNoiseHandshake rcv hello"]))).tags("handshake");var s=o("decodeProtobuf").decodeProtobuf(o("WAWebProtobufsWa6.pb").HandshakeMessageSpec,n),u=s.serverHello,c=u||{},d=c.ephemeral,m=c.static,p=c.payload;if(m==null){if(o("WALogger").LOG(y||(y=babelHelpers.taggedTemplateLiteralLoose(["[socket] resumeNoiseHandshake continuing resume handshake"]))).tags("handshake"),!d)throw r("err")("serverHello missing serverEphemeral");if(!p)throw r("err")("serverHello missing certificateCiphertext");return S.authenticate(d),S.mixIntoKey(o("WAWebCryptoCurve25519").sharedSecret(d,i.privKey)),S.mixIntoKey(o("WAWebCryptoCurve25519").sharedSecret(d,l.privKey)),S.decrypt(p).then(function(){return o("WALogger").LOG(C||(C=babelHelpers.taggedTemplateLiteralLoose(["[socket] resumeNoiseHandshake deriving secrets"]))).tags("handshake"),S.finish()})}return o("WALogger").LOG(b||(b=babelHelpers.taggedTemplateLiteralLoose(["[socket] resumeNoiseHandshake failed: serverStaticCiphertext not null"]))),K(e,t,a,i,n)})})}function K(e,t,n,r,o){return Q.apply(this,arguments)}function Q(){return Q=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n,r,a){var i=new(o("WANoiseHandshake")).NoiseHandshake(e);return i.start(U,B),i.authenticate(r.pubKey),o("WALogger").LOG(T||(T=babelHelpers.taggedTemplateLiteralLoose(["[socket] doFallbackHandshake continuing handshake with given server hello"]))),X(i,a,r,n,t)}),Q.apply(this,arguments)}function X(e,t,a,i,l){o("WALogger").LOG(v||(v=babelHelpers.taggedTemplateLiteralLoose(["[socket] openChatSocket rcv hello"]))),o("WALogger").DEV(S||(S=babelHelpers.taggedTemplateLiteralLoose(["[socket] server hello content: ",""])),o("WAHex").toLowerCaseHex(t));var s=o("decodeProtobuf").decodeProtobuf(o("WAWebProtobufsWa6.pb").HandshakeMessageSpec,t),u=s.serverHello;if(!u)throw r("err")("ServerHello payload error");var c=u.ephemeral,d=u.static,m=u.payload;if(c==null||d==null||m==null)throw r("err")("Missing server Ephemeral");o("WALogger").DEV(R||(R=babelHelpers.taggedTemplateLiteralLoose(["[socket] serverEphemeral: ",""])),o("WAHex").toLowerCaseHex(new Uint8Array(c))),o("WALogger").DEV(L||(L=babelHelpers.taggedTemplateLiteralLoose(["[socket] serverStaticCiphertext: ",""])),o("WAHex").toLowerCaseHex(new Uint8Array(d))),o("WALogger").DEV(E||(E=babelHelpers.taggedTemplateLiteralLoose(["[socket] certificateCiphertext: ",""])),o("WAHex").toLowerCaseHex(new Uint8Array(m))),e.authenticate(c),e.mixIntoKey(o("WAWebCryptoCurve25519").sharedSecret(c,a.privKey));var p=e.decrypt(d),_=p.then(function(e){return o("WAWebCryptoCurve25519").sharedSecret(e,a.privKey)});return e.mixIntoKey(_),(A||(A=n("Promise"))).all([p,e.decrypt(m),c]).then(function(t){var n=t[0],r=t[1],o=t[2];return Y(e,n,r,o,i,l)})}function Y(e,t,n,r,o,a){return J.apply(this,arguments)}function J(){return J=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,a,i,l,s){yield o("WAWebProcessCertificate").verifyAndProcessCertificate({certificate:a,serverStatic:t,isRegistered:l}),yield i;var u=l?o("WAWebGetClientPayloadForLogin").getClientPayloadForLogin(s):o("WAWebGetClientPayloadForRegistration").getClientPayloadForRegistration(s),c=yield o("WAWebUserPrefsInfoStore").waNoiseInfo.get();c==null&&(o("WALogger").LOG(D||(D=babelHelpers.taggedTemplateLiteralLoose(["[socket] Unable to decrypt noise data"]))).tags("launch-socket-chat","handshake"),yield o("WAWebSocketLogoutJob").socketLogout(),r("WANullthrows")(c,"Unexpected null: noiseData"));var d=r("WANullthrows")(c).staticKeyPair;return(A||(A=n("Promise"))).all([Z(d,e,i),e.encrypt(A.resolve(u))]).then(function(t){var n=t[0],r=t[1],a={clientFinish:{static:n,payload:r}};return o("WALogger").LOG(x||(x=babelHelpers.taggedTemplateLiteralLoose(["[socket] continueFullHandshakeCore client finish and deriving secrets"]))),e.send(o("encodeProtobuf").encodeProtobuf(o("WAWebProtobufsWa6.pb").HandshakeMessageSpec,a).readByteArrayView()),e.finish()})}),J.apply(this,arguments)}function Z(e,t,a){var i=(A||(A=n("Promise"))).resolve(e.pubKey),l=t.encrypt(i);if(!a)return(A||(A=n("Promise"))).reject(r("err")("staticAgreement called before serverKeys"));var s=o("WAWebCryptoCurve25519").sharedSecret(a,e.privKey);return t.mixIntoKey(s),l}var ee=0;function te(e){return ne.apply(this,arguments)}function ne(){return ne=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){if(o("WAWebUserPrefsScreenLock").getScreenLockEnabled())return null;if(e>=F)return o("WALogger").LOG($||($=babelHelpers.taggedTemplateLiteralLoose(["[socket][unified] getCertficateChain handshake previously failed "," times. Falling back to full handshake"])),e).tags("handshake"),null;try{var t=yield o("WAWebUserPrefsInfoStore").waNoiseInfo.get();if(t==null)return o("WALogger").LOG(P||(P=babelHelpers.taggedTemplateLiteralLoose(["Unable to decrypt noise data for resume handshake"]))).tags("launch-socket-chat"),null;var n=t.certificateChainBuffer?o("WAWebUserPrefsInfoStore").waNoiseInfo.getCertficateChain(t.certificateChainBuffer):null;return o("WAWebCommonSocketPlatformDetails").makeServerInfoIfKnown(n)}catch(e){return o("WALogger").ERROR(N||(N=babelHelpers.taggedTemplateLiteralLoose(["[socket][unified] getCertficateChain error: ",", msg: ",", stack: ",""])),e.name,e.message,e.stack).tags("handshake"),null}}),ne.apply(this,arguments)}function re(e,t){return oe.apply(this,arguments)}function oe(){return oe=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){try{var n=e||{passive:!1,pull:!0},r=new(o("WAWebWebcSocketConnectWamEvent")).WebcSocketConnectWamEvent,a=yield H(t,r,n);return o("WAWebPageLoadLogging").endPageLoadQplMeasure("auth_handshake"),r.markWebcAuthHandshakeDuration(),r.commit(),ee=0,o("WAResultOrError").makeResult(a)}catch(e){o("WAWebPageLoadLogging").incrementPageLoadQplSocketError();var i=ae();return o("WALogger").LOG(M||(M=babelHelpers.taggedTemplateLiteralLoose(["[socket][unified] handshake failed with ",", msg: ",", network: ",""])),e.name,e.message,i).tags("handshake"),i&&(ee++,o("WALogger").ERROR(w||(w=babelHelpers.taggedTemplateLiteralLoose(["[socket][unified] handshake failed. Retry count: ",""])),ee).tags("handshake").sendLogs("handshake-error",{sampling:.01})),o("WAResultOrError").makeError("disconnected")}}),oe.apply(this,arguments)}function ae(){return self.navigator!=null?self.navigator.onLine:!0}function ie(e){return le.apply(this,arguments)}function le(){return le=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=o("WAWebUserPrefsMultiDevice").isRegistered();return re(e,t)}),le.apply(this,arguments)}l.default=ie}),98);
__d("WAWebStanzaValidation",["WALogger"],(function(t,n,r,o,a,i,l){"use strict";var e;function s(e){u(e)}function u(t){t.tag!=="receipt"||t.attrs.type!=="sender"||t.attrs.recipient==null&&t.attrs.participant==null&&o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[stanza-validation] sender receipt without recipient nor participant"]))).sendLogs("sender-receipt-without-participant-nor-recipient-validation")}l.validateSentStanza=s}),98);
__d("WAWebCommsConfig",["WALogger","WANullthrows","WAWapJid","WAWebABProps","WAWebCmd","WAWebCommsProcessAck","WAWebCommsSendPing","WAWebEnvironment","WAWebNoop","WAWebOfflineResumePreAckHandler","WAWebOpenChatSocket","WAWebSocketConstants","WAWebStanzaValidation","WAWebUserPrefsMultiDevice","cr:7907","gkx"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m=9e5;function p(){return{jitter:.1,max:m,algo:{type:"fibonacci",first:1e3,second:1e3},relativeDelay:!1}}function _(t){var a=t||{passive:!1,pull:!1};return{maxRetries:Number.MAX_SAFE_INTEGER,openChatSocket:function(n,i){return o("WAWebABProps").getABPropConfigValue("web_comms_socket_reconnect_enabled")?a.signal=r("WANullthrows")(i):a.signal=new AbortController().signal,r("WAWebOpenChatSocket")(a).then(function(t){return o("WALogger").DEV(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[comms] getCommsConfig:openChatSocket"]))).devConsole(t),n(),a.passive=!1,t})},healthCheckInterval:15,deadSocketTime:2e4,maxSocketLoopWaitTime:m,shouldCloseStaleSocket:!0,socketReconnectBackoffAlgo:p(),shouldBlockReceivingUntilSuccess:!0,handlers:{onConnect:function(){o("WAWebUserPrefsMultiDevice").isRegistered()&&(o("WAWebCmd").Cmd.setSocketState(o("WAWebSocketConstants").SOCKET_STATE.CONNECTED),o("WAWebCmd").Cmd.openSocketStream())},onDisconnect:function(){o("WALogger").DEV(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[comms] getCommsConfig:onDisconnect"]))),o("WAWebABProps").getABPropConfigValue("web_reset_offline_state_ondisconnect_enabled")&&o("WAWebCmd").Cmd.resetOfflineDeliveryState(),o("WAWebCmd").Cmd.socketStreamDisconnected()},onSocketOpen:function(){o("WALogger").DEV(u||(u=babelHelpers.taggedTemplateLiteralLoose(["[comms] getCommsConfig:onSocketOpen"]))),o("WAWebCmd").Cmd.setSocketState(o("WAWebSocketConstants").SOCKET_STATE.PAIRING)},onSocketLoopIteration:function(t){o("WALogger").DEV(c||(c=babelHelpers.taggedTemplateLiteralLoose(["[comms] getCommsConfig:onSocketLoopIteration"]))),o("WAWebCmd").Cmd.setSocketState(o("WAWebSocketConstants").SOCKET_STATE.OPENING)},onConnectionChange:r("WAWebNoop"),onOptimisticConnectionChange:r("WAWebNoop"),onBeforeCastStanzaForE2E:function(t,n){t.tag==="ack"&&!(n!=null&&n.preAck)&&!o("WAWebCmd").Cmd.isOfflineDeliveryEnd&&o("WAWebOfflineResumePreAckHandler").parseAndSerializeOfflinePreAck(t)},onCastStanza:function(t){r("gkx")("26259")&&t.tag==="ack"&&!(t.attrs.to instanceof o("WAWapJid").WapJid)&&o("WALogger").ERROR(d||(d=babelHelpers.taggedTemplateLiteralLoose(["ack.to is a "," not a WapJid: ",""])),typeof t.attrs.to,t).sendLogs("send-string-jid"),r("gkx")("26258")||n("cr:7907")==null||n("cr:7907").sendNewStanzaToDevTool(t,!0),o("WAWebStanzaValidation").validateSentStanza(t)},onHandleAck:function(t){r("WAWebCommsProcessAck")(t)},onHandleStanza:function(t){r("gkx")("26258")||n("cr:7907")==null||n("cr:7907").sendNewStanzaToDevTool(t,!1)},onSendIq:o("WAWebStanzaValidation").validateSentStanza,onClockSkewUpdate:function(t){o("WAWebCommsSendPing").updateClockSkew(t)}},isPauseEnabled:r("WAWebEnvironment").isWindows}}l.getCommsConfig=_}),98);
__d("WAWebCommsHandleStanzaUtils",["WALogger","WAParsableWapNode","WAWeb-dexie","WAWebCreateNackFromStanza","WAWebPostIncomingMessageDropMetric","WAWebPostUnknownStanzaMetric"],(function(t,n,r,o,a,i,l){var e,s,u;function c(t,n){if(n instanceof o("WAParsableWapNode").XmppParsingFailure)return o("WAWebPostUnknownStanzaMetric").postUnknownStanzaMetric(t),o("WAWebPostIncomingMessageDropMetric").postIncomingMessageDropInvalidStanza(t),o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["handleMsg: error while parsing message: ",""])),n).tags("messaging").sendLogs("failedParsingMessageStanza",{sampling:.01}),o("WAWebCreateNackFromStanza").createNackFromStanza(t,o("WAWebCreateNackFromStanza").NackReason.ParsingError);if(n instanceof r("WAWeb-dexie").DexieError){o("WAWebPostIncomingMessageDropMetric").postIncomingMessageDropDBOperationFailed(t),o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["handleMsg: drop incoming message due to an internal error: ",", message: ",", stack: ",""])),n.name,n.message,n.stack).sendLogs("incoming-message-drop-db-operation-failed",{sampling:.01});return}return o("WALogger").ERROR(u||(u=babelHelpers.taggedTemplateLiteralLoose(["handleMsg: drop incoming message due to an internal error: ",", message: ",", stack: ",""])),n.name,n.message,n.stack).sendLogs("incoming-message-drop-internal-error",{sampling:.01}),o("WAWebPostIncomingMessageDropMetric").postIncomingMessageDropInternalError(t),o("WAWebCreateNackFromStanza").createNackFromStanza(t,o("WAWebCreateNackFromStanza").NackReason.UnhandledError)}function d(e){if(Array.isArray(e.content)&&e.content.length>0){var t=e.content[0].tag;return t==="offer"||t==="accept"||t==="reject"}return!1}l.handleMessageParsingFailure=c,l.isCallReceipt=d}),98);
__d("WAWebHandlePaymentAmountUtils",["WALogger","err"],(function(t,n,r,o,a,i,l){var e,s=1e3;function u(e){e.assertTag("money");var t=parseFloat(e.attrString("value")),n=e.attrString("currency"),r=e.maybeAttrInt("offset"),o=r!=null&&r!==0?r:s,a=t*s/o;return{currency:n,amount1000:a}}function c(t){if(t.hasChild("amount")){var n=t.child("amount");return u(n.child("money"))}else if(t.hasAttr("amount")){var a=parseFloat(t.attrString("amount"));return{amount1000:a*s,currency:t.attrString("currency")}}throw o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["Amount missing in pay or transaction node"]))),r("err")("Amount missing in pay or transaction node")}function d(e){return c(e)}l.getAmount1000AndCurrency=d}),98);
__d("WAWebPaymentStatusUtils",["$InternalEnum","WALogger","WAWebProtobufsWeb.pb"],(function(t,n,r,o,a,i,l){var e,s=n("$InternalEnum")({TYPE_UNSET:0,TYPE_P2P_SENT:1,TYPE_P2P_RCVD:2,TYPE_P2P_GRP:3,TYPE_P2P_NO_INFO:4,TYPE_FUTURE:5,TYPE_P2P_REQ_SENT:10,TYPE_P2P_REQ_RCVD:20,TYPE_P2P_REQ_SCHEDULED_PAYMENT_RCVD:21,TYPE_P2P_REQ_GRP:30,TYPE_P2M_SENT:100,TYPE_P2M_RCVD:200,TYPE_P2M_PAYOUT:300,TYPE_MISSING_DETAILS:400,TYPE_DEPOSIT:500,TYPE_REFUND:600,TYPE_WITHDRAWAL:700}),u=n("$InternalEnum")({STATUS_UNSET:0,REQUEST_PAY_INIT:11,REQUEST_PAY_SUCCESS:12,REQUEST_PAY_FAILED:13,REQUEST_PAY_FAILED_RISK:14,REQUEST_PAY_REJECTED:15,REQUEST_PAY_EXPIRED:16,REQUEST_PAY_FULFILLED:17,REQUEST_PAY_CANCELLED:18,REQUEST_PAY_CANCELLING:19,REQUEST_PAY_SCHEDULED_PAYMENT_SUCCESS:20,RECV_PAY_INIT:101,RECV_PAY_PENDING_SETUP:102,RECV_PAY_PENDING:103,RECV_PAY_RETRY_ON_FAILURE:104,RECV_PAY_FAILURE:105,RECV_PAY_SUCCESS:106,RECV_PAY_EXPIRED:107,RECV_PAY_FAILURE_RISK:108,RECV_PAY_WITHDRAWAL_PROCESSING:109,RECV_PAY_WITHDRAWAL_FAILURE:110,RECV_PAY_WITHDRAWAL_PERMANENT_FAILED:111,RECV_PAY_SENDER_CANCELED:112,SEND_PAY_INIT:401,SEND_PAY_PENDING_RECEIVER:402,SEND_PAY_PENDING:403,SEND_PAY_REFUND_PENDING:404,SEND_PAY_SUCCESS:405,SEND_PAY_FAILURE:406,SEND_PAY_FAILURE_RISK:407,SEND_PAY_REFUNDED:408,SEND_PAY_REFUND_FAILED:409,SEND_PAY_FAILURE_RECEIVER:410,SEND_PAY_REFUND_FAILED_PROCESSING:411,SEND_PAY_PENDING_REFUND:412,SEND_PAY_AUTH_CANCEL_FAILED_PROCESSING:413,SEND_PAY_AUTH_CANCEL_FAILED:414,SEND_PAY_AUTH_CANCELED:415,SEND_PAY_EXPIRED:416,SEND_PAY_AUTH_SUCCESS:417,SEND_PAY_AUTH_SUCCESS_CANCELING:418,SEND_PAY_IN_REVIEW:419,SEND_PAY_PENDING_PROCESSING:420,SEND_PAY_USER_CANCELED:421,WITHDRAWAL_INIT:601,WITHDRAWAL_PENDING:602,WITHDRAWAL_IN_REVIEW:603,WITHDRAWAL_SUCCESS:604,WITHDRAWAL_FAILED:605,WITHDRAWAL_USER_CANCELED:606,WITHDRAWAL_EXPIRED:607,WITHDRAWAL_ACTIVE:608}),c={TYPE_P2P:"p2p",TYPE_P2M:"p2m",TYPE_P2M_PAYOUT:"payout",TYPE_WITHDRAWAL:"withdrawal",TYPE_DEPOSIT:"deposit",TYPE_REFUND:"refund"},d={PENDING_RECEIVER_SETUP:"PENDING_RECEIVER_SETUP",PENDING_SETUP:"PENDING_SETUP",PENDING:"PENDING",INITIAL:"INITIAL",SUCCESS:"SUCCESS",COMPLETED:"COMPLETED",IN_REVIEW:"IN_REVIEW",FAILED:"FAILED",DECLINED:"DECLINED",FAILURE:"FAILURE",FAILED_RISK:"FAILED_RISK",FAILED_PROCESSING:"FAILED_PROCESSING",FAILED_RECEIVER_PROCESSING:"FAILED_RECEIVER_PROCESSING",REFUND_FAILED_PROCESSING:"REFUND_FAILED_PROCESSING",REFUNDED:"REFUNDED",REFUND_FAILED:"REFUND_FAILED",EXPIRED:"EXPIRED",CANCELED:"CANCELLED",AUTH_SUCCESS:"AUTH_SUCCESS",AUTH_CANCELED:"AUTH_CANCELED",AUTH_CANCEL_FAILED_PROCESSING:"AUTH_CANCEL_FAILED_PROCESSING",AUTH_CANCEL_FAILED:"AUTH_CANCEL_FAILED",COLLECT_SUCCESS:"COLLECT_SUCCESS",COLLECT_FAILED:"COLLECT_FAILED",COLLECT_REJECTED:"COLLECT_REJECTED",COLLECT_EXPIRED:"COLLECT_EXPIRED",COLLECT_CANCELED:"COLLECT_CANCELED",FAILED_DA:"FAILED_DA",FAILED_DA_FINAL:"FAILED_DA_FINAL",REFUND_FAILED_DA:"REFUND_FAILED_DA",COLLECT_FAILED_RISK:"COLLECT_FAILED_RISK",WITHDRAWAL_PROCESSING:"WITHDRAWAL_PROCESSING",WITHDRAWAL_FAILURE:"WITHDRAWAL_FAILURE",WITHDRAWAL_PERMANENT_FAILED:"WITHDRAWAL_PERMANENT_FAILED",WITHDRAWAL_ACTIVE:"WITHDRAWAL_ACTIVE"};function m(e,t){if(e==null)return o("WAWebProtobufsWeb.pb").PaymentInfo$Status.UNKNOWN_STATUS;switch(e){case u.SEND_PAY_INIT:case u.SEND_PAY_PENDING:case u.RECV_PAY_INIT:case u.RECV_PAY_PENDING:case u.RECV_PAY_RETRY_ON_FAILURE:case u.REQUEST_PAY_INIT:return o("WAWebProtobufsWeb.pb").PaymentInfo$Status.PROCESSING;case u.SEND_PAY_PENDING_RECEIVER:case u.SEND_PAY_FAILURE_RECEIVER:return o("WAWebProtobufsWeb.pb").PaymentInfo$Status.SENT;case u.REQUEST_PAY_SUCCESS:return t===s.TYPE_P2P_REQ_SENT?o("WAWebProtobufsWeb.pb").PaymentInfo$Status.WAITING_FOR_PAYER:o("WAWebProtobufsWeb.pb").PaymentInfo$Status.WAITING;case u.RECV_PAY_PENDING_SETUP:return o("WAWebProtobufsWeb.pb").PaymentInfo$Status.NEED_TO_ACCEPT;case u.SEND_PAY_SUCCESS:case u.RECV_PAY_SUCCESS:case u.REQUEST_PAY_FULFILLED:return o("WAWebProtobufsWeb.pb").PaymentInfo$Status.COMPLETE;case u.SEND_PAY_FAILURE:case u.SEND_PAY_FAILURE_RISK:case u.SEND_PAY_PENDING_REFUND:case u.SEND_PAY_REFUND_PENDING:case u.SEND_PAY_REFUND_FAILED:case u.SEND_PAY_REFUND_FAILED_PROCESSING:case u.RECV_PAY_FAILURE:case u.REQUEST_PAY_FAILED:case u.REQUEST_PAY_FAILED_RISK:return o("WAWebProtobufsWeb.pb").PaymentInfo$Status.COULD_NOT_COMPLETE;case u.SEND_PAY_REFUNDED:return o("WAWebProtobufsWeb.pb").PaymentInfo$Status.REFUNDED;case u.RECV_PAY_EXPIRED:case u.REQUEST_PAY_EXPIRED:case u.SEND_PAY_AUTH_CANCELED:case u.SEND_PAY_AUTH_CANCEL_FAILED:case u.SEND_PAY_AUTH_CANCEL_FAILED_PROCESSING:return o("WAWebProtobufsWeb.pb").PaymentInfo$Status.EXPIRED;case u.REQUEST_PAY_REJECTED:return o("WAWebProtobufsWeb.pb").PaymentInfo$Status.REJECTED;case u.REQUEST_PAY_CANCELLED:return o("WAWebProtobufsWeb.pb").PaymentInfo$Status.CANCELLED;case u.STATUS_UNSET:return o("WAWebProtobufsWeb.pb").PaymentInfo$Status.UNKNOWN_STATUS;case u.REQUEST_PAY_CANCELLING:return o("WAWebProtobufsWeb.pb").PaymentInfo$Status.UNKNOWN_STATUS;default:return o("WAWebProtobufsWeb.pb").PaymentInfo$Status.UNKNOWN_STATUS}}function p(e,t){if(!t)return u.STATUS_UNSET;var n=t.toUpperCase();switch(e){case s.TYPE_P2P_SENT:case s.TYPE_P2M_SENT:case s.TYPE_DEPOSIT:switch(n){case d.PENDING_RECEIVER_SETUP:return u.SEND_PAY_PENDING_RECEIVER;case d.FAILED_DA:return u.SEND_PAY_PENDING;case d.REFUND_FAILED_DA:return u.SEND_PAY_REFUND_PENDING;case d.FAILED_RISK:return u.SEND_PAY_FAILURE_RISK;case d.INITIAL:return u.SEND_PAY_INIT;case d.SUCCESS:case d.COMPLETED:return u.SEND_PAY_SUCCESS;case d.FAILURE:case d.FAILED:return u.SEND_PAY_FAILURE;case d.REFUNDED:return u.SEND_PAY_REFUNDED;case d.REFUND_FAILED:return u.SEND_PAY_REFUND_FAILED;case d.FAILED_RECEIVER_PROCESSING:return u.SEND_PAY_FAILURE_RECEIVER;case d.REFUND_FAILED_PROCESSING:return u.SEND_PAY_REFUND_FAILED_PROCESSING;case d.FAILED_DA_FINAL:return u.SEND_PAY_PENDING_REFUND;case d.AUTH_CANCEL_FAILED_PROCESSING:return u.SEND_PAY_AUTH_CANCEL_FAILED_PROCESSING;case d.AUTH_CANCEL_FAILED:return u.SEND_PAY_AUTH_CANCEL_FAILED;case d.AUTH_CANCELED:return u.SEND_PAY_AUTH_CANCELED;case d.EXPIRED:return u.SEND_PAY_EXPIRED;case d.IN_REVIEW:return u.SEND_PAY_IN_REVIEW;case d.PENDING:return u.SEND_PAY_PENDING_PROCESSING;case d.CANCELED:return u.SEND_PAY_USER_CANCELED}break;case s.TYPE_P2P_RCVD:case s.TYPE_P2M_RCVD:switch(n){case d.PENDING_SETUP:return u.RECV_PAY_PENDING_SETUP;case d.FAILED_DA:return u.RECV_PAY_PENDING;case d.FAILED_PROCESSING:return u.RECV_PAY_RETRY_ON_FAILURE;case d.SUCCESS:case d.COMPLETED:return u.RECV_PAY_SUCCESS;case d.FAILURE:case d.FAILED:return u.RECV_PAY_FAILURE;case d.EXPIRED:return u.RECV_PAY_EXPIRED;case d.FAILED_RISK:return u.RECV_PAY_FAILURE_RISK;case d.WITHDRAWAL_PROCESSING:return u.RECV_PAY_WITHDRAWAL_PROCESSING;case d.WITHDRAWAL_FAILURE:return u.RECV_PAY_WITHDRAWAL_FAILURE;case d.WITHDRAWAL_PERMANENT_FAILED:return u.RECV_PAY_WITHDRAWAL_PERMANENT_FAILED;case d.CANCELED:return u.RECV_PAY_SENDER_CANCELED}break;case s.TYPE_P2P_REQ_SENT:case s.TYPE_P2P_REQ_RCVD:switch(n){case d.COLLECT_SUCCESS:return u.REQUEST_PAY_SUCCESS;case d.COLLECT_FAILED:return u.REQUEST_PAY_FAILED;case d.COLLECT_FAILED_RISK:return u.REQUEST_PAY_FAILED_RISK;case d.COLLECT_REJECTED:return u.REQUEST_PAY_REJECTED;case d.COLLECT_EXPIRED:return u.REQUEST_PAY_EXPIRED;case d.COLLECT_CANCELED:return u.REQUEST_PAY_CANCELLED}break;case s.TYPE_P2P_REQ_SCHEDULED_PAYMENT_RCVD:switch(n){case d.COLLECT_SUCCESS:return u.REQUEST_PAY_SCHEDULED_PAYMENT_SUCCESS;case d.AUTH_SUCCESS:return u.SEND_PAY_AUTH_SUCCESS}break;case s.TYPE_REFUND:switch(n){case d.SUCCESS:case d.COMPLETED:return u.RECV_PAY_SUCCESS}break;case s.TYPE_WITHDRAWAL:switch(n){case d.PENDING:return u.WITHDRAWAL_PENDING;case d.IN_REVIEW:return u.WITHDRAWAL_IN_REVIEW;case d.SUCCESS:case d.COMPLETED:return u.WITHDRAWAL_SUCCESS;case d.FAILED:case d.DECLINED:return u.WITHDRAWAL_FAILED;case d.CANCELED:return u.WITHDRAWAL_USER_CANCELED;case d.EXPIRED:return u.WITHDRAWAL_EXPIRED;case d.WITHDRAWAL_ACTIVE:return u.WITHDRAWAL_ACTIVE}break;default:return u.STATUS_UNSET}return u.STATUS_UNSET}function _(e){if(e==null)return o("WAWebProtobufsWeb.pb").PaymentInfo$TxnStatus.UNKNOWN;switch(e){case u.RECV_PAY_EXPIRED:case u.SEND_PAY_EXPIRED:return o("WAWebProtobufsWeb.pb").PaymentInfo$TxnStatus.EXPIRED_TXN;case u.RECV_PAY_FAILURE:case u.SEND_PAY_FAILURE:return o("WAWebProtobufsWeb.pb").PaymentInfo$TxnStatus.FAILED;case u.RECV_PAY_INIT:case u.SEND_PAY_INIT:return o("WAWebProtobufsWeb.pb").PaymentInfo$TxnStatus.INIT;case u.RECV_PAY_PENDING_SETUP:return o("WAWebProtobufsWeb.pb").PaymentInfo$TxnStatus.PENDING_SETUP;case u.RECV_PAY_PENDING:case u.SEND_PAY_PENDING:return o("WAWebProtobufsWeb.pb").PaymentInfo$TxnStatus.FAILED_DA;case u.RECV_PAY_RETRY_ON_FAILURE:return o("WAWebProtobufsWeb.pb").PaymentInfo$TxnStatus.FAILED_PROCESSING;case u.RECV_PAY_SUCCESS:case u.SEND_PAY_SUCCESS:case u.REQUEST_PAY_FULFILLED:return o("WAWebProtobufsWeb.pb").PaymentInfo$TxnStatus.SUCCESS;case u.REQUEST_PAY_CANCELLED:return o("WAWebProtobufsWeb.pb").PaymentInfo$TxnStatus.COLLECT_CANCELED;case u.REQUEST_PAY_CANCELLING:return o("WAWebProtobufsWeb.pb").PaymentInfo$TxnStatus.COLLECT_CANCELLING;case u.REQUEST_PAY_EXPIRED:return o("WAWebProtobufsWeb.pb").PaymentInfo$TxnStatus.COLLECT_EXPIRED;case u.REQUEST_PAY_FAILED_RISK:return o("WAWebProtobufsWeb.pb").PaymentInfo$TxnStatus.COLLECT_FAILED_RISK;case u.REQUEST_PAY_FAILED:return o("WAWebProtobufsWeb.pb").PaymentInfo$TxnStatus.COLLECT_FAILED;case u.REQUEST_PAY_INIT:return o("WAWebProtobufsWeb.pb").PaymentInfo$TxnStatus.COLLECT_INIT;case u.REQUEST_PAY_REJECTED:return o("WAWebProtobufsWeb.pb").PaymentInfo$TxnStatus.COLLECT_REJECTED;case u.REQUEST_PAY_SUCCESS:return o("WAWebProtobufsWeb.pb").PaymentInfo$TxnStatus.COLLECT_SUCCESS;case u.SEND_PAY_AUTH_CANCELED:return o("WAWebProtobufsWeb.pb").PaymentInfo$TxnStatus.AUTH_CANCELED;case u.SEND_PAY_AUTH_CANCEL_FAILED_PROCESSING:return o("WAWebProtobufsWeb.pb").PaymentInfo$TxnStatus.AUTH_CANCEL_FAILED_PROCESSING;case u.SEND_PAY_AUTH_CANCEL_FAILED:return o("WAWebProtobufsWeb.pb").PaymentInfo$TxnStatus.AUTH_CANCEL_FAILED;case u.SEND_PAY_FAILURE_RECEIVER:return o("WAWebProtobufsWeb.pb").PaymentInfo$TxnStatus.FAILED_RECEIVER_PROCESSING;case u.SEND_PAY_FAILURE_RISK:case u.RECV_PAY_FAILURE_RISK:return o("WAWebProtobufsWeb.pb").PaymentInfo$TxnStatus.FAILED_RISK;case u.SEND_PAY_PENDING_RECEIVER:return o("WAWebProtobufsWeb.pb").PaymentInfo$TxnStatus.PENDING_RECEIVER_SETUP;case u.SEND_PAY_PENDING_REFUND:return o("WAWebProtobufsWeb.pb").PaymentInfo$TxnStatus.FAILED_DA_FINAL;case u.SEND_PAY_REFUNDED:return o("WAWebProtobufsWeb.pb").PaymentInfo$TxnStatus.REFUNDED_TXN;case u.SEND_PAY_REFUND_FAILED_PROCESSING:return o("WAWebProtobufsWeb.pb").PaymentInfo$TxnStatus.REFUND_FAILED_PROCESSING;case u.SEND_PAY_REFUND_FAILED:return o("WAWebProtobufsWeb.pb").PaymentInfo$TxnStatus.REFUND_FAILED;case u.SEND_PAY_REFUND_PENDING:return o("WAWebProtobufsWeb.pb").PaymentInfo$TxnStatus.REFUND_FAILED_DA;case u.SEND_PAY_IN_REVIEW:return o("WAWebProtobufsWeb.pb").PaymentInfo$TxnStatus.IN_REVIEW;case u.STATUS_UNSET:return o("WAWebProtobufsWeb.pb").PaymentInfo$TxnStatus.UNKNOWN;default:return o("WAWebProtobufsWeb.pb").PaymentInfo$TxnStatus.UNKNOWN}}function f(t,n){if(t){var r=t.toLowerCase();switch(r){case c.TYPE_P2P:return n?s.TYPE_P2P_SENT:s.TYPE_P2P_RCVD;case c.TYPE_P2M:return n?s.TYPE_P2M_SENT:s.TYPE_P2M_RCVD;case c.TYPE_P2M_PAYOUT:return s.TYPE_P2M_PAYOUT;case c.TYPE_DEPOSIT:return s.TYPE_DEPOSIT;case c.TYPE_REFUND:return s.TYPE_REFUND;case c.TYPE_WITHDRAWAL:return s.TYPE_WITHDRAWAL;default:o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["parsePaymentTransactionType payment transaction string=",""])),r)}}return n?s.TYPE_P2P_SENT:s.TYPE_P2P_RCVD}function g(e){return e===o("WAWebProtobufsWeb.pb").PaymentInfo$TxnStatus.COMPLETED||e===o("WAWebProtobufsWeb.pb").PaymentInfo$TxnStatus.SUCCESS}function h(e){return g(e)?e:o("WAWebProtobufsWeb.pb").PaymentInfo$TxnStatus.COLLECT_INIT}l.PaymentTransactionType=s,l.NotificationTransactionStatus=u,l.PaymentTransactionTypeServerString=c,l.PaymentTransactionStatusServerString=d,l.getPaymentWebStatus=m,l.getNotificationTransactionStatus=p,l.getPaymentTxnWebStatus=_,l.getPaymentTransactionType=f,l.determinePaymentRequestFulfilledStatus=h}),98);
__d("WAWebPaymentNotificationParser",["WADeprecatedWapParser","WALogger","WAWebHandlePaymentAmountUtils","WAWebJidToWid","WAWebMsgKey","WAWebPaymentStatusUtils","WAWebUserPrefsMeUser"],(function(t,n,r,o,a,i,l){var e;function s(e){return e&&e.hasAttr("service")?e.attrString("service").toUpperCase()==="NOVI":!1}var u=new(r("WADeprecatedWapParser"))("paymentNotificationParser",function(e){return e.assertTag("notification"),e.assertAttr("type","pay"),{stanzaId:e.attrString("id"),from:e.attrWapJid("from"),transaction:e.hasChild("transaction")?c(e.child("transaction")):null,invite:d(e)}});function c(t){if(s(t))return o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["Payment notification from Novi not supported."]))),null;var n=void 0,a=void 0,i=o("WAWebJidToWid").jidWithTypeToWid(t.attrJidWithType("sender")),l=o("WAWebJidToWid").jidWithTypeToWid(t.attrJidWithType("receiver")),u=o("WAWebUserPrefsMeUser").isMeAccount(i);t.hasAttr("group")?(n=o("WAWebJidToWid").jidWithTypeToWid(t.attrJidWithType("group")),a=o("WAWebJidToWid").jidWithTypeToWid(t.attrJidWithType("sender"))):u?n=l:n=i;var c=new(r("WAWebMsgKey"))({id:t.attrString("message-id"),fromMe:u,remote:n,participant:a}),d=o("WAWebPaymentStatusUtils").getPaymentTransactionType(t.attrString("transaction-type"),c.fromMe),m=o("WAWebHandlePaymentAmountUtils").getAmount1000AndCurrency(t),p=m.amount1000,_=m.currency;return{receiver:l,currency:_,amount1000:p,status:o("WAWebPaymentStatusUtils").getNotificationTransactionStatus(d,t.attrString("status")),ts:t.attrInt("ts"),type:d,msgKey:c}}function d(e){if(!e.hasChild("invite"))return null;var t=e.child("invite");return{type:t.maybeAttrString("type"),service:t.maybeAttrString("service"),inviteUsed:t.hasAttr("invite-used")?t.attrString("invite-used")==="1":null,from:o("WAWebJidToWid").chatJidToChatWid(e.attrChatJid("from")),timestamp:e.attrTime("t")}}l.isNoviTransaction=s,l.paymentNotificationParser=u,l.parseTransactionNode=c}),98);
__d("WAWebHandleMsgParser",["WADeprecatedWapParser","WALogger","WAParsableWapNode","WAWebAck","WAWebBackendJobs.flow","WAWebBizCoexGatingUtils","WAWebBotTypes","WAWebCountriesUtils","WAWebCreateNackFromStanza","WAWebCurrentUser","WAWebHandleMsgCommon","WAWebHandleMsgTypes.flow","WAWebHandlePaymentAmountUtils","WAWebJidToWid","WAWebLid1X1MigrationGating","WAWebLidMigrationUtils","WAWebMessagingGatingUtils","WAWebPaymentNotificationParser","WAWebPaymentStatusUtils","WAWebProtobufsWeb.pb","WAWebSimpleSignalPNToFBIDMigration","WAWebStatusGatingUtils","WAWebUserPrefsMeUser","WAWebUserPrefsNotifications","WAWebUsernameGatingUtils","WAWebWidFactory"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p,_,f,g,h,y=new(r("WADeprecatedWapParser"))("incomingMsgParser",function(e){var t,n;e.assertTag("message"),e.hasAttr("to")&&e.assertAttr("to",o("WAWebUserPrefsMeUser").getMeDevicePnOrThrow().toJid());var r=e.maybeChild("plaintext");r!=null&&r.throw("not to be present in e2ee messages");var a=e.mapChildrenWithTag("enc",function(e){return{e2eType:e.attrEnumValues("type",o("WAWebBackendJobs.flow").CiphertextType.members()),encMediaType:o("WAWebBackendJobs.flow").EncMediaType.cast(e.maybeAttrString("mediatype")),ciphertext:e.contentBytes(),retryCount:e.hasAttr("count")?e.attrInt("count"):0,hideFail:e.maybeAttrString("decrypt-fail")==="hide"}}),i=e.maybeChild("device-identity"),l=i?i.contentBytes():null,s=v(e),u=b(e,a),c=C(e,a,s,u),d=S(e,c),m=L(e),p=R(e),_=I(e),f=(t=(n=e.maybeChild("rcat"))==null?void 0:n.contentBytes())!=null?t:null;return{encs:a,msgInfo:c,msgMeta:u,bizInfo:d,hsmInfo:p,paymentInfo:m,deviceIdentity:l,rcat:f,msgBotInfo:s,reportingTokenInfo:_}});function C(t,n,r,a){var i={externalId:t.attrString("id"),ts:t.attrTime("t"),edit:t.hasAttr("edit")?t.attrInt("edit"):o("WAWebAck").EDIT_ATTR.NONE,isHsm:t.hasChild("hsm"),count:t.hasAttr("count")?t.attrInt("count"):null,pushname:t.hasAttr("notify")?t.attrString("notify"):null,username:t.hasAttr("username")?t.attrString("username"):null,displayName:t.hasAttr("display_name")?t.attrString("display_name"):null,senderPn:t.hasAttr("sender_pn")?o("WAWebJidToWid").userJidToUserWid(t.attrUserJid("sender_pn")):null,senderLid:t.hasAttr("sender_lid")?o("WAWebJidToWid").userJidToUserWid(t.attrUserJid("sender_lid")):null,recipientLid:t.hasAttr("recipient_lid")?o("WAWebJidToWid").lidUserJidToUserLid(t.attrLidUserJid("recipient_lid")):null,recipientPn:t.hasAttr("recipient_pn")?o("WAWebJidToWid").userJidToUserWid(t.attrUserJid("recipient_pn")):null,peerRecipientPn:t.hasAttr("peer_recipient_pn")?o("WAWebJidToWid").userJidToUserWid(t.attrUserJid("peer_recipient_pn")):null,peerRecipientLid:t.hasAttr("peer_recipient_lid")?o("WAWebJidToWid").lidUserJidToUserLid(t.attrLidUserJid("peer_recipient_lid")):null,peerRecipientUsername:t.hasAttr("peer_recipient_username")?t.attrString("peer_recipient_username"):null,recipientLatestLid:t.hasAttr("recipient_latest_lid")?o("WAWebJidToWid").lidUserJidToUserLid(t.attrLidUserJid("recipient_latest_lid")):null,recipientUsername:t.hasAttr("recipient_username")?t.attrString("recipient_username"):null,participantLid:t.hasAttr("participant_lid")?o("WAWebJidToWid").lidUserJidToUserLid(t.attrLidUserJid("participant_lid")):null,participantPn:t.hasAttr("participant_pn")?o("WAWebJidToWid").userJidToUserWid(t.attrUserJid("participant_pn")):null,participantUsername:t.hasAttr("participant_username")?t.attrString("participant_username"):null,category:t.hasAttr("category")?t.attrString("category"):null,offline:t.hasAttr("offline")?t.attrString("offline"):null,senderCountryCode:T(t.maybeChild("meta"))};i.category!=null&&i.category!==o("WAWebHandleMsgCommon").CATEGORY_PEER&&o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["parseMessageInfo: msg category is other than 'peer': ",""])),i.category).sendLogs("msg-category-not-peer");var l=o("WAWebJidToWid").jidWithTypeToWid(t.attrJidWithType("from"));l.isNewsletter()&&t.throw("unexpected `from` attribute with newsletter Jid");var f=t.hasAttr("participant")?o("WAWebJidToWid").deviceJidToDeviceWid(t.attrDeviceJid("participant")):null,g=t.hasAttr("recipient")?o("WAWebJidToWid").userJidToUserWid(t.attrUserJid("recipient")):null;if(o("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()){var h=!!(f!=null&&f.isHosted()&&(l.isStatus()||l.isGroup()||l.isBroadcast()));if(h)throw new(o("WAParsableWapNode")).XmppParsingFailure("incomingMsgParser",""+o("WAWebCreateNackFromStanza").NackReason.InvalidHostedCompanionStanza)}var y=n.every(function(e){return e.e2eType!==o("WAWebBackendJobs.flow").CiphertextType.Skmsg}),C=n.some(function(e){return e.retryCount>0}),b=l.isGroup()||l.isBroadcast()?f:l;if(g!=null&&b!=null&&!o("WAWebUserPrefsMeUser").isMeAccount(b))return t.throw("Invalid recipient from non peer device");var v,S=t.maybeChild("participants");if(S){var R=[];S.forEachChildWithTag("to",function(e){var t=o("WAWebJidToWid").userJidToUserWid(e.attrUserJid("jid")),n=e.maybeAttrString("eph_setting"),r=e.maybeAttrLidUserJid("peer_recipient_lid"),a=e.maybeAttrUserJid("peer_recipient_pn"),i=o("WAWebUsernameGatingUtils").usernameDisplayedEnabled()?e.maybeAttrString("peer_recipient_username"):null,l=e.maybeAttrLidUserJid("recipient_latest_lid"),u={wid:t};n!=null&&(u.ephSetting=n),r!=null&&(u.peerRecipientLid=o("WAWebJidToWid").lidUserJidToUserLid(r)),a!=null&&(u.peerRecipientPn=o("WAWebJidToWid").userJidToUserWid(a)),i!=null&&(u.peerRecipientUsername=i),l!=null&&(r==null&&o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[broadcast] Received a recipient_latest_lid without a peer_recipient_lid, this should not happen"]))),u.recipientLatestLid=o("WAWebJidToWid").lidUserJidToUserLid(l)),R.push(u)}),v=R}var L=a==null?void 0:a.targetChatJid;if(r&&l.isPnBot()&&L!=null){var E;return babelHelpers.extends({type:o("WAWebHandleMsgTypes.flow").MESSAGE_TYPE.CHAT},i,{chat:o("WAWebWidFactory").asUserWidOrThrow((E=a==null?void 0:a.targetChatJidLid)!=null?E:L),author:l,botParticipant:l})}else if(r&&l.isFbidBot()&&L!=null){var k=o("WAWebWidFactory").asUserWidOrThrow(L);return babelHelpers.extends({type:o("WAWebHandleMsgTypes.flow").MESSAGE_TYPE.CHAT},i,{chat:o("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.isLidMigrated()?k:o("WAWebLidMigrationUtils").toPnOrThrow(k),author:l,botParticipant:l})}else if(l.isUser()){var I=l;if(g!=null){if(!o("WAWebUserPrefsMeUser").isMeAccount(l))return t.throw("recipient on non peer chat message");I=g}var D=null,x=o("WAWebSimpleSignalPNToFBIDMigration").getDeprecatedPnChatForFbidThread(I);return x!=null&&(o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["parseMessageInfo: forwarding "," to ",""])),I.toLogString(),x.toLogString()),g!=null&&(D=g),I=x),babelHelpers.extends({type:o("WAWebHandleMsgTypes.flow").MESSAGE_TYPE.CHAT},i,{chat:o("WAWebWidFactory").asUserWidOrThrow(I),author:l,originalBotRecipient:D})}else if(l.isGroup()){if(f==null)return t.throw("group message with no participant");var $=t.attrEnumOrDefault("addressing_mode",o("WAWebHandleMsgCommon").STANZA_MSG_ADDRESSING_MODE,o("WAWebHandleMsgCommon").STANZA_MSG_ADDRESSING_MODE.pn);try{!o("WAWebUsernameGatingUtils").usernameDisplayedEnabled()&&f.isLid()&&i.participantPn==null&&i.displayName==null&&!o("WAWebUserPrefsMeUser").isMeAccount(f)&&(o("WALogger").ERROR(c||(c=babelHelpers.taggedTemplateLiteralLoose(["[lid group] missing participant_pn for Lid message. sw worker: ",""])),o("WAWebUserPrefsNotifications").getGlobalOfflineNotifications().toString()),o("WAWebCurrentUser").isEmployee()?(o("WALogger").ERROR(d||(d=babelHelpers.taggedTemplateLiteralLoose(["[lid group] chat id: "," participant lid: ",""])),l.toString(),f.toString()),o("WALogger").ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["[lid group] missing group mapping in message parser for employee"]))).sendLogs("[lid group] missing group mapping in message parser for employee")):o("WALogger").ERROR(p||(p=babelHelpers.taggedTemplateLiteralLoose(["[lid group] missing group mapping in message parser"]))).sendLogs("[lid group] missing group mapping in message parser"))}catch(e){o("WALogger").ERROR(_||(_=babelHelpers.taggedTemplateLiteralLoose(["[lid group] could not report missing lid in group message parser ",""])),e)}return babelHelpers.extends({type:o("WAWebHandleMsgTypes.flow").MESSAGE_TYPE.GROUP},i,{chat:l,author:f,isDirect:y,addressingMode:$})}else if(l.isBroadcast()&&!l.isStatus()){if(f==null)return t.throw("broadcast message with no participant");if(o("WAWebUserPrefsMeUser").isMeAccount(f)){if(v==null){if(!C)return t.throw("peer broadcast message with no participants node");v=[]}return babelHelpers.extends({type:o("WAWebHandleMsgTypes.flow").MESSAGE_TYPE.PEER_BROADCAST},i,{chat:l,author:f,isDirect:y,bclParticipants:v,bclHashValidated:!1})}return babelHelpers.extends({type:o("WAWebHandleMsgTypes.flow").MESSAGE_TYPE.OTHER_BROADCAST},i,{chat:l,author:f,isDirect:y,ephSetting:t.maybeAttrString("eph_setting")})}else if(l.isBroadcast()&&l.isStatus()){var P,N;if(f==null)return t.throw("status message with no participant");var M=(P=(N=t.maybeChild("meta"))==null?void 0:N.maybeAttrString("status_setting"))!=null?P:void 0;if(o("WAWebUserPrefsMeUser").isMeAccount(f)&&y){if(v==null)return babelHelpers.extends({type:o("WAWebHandleMsgTypes.flow").MESSAGE_TYPE.DIRECT_PEER_STATUS},i,{chat:l,author:f,isDirect:y,statusSetting:M});var w=v.map(function(e){return e.wid});return babelHelpers.extends({type:o("WAWebHandleMsgTypes.flow").MESSAGE_TYPE.DIRECT_PEER_STATUS},i,{chat:l,author:f,directPeerStatusBclParticipants:w,bclHashValidated:!1,statusSetting:M})}return babelHelpers.extends({type:o("WAWebHandleMsgTypes.flow").MESSAGE_TYPE.OTHER_STATUS},i,{chat:l,author:f,isDirect:y,statusSetting:M})}return t.throw("Unrecognized message type")}function b(e,t){var n=o("WAWebJidToWid").jidWithTypeToWid(e.attrJidWithType("from")),r=e.hasAttr("participant")?o("WAWebJidToWid").deviceJidToDeviceWid(e.attrDeviceJid("participant")):null,a=n.isGroup()||n.isBroadcast()?r:n;if(a==null)return e.throw("incomingMsgParser: to have a sender");var i=e.hasChild("unavailable");!i&&t.length===0&&e.throw("incomingMsgParser: to have enc node children");var l=!1,s=!1;if(i){var u=e.maybeChild("unavailable");s=(u==null?void 0:u.maybeAttrString("hosted"))==="true",l=(u==null?void 0:u.maybeAttrString("type"))==="view_once"}var c=e.attrEnum("type",o("WAWebHandleMsgCommon").STANZA_MSG_TYPES),d=e.maybeChild("meta"),m=c===o("WAWebHandleMsgCommon").STANZA_MSG_TYPES.poll?d==null?void 0:d.attrEnumOrNullIfUnknown("polltype",o("WAWebHandleMsgCommon").POLL_TYPES):null,p;o("WAWebStatusGatingUtils").isStatusPrivateMentionsReceiveEnabled()&&(p=(d==null?void 0:d.maybeAttrString("status_mentioned"))==="true");var _={isUnavailable:i,isViewOnceUnavailable:l,isHostedMsgUnavailable:s,type:c,pollType:m,origin:d==null?void 0:d.attrEnumOrDefault("origin",o("WAWebHandleMsgCommon").STANZA_MSG_ORIGIN,null),rawTs:e.attrString("t"),urlNumber:e.hasChild("url_number"),urlText:e.hasChild("url_text"),statusMentioned:p,appdata:d==null?void 0:d.attrEnumOrDefault("appdata",o("WAWebHandleMsgCommon").APPDATA,null)};return d&&d.hasAttr(o("WAWebHandleMsgCommon").BIZ_SOURCE_ATTR)&&(_.bizSource=d.attrString(o("WAWebHandleMsgCommon").BIZ_SOURCE_ATTR)),d&&d.hasAttr("thread_msg_id")&&(_.threadMsgId=d.attrString("thread_msg_id")),d&&d.hasAttr("thread_msg_sender_jid")&&(_.threadMsgSenderJid=o("WAWebJidToWid").jidWithTypeToWid(d.attrJidWithType("thread_msg_sender_jid"))),d&&d.hasAttr("target_id")&&(_.targetId=d.attrString("target_id")),d&&d.hasAttr("target_sender_jid")&&(_.targetSenderJid=o("WAWebJidToWid").jidWithTypeToWid(d.attrJidWithType("target_sender_jid"))),d&&d.hasAttr("target_chat_jid")&&(_.targetChatJid=o("WAWebJidToWid").jidWithTypeToWid(d.attrJidWithType("target_chat_jid"))),d&&d.hasAttr("target_chat_jid_lid")&&(_.targetChatJidLid=o("WAWebJidToWid").jidWithTypeToWid(d.attrJidWithType("target_chat_jid_lid"))),d&&d.hasAttr("capi")&&d.attrString("capi")==="true"&&(_.capi=!0),c===o("WAWebHandleMsgCommon").STANZA_MSG_TYPES.event&&d&&d.hasAttr("event_type")&&(_.eventType=d.attrEnum("event_type",o("WAWebHandleMsgCommon").EVENT_TYPES)),_}function v(e){var t=e.maybeChild("bot");if(t){var n=t.maybeAttrString("sender_timestamp_ms"),r=t.maybeAttrString("edit_target_id"),a=o("WAWebBotTypes").BotMsgEditType.cast(t.maybeAttrString("edit")),i;t.hasAttr("biz_bot")&&(t.attrString("biz_bot")==="1"?i=o("WAWebBotTypes").BizBotType.BIZ_1P:t.attrString("biz_bot")==="3"&&(i=o("WAWebBotTypes").BizBotType.BIZ_3P));var l=o("WAWebBotTypes").BotMsgBodyType.cast(t.maybeAttrString("type")),s={botSenderTimestampMs:n,botEditTargetId:r,botEditType:a,botMsgBodyType:l,bizBotType:i};return s}}function S(e,t){var n,r,a,i,l=!!(!(t==null||(n=t.author)==null)&&n.isBot()),s=!!(!(t==null||(r=t.chat)==null)&&r.isBot()),u=!s&&l;if(u)return{verifiedNameSerial:null,verifiedLevel:null,verifiedNameCert:null,privacyMode:null,nativeFlowName:null,campaignId:null};var c=e.hasChild("verified_name")?e.child("verified_name").contentBytes():null,d=e.attrEnumOrDefault("verified_level",o("WAWebHandleMsgCommon").MSG_VERIFIED_LEVEL,null),m=e.hasAttr("verified_name")?e.attrInt("verified_name"):-1,p=e.maybeChild("biz"),_=null;if(p!=null){var f=o("WAWebHandleMsgTypes.flow").ActualActorsEnumType.cast(p.maybeAttrInt("actual_actors")),g=o("WAWebHandleMsgTypes.flow").HostStorageEnumType.cast(p.maybeAttrInt("host_storage")),h=p.maybeAttrInt("privacy_mode_ts");f!=null&&g!=null&&h!=null&&!l&&(_={actualActors:f,hostStorage:g,privacyModeTs:h})}var y=(a=p==null||(i=p.maybeChild("interactive"))==null||(i=i.maybeChild("native_flow"))==null?void 0:i.maybeAttrString("name"))!=null?a:p==null?void 0:p.maybeAttrString("native_flow_name"),C=p==null?void 0:p.maybeAttrString("campaign_id");return babelHelpers.extends({verifiedNameCert:c,verifiedLevel:d,verifiedNameSerial:m,privacyMode:_,nativeFlowName:y,campaignId:C},p&&{verifiedButtonsEnvelope:p.hasChild("buttons"),verifiedListEnvelope:p.hasChild("list"),verifiedHsmEnvelope:e.hasChild("hsm")})}function R(e){var t=e.maybeChild("hsm");if(t!=null){var n=t.maybeAttrString("tag"),r=t.maybeAttrString("category");if(n!=null||r!=null)return{tag:n,category:r}}return null}function L(e){var t=null,n=e.hasChild("pay")?e.child("pay"):null,r=e.hasChild("transaction")?e.child("transaction"):null,a=o("WAWebJidToWid").jidWithTypeToWid(e.attrJidWithType("from")).isGroup(),i=e.hasAttr("participant")?o("WAWebJidToWid").jidWithTypeToWid(e.attrJidWithType("participant")):null;if(o("WAWebPaymentNotificationParser").isNoviTransaction(n)||o("WAWebPaymentNotificationParser").isNoviTransaction(r))t={futureproofed:!0};else if(r){var l=o("WAWebPaymentNotificationParser").parseTransactionNode(r);l&&(E(a,i,o("WAWebWidFactory").createWid(l.receiver.toString()))?t={receiverJid:l.receiver.toString(),currency:l.currency,amount1000:l.amount1000,transactionTimestamp:l.ts,txnStatus:o("WAWebPaymentStatusUtils").getPaymentTxnWebStatus(l.status)}:t={receiverJid:l.receiver.toString(),currency:l.currency,amount1000:l.amount1000,transactionTimestamp:l.ts})}else if(n){var s=n.attrEnum("type",o("WAWebHandleMsgCommon").PAY_NODE_TYPES);switch(s){case o("WAWebHandleMsgCommon").PAY_NODE_TYPES.send:{var u=o("WAWebHandlePaymentAmountUtils").getAmount1000AndCurrency(n),c=u.amount1000,d=u.currency,m=n.hasAttr("receiver")?n.attrString("receiver"):e.attrString("recipient");E(a,i,o("WAWebWidFactory").createWid(m))?t={receiverJid:m,currency:d,amount1000:c,transactionTimestamp:e.attrInt("t"),txnStatus:o("WAWebProtobufsWeb.pb").PaymentInfo$TxnStatus.INIT}:t={receiverJid:m,currency:d,amount1000:c,transactionTimestamp:e.attrInt("t")};break}case o("WAWebHandleMsgCommon").PAY_NODE_TYPES.request:break;case o("WAWebHandleMsgCommon").PAY_NODE_TYPES.invite:break;default:break}}return t}function E(e,t,n){return!(e&&t!=null&&n!=null&&!o("WAWebUserPrefsMeUser").isMeAccount(t)&&!o("WAWebUserPrefsMeUser").isMeAccount(n))}var k=new(r("WADeprecatedWapParser"))("incomingMsgParserForAckOnly",function(e){e.assertTag("message");var t=null;try{t=e.attrEnum("type",o("WAWebHandleMsgCommon").STANZA_MSG_TYPES)}catch(e){o("WALogger").WARN(f||(f=babelHelpers.taggedTemplateLiteralLoose(["incomingMsgParserForAckOnly: failed to parse stanza type: ",""])),e)}var n=null;try{n=e.attrString("offline")!==""}catch(e){}var r=null;try{r=C(e,[],v(e))}catch(e){o("WALogger").WARN(g||(g=babelHelpers.taggedTemplateLiteralLoose(["incomingMsgParserForAckOnly: failed to parse msg info: ",""])),e)}return{type:t,externalId:e.attrString("id"),from:o("WAWebJidToWid").jidWithTypeToWid(e.attrJidWithType("from")),participant:e.hasAttr("participant")?o("WAWebJidToWid").deviceJidToDeviceWid(e.attrDeviceJid("participant")):null,msgInfo:r,offline:n}});function I(e){if(!o("WAWebMessagingGatingUtils").isReportingTokenReceivingEnabled())return null;var t=e.maybeChild("reporting");if(t==null)return null;var n={},r=t.maybeChild("reporting_token"),a=t.maybeChild("reporting_tag");return r!=null&&(n.reportingToken=r.contentBytes(),n.version=r.attrInt("v")),a!=null&&(n.reportingTag=a.contentBytes()),n}function T(e){var t=e==null?void 0:e.maybeAttrString("sender_country_code");if(t!=null)try{return o("WAWebCountriesUtils").asISOCountryCode(t)}catch(e){o("WAWebCurrentUser").isEmployee()&&o("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Failed to parse sender country code: ",""])),t).sendLogs("failed-to-parse-sender-country-code",{sampling:.01})}}l.incomingMsgParser=y,l.incomingMsgParserForAckOnly=k}),98);
__d("WAWebHandleCloudApiThreadControlNotification",["WALogger","WAWebBackendApi"],(function(t,n,r,o,a,i,l){"use strict";var e;function s(t){var n=t.consumerPhoneNumber,r=t.consumerLid,a=t.status;n==null&&r==null||(o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[Biz AI] Received thread control notification, status: ",""])),a),o("WAWebBackendApi").frontendFireAndForget("updateChatCapiThreadControl",{consumerPhoneNumber:n,consumerLid:r,status:a}))}l.default=s}),98);
__d("WAWebIcdcHandlerApi",["Promise","WAJids","WALogger","WALongInt","WATimeUtils","WAWebAdvExpectedTsApi","WAWebApiDeviceList","WAWebApiPendingDeviceSync","WAWebBizCoexGatingUtils","WAWebBizCoexHostedAddVerification","WAWebBizCoexOfflineICDCHandledCache","WAWebCmd","WAWebHandleAdvForUsyncApi","WAWebIdentityUpdateDeviceTableApi","WAWebLastADVCheckTimeApi","WAWebPromiseQueue","WAWebProtobufsAdv.pb","WAWebSyncDeviceAdvDeviceListJob","WAWebUserPrefsMeUser","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p,_=new(o("WAWebPromiseQueue")).PromiseQueue;function f(e,t,r){return r==null?(p||(p=n("Promise"))).resolve():_.enqueue(function(){return y(e,t,r)})}function g(e,t,n){return h.apply(this,arguments)}function h(){return h=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,n,r){var a,i,l={hostedBizEncMismatch:!1,senderOrRecipientAccountTypeHosted:!1};if(!o("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()||o("WAWebUserPrefsMeUser").isMeAccount(t)||!t.isUser())return l;var c=r==null?void 0:r.deviceListMetadata;if(c==null)return l;var d=o("WAWebUserPrefsMeUser").isMeAccount(n),m=d?c.receiverAccountType:c.senderAccountType,p=d?t:n;if(m==null)return l;if(m===o("WAWebProtobufsAdv.pb").ADVEncryptionType.E2EE)return o("WAWebBizCoexOfflineICDCHandledCache").removeFromOfflineBizHostedSenderICDCProcessedCache(p),l;if(m!==o("WAWebProtobufsAdv.pb").ADVEncryptionType.HOSTED)return l;if(o("WAWebBizCoexOfflineICDCHandledCache").hasOfflineBizHostedSenderICDCProcessedForSender(p))return o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["handleHostedIcdcMetadataInline: skip processing since already processed for current offline resume session for ",""])),p==null?void 0:p.toLogString()),{hostedBizEncMismatch:!1,senderOrRecipientAccountTypeHosted:!0};o("WAWebBizCoexOfflineICDCHandledCache").addToOfflineBizHostedSenderICDCProcessedCache(p),o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["handleIcdcMetadataInline: add to coex cache for ",""])),p==null?void 0:p.toLogString()),o("WAWebBizCoexHostedAddVerification").addToCoexHostedVerificationCache(p);var _=yield o("WAWebApiDeviceList").getDeviceRecord(p),f=o("WALongInt").numberOrThrowIfTooLarge((a=c.senderTimestamp)!=null?a:0),g=(i=_==null?void 0:_.timestamp)!=null?i:0;if(f>=g){if((_==null?void 0:_.advAccountType)!==o("WAWebProtobufsAdv.pb").ADVEncryptionType.HOSTED){var h;return yield o("WAWebIdentityUpdateDeviceTableApi").clearDeviceRecord(p,(h=_==null?void 0:_.devices)!=null?h:[],!o("WAWebCmd").Cmd.isOfflineDeliveryEnd,o("WAWebProtobufsAdv.pb").ADVEncryptionType.E2EE,o("WAWebProtobufsAdv.pb").ADVEncryptionType.HOSTED),o("WAWebCmd").Cmd.isOfflineDeliveryEnd?o("WAWebSyncDeviceAdvDeviceListJob").syncDeviceListJob([p],null,null):yield o("WAWebApiPendingDeviceSync").addUserToPendingDeviceSync([p.toString()]),o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["handleHostedIcdcMetadataInline: update ADV type for ",""])),p==null?void 0:p.toLogString()),{hostedBizEncMismatch:(_==null?void 0:_.advAccountType)===o("WAWebProtobufsAdv.pb").ADVEncryptionType.E2EE||(_==null?void 0:_.deletedChangedToHost)!==!0,senderOrRecipientAccountTypeHosted:!0}}return{hostedBizEncMismatch:!1,senderOrRecipientAccountTypeHosted:!0}}return l}),h.apply(this,arguments)}function y(e,t,n){return C.apply(this,arguments)}function C(){return C=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n){var r=n.deviceListMetadata;if(r==null){o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["get empty device list metadata"]))).tags("handleICDCData");return}if((e.device==null||e.device===o("WAJids").DEFAULT_DEVICE_ID)&&r.senderTimestamp!=null&&r.senderKeyHash==null){var a=o("WALongInt").numberOrThrowIfTooLarge(r.senderTimestamp)+1,i=o("WAWebHandleAdvForUsyncApi").handleADVSyncResult(e,{deviceList:[{id:o("WAJids").DEFAULT_DEVICE_ID,keyIndex:0}],keyIndex:{ts:o("WATimeUtils").castToUnixTime(a),signedKeyIndexBytes:null}},null,null);(i==null?void 0:i.identityUpdatePromise)!=null&&(yield i.identityUpdatePromise);return}var l=[],s=e.user===o("WAWebUserPrefsMeUser").getMePnUserOrThrow().user;l.push({id:e,ts:r.senderTimestamp}),s&&t!=null&&l.push({id:t,ts:r.recipientTimestamp});var u=yield o("WAWebLastADVCheckTimeApi").getLastADVDeviceInfoCheckTime(),p=yield o("WAWebApiDeviceList").bulkGetDeviceRecord(l.map(function(e){return e.id})),_=[];if(p.forEach(function(e,t){var n=l[t].ts;if(!(e==null||e.deleted||n==null)){var r=o("WAWebAdvExpectedTsApi").computeExpectedTsForDeviceRecord(o("WALongInt").numberOrThrowIfTooLarge(n),e,u);(r.expectedTs!==e.expectedTs||r.expectedTsLastDeviceJobTs!==e.expectedTsLastDeviceJobTs||r.expectedTsUpdateTs!==e.expectedTsUpdateTs)&&(o("WALogger").LOG(d||(d=babelHelpers.taggedTemplateLiteralLoose(["handleICDCData: update expectd timestamp for ",""])),e.id),o("WALogger").DEV(m||(m=babelHelpers.taggedTemplateLiteralLoose(["handleICDCData: old values: ",", new expected values record ",""])),JSON.stringify(e),JSON.stringify(r)),_.push(babelHelpers.extends({},e,r)))}}),_.length>0)return o("WAWebApiDeviceList").bulkCreateOrReplaceDeviceRecord(_)}),C.apply(this,arguments)}l.handleICDCData=f,l.handleHostedIcdcMetadataInline=g}),98);
__d("WAWebHandleMsgProcessUtils",["WALogger","WAWebBackendApi","WAWebBizCoexGatingUtils","WAWebDBCreateOrUpdateReactions","WAWebDBPollsUpsertVotes","WAWebDBProcessEditProtocolMsgs","WAWebDBUpdateLastAddOnPreviewChat","WAWebGetMessageCache","WAWebHandleMsgCommon","WAWebHandleMsgError","WAWebHandleMsgValidate","WAWebIcdcHandlerApi","WAWebLastAddOnDBSerialization","WAWebOfflineDeviceCache","WAWebReactionDataUtils","WAWebShouldUpdateLastAddOnPreview","WAWebSyncDeviceAdvDeviceListJob","WAWebWidFactory","asyncToGeneratorRuntime","cr:10197"],(function(t,n,r,o,a,i,l){var e,s,u;function c(t,n){o("WALogger").DEV(e||(e=babelHelpers.taggedTemplateLiteralLoose(["storing offline message for async processing"]))).devConsole({msg:t,msgInfo:n});var r={msg:t,receiptInfo:{externalId:t.id.id,from:t.from,author:n.author}};o("WAWebGetMessageCache").getMessageCache().addMessages([r],!1)}function d(e,t){return m.apply(this,arguments)}function m(){return m=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){if(e.offline==null&&o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["processDecryptedMessageProto: msgId::",", message decrypted: "])),e.externalId).tags("messaging").devConsole(t),!e.isHsm&&t.highlyStructuredMessage)throw new(o("WAWebHandleMsgCommon")).HsmMismatchError;var n=null;if(!(yield o("WAWebHandleMsgValidate").isFromKnownDevice(e.author))){var r=o("WAWebWidFactory").asUserWidOrThrow(e.author);throw e.offline==null?o("WAWebSyncDeviceAdvDeviceListJob").syncDeviceListJob([r],null,null):o("WAWebOfflineDeviceCache").OfflinePendingDeviceCache.addOfflinePendingDevice(String(r),null),new(o("WAWebHandleMsgError")).UnknownDeviceMessageError("[messaging] msgId::"+e.externalId+", processDecryptedMessageProto: reject message from unknown device")}return t.messageContextInfo&&(o("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()&&(n=e.chat.isUser()?yield o("WAWebIcdcHandlerApi").handleHostedIcdcMetadataInline(e.chat,e.author,t.messageContextInfo):null),o("WAWebIcdcHandlerApi").handleICDCData(e.author,e.chat.isUser()?e.chat:null,t.messageContextInfo)),n}),m.apply(this,arguments)}function p(e){return _.apply(this,arguments)}function _(){return _=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e.msg,n=e.msgInfo,r=e.reparsing;if(n.offline!=null&&!r)return c(t,n);yield o("WAWebBackendApi").frontendSendAndReceive("processEphemeralSyncResponse",{msg:t})}),_.apply(this,arguments)}function f(e,t,n){return g.apply(this,arguments)}function g(){return g=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n){if(t.offline!=null&&!n)return c(e,t);yield o("WAWebBackendApi").frontendSendAndReceive("processKeepInChatMessage",{keepInChatMessage:e,allowNotification:!0})}),g.apply(this,arguments)}function h(e,t,n){return y.apply(this,arguments)}function y(){return y=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n){var r=e;if(t.offline!=null&&!n)return c(r,t);yield o("WAWebDBProcessEditProtocolMsgs").processEditProtocolMsgs([r],n)}),y.apply(this,arguments)}function C(e){return b.apply(this,arguments)}function b(){return b=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=yield o("WAWebDBPollsUpsertVotes").upsertVotesDb(e);o("WAWebBackendApi").frontendFireAndForget("upsertVotesModelCollection",{votes:t,votesToRemove:null,restoredFromDb:!0}),yield v(t.map(function(e){return o("WAWebLastAddOnDBSerialization").lastAddOnPreviewCandidateFromVoteData(e,!1)}))}),b.apply(this,arguments)}function v(e){return S.apply(this,arguments)}function S(){return S=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=yield o("WAWebShouldUpdateLastAddOnPreview").filterChatsWithAddOnPreviewUpdates(e);t.size>0&&(yield o("WAWebDBUpdateLastAddOnPreviewChat").updateDatabaseForLastAddOnPreview(t),o("WAWebBackendApi").frontendFireAndForget("updateChatLastAddOnPreview",{chatMap:t}))}),S.apply(this,arguments)}function R(e){return L.apply(this,arguments)}function L(){return L=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e.map(function(e){return o("WAWebReactionDataUtils").webMsgInfoReactionTypeToReactionsRow(e)}),n="reaction received: "+t.map(function(e){return e.msgKey.toString()+" to "+e.parentMsgKey}).toString()+";";o("WALogger").DEV(u||(u=babelHelpers.taggedTemplateLiteralLoose(["storeReactionMsgBulk: ",""])),n).tags("messaging");var r=yield o("WAWebDBCreateOrUpdateReactions").createOrUpdateReactions(t);return r&&(yield v(r.map(function(e){return o("WAWebLastAddOnDBSerialization").lastAddOnPreviewCandidateFromReactionRowType(e)}))),r}),L.apply(this,arguments)}l.preProcessMsg=d,l.processEphemeralSyncResponseMsg=p,l.processKeepInChatMsg=f,l.processEditProtocolMsg=h,l.storePollVotesBulk=C,l.storeReactionMsgBulk=R}),98);
__d("WAWebWamEnumMigrationStageEnum",[],(function(t,n,r,o,a,i){var e=Object.freeze({GOT_ABPROP:1,PRIMARY_LOCAL_MIGRATION_STARTED:2,PRIMARY_LOCAL_MIGRATION_ENDED:3,PRIMARY_LOCAL_MIGRATION_FAILED:4,PRIMARY_SENT_PEER_MESSAGE:5,COMPANION_RECEIVED_PEER_MESSAGE:6,COMPANION_LOCAL_MIGRATION_STARTED:7,COMPANION_LOCAL_MIGRATION_ENDED:8,COMPANION_LOCAL_MIGRATION_FAILED:9,COMPANION_MIGRATED_ON_NEW_PAIRING:10,COMPANION_RECEIVED_DEVICE_CAPABILITY:11,COMPANION_EXTRACTED_AND_SAVED_PEER_MESSAGE:12});i.MIGRATION_STAGE_ENUM=e}),66);
__d("WAWebWamEnumStageFailureReasonEnum",[],(function(t,n,r,o,a,i){var e=Object.freeze({MALFORMED_PEER_MESSAGE:1,INITIATED_LOGOUT_BASED_ON_MAPPING:2,DID_NOT_GET_PEER_MESSAGE_ON_TIME:3,DID_NOT_COMPLETE_MIGRATION_ON_TIME:4,COMPANION_UNSUPPORTED_VERSION:5,INTERNAL_ERROR:6,COMPANION_TIMEOUT_BASED_ON_DEVICE_CAPABILITY:7});i.STAGE_FAILURE_REASON_ENUM=e}),66);
__d("WAWebLid11MigrationLifecycleWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumMigrationStageEnum","WAWebWamEnumStageFailureReasonEnum"],(function(t,n,r,o,a,i,l){var e,s=(e=o("WAWebWamCodegenUtils")).defineEvents({Lid11MigrationLifecycle:[6154,{chatNotInMappingCount:[1,e.TYPES.INTEGER],companionHasADifferentMappingCount:[2,e.TYPES.INTEGER],currentLocalTimeSeconds:[10,e.TYPES.INTEGER],fakeLidCount:[3,e.TYPES.INTEGER],isLocally1x1MigratedFromDb:[14,e.TYPES.BOOLEAN],isStageInOfflineResume:[11,e.TYPES.BOOLEAN],isSyncdLidSession:[4,e.TYPES.BOOLEAN],latestMappingCount:[5,e.TYPES.INTEGER],mappingCount:[6,e.TYPES.INTEGER],migratedThreadCount:[7,e.TYPES.INTEGER],migrationStage:[8,o("WAWebWamEnumMigrationStageEnum").MIGRATION_STAGE_ENUM],peerMappingBytesLength:[12,e.TYPES.INTEGER],primaryMigrationTimeSeconds:[13,e.TYPES.INTEGER],stageFailureReason:[9,o("WAWebWamEnumStageFailureReasonEnum").STAGE_FAILURE_REASON_ENUM],webClientDidPairingStanzaIndicated1x1MigrationThisSession:[15,e.TYPES.BOOLEAN]},[1,1,1],"regular"]},{Lid11MigrationLifecycle:[]});l.Lid11MigrationLifecycleWamEvent=s}),98);
__d("WAWebLid1X1ThreadAccountMigrations.flow",["$InternalEnum"],(function(t,n,r,o,a,i){var e=n("$InternalEnum")({WAITING_PROP:1,WAITING_MAPPINGS:2,READY:3,IN_PROGRESS:4,COMPLETE:5});i.LidThreadMigrationStatus=e}),66);
__d("WAWebProtobufLidMigrationSyncPayload.pb",["WAProtoConst"],(function(t,n,r,o,a,i,l){var e,s={},u={};s.name="LIDMigrationMapping",s.internalSpec={pn:[1,(e=o("WAProtoConst")).FLAGS.REQUIRED|e.TYPES.UINT64],assignedLid:[2,e.FLAGS.REQUIRED|e.TYPES.UINT64],latestLid:[3,e.TYPES.UINT64]},u.name="LIDMigrationMappingSyncPayload",u.internalSpec={pnToLidMappings:[1,e.FLAGS.REPEATED|e.TYPES.MESSAGE,s],chatDbMigrationTimestamp:[2,e.TYPES.UINT64]},l.LIDMigrationMappingSpec=s,l.LIDMigrationMappingSyncPayloadSpec=u}),98);
__d("WAWebLid1x1MigrationMsgParser",["WABinary","WAGzip","WALogger","WAWebLogoutReasonConstants","WAWebProtobufLidMigrationSyncPayload.pb","WAWebSocketLogoutJob","WAWebWidFactory","asyncToGeneratorRuntime","decodeProtobuf"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p;function _(e){return f.apply(this,arguments)}function f(){return f=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){try{o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["parseLidMigrationMappingSyncMsg: start handle peer mapping"])));var n=new(o("WABinary")).Binary(t);o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["parseLidMigrationMappingSyncMsg: after read binary"])));var r=yield o("WAGzip").inflate(n.readByteArrayView());o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["parseLidMigrationMappingSyncMsg: after decompress"])));var a=o("decodeProtobuf").decodeProtobuf(o("WAWebProtobufLidMigrationSyncPayload.pb").LIDMigrationMappingSyncPayloadSpec,r);if(o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["parseLidMigrationMappingSyncMsg: after decode protobuf ("," entries)"])),a.pnToLidMappings.length),a==null||a.pnToLidMappings.length===0)return o("WALogger").LOG(d||(d=babelHelpers.taggedTemplateLiteralLoose(["parseLidMigrationMappingSyncMsg: no mapping in protobuf"]))),{mappings:[],primaryMigrationTsSec:null};var i=a.pnToLidMappings.map(function(e){var t,n=(t=o("WAWebWidFactory")).asUserWidOrThrow(t.createUserWidOrThrow(e.pn.toString())),r=t.asUserWidOrThrow(t.createWid(e.assignedLid.toString()+"@lid")),a=(e==null?void 0:e.latestLid)!=null?o("WAWebWidFactory").asUserWidOrThrow(o("WAWebWidFactory").createWid(e.latestLid.toString()+"@lid")):null;return{pnUser:n,assignedLid:r,latestLid:a}});return o("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["parseLidMigrationMappingSyncMsg: completed successfully"]))),{mappings:i,primaryMigrationTsSec:a.chatDbMigrationTimestamp}}catch(e){o("WALogger").ERROR(p||(p=babelHelpers.taggedTemplateLiteralLoose(["parseLidMigrationMappingSyncMsg: failed to parse lid sync payload"]))).sendLogs("lid-migration-parse-mappings").devConsole(e),yield o("WAWebSocketLogoutJob").socketLogout(o("WAWebLogoutReasonConstants").LogoutReason.LidMigrationFailedToParseMapping)}}),f.apply(this,arguments)}l.parseLidMigrationMappingSyncMsg=_}),98);
__d("WAWebLid1x1MigrationPrimaryCache",["Promise","WALogger","WAWebApiContact","WAWebDBCreateLidPnMappings","WAWebLid1x1MigrationMsgParser","WAWebUserPrefsIndexedDBStorage","WAWebWidFactory","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u=(function(){function t(){this.$1=0,this.$2=new Map,this.$3=new Map,this.$4=null;var t=o("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.get("WALidThreadAccountMigrationStatus");t==null||t.lidMappingsFromPrimaryMigration==null||(this.$1=t.ts,this.$5(t.lidMappingsFromPrimaryMigration).catch(function(t){o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[LID] Failed to populate lid mappings from primary device"]))).sendLogs(t)}))}var r=t.prototype;return r.getPrimaryMigrationTsSec=function(){return this.$4},r.getLidForPn=function(t){return this.$2.get(t)},r.updateCacheIfEmpty=function(t,r){return this.$2.size!==0?(s||(s=n("Promise"))).resolve():(this.clear(),this.$1=r,this.$5(t))},r.$5=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=this;yield o("WAWebLid1x1MigrationMsgParser").parseLidMigrationMappingSyncMsg(e).then(function(e){var n;t.$4=e==null?void 0:e.primaryMigrationTsSec,e==null||(n=e.mappings)==null||n.forEach(function(e){t.$2.set(e.pnUser,e.assignedLid),e.latestLid!=null&&t.$3.set(e.pnUser,e.latestLid)})})});function t(t){return e.apply(this,arguments)}return t})(),r.getAllPnLidMappings=function(){var e=this;return Array.from(this.$2.entries(),function(t){var n=t[0],r=t[1],o=e.$3.get(n);return{primaryProvidedPn:n,primaryProvidedLid:r,primaryProvidedLatestLid:o}})},r.$6=function(t,n,r){var e=o("WAWebApiContact").lidPnCache.getCurrentLid(o("WAWebWidFactory").asUserWidOrThrow(t)),a=n.equals(e);if(!a){var i="migration-sync-latest",l=[{pn:o("WAWebWidFactory").asUserWidOrThrow(t),lid:o("WAWebWidFactory").asUserLidOrThrow(n)}];if(r==null)return{mappings:l,learningSource:i};var s=r.equals(e);if(s)i="migration-sync-old";else{var u={pn:o("WAWebWidFactory").asUserWidOrThrow(t),lid:o("WAWebWidFactory").asUserLidOrThrow(r)};l.push(u)}return{mappings:l,learningSource:i}}},r.learnMappingsInBulk=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=this,t=this.getAllPnLidMappings(),n=[],r=[];t.forEach(function(t){var o=t.primaryProvidedPn,a=t.primaryProvidedLid,i=t.primaryProvidedLatestLid,l=e.$6(o,a,i);if(l!=null){var s=l.mappings,u=l.learningSource;u==="migration-sync-latest"?r.push.apply(r,s):n.push.apply(n,s)}}),yield o("WAWebDBCreateLidPnMappings").createLidPnMappings({mappings:n,flushImmediately:!0,learningSource:"migration-sync-old"}),yield o("WAWebDBCreateLidPnMappings").createLidPnMappings({mappings:r,flushImmediately:!0,learningSource:"migration-sync-latest"})});function t(){return e.apply(this,arguments)}return t})(),r.clear=function(){this.$1=0,this.$2.clear(),this.$3.clear()},t})(),c=new u;l.lidPnMigrationPrimaryCache=c}),98);
__d("WAWebLid1X1ThreadAccountMigrations",["Promise","WAAsyncSleep","WAJobOrchestratorTypes","WALogger","WALongInt","WANullthrows","WATimeUtils","WAWebABProps","WAWebApiContact","WAWebCurrentUser","WAWebDBMessageSerialization","WAWebDBMessageUtils","WAWebEventsWaitForOfflineDeliveryEnd","WAWebLid11MigrationLifecycleWamEvent","WAWebLid1X1MigrationGating","WAWebLid1X1ThreadAccountMigrations.flow","WAWebLid1x1MigrationPrimaryCache","WAWebLogoutReasonConstants","WAWebModelStorageUtils","WAWebMsgGetters","WAWebOfflineResumeUtils","WAWebOrchestratorNonPersistedJob","WAWebSocketLogoutJob","WAWebUserPrefsIndexedDBStorage","WAWebUserPrefsMultiDevice","WAWebUserPrefsTypes","WAWebUsernameTypes","WAWebWamEnumMigrationStageEnum","WAWebWamEnumStageFailureReasonEnum","WAWebWid","WAWebWidFactory","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p,_,f,g,h,y,C,b,v,S,R,L,E,k,I,T,D,x,$,P,N,M;function w(){var e=o("WAWebABProps").getABPropConfigValue("lid_one_on_one_migration_enabled"),t=G().state;if(e&&t===o("WAWebLid1X1ThreadAccountMigrations.flow").LidThreadMigrationStatus.WAITING_PROP)return V(o("WAWebLid1X1ThreadAccountMigrations.flow").LidThreadMigrationStatus.WAITING_MAPPINGS)}function A(e){return F.apply(this,arguments)}function F(){return F=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){try{var t;o("WALogger").LOG(d||(d=babelHelpers.taggedTemplateLiteralLoose(["[LID] setLidMigrationMappings: received mappings. size: "," is offline: ",""])),(t=e==null?void 0:e.byteLength)!=null?t:0,o("WAWebEventsWaitForOfflineDeliveryEnd").isOfflineDeliveryEnd());var n=o("WATimeUtils").unixTime();new(o("WAWebLid11MigrationLifecycleWamEvent")).Lid11MigrationLifecycleWamEvent({migrationStage:o("WAWebWamEnumMigrationStageEnum").MIGRATION_STAGE_ENUM.COMPANION_RECEIVED_PEER_MESSAGE}).commit();var r=o("WATimeUtils").unixTime();if(o("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["[LID] after sending WAM. is offline: ",". duration: ",""])),o("WAWebEventsWaitForOfflineDeliveryEnd").isOfflineDeliveryEnd(),r-n),e==null)return o("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["[LID] peer mapping is null"]))),yield new(o("WAWebLid11MigrationLifecycleWamEvent")).Lid11MigrationLifecycleWamEvent({migrationStage:o("WAWebWamEnumMigrationStageEnum").MIGRATION_STAGE_ENUM.COMPANION_LOCAL_MIGRATION_FAILED,stageFailureReason:o("WAWebWamEnumStageFailureReasonEnum").STAGE_FAILURE_REASON_ENUM.MALFORMED_PEER_MESSAGE}).commitAndWaitForFlush(!0),o("WALogger").ERROR(_||(_=babelHelpers.taggedTemplateLiteralLoose(["[LID] setLidMigrationMappings: received empty mappings payload"]))).sendLogs("lid-migration-empty-mappings"),o("WAWebSocketLogoutJob").socketLogout(o("WAWebLogoutReasonConstants").LogoutReason.LidMigrationPeerMappingsMalformed);var a=o("WATimeUtils").unixTime();o("WALogger").LOG(f||(f=babelHelpers.taggedTemplateLiteralLoose(["[LID] before update state. is offline: ",""])),o("WAWebEventsWaitForOfflineDeliveryEnd").isOfflineDeliveryEnd()),yield o("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.set("WALidThreadAccountMigrationStatus",{state:o("WAWebLid1X1ThreadAccountMigrations.flow").LidThreadMigrationStatus.READY,ts:a,lidMappingsFromPrimaryMigration:e});var i=o("WATimeUtils").unixTime();o("WALogger").LOG(g||(g=babelHelpers.taggedTemplateLiteralLoose(["[LID] before update cache. is offline: ",". duration: ",""])),o("WAWebEventsWaitForOfflineDeliveryEnd").isOfflineDeliveryEnd(),i-r),yield o("WAWebLid1x1MigrationPrimaryCache").lidPnMigrationPrimaryCache.updateCacheIfEmpty(e,a),o("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[LID] setLidMigrationMappings: saved updated mapping. is offline: ",""])),o("WAWebEventsWaitForOfflineDeliveryEnd").isOfflineDeliveryEnd()),z()}catch(e){throw o("WALogger").ERROR(y||(y=babelHelpers.taggedTemplateLiteralLoose(["[LID] setLidMigrationMappings: failed to save mappings ",""])),e).sendLogs("lid-migration-failed-to-save-mappings"),e}}),F.apply(this,arguments)}function O(){var e=G().state;return e===o("WAWebLid1X1ThreadAccountMigrations.flow").LidThreadMigrationStatus.READY||e===o("WAWebLid1X1ThreadAccountMigrations.flow").LidThreadMigrationStatus.IN_PROGRESS}function B(){return W.apply(this,arguments)}function W(){return W=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){new(o("WAWebLid11MigrationLifecycleWamEvent")).Lid11MigrationLifecycleWamEvent({migrationStage:o("WAWebWamEnumMigrationStageEnum").MIGRATION_STAGE_ENUM.COMPANION_LOCAL_MIGRATION_STARTED,mappingCount:o("WAWebLid1x1MigrationPrimaryCache").lidPnMigrationPrimaryCache.getAllPnLidMappings().length}).commit();try{if(!O()){o("WALogger").ERROR(C||(C=babelHelpers.taggedTemplateLiteralLoose(["[LID] migrate1x1Chats: migration is not ready"]))).sendLogs("lid-migration-not-ready");return}if(!o("WAWebABProps").getABPropConfigValue("lid_one_on_one_migration_compatible"))return yield new(o("WAWebLid11MigrationLifecycleWamEvent")).Lid11MigrationLifecycleWamEvent({migrationStage:o("WAWebWamEnumMigrationStageEnum").MIGRATION_STAGE_ENUM.COMPANION_LOCAL_MIGRATION_FAILED,stageFailureReason:o("WAWebWamEnumStageFailureReasonEnum").STAGE_FAILURE_REASON_ENUM.COMPANION_UNSUPPORTED_VERSION}).commitAndWaitForFlush(!0),o("WAWebSocketLogoutJob").socketLogout(o("WAWebLogoutReasonConstants").LogoutReason.LidMigrationCompanionIncompatibleKillswitch);o("WALogger").LOG(b||(b=babelHelpers.taggedTemplateLiteralLoose(["[Lid] 1x1ThreadMigration started"]))),V(o("WAWebLid1X1ThreadAccountMigrations.flow").LidThreadMigrationStatus.IN_PROGRESS);var e=G(),t=r("WANullthrows")(e==null?void 0:e.lidMappingsFromPrimaryMigration,"got empty mappings while in lid thread migration"),a=r("WANullthrows")(e==null?void 0:e.ts,"received empty sync timestamp while in lid thread migration");o("WALogger").DEV(v||(v=babelHelpers.taggedTemplateLiteralLoose(["[Lid] 1x1ThreadMigration Step 2: update cache with mappings"]))),yield o("WAWebLid1x1MigrationPrimaryCache").lidPnMigrationPrimaryCache.updateCacheIfEmpty(t,a);var i=[],l=0,s=0;o("WAWebCurrentUser").isEmployee()&&o("WALogger").LOG(S||(S=babelHelpers.taggedTemplateLiteralLoose(["[Lid] 1x1ThreadMigration Primary Mappings: ",""])),o("WAWebLid1x1MigrationPrimaryCache").lidPnMigrationPrimaryCache.getAllPnLidMappings().map(function(e){var t,n;return e.primaryProvidedPn.toString()+":"+e.primaryProvidedLid.toString()+":"+((t=(n=e.primaryProvidedLatestLid)==null?void 0:n.toString())!=null?t:"")}).join(", "));var u=null;if(yield o("WAWebModelStorageUtils").getStorage().lock(["chat","message","user-prefs"],(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e[0],c=e[1];o("WALogger").DEV(R||(R=babelHelpers.taggedTemplateLiteralLoose(["[Lid] 1x1ThreadMigration Step 3: db query to fetch migration candidates"])));var d=(yield t.all()).filter(function(e){var t=e.id,n=o("WAWebWidFactory").createWid(t);return n.isRegularUser()}),m=[],p=[],_=new Set(d.map(function(e){var t=e.id;return o("WAWebWidFactory").asUserWidOrThrow(o("WAWebWidFactory").createWid(t))})),f=d.map((function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t;if(u==null){var n=o("WAWebWidFactory").createWid(e.id),d=e.lidOriginType,f=o("WAWebLid1x1MigrationPrimaryCache").lidPnMigrationPrimaryCache.getAllPnLidMappings().some(function(e){var t=e.primaryProvidedLatestLid;return r("WAWebWid").equals(t,n)}),g=d===o("WAWebUsernameTypes").LidOriginType.PNH_CTWA&&f;if(n.isLid()){i.push({id:e.id,accountLid:n.toString(),lidOriginType:g?o("WAWebUsernameTypes").LidOriginType.GENERAL:d});return}var h=o("WAWebApiContact").getCurrentLid(o("WAWebWidFactory").asUserWidOrThrow(n));h==null&&s++;var y=h!=null?_.has(h):!1,C=o("WAWebLid1x1MigrationPrimaryCache").lidPnMigrationPrimaryCache.getLidForPn(n);r("WAWebWid").equals(h,C)||l++;var b=o("WALongInt").maybeNumber(o("WAWebLid1x1MigrationPrimaryCache").lidPnMigrationPrimaryCache.getPrimaryMigrationTsSec());b==null&&o("WALogger").ERROR(L||(L=babelHelpers.taggedTemplateLiteralLoose(["[LID] migrate1x1Chats: primaryMigrationTsSec is a too large number"]))).sendLogs("lid-migration-primary-ts-too-large");var v=yield q({mostRecentMsgTs:(t=e.t)!=null?t:0,isThreadExistsWithChatJid:y,primarySyncTs:b!=null?b:a,primaryProvidedLid:C,latestLocalLid:h,chat:e,MessageTable:c});if(v.deleteChat){m.push(e.id),p.push.apply(p,v.messagesToDelete);return}if(v.logoutReason!=null){u=v.logoutReason;return}i.push({id:e.id,accountLid:v.threadLid.toString(),lidOriginType:e.lidOriginType})}});return function(t){return e.apply(this,arguments)}})());if(yield(M||(M=n("Promise"))).all(f),u!=null){o("WALogger").DEV(E||(E=babelHelpers.taggedTemplateLiteralLoose(["[Lid] 1x1ThreadMigration Step 4: logout reason detected: ",""])),u);return}o("WALogger").DEV(k||(k=babelHelpers.taggedTemplateLiteralLoose(["[Lid] 1x1ThreadMigration Step 5: migrate chat table"]))),yield t.bulkCreateOrMerge(i),yield t.bulkRemove(m),yield c.bulkRemove(p),m.length>0&&o("WALogger").LOG(I||(I=babelHelpers.taggedTemplateLiteralLoose([""," chats deleted on migration instead of logging out"])),m.length).sendLogs("lid-migration-chats-deleted",{sampling:0}),o("WALogger").DEV(T||(T=babelHelpers.taggedTemplateLiteralLoose(["[Lid] 1x1ThreadMigration Step 6: mark migration as completed"]))),V(o("WAWebLid1X1ThreadAccountMigrations.flow").LidThreadMigrationStatus.COMPLETE),o("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.setIsLidMigrated(!0,o("WAWebUserPrefsTypes").LidMigrationSource.PEER,!1),o("WALogger").LOG(D||(D=babelHelpers.taggedTemplateLiteralLoose(["[Lid] 1x1ThreadMigration completed successfully"])))});return function(t){return e.apply(this,arguments)}})()),u)return yield new(o("WAWebLid11MigrationLifecycleWamEvent")).Lid11MigrationLifecycleWamEvent({migrationStage:o("WAWebWamEnumMigrationStageEnum").MIGRATION_STAGE_ENUM.COMPANION_LOCAL_MIGRATION_FAILED,stageFailureReason:o("WAWebWamEnumStageFailureReasonEnum").STAGE_FAILURE_REASON_ENUM.INITIATED_LOGOUT_BASED_ON_MAPPING}).commitAndWaitForFlush(!0),o("WALogger").ERROR(x||(x=babelHelpers.taggedTemplateLiteralLoose(["[LID] Failed to migrate 1x1 chats with reason: ",". Logging out"])),u).sendLogs("lid-migration-failed"),yield o("WAAsyncSleep").asyncSleep(5e3),o("WAWebSocketLogoutJob").socketLogout(u);yield o("WAWebLid1x1MigrationPrimaryCache").lidPnMigrationPrimaryCache.learnMappingsInBulk();var c=o("WAWebLid1x1MigrationPrimaryCache").lidPnMigrationPrimaryCache.getAllPnLidMappings().reduce(function(e,t){return e+(t.primaryProvidedLatestLid!=null?1:0)},0);new(o("WAWebLid11MigrationLifecycleWamEvent")).Lid11MigrationLifecycleWamEvent({migrationStage:o("WAWebWamEnumMigrationStageEnum").MIGRATION_STAGE_ENUM.COMPANION_LOCAL_MIGRATION_ENDED,mappingCount:o("WAWebLid1x1MigrationPrimaryCache").lidPnMigrationPrimaryCache.getAllPnLidMappings().length,migratedThreadCount:i.length,companionHasADifferentMappingCount:l,chatNotInMappingCount:s,latestMappingCount:c}).commit()}catch(e){return yield new(o("WAWebLid11MigrationLifecycleWamEvent")).Lid11MigrationLifecycleWamEvent({migrationStage:o("WAWebWamEnumMigrationStageEnum").MIGRATION_STAGE_ENUM.COMPANION_LOCAL_MIGRATION_FAILED,stageFailureReason:o("WAWebWamEnumStageFailureReasonEnum").STAGE_FAILURE_REASON_ENUM.INTERNAL_ERROR}).commitAndWaitForFlush(!0),o("WALogger").ERROR($||($=babelHelpers.taggedTemplateLiteralLoose(["[LID] Failed to migrate 1x1 chats: ",""])),e).sendLogs("lid-thread-migration"),o("WAWebSocketLogoutJob").socketLogout(o("WAWebLogoutReasonConstants").LogoutReason.LidMigrationOneOnOneThreadMigrationInternalError)}}),W.apply(this,arguments)}function q(e){return U.apply(this,arguments)}function U(){return U=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e.mostRecentMsgTs,n=e.isThreadExistsWithChatJid,r=e.primarySyncTs,a=e.primaryProvidedLid,i=e.latestLocalLid,l=e.chat,s=e.MessageTable;if(a==null){if(i==null){if(l){var u=yield j(l,s);if(u.result)return o("WALogger").LOG(P||(P=babelHelpers.taggedTemplateLiteralLoose(["[LID] chat can be deleted, deleting chat ",""])),l.id),{deleteChat:!0,messagesToDelete:u.messages.map(function(e){return e.id})};X(l,r,n,u.messages)}return{logoutReason:o("WAWebLogoutReasonConstants").LogoutReason.LidMigrationNoLidAvailiable}}return n?{logoutReason:o("WAWebLogoutReasonConstants").LogoutReason.LidMigrationSplitThreadMismatch}:{threadLid:i}}var c=o("WAWebABProps").getABPropConfigValue("lid_one_on_one_migration_log_out_on_mismatch");return c?i==null||i.equals(a)?(i==null&&o("WALogger").WARN(N||(N=babelHelpers.taggedTemplateLiteralLoose(["[LID] getResolvedThreadAccountLid: latestLocalLid is null"]))),{threadLid:a}):t>=r?{logoutReason:o("WAWebLogoutReasonConstants").LogoutReason.LidMigrationPrimaryMappingsObsolete}:{threadLid:a}:{threadLid:a}}),U.apply(this,arguments)}function V(t){o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[LID] setLidThreadMigrationProgress: ",""])),t);var n=o("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.get("WALidThreadAccountMigrationStatus"),r=babelHelpers.extends({},n,{state:t,ts:o("WATimeUtils").unixTime()});o("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.set("WALidThreadAccountMigrationStatus",r)}function H(e,t){return e==null?"unknown":t<e?"true":"false"}function G(){var e=o("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.get("WALidThreadAccountMigrationStatus");if(e==null){var t={state:o("WAWebLid1X1ThreadAccountMigrations.flow").LidThreadMigrationStatus.WAITING_PROP,ts:o("WATimeUtils").unixTime()};return o("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.set("WALidThreadAccountMigrationStatus",t),t}return e}function z(){if(!O()){o("WALogger").WARN(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[LID] scheduleLid1x1ThreadAccountMigrationJob: migration is not ready"])));return}o("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("scheduleLid1x1ThreadAccountMigration",n("asyncToGeneratorRuntime").asyncToGenerator(function*(){o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["[LID] refreshing the page to start 1x1 lid thread migration"]))),o("WAWebOfflineResumeUtils").refreshWindow()}),{priority:o("WAJobOrchestratorTypes").JOB_PRIORITY.BEST_EFFORT}).fireAndForget()}function j(e,t){return K.apply(this,arguments)}function K(){return K=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=o("WAWebWidFactory").createWid(e.id),r=yield t.between(["internalId"],o("WAWebDBMessageUtils").beginningOfChat(n),o("WAWebDBMessageUtils").endOfChat(n),{lowerInclusive:!0,upperInclusive:!0,shouldDecrypt:!1});return e.createdLocally!==!0?{result:!1,messages:r}:e.ephemeralDuration!=null||e.ephemeralSettingTimestamp!=null||e.isLocked||e.archive||e.muteExpiration?{result:!1,messages:r}:r.every(Q)?{result:!0,messages:r}:{result:!1,messages:r}}),K.apply(this,arguments)}function Q(e){var t=o("WAWebDBMessageSerialization").messageFromDbRow(e);return o("WAWebMsgGetters").getIsInitialE2ENotification(t)}function X(e,t,n,r){var a=o("WAWebUserPrefsMultiDevice").getPairingTimestamp(),i=Y(r),l=i.oldestMessageTs,s=i.newestMessageTs,u=i.count,d=H(a,l),m=e.t,p=J(m),_=J(t),f=J(a),g=e.createdLocally===!0,h=J(l),y=J(s),C={chatT:p,fromHistSync:d,primarySyncT:_,threadExist:n,pairingT:f,oldestMessageT:h,newestMessageT:y,messagesCount:u};r.length<=4&&(C.messages=r.map(function(e){return{type:e.type,subtype:e.subtype}})),o("WALogger").ERROR(c||(c=babelHelpers.taggedTemplateLiteralLoose(["[LID] no lid available for chat ",", ",""])),e.id,JSON.stringify(C)).sendLogs(g?"lid-migration-no-lid-available-created-locally":"lid-migration-no-lid-available")}function Y(e){var t=Math.min.apply(Math,e.map(function(e){return e.t})),n=Math.max.apply(Math,e.map(function(e){return e.t})),r=e.length;return{oldestMessageTs:t,newestMessageTs:n,count:r}}function J(e){return e==null?null:o("WATimeUtils").toHttpHeaderDate(o("WATimeUtils").castToUnixTime(e))}l.checkIfMigrationEnabled=w,l.setLidMigrationMappings=A,l.shouldMigrateNow=O,l.migrate1x1Chats=B,l.getResolvedThreadAccountLid=q,l.getLidThreadMigrationStatus=G}),98);
__d("WAWebLogMissingGroupParticipantMappings",["WALogger","WAWebApiContact","WAWebGroupsParticipantsApi","WAWebIsCagGroupCache","WAWebWidFactory","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){"use strict";var e;function s(e,t,n,r){return u.apply(this,arguments)}function u(){return u=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,n,a,i){if(!(!t.isGroup()||r("WAWebIsCagGroupCache").isCag(t)||n.isBot())){var l=o("WAWebWidFactory").asUserWidOrThrow(n);if(o("WAWebApiContact").getAlternateUserWid(l)==null){var s=yield o("WAWebGroupsParticipantsApi").getParticipants(t);s==null||s.participants.includes(l.toString())||o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["participant missing mapping, addressing mode mismatch = ",""])),String(i!==a)).sendLogs("GroupLidInfra/incoming_group_message_unknown",{sampling:.01})}}}),u.apply(this,arguments)}l.logMissingGroupParticipantMappings=s}),98);
__d("WAWebWamEnumChatGatedReason",[],(function(t,n,r,o,a,i){var e=Object.freeze({TOS3:1,COUNTRY:2});i.CHAT_GATED_REASON=e}),66);
__d("WAWebGatedMessageReceivedWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumChatGatedReason"],(function(t,n,r,o,a,i,l){var e=o("WAWebWamCodegenUtils").defineEvents({GatedMessageReceived:[3152,{chatGatedReason:[1,o("WAWebWamEnumChatGatedReason").CHAT_GATED_REASON]},[1,1,1],"regular"]},{GatedMessageReceived:[]});l.GatedMessageReceivedWamEvent=e}),98);
__d("WAWebWamEnumPairedMediaType",[],(function(t,n,r,o,a,i){var e=Object.freeze({SD_PHOTO:0,HD_PHOTO:1,SD_VIDEO:2,HD_VIDEO:3,MOTION_PHOTO_PARENT:4,MOTION_PHOTO_CHILD:5,HEVC_VIDEO_PARENT:6,HEVC_VIDEO_CHILD:7});i.PAIRED_MEDIA_TYPE=e}),66);
__d("WAWebWamEnumPrivateAiFeatureName",[],(function(t,n,r,o,a,i){var e=Object.freeze({SUMMARIZATION:0,WRITE_WITH_AI:1,PSI:2,QUICK_RECAP:3,INCONGNITO:4,SIDE_CHAT:5,GROUP_AI:6,PSI_SEARCH:7});i.PRIVATE_AI_FEATURE_NAME=e}),66);
__d("WAWebWamEnumStickerMakerSourceType",[],(function(t,n,r,o,a,i){var e=Object.freeze({CUTOUT_IMAGE:1,WEB_STICKER_MAKER:2,IOS_STICKER_MAKER:3,ANDROID_STICKER_MAKER:4,TRANSPARENT_IMAGE:5,GIF:6});i.STICKER_MAKER_SOURCE_TYPE=e}),66);
__d("WAWebMessageReceiveWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumAddressingMode","WAWebWamEnumAgentEngagementEnumType","WAWebWamEnumBotType","WAWebWamEnumChatOriginsType","WAWebWamEnumDisappearingChatInitiatorType","WAWebWamEnumEditType","WAWebWamEnumEncryptionTypeCode","WAWebWamEnumEphemeralityInitiatorType","WAWebWamEnumEphemeralityTriggerActionType","WAWebWamEnumInvisibleMessageCategoryType","WAWebWamEnumMediaType","WAWebWamEnumMessageType","WAWebWamEnumOppositeVisibleIdentificationType","WAWebWamEnumPairedMediaType","WAWebWamEnumPrivateAiFeatureName","WAWebWamEnumRevokeType","WAWebWamEnumSizeBucket","WAWebWamEnumStickerMakerSourceType","WAWebWamEnumTypeOfGroupEnum"],(function(t,n,r,o,a,i,l){var e,s=(e=o("WAWebWamCodegenUtils")).defineEvents({MessageReceive:[450,{agentEngagementType:[28,o("WAWebWamEnumAgentEngagementEnumType").AGENT_ENGAGEMENT_ENUM_TYPE],appContext:[43,e.TYPES.STRING],appContextBitfield:[44,e.TYPES.INTEGER],botType:[37,o("WAWebWamEnumBotType").BOT_TYPE],chatOrigins:[38,o("WAWebWamEnumChatOriginsType").CHAT_ORIGINS_TYPE],deviceCount:[16,e.TYPES.INTEGER],deviceSizeBucket:[10,o("WAWebWamEnumSizeBucket").SIZE_BUCKET],disappearingChatInitiator:[14,o("WAWebWamEnumDisappearingChatInitiatorType").DISAPPEARING_CHAT_INITIATOR_TYPE],editType:[25,o("WAWebWamEnumEditType").EDIT_TYPE],encryptionType:[54,o("WAWebWamEnumEncryptionTypeCode").ENCRYPTION_TYPE_CODE],ephemeralityDuration:[13,e.TYPES.INTEGER],ephemeralityInitiator:[26,o("WAWebWamEnumEphemeralityInitiatorType").EPHEMERALITY_INITIATOR_TYPE],ephemeralityTriggerAction:[27,o("WAWebWamEnumEphemeralityTriggerActionType").EPHEMERALITY_TRIGGER_ACTION_TYPE],hasUsername:[39,e.TYPES.BOOLEAN],hasUsernamePin:[45,e.TYPES.BOOLEAN],invisibleMessageCategory:[41,o("WAWebWamEnumInvisibleMessageCategoryType").INVISIBLE_MESSAGE_CATEGORY_TYPE],isAComment:[36,e.TYPES.BOOLEAN],isAReply:[19,e.TYPES.BOOLEAN],isForwardedForward:[18,e.TYPES.BOOLEAN],isLid:[24,e.TYPES.BOOLEAN],isPq:[55,e.TYPES.BOOLEAN],isViewOnce:[9,e.TYPES.BOOLEAN],localAddressingMode:[33,o("WAWebWamEnumAddressingMode").ADDRESSING_MODE],messageAddressingMode:[34,o("WAWebWamEnumAddressingMode").ADDRESSING_MODE],messageIsInternational:[4,e.TYPES.BOOLEAN],messageIsInvisible:[23,e.TYPES.BOOLEAN],messageIsOffline:[5,e.TYPES.BOOLEAN],messageMediaType:[2,o("WAWebWamEnumMediaType").MEDIA_TYPE],messageQueueTime:[15,e.TYPES.TIMER],messageReceiveT0:[6,e.TYPES.TIMER],messageReceiveT1:[7,e.TYPES.TIMER],messageReceiveT2:[49,e.TYPES.TIMER],messageType:[1,o("WAWebWamEnumMessageType").MESSAGE_TYPE],mutedGroupMessage:[8,e.TYPES.BOOLEAN],numOfWebUrlsInTextMessage:[3,e.TYPES.INTEGER],offlineCount:[30,e.TYPES.INTEGER],oppositeVisibleIdentification:[40,o("WAWebWamEnumOppositeVisibleIdentificationType").OPPOSITE_VISIBLE_IDENTIFICATION_TYPE],paddingBytesSize:[22,e.TYPES.INTEGER],pairedMediaType:[42,o("WAWebWamEnumPairedMediaType").PAIRED_MEDIA_TYPE],participantCount:[17,e.TYPES.INTEGER],privateAiFeatureName:[53,o("WAWebWamEnumPrivateAiFeatureName").PRIVATE_AI_FEATURE_NAME],processingDeferred:[47,e.TYPES.BOOLEAN],receivedPhoneNumberContactSize:[50,e.TYPES.INTEGER],receivedPhoneNumberWithUsernameContactSize:[51,e.TYPES.INTEGER],receivedUsernameContactSize:[52,e.TYPES.INTEGER],receiverDefaultDisappearingDuration:[12,e.TYPES.INTEGER],revokeType:[20,o("WAWebWamEnumRevokeType").REVOKE_TYPE],senderDefaultDisappearingDuration:[11,e.TYPES.INTEGER],serverAddressingMode:[35,o("WAWebWamEnumAddressingMode").ADDRESSING_MODE],stanzaProcessCount:[48,e.TYPES.INTEGER],stickerIsAi:[29,e.TYPES.BOOLEAN],stickerIsFromStickerMaker:[31,e.TYPES.BOOLEAN],stickerMakerSourceType:[32,o("WAWebWamEnumStickerMakerSourceType").STICKER_MAKER_SOURCE_TYPE],typeOfGroup:[21,o("WAWebWamEnumTypeOfGroupEnum").TYPE_OF_GROUP_ENUM]},[1,1,5],"regular"]},{MessageReceive:[]});l.MessageReceiveWamEvent=s}),98);
__d("WAWebLogReceivedMessages",["PaymentLinkWamLogger","Promise","WALogger","WATimeUtils","WAWebABProps","WAWebAddonProcessMsgsUtils","WAWebApiChat","WAWebBackendApi","WAWebChatThreadLogging","WAWebChatThreadLoggingUtils","WAWebDBMsgUtils","WAWebDBProcessReplyMsgs","WAWebEphemeralityResolver","WAWebGalaxyFlowWamLoggerUtils","WAWebGatedMessageReceivedWamEvent","WAWebLidAwareContactsDB","WAWebLidMigrationUtils","WAWebMessageReceiveWamEvent","WAWebMsgGetters","WAWebMsgType","WAWebRuntimeEnvironmentUtils","WAWebUserPrefsMeUser","WAWebUsernameTypes","WAWebWamAddressingModeUtils","WAWebWamEnumChatGatedReason","WAWebWamEnumChatOriginsType","WAWebWamEnumRevokeType","WAWebWamGroupMetadataMetricUtils","WAWebWamGroupMetricCache","WAWebWamMsgUtils","WAWebWidFactory","WAWebWorkerSafeBackendApi","asyncToGeneratorRuntime","justknobx"],(function(t,n,r,o,a,i,l){var e,s,u,c,d="\uD83D\uDC9A";function m(e){return p.apply(this,arguments)}function p(){return p=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){yield(c||(c=n("Promise"))).all(e.map((function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){o("PaymentLinkWamLogger").shouldLogReceiverEvent(e)&&(yield o("PaymentLinkWamLogger").genLogReceiveEvent({interaction_component:null,msg:e},e.matchedText).catch(function(e){o("WALogger").WARN(s||(s=babelHelpers.taggedTemplateLiteralLoose(["error logging payment link message receive: ",""])),e)}))});return function(t){return e.apply(this,arguments)}})()))}),p.apply(this,arguments)}function _(e,t,n){return f.apply(this,arguments)}function f(){return f=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,r){var a,i=e.msgs,l=e.offline,s=e.tsMillis,u=e.clientReceivedTsMillis,d=e.msgProcessStartTsMillis,m=e.serverAddressingMode,p=e.localAddressingMode,_=o("WATimeUtils").unixTimeMs(),f=yield(c||(c=n("Promise"))).all([o("WAWebChatThreadLoggingUtils").getMeHasUsername(),o("WAWebChatThreadLoggingUtils").getMeHasUsernamePin()]),g=f[0],h=f[1],y=(a=r.get(o("WAWebUserPrefsMeUser").getMePnUserOrThrow().toJid()))==null?void 0:a.ephemeralDuration;yield c.all(i.map((function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,n){var a=e.from;if(a!=null){var i=o("WAWebWamEnumChatOriginsType").CHAT_ORIGINS_TYPE.OTHERS;a.isLid()&&(i=o("WAWebWamEnumChatOriginsType").CHAT_ORIGINS_TYPE.LID_CTWA);var c=t[n];if(c!=null&&c.lidOriginType)switch(c.lidOriginType){case o("WAWebUsernameTypes").LidOriginType.PNH_CTWA:i=o("WAWebWamEnumChatOriginsType").CHAT_ORIGINS_TYPE.LID_CTWA;break;case o("WAWebUsernameTypes").LidOriginType.GENERAL:i=o("WAWebWamEnumChatOriginsType").CHAT_ORIGINS_TYPE.OTHERS;break}var f=yield o("WAWebChatThreadLoggingUtils").getOppositeVisibleIdentification(a),C=a.isGroup()?e.from.isLid():o("WAWebWamMsgUtils").msgIsLid(e,a),b=new(o("WAWebMessageReceiveWamEvent")).MessageReceiveWamEvent({messageType:o("WAWebWamMsgUtils").getWamMessageType(e),messageMediaType:o("WAWebWamMsgUtils").getWamMediaType(e),messageIsInternational:o("WAWebMsgGetters").getIsInternational(e),messageIsOffline:l!=null,isViewOnce:!!e.isViewOnce,isForwardedForward:o("WAWebMsgGetters").getNumTimesForwarded(e)>1,isAReply:o("WAWebMsgGetters").getIsReply(e),editType:o("WAWebMsgGetters").getWamEditType(e),botType:o("WAWebWamMsgUtils").getWamBotType(a,e.bizBotType),isAComment:o("WAWebMsgGetters").getType(e)===o("WAWebMsgType").MSG_TYPE.COMMENT,hasUsername:g,hasUsernamePin:h,chatOrigins:i,oppositeVisibleIdentification:f!=null?f:void 0,isLid:C,messageReceiveT0:0,messageReceiveT1:0,messageReceiveT2:0});if(l!=null&&(b.offlineCount=l),!a.isGroup()&&!a.isStatus()){var v,S=(v=r.get(a.toJid()))==null?void 0:v.ephemeralDuration;S!=null&&(b.senderDefaultDisappearingDuration=S),y!=null&&(b.receiverDefaultDisappearingDuration=y),b.isLid=a.isLid()}o("WAWebMsgGetters").getIsRevoke(e)&&(b.revokeType=e.subtype==="admin_revoke"?o("WAWebWamEnumRevokeType").REVOKE_TYPE.ADMIN:o("WAWebWamEnumRevokeType").REVOKE_TYPE.SENDER),u!=null&&(b.messageReceiveT0=u-s,b.messageReceiveT1=_-u,d!=null&&(b.messageQueueTime=d-u)),e.ephemeralDuration!=null&&e.ephemeralDuration>0&&(b.ephemeralityDuration=e.ephemeralDuration);var R=o("WAWebMsgGetters").getWamDisappearingModeInitiator(e);if(R!=null&&(b.disappearingChatInitiator=R),o("WAWebABProps").getABPropConfigValue("dm_initiator_trigger")){var L=o("WAWebMsgGetters").getWamDisappearingModeTrigger(e);L!=null&&(b.ephemeralityTriggerAction=L);var E=o("WAWebMsgGetters").getWamDisappearingModeInitiatedByMe(e);E!=null&&(b.ephemeralityInitiator=E)}var k=o("WAWebWamMsgUtils").getWamAgentEngagementType(e);k!=null&&(b.agentEngagementType=k);var I=yield o("WAWebWamGroupMetadataMetricUtils").getGroupTypeFromChatWid(a);if(I!=null&&(b.typeOfGroup=I),m!=null&&(b.serverAddressingMode=o("WAWebWamAddressingModeUtils").getWamAddressingModeFromString(m)),p!=null&&(b.localAddressingMode=o("WAWebWamAddressingModeUtils").getWamAddressingModeFromString(p)),a!=null&&a.isGroup()){var T=yield o("WAWebWamGroupMetadataMetricUtils").isCagFromChatWid(a),D=o("WAWebMsgGetters").getIsReaction(e);T!=null&&D!=null&&(b.isLid=T&&D);var x=yield o("WAWebWamGroupMetricCache").getGroupMetrics(a);(x==null?void 0:x.participantCount)!=null&&(b.participantCount=x.participantCount),(x==null?void 0:x.deviceCount)!=null&&(b.deviceCount=x.deviceCount),(x==null?void 0:x.deviceSizeBucket)!=null&&(b.deviceSizeBucket=x.deviceSizeBucket)}b.commit()}});return function(t,n){return e.apply(this,arguments)}})()))}),f.apply(this,arguments)}function g(e){return h.apply(this,arguments)}function h(){return h=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["getContactData"])));var t=new Set(e.filter(function(e){return e.id.remote.isUser()}).map(function(e){return e.id.remote.toJid()}));t.add(o("WAWebUserPrefsMeUser").getMePnUserOrThrow().toJid());var n=Array.from(t),a;return o("WAWebRuntimeEnvironmentUtils").isWorker()?(a=yield r("WAWebLidAwareContactsDB").bulkGet(n),new Map(a.map(function(e,t){return[n[t],{ephemeralDuration:o("WAWebEphemeralityResolver").getEphemeralDurationForUser(e),shouldBlockByCountry:function(){return!1},shouldBlockByTos:function(){return!1}}]}))):o("WAWebWorkerSafeBackendApi").workerSafeSendAndReceive("getContactData",{ids:n.map(o("WAWebWidFactory").createWid)})}),h.apply(this,arguments)}function y(e){return C.apply(this,arguments)}function C(){return C=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){return o("WAWebApiChat").bulkGetChats(e.map(function(e){return e.from}))}),C.apply(this,arguments)}function b(e){return v.apply(this,arguments)}function v(){return v=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=yield(c||(c=n("Promise"))).all([y(e),g(e)]),r=t[0],o=t[1];return{chatData:r,contactData:o}}),v.apply(this,arguments)}function S(e,t){for(var n of e){var r=t.get(n.id.remote.toJid());r&&!o("WAWebMsgGetters").getIsSentByMe(n)&&(r.shouldBlockByCountry()?new(o("WAWebGatedMessageReceivedWamEvent")).GatedMessageReceivedWamEvent({chatGatedReason:o("WAWebWamEnumChatGatedReason").CHAT_GATED_REASON.COUNTRY}).commit():r.shouldBlockByTos()&&new(o("WAWebGatedMessageReceivedWamEvent")).GatedMessageReceivedWamEvent({chatGatedReason:o("WAWebWamEnumChatGatedReason").CHAT_GATED_REASON.TOS3}).commit())}}function R(e){return o("WAWebMsgGetters").getIsReaction(e)?o("WAWebAddonProcessMsgsUtils").getParentMsgKey(e):o("WAWebDBProcessReplyMsgs").createQuotedMsgKey(e)}function L(e){return E.apply(this,arguments)}function E(){return E=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t,n=(t=o("WAWebLidMigrationUtils").getAlternateMsgKey(e))==null?void 0:t.toString();if(n!=null)return o("WAWebDBMsgUtils").getMsgByMsgKey(n)}),E.apply(this,arguments)}function k(e){return I.apply(this,arguments)}function I(){return I=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){if(o("WAWebMsgGetters").getType(e)===o("WAWebMsgType").MSG_TYPE.COMMENT){var t;return{activityType:"commentsReceived",ts:(t=e.t)!=null?t:o("WATimeUtils").unixTimeMs(),chatId:e.id.remote}}if(r("justknobx")._("2641")&&o("WAWebABProps").getABPropConfigValue("group_status_receiver_enabled")){var n=R(e);if(n!=="missing-stanza-id"){var a=yield o("WAWebDBMsgUtils").getMsgByMsgKey(n);if(o("WAWebMsgGetters").getIsReply(e)&&a==null&&(a=yield L(n)),a!=null&&o("WAWebMsgGetters").getIsGroupStatus(a)){var i=o("WAWebMsgGetters").getIsReply(e),l=o("WAWebMsgGetters").getIsReaction(e)&&e.reactionText===d;if(i||l){var s=o("WAWebMsgGetters").getIsSentByMe(a);return{activityType:"groupStatusMsgReceive",chatId:e.id.remote,ts:e.t,isGroupStatusReplyOthersToOwn:i&&s,isGroupStatusReplyOthersToOthers:i&&!s,isGroupStatusLikeOthersToOwn:l&&s,isGroupStatusLikeOthersToOthers:l&&!s}}}}}return{activityType:e.id.fromMe?"msgSend":"msgReceive",ts:e.t,chatId:e.id.remote,isViewOnce:e.isViewOnce===!0,isReaction:o("WAWebMsgGetters").getIsReaction(e),isForwarded:e.isForwarded===!0,isCommerceMessage:o("WAWebChatThreadLoggingUtils").isCommerceMessage(e),isReply:o("WAWebMsgGetters").getIsReply(e),isEdit:o("WAWebMsgGetters").getIsEditProtocolMsg(e),isBot:o("WAWebMsgGetters").getIsBotQuery(e)||o("WAWebMsgGetters").getIsMetaBotResponse(e),isEventCreation:e.type===o("WAWebMsgType").MSG_TYPE.EVENT_CREATION,isEventResponse:e.type===o("WAWebMsgType").MSG_TYPE.EVENT_RESPONSE}}),I.apply(this,arguments)}function T(e){(c||(c=n("Promise"))).all(e.filter(o("WAWebChatThreadLoggingUtils").shouldIncrementMsgSendAndReceive).map(k)).then(o("WAWebChatThreadLogging").handleActivitiesForChatThreadLogging)}function D(e){e.filter(o("WAWebMsgGetters").getIsAuthenticationMessage).forEach(function(e){o("WAWebBackendApi").frontendFireAndForget("logOTPMessageReceivedActions",{msgData:e})})}function x(t){var r=t.msgs;b(r).then(function(e){return(c||(c=n("Promise"))).all([_(t,e.chatData,e.contactData),S(r,e.contactData),T(r),D(r),m(r),o("WAWebGalaxyFlowWamLoggerUtils").logStructuredMessageReceivedWAMEvent(r)])}).catch(function(t){o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["error logging received messages: ",""])),t)})}l.logReceivedMessagesInWAM=x}),98);
__d("WAWebMessageDestinationChat",["WALogger","WAWebLid1X1MigrationGating","WAWebWidFactory","err"],(function(t,n,r,o,a,i,l){var e;function s(t){var n=t.chat,a=t.msg,i=t.msgInfo;if(n.isRegularUser()){if(o("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.isLidMigrated()){var l=o("WAWebWidFactory").asUserWidOrThrow(a.id.remote);if(l.isLid())return{chatId:l,accountLid:l};var s=i.accountLid;if(s==null)throw o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["determineDestinationChatForIncomingMessage: accountLid is null for incoming message (LID migrated)"]))).sendLogs("determineDestinationChatForIncomingMessage-account-lid-null"),r("err")("determineDestinationChatForIncomingMessage: accountLid is null for incoming message (LID migrated)");return{chatId:l,accountLid:s}}var u=!o("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.isLidMigrated()&&n.isLid();if(u)return{chatId:a.id.remote}}return{chatId:n}}l.determineDestinationChatForIncomingMessage=s}),98);
__d("WAWebWamEnumOfflineProcessRunReasons",[],(function(t,n,r,o,a,i){var e=Object.freeze({PUSH_NOTIFICATION:1,PERIODIC_BACKGROUND_SYNC:2});i.OFFLINE_PROCESS_RUN_REASONS=e}),66);
__d("WAWebWamEnumOfflineProcessStages",[],(function(t,n,r,o,a,i){var e=Object.freeze({PAGE_LOAD:1,SOCKET_CONNECT:2,OFFLINE_PREVIEW:3,PROCESSING:4,PROCESS_COMPLETE:5,PROCESS_INTERRUPTED:6});i.OFFLINE_PROCESS_STAGES=e}),66);
__d("WAWebWebcOfflineNotificationProcessWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumOfflineProcessRunReasons","WAWebWamEnumOfflineProcessStages"],(function(t,n,r,o,a,i,l){var e,s=(e=o("WAWebWamCodegenUtils")).defineEvents({WebcOfflineNotificationProcess:[4222,{currentOfflineProcessStage:[4,o("WAWebWamEnumOfflineProcessStages").OFFLINE_PROCESS_STAGES],offlineProcessDecryptErrorCount:[5,e.TYPES.INTEGER],offlineProcessMailboxAge:[6,e.TYPES.INTEGER],offlineProcessMessageCount:[7,e.TYPES.INTEGER],offlineProcessNotificationCount:[8,e.TYPES.INTEGER],offlineProcessSessionId:[9,e.TYPES.STRING],offlineProcessStageTimestampMs:[10,e.TYPES.INTEGER],runReason:[12,o("WAWebWamEnumOfflineProcessRunReasons").OFFLINE_PROCESS_RUN_REASONS],swVersion:[11,e.TYPES.STRING]},[1,1,1],"regular"]},{WebcOfflineNotificationProcess:[]});l.WebcOfflineNotificationProcessWamEvent=s}),98);
__d("WAWebWamWorkerOfflineProcessReporter",["WALogger","WARandomHex","WAShiftTimer","WATimeUtils","WAWebBuildConstants","WAWebRuntimeEnvironmentUtils","WAWebUserPrefsGeneral","WAWebUserPrefsMultiDevice","WAWebWamEnumOfflineProcessRunReasons","WAWebWamEnumOfflineProcessStages","WAWebWamOfflineResumeReporter","WAWebWebcOfflineNotificationProcessWamEvent","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u,c=1e4,d=12e4,m=(function(){function t(){this.$8=null,this.$1=this.$13(),this.$2=o("WAWebWamEnumOfflineProcessRunReasons").OFFLINE_PROCESS_RUN_REASONS.PUSH_NOTIFICATION,this.pageLoadT=self.performance.now(),this.$3=0,this.$4=0,this.$5=0,this.$6=0,this.$7=0,this.$9=0,this.$10=0,this.$11=0}var r=t.prototype;return r.$13=function(){return""+o("WARandomHex").randomHex(4)+o("WATimeUtils").unixTimeWithoutClockSkewCorrection()},r.$14=function(t,n){var e=new(o("WAWebWebcOfflineNotificationProcessWamEvent")).WebcOfflineNotificationProcessWamEvent({offlineProcessSessionId:this.$1,offlineProcessStageTimestampMs:n,currentOfflineProcessStage:t,swVersion:o("WAWebBuildConstants").VERSION_BASE,runReason:this.$2});(t===o("WAWebWamEnumOfflineProcessStages").OFFLINE_PROCESS_STAGES.PROCESSING||t===o("WAWebWamEnumOfflineProcessStages").OFFLINE_PROCESS_STAGES.PROCESS_COMPLETE||t===o("WAWebWamEnumOfflineProcessStages").OFFLINE_PROCESS_STAGES.PROCESS_INTERRUPTED)&&this.$15(e),t===o("WAWebWamEnumOfflineProcessStages").OFFLINE_PROCESS_STAGES.PROCESS_COMPLETE||t===o("WAWebWamEnumOfflineProcessStages").OFFLINE_PROCESS_STAGES.PROCESS_INTERRUPTED?e.commitAndWaitForFlush(!0):e.commit()},r.$15=function(t){var e,n,r,a;t.offlineProcessMessageCount=o("WAWebWamOfflineResumeReporter").roundUp((e=this.$10)!=null?e:0,10),t.offlineProcessNotificationCount=o("WAWebWamOfflineResumeReporter").roundUp((n=this.$11)!=null?n:0,10),t.offlineProcessMailboxAge=o("WAWebWamOfflineResumeReporter").countDays((r=this.$7)!=null?r:0),t.offlineProcessDecryptErrorCount=(a=this.$9)!=null?a:0},r.$16=function(){var t=this;this.$8==null&&(this.$8=new(o("WAShiftTimer")).ShiftTimer(function(){if(t.$12===o("WAWebWamEnumOfflineProcessStages").OFFLINE_PROCESS_STAGES.PROCESSING){var n=Math.floor(self.performance.now()-t.pageLoadT);if(o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[offline-resume][worker] worker offline processing progress updates\n          ======= worker offline processing update ========\n          ProcessedMessage: ","\n          ProcessedNotification: ","\n          currentProcessingT: ","\n          =================================================\n         "])),t.$10,t.$11,n),n>d){o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose([" [offline-resume][worker] worker offline processing takes too long"]))).sendLogs("worker-offline-process-takes-too-long");return}t.$14(o("WAWebWamEnumOfflineProcessStages").OFFLINE_PROCESS_STAGES.PROCESSING,n),t.$16()}})),this.$8.onOrAfter(c)},r.$17=function(){var e;this.$12=o("WAWebWamEnumOfflineProcessStages").OFFLINE_PROCESS_STAGES.PROCESSING,(e=this.$8)==null||e.cancel(),this.$16()},r.$18=function(t){t===void 0&&(t=-1),o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["[offline-resume][worker] worker offline processing ends\n        ========= worker offline processing perf ==========\n        message: ","\n        receipt: ","\n        notification: ","\n        call: ","\n        ProcessedMessage: ","\n        ProcessedNotification: ","\n        decryptError: ","\n        pageLoadT: 0\n        socketConnectT: ","\n        offlinePreviewT: ","\n        processCompleteT: ","\n        mailboxAge: ","\n        isInterrupted: ","\n        runReason: ","\n        ===================================================\n        "])),this.$3,this.$4,this.$5,this.$6,this.$10,this.$11,this.$9,this.socketConnectT,this.offlinePreviewT,this.processCompleteT,t,this.$12===o("WAWebWamEnumOfflineProcessStages").OFFLINE_PROCESS_STAGES.PROCESS_INTERRUPTED,this.$2)},r.getCurrentStage=function(){return this.$12},r.updateOldestStanzaTime=function(t){(this.$7==null||this.$7>t)&&(this.$7=t)},r.updateOfflineCount=function(t){this.$3=t.message,this.$4=t.receipt,this.$5=t.notification,this.$6=t.call},r.updateOfflineDecryptionErrorCount=function(t){this.$9=t},r.updateProcessedMessageCount=function(){o("WAWebRuntimeEnvironmentUtils").isWorker()&&(this.$10+=1)},r.updateProcessedNotificationCount=function(){o("WAWebRuntimeEnvironmentUtils").isWorker()&&(this.$11+=1)},r.logWorkerInitialized=function(t){this.$12=o("WAWebWamEnumOfflineProcessStages").OFFLINE_PROCESS_STAGES.PAGE_LOAD,this.$2=t,this.$14(o("WAWebWamEnumOfflineProcessStages").OFFLINE_PROCESS_STAGES.PAGE_LOAD,0)},r.logSocketConnect=function(){this.$12=o("WAWebWamEnumOfflineProcessStages").OFFLINE_PROCESS_STAGES.SOCKET_CONNECT;var e=Math.floor(self.performance.now()-this.pageLoadT);this.socketConnectT=e,this.$14(o("WAWebWamEnumOfflineProcessStages").OFFLINE_PROCESS_STAGES.SOCKET_CONNECT,e)},r.logOfflinePreview=function(){this.$12=o("WAWebWamEnumOfflineProcessStages").OFFLINE_PROCESS_STAGES.OFFLINE_PREVIEW;var e=Math.floor(self.performance.now()-this.pageLoadT);this.offlinePreviewT=e,this.$14(o("WAWebWamEnumOfflineProcessStages").OFFLINE_PROCESS_STAGES.OFFLINE_PREVIEW,e),this.$17()},r.logProcessComplete=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e;if(!(this.$12===o("WAWebWamEnumOfflineProcessStages").OFFLINE_PROCESS_STAGES.PROCESS_COMPLETE||this.$12===o("WAWebWamEnumOfflineProcessStages").OFFLINE_PROCESS_STAGES.PROCESS_INTERRUPTED)){this.$12=o("WAWebWamEnumOfflineProcessStages").OFFLINE_PROCESS_STAGES.PROCESS_COMPLETE,(e=this.$8)==null||e.cancel(),this.$8=null;var t=o("WAWebWamOfflineResumeReporter").countDays(this.$7);yield o("WAWebUserPrefsMultiDevice").setRecentMailboxAgeDays(t);var n=Math.floor(self.performance.now()-this.pageLoadT);this.processCompleteT=n,this.$18(t),this.$14(o("WAWebWamEnumOfflineProcessStages").OFFLINE_PROCESS_STAGES.PROCESS_COMPLETE,n),o("WAWebUserPrefsGeneral").setLastPushCompleteTimestamp(o("WATimeUtils").unixTimeMs())}});function t(){return e.apply(this,arguments)}return t})(),r.logProcessInterrupted=function(){var e;if(!(this.$12==null||this.$12===o("WAWebWamEnumOfflineProcessStages").OFFLINE_PROCESS_STAGES.PROCESS_COMPLETE||this.$12===o("WAWebWamEnumOfflineProcessStages").OFFLINE_PROCESS_STAGES.PROCESS_INTERRUPTED)){this.$12=o("WAWebWamEnumOfflineProcessStages").OFFLINE_PROCESS_STAGES.PROCESS_INTERRUPTED,(e=this.$8)==null||e.cancel(),this.$8=null;var t=Math.floor(self.performance.now()-this.pageLoadT);this.processCompleteT=t,this.$18(),this.$14(o("WAWebWamEnumOfflineProcessStages").OFFLINE_PROCESS_STAGES.PROCESS_INTERRUPTED,t)}},t})(),p=new m;l.WorkerOfflineResumeReporter=p}),98);
__d("WAWebMessageProcessPlaceholder",["Promise","WALogger","WANullthrows","WAWebAck","WAWebAdvHostedAccountTypeSystemMsg","WAWebApiDeviceList","WAWebBackendApi","WAWebBizCoexGatingUtils","WAWebBizCoexUtils","WAWebCheckChatExistsOrCreate","WAWebCmd","WAWebDBProcessMessage","WAWebHandleMsgCommon","WAWebHandleMsgTypes.flow","WAWebMessageDestinationChat","WAWebMessageProcessorCache","WAWebMsgProcessingApiUtils","WAWebMsgType","WAWebProtobufsAdv.pb","WAWebUserPrefsMultiDevice","WAWebWamWorkerOfflineProcessReporter","WAWebWidFactory","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u,c,d;function m(e){return p.apply(this,arguments)}function p(){return p=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var a=t.msgInfo,i=a.chat;if(a.category===o("WAWebHandleMsgCommon").CATEGORY_PEER){o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["processPlaceHolderMessage: msgId:",", skip placeholder for peer message"])),a.externalId).tags("messaging");return}var l=a.offline!=null;try{var m=[];if(o("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()&&i.isUser()&&(t.placeholderType===o("WAWebHandleMsgTypes.flow").PlaceholderType.E2E||t.placeholderType===o("WAWebHandleMsgTypes.flow").PlaceholderType.FANOUT)){var p,_=o("WAWebUserPrefsMultiDevice").getHaveProcessedCoexAdv()===!0?yield o("WAWebApiDeviceList").getDeviceRecord(a.author):null;if(a.placeholderCreatedWhenAccountIsHosted=(_==null?void 0:_.advAccountType)===o("WAWebProtobufsAdv.pb").ADVEncryptionType.HOSTED,(_==null?void 0:_.advAccountType)===o("WAWebProtobufsAdv.pb").ADVEncryptionType.HOSTED&&(a==null||(p=a.chat)==null?void 0:p.isUser())===!0){var f=yield o("WAWebBizCoexUtils").shouldCreateFallbackHostedAdvSystemMsgOnPlaceholder(o("WAWebWidFactory").asUserWidOrThrow(a==null?void 0:a.author).toString());f&&!o("WAWebBizCoexUtils").shouldDedupInitialHostedSystemMsg(o("WAWebWidFactory").asUserWidOrThrow(a==null?void 0:a.author))&&(m=[r("WANullthrows")(o("WAWebAdvHostedAccountTypeSystemMsg").genAdvAccountTypeInitialSysMsg(o("WAWebWidFactory").asUserWidOrThrow(a==null?void 0:a.author),o("WAWebWidFactory").asUserWidOrThrow(a==null?void 0:a.author)))])}}var g=[];if(t.type===o("WAWebMsgType").MSG_TYPE.CIPHERTEXT){var h=o("WAWebMsgProcessingApiUtils").generatePlaceholder(t);if(h==null||(h.realType!=null&&o("WALogger").DEV(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[message][addon] processPlaceholderMessage: msgId::",""])),a.externalId),a.type===o("WAWebHandleMsgTypes.flow").MESSAGE_TYPE.PEER_BROADCAST?(yield o("WAWebDBProcessMessage").storeMessages([h],h.id.remote),a.bclParticipants!=null&&a.edit!==o("WAWebAck").EDIT_ATTR.SENDER_REVOKE&&(g=yield o("WAWebMsgProcessingApiUtils").generateBclMsgs(h,a.bclParticipants))):g=[h],g.length===0))return;o("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()&&m.length>0&&a.placeholderCreatedWhenAccountIsHosted===!0&&(g=[].concat(m,g))}else g=[o("WAWebMsgProcessingApiUtils").genDebugPlaceholderMsg(a,t.nackReason)];var y=g;if(y.length===0)return;if(t.type===o("WAWebMsgType").MSG_TYPE.CIPHERTEXT){if(i.isUser()){var C=y[0],b=o("WAWebMessageDestinationChat").determineDestinationChatForIncomingMessage({chat:i,msg:C,msgInfo:a});yield o("WAWebCheckChatExistsOrCreate").checkChatExistsOrCreate({destinationChat:b,msgMeta:t.msgMeta,options:{firstIncomingMsg:C},chatOriginType:"createChatOnNewMsg"})}}else t.type;var v=o("WAWebMessageProcessorCache").messageProcessorCache.addMessages(y.map(function(e){return{msg:e}}),!l).then(function(){o("WALogger").DEV(u||(u=babelHelpers.taggedTemplateLiteralLoose(["[unify][message] processing placeholders in cache completed"]))),o("WAWebWamWorkerOfflineProcessReporter").WorkerOfflineResumeReporter.updateProcessedMessageCount()});o("WAWebCmd").Cmd.isMainStreamReadyMd&&(o("WAWebCmd").Cmd.isOfflineDeliveryEnd&&(yield v),yield(d||(d=n("Promise"))).all(y.map((function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){if(e.kind!==o("WAWebMsgType").MsgKind.PlaceholderAddon){var t=e.id.remote;yield o("WAWebBackendApi").frontendSendAndReceive("updateMessageUI",{chatId:t,msg:e})}});return function(t){return e.apply(this,arguments)}})())))}catch(e){o("WALogger").ERROR(c||(c=babelHelpers.taggedTemplateLiteralLoose(["processPlaceholderMsg: msgId::",", failed with error: ",""])),a.externalId,e).tags("messaging").sendLogs("handle_msg: error storing/processing single message")}}),p.apply(this,arguments)}l.processPlaceholderMessage=m}),98);
__d("WAWebGetPrivacyModeWhenSent",["WAWebApiVerifiedBusinessName","WAWebHandleMsgTypes.flow","WAWebPrivacyModeSystemMsg","WAWebRuntimeEnvironmentUtils","WAWebUserPrefsMeUser","WAWebWorkerSafeBackendApi","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){function e(e,t){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){if(e.type===o("WAWebHandleMsgTypes.flow").MESSAGE_TYPE.CHAT){if(!o("WAWebUserPrefsMeUser").isMeAccount(e.author))return t.privacyMode;var n=t.privacyMode,r=o("WAWebRuntimeEnvironmentUtils").isWorker()?yield o("WAWebApiVerifiedBusinessName").getPrivacyMode(e.chat):yield o("WAWebWorkerSafeBackendApi").workerSafeSendAndReceive("getPrivacyMode",{id:e.chat});return o("WAWebPrivacyModeSystemMsg").getLatestPrivacyMode(r,n)}}),s.apply(this,arguments)}l.getPrivacyModeWhenSent=e}),98);
__d("WAWebHandleBizBotMsgs",["Promise","WALogger","WAWebBotSystemMsg","WAWebBotTypes","WAWebModelStorageUtils","WAWebRuntimeEnvironmentUtils","WAWebSchemaChat","WAWebWidFactory","WAWebWorkerSafeBackendApi","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s;function u(e){return c.apply(this,arguments)}function c(){return c=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var r=new Map;t.forEach(function(e){var t=e.from.toJid();t!=null&&!r.has(t)&&e.bizBotType&&r.set(t,e.bizBotType)});var a=Array.from(r.keys()),i=yield d(a),l=[],u=[];for(var c of r.entries()){var m,p=c[0],_=c[1],f=(m=i.get(p))==null?void 0:m.bizBotSystemMsgType;_===o("WAWebBotTypes").BizBotType.BIZ_1P&&f!==o("WAWebBotTypes").BizBotType.BIZ_1P?(l.push(o("WAWebBotSystemMsg").genBizBot1pDisclosureMessage(o("WAWebWidFactory").createWid(p))),u.push({id:p,bizBotSystemMsgType:o("WAWebBotTypes").BizBotType.BIZ_1P})):_===o("WAWebBotTypes").BizBotType.BIZ_3P&&f!==o("WAWebBotTypes").BizBotType.BIZ_3P&&(l.push(o("WAWebBotSystemMsg").genBizBot3pDisclosureMessage(o("WAWebWidFactory").createWid(p))),u.push({id:p,bizBotSystemMsgType:o("WAWebBotTypes").BizBotType.BIZ_3P}))}return l.length?(o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["handleBizBotMsgs: bulkCreateOrMerge"]))).tags("missing-lid"),yield o("WAWebModelStorageUtils").getStorage().lock(["chat"],(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e[0];yield(s||(s=n("Promise"))).all([t.bulkCreateOrMerge(u)])});return function(t){return e.apply(this,arguments)}})()),l):[]}),c.apply(this,arguments)}function d(e){return m.apply(this,arguments)}function m(){return m=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){if(!o("WAWebRuntimeEnvironmentUtils").isWorker())return o("WAWebWorkerSafeBackendApi").workerSafeSendAndReceive("getBizBotData",{chatIds:e.map(o("WAWebWidFactory").createWid)});var t=new Map,n=yield o("WAWebSchemaChat").getChatTable().bulkGet(e);return n.map(function(e){e&&t.set(e.id,{bizBotSystemMsgType:e.bizBotSystemMsgType})}),t}),m.apply(this,arguments)}l.handleBizBotMsgs=u}),98);
__d("WAWebHandlePrivacyModeChange",["WALogger","WAWebApiVerifiedBusinessName","WAWebBusinessProfileTypes","WAWebCheckChatExistsOrCreate","WAWebHandlePrivacyModeUpdateMsgAction","WAWebMessageDestinationChat","WAWebMiscGatingUtils","WAWebPrivacyModeSystemMsg","WAWebRuntimeEnvironmentUtils","WAWebWorkerSafeBackendApi","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e;function s(e){return u.apply(this,arguments)}function u(){return u=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var n=t.msgs,r=t.chatWid,a=t.bizInfo,i=t.msgMeta,l=t.msgInfo,s=n[0],u=o("WAWebMessageDestinationChat").determineDestinationChatForIncomingMessage({chat:r,msg:s,msgInfo:l}),d=u.chatId,m=yield c(d),p=o("WAWebPrivacyModeSystemMsg").getLatestPrivacyMode(a.privacyMode,m.privacyMode),_=yield o("WAWebCheckChatExistsOrCreate").checkChatExistsOrCreate({destinationChat:u,msgMeta:i,options:{firstIncomingMsg:s,nextPrivacyMode:p},chatOriginType:"createChatOnNewMsg"}),f=_!==!0||o("WAWebMiscGatingUtils").queryVerifiedNameWhenMsgDiffers()&&m.verifiedLevel!==o("WAWebBusinessProfileTypes").convertLevel(a.verifiedLevel);try{return _&&p!=null&&(yield o("WAWebHandlePrivacyModeUpdateMsgAction").handlePrivacyModeTransition(d,p,{shouldRunMATonWid:!1})),{shouldQueryContactInfo:f,latestPrivacyMode:p}}catch(t){o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["handlePrivacyModeChange for ",", failed with error: ",""])),d.toLogString(),t).tags("messaging","non-sad").sendLogs("handlePrivacyModeChange failed",{sampling:.01})}}),u.apply(this,arguments)}function c(e){return d.apply(this,arguments)}function d(){return d=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){if(!o("WAWebRuntimeEnvironmentUtils").isWorker())return o("WAWebWorkerSafeBackendApi").workerSafeSendAndReceive("getChatPrivacyInfoOnNewMsg",{chatId:e});var t=yield o("WAWebApiVerifiedBusinessName").getVerifiedBusinessNameRecordLidAware(e);return{privacyMode:(t==null?void 0:t.privacyMode)!=null?o("WAWebApiVerifiedBusinessName").convertPrivacyModeFromStorageType(t.privacyMode):null,verifiedLevel:o("WAWebBusinessProfileTypes").convertLevel(t==null?void 0:t.level)}}),d.apply(this,arguments)}l.handlePrivacyModeChangeAndCreateChat=s}),98);
__d("WAWebDBOrphanDbSerialization",["WAWebDBMessageSerialization","WAWebWidFactory"],(function(t,n,r,o,a,i,l){function e(e){return babelHelpers.extends({},e,{sender:e.sender==null?null:o("WAWebWidFactory").createUserWidOrThrow(e.sender),parsedMsgPayload:o("WAWebDBMessageSerialization").messageFromDbRow(e.parsedMsgPayload)})}l.orphanFromDbRow=e}),98);
__d("WAWebDBGetByParentMsgKey",["WAWebDBOrphanDbSerialization","WAWebSchemaMessageOrphans"],(function(t,n,r,o,a,i,l){function e(e){return s([e])}function s(e){return o("WAWebSchemaMessageOrphans").getMessageOrphanTable().anyOf(["parentMsgKey"],e.map(String)).then(function(e){return e.filter(Boolean).map(o("WAWebDBOrphanDbSerialization").orphanFromDbRow)})}l.getMessageOrphansByParentMsgKey=e,l.bulkGetMessageOrphansByParentMsgKey=s}),98);
__d("WAWebDBMapOrphansToProviders",["WAWebDBAddOnProviders"],(function(t,n,r,o,a,i,l){function e(e){var t=new Map;for(var n of e){var r,a=o("WAWebDBAddOnProviders").getProviderForAddOnType(n.type);if(a){var i=(r=t.get(a))!=null?r:[];i.push(n),t.set(a,i)}}return t}l.mapOrphansToProviders=e}),98);
__d("WAWebDBProcessOrphansForNewMsg",["Promise","WALogger","WAWebAddonProcessMsgsUtils","WAWebDBGetByParentMsgKey","WAWebDBMapOrphansToProviders","WAWebDBProcessReactionsMsgs","WAWebLidMigrationUtils","WAWebSchemaMessageOrphans","WAWebStoreMsgs","asyncToGeneratorRuntime","lodash"],(function(t,n,r,o,a,i,l){var e,s;function u(e){return c.apply(this,arguments)}function c(){return c=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var a=o("WAWebLidMigrationUtils").getAlternateMsgKey(t.id),i=yield o("WAWebDBGetByParentMsgKey").bulkGetMessageOrphansByParentMsgKey([t.id,a].filter(Boolean));i.length&&o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["processOrphansForNewMsg: found orphans"]))).devConsole({orphans:i});var l=o("WAWebAddonProcessMsgsUtils").sortAddonOrphans(i),u=l.unifiedAddons,c=l.otherOrphans,d=l.legacyReactionAddons,m=yield o("WAWebDBMapOrphansToProviders").mapOrphansToProviders(c),p=[o("WAWebStoreMsgs").storeMsgs(u),o("WAWebDBProcessReactionsMsgs").processReactionMsgs(d)];for(var _ of m.entries()){var f=_[0],g=_[1];p.push(f.processOrphansForNewMsg(t,g))}yield(s||(s=n("Promise"))).all(p);var h=r("lodash").flatten(Array.from(m.values())).map(function(e){return e.msgKey});h=h.concat(u.map(function(e){return e.id.toString()})),d.length&&(h=h.concat(d.map(function(e){return e.id.toString()}))),yield o("WAWebSchemaMessageOrphans").getMessageOrphanTable().bulkRemove(h)}),c.apply(this,arguments)}l.processOrphansForNewMsg=u}),98);
__d("WAWebHandleOrphansForNewMsg",["Promise","WAWebDBAssociatedMsgsAttachDetachAPI","WAWebDBProcessOrphansForNewMsg","WAWebMessageAssociationGatingUtils","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e;function s(e){return u.apply(this,arguments)}function u(){return u=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var r=[o("WAWebDBProcessOrphansForNewMsg").processOrphansForNewMsg(t)];o("WAWebMessageAssociationGatingUtils").isMessageAssociationInfraEnabled()&&r.push(o("WAWebDBAssociatedMsgsAttachDetachAPI").processOrphansFromAssociationsTableForNewMsg([t])),yield(e||(e=n("Promise"))).all(r)}),u.apply(this,arguments)}l.handleOrphansForNewMsg=s}),98);
__d("WAWebMessageProcessDBPipeline",["Promise","WALogger","WAWebHandleOrphansForNewMsg","WAWebMessageProcessorCache","WAWebWamWorkerOfflineProcessReporter","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u,c;function d(t,r){return o("WAWebMessageProcessorCache").messageProcessorCache.addMessages(t.map(function(e){return{msg:e}}),r).then(n("asyncToGeneratorRuntime").asyncToGenerator(function*(){o("WALogger").DEV(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[unify][message] processing messages in cache completed"]))),o("WAWebWamWorkerOfflineProcessReporter").WorkerOfflineResumeReporter.updateProcessedMessageCount(),r&&(o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["process msgs orphans ",""])),t.length),yield(c||(c=n("Promise"))).all(t.map(function(e){return o("WAWebHandleOrphansForNewMsg").handleOrphansForNewMsg(e)})))})).catch(function(e){o("WALogger").ERROR(u||(u=babelHelpers.taggedTemplateLiteralLoose(["processRenderableMessages write to DB from cache, failed with error: ",""])),e).tags("messaging").sendLogs("processRenderableMessages write to DB from cache, failed")})}l.processMsgDataDBPipeline=d}),98);
__d("WAWebDBChatEphemeralExemptionData",["WALogger","WAWebChatEphemeralExemptionCache","WAWebDBUpdateChatTable","WAWebSchemaChat","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e;function s(e){return u.apply(this,arguments)}function u(){return u=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e.toString();if(r("WAWebChatEphemeralExemptionCache").has(t))return r("WAWebChatEphemeralExemptionCache").get(t);var n=yield o("WAWebSchemaChat").getChatTable().get(e.toString(),!1),a=n==null?null:{id:t,ephemeralDuration:n==null?void 0:n.ephemeralDuration,ephemeralDisplayedExemptions:n==null?void 0:n.ephemeralDisplayedExemptions};return r("WAWebChatEphemeralExemptionCache").add(t,a),a}),u.apply(this,arguments)}function c(t,n,a){var i=t.toString();r("WAWebChatEphemeralExemptionCache").add(i,{id:i,ephemeralDuration:n,ephemeralDisplayedExemptions:a}),o("WAWebDBUpdateChatTable").updateChatTable(t,{ephemeralDisplayedExemptions:a}).catch(function(){o("WALogger").DEV(e||(e=babelHelpers.taggedTemplateLiteralLoose(["Failed to update chat.ephemeralDisplayedExemptions: ",""])),o("WAWebDBUpdateChatTable").updateChatTable)})}function d(e,t){var n,o=e.toString(),a=r("WAWebChatEphemeralExemptionCache").get(o),i={id:o,ephemeralDuration:t,ephemeralDisplayedExemptions:(n=a==null?void 0:a.ephemeralDisplayedExemptions)!=null?n:null};r("WAWebChatEphemeralExemptionCache").add(o,i)}l.getChatEphemeralExemptionDataFromChat=s,l.persistsEphemeralDisplayedExemptions=c,l.updateEphemeralDurationCache=d}),98);
__d("WAWebDBEphemeralDisplayedExemptions",["$InternalEnum"],(function(t,n,r,o,a,i){var e=n("$InternalEnum")({UNSET:0,ORDERS_AND_PAYMENTS:1});i.EphemeralExemptionType=e}),66);
__d("WAWebOrderEphemeralExemptionUtil",["WAWebBizGatingUtils","WAWebDBEphemeralDisplayedExemptions","WAWebInteractiveMessageType","WAWebInteractiveMessagesNativeFlowName","WAWebMsgType"],(function(t,n,r,o,a,i,l){function e(e,t,n){return o("WAWebBizGatingUtils").inOrderMessagesEphemeralExceptionEnabled()&&e===o("WAWebMsgType").MSG_TYPE.INTERACTIVE&&t===r("WAWebInteractiveMessageType").NATIVE_FLOW&&(n===r("WAWebInteractiveMessagesNativeFlowName").ORDER_DETAILS||n===r("WAWebInteractiveMessagesNativeFlowName").ORDER_STATUS||n===r("WAWebInteractiveMessagesNativeFlowName").PAYMENT_METHOD||n===r("WAWebInteractiveMessagesNativeFlowName").PAYMENT_STATUS||n===r("WAWebInteractiveMessagesNativeFlowName").PAYMENT_INFO)}function s(e){var t=e.id,n=e.ephemeralDuration,r=e.ephemeralDisplayedExemptions;return t!=null&&n!==0&&n!=null&&o("WAWebDBEphemeralDisplayedExemptions").EphemeralExemptionType.ORDERS_AND_PAYMENTS!==r}function u(e){var t=e.id,n=e.ephemeralDuration,r=e.ephemeralDisplayedExemptions;return t!=null&&(n===0||n==null)&&o("WAWebDBEphemeralDisplayedExemptions").EphemeralExemptionType.ORDERS_AND_PAYMENTS===r}l.isMessageTypeExemptedFromDisappearing=e,l.shouldShowOrderExemptionSystemMessage=s,l.shouldUnsetChatEphemeralDisplayedExemption=u}),98);
__d("WAWebOrderSystemMsg",["WAWebContactSystemMsg","WAWebMsgType"],(function(t,n,r,o,a,i,l){function e(e){return o("WAWebContactSystemMsg").genNotificationMsg(e,{type:"notification_template",kind:o("WAWebMsgType").MsgKind.NotificationTemplate,subtype:"order_ephemeral_exemption",templateParams:[]})}l.getOrderEphemeralExemptionSystemMsg=e}),98);
__d("WAWebPreProcessOrderEphemeralExemption",["WAWebBizGatingUtils","WAWebDBChatEphemeralExemptionData","WAWebDBEphemeralDisplayedExemptions","WAWebOrderEphemeralExemptionUtil","WAWebOrderSystemMsg","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){function e(e){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t,n;if(!o("WAWebBizGatingUtils").inOrderMessagesEphemeralExceptionEnabled())return e;var r=e.findIndex(function(e){var t=e.nativeFlowName,n=e.interactiveType,r=e.type;return o("WAWebOrderEphemeralExemptionUtil").isMessageTypeExemptedFromDisappearing(r,n,t)});if(r===-1||((t=e.at(r))==null||(t=t.id)==null?void 0:t.remote)==null)return e;var a=(n=e.at(r))==null||(n=n.id)==null?void 0:n.remote;if(a==null)return e;var i=yield o("WAWebDBChatEphemeralExemptionData").getChatEphemeralExemptionDataFromChat(a);if(i!=null&&o("WAWebOrderEphemeralExemptionUtil").shouldShowOrderExemptionSystemMessage(i)){var l;o("WAWebDBChatEphemeralExemptionData").persistsEphemeralDisplayedExemptions(a,(l=i.ephemeralDuration)!=null?l:0,o("WAWebDBEphemeralDisplayedExemptions").EphemeralExemptionType.ORDERS_AND_PAYMENTS);var s=e.slice(0,r),u=o("WAWebOrderSystemMsg").getOrderEphemeralExemptionSystemMsg(a),c=e.slice(r,e.length);return[].concat(s,[u],c)}else if(i!=null&&o("WAWebOrderEphemeralExemptionUtil").shouldUnsetChatEphemeralDisplayedExemption(i)){var d;o("WAWebDBChatEphemeralExemptionData").persistsEphemeralDisplayedExemptions(a,(d=i.ephemeralDuration)!=null?d:0,o("WAWebDBEphemeralDisplayedExemptions").EphemeralExemptionType.UNSET)}return e}),s.apply(this,arguments)}l.preProcessOrderEphemeralExemption=e}),98);
__d("WAWebStatusContactUtils",["WALogger","WAWebBackendApi","WAWebCmd","WAWebLidAwareContactsDB","WAWebWidFactory","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e;function s(){return u.apply(this,arguments)}function u(){return u=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["UserPrefsStatus: staring to getStatusContacts"]))),o("WAWebCmd").Cmd.isMainStreamReadyMd){var t=yield o("WAWebBackendApi").frontendSendAndReceive("getFilteredContacts",{showMe:!1,showWithoutName:!1});return t.map(function(e){return e.id})}var n=yield r("WAWebLidAwareContactsDB").equals(["isAddressBookContact"],1);return n.map(function(e){return o("WAWebWidFactory").createWid(e.id)}).filter(function(e){return!e.isLid()})}),u.apply(this,arguments)}l.getStatusContacts=s}),98);
__d("WAWebUserPrefsStatusType",["$InternalEnum"],(function(t,n,r,o,a,i){var e=n("$InternalEnum")({Contact:"contact",AllowList:"allow-list",DenyList:"deny-list"});i.StatusPrivacySettingType=e}),66);
__d("WAWebUserPrefsStatus",["WALogger","WAWebApiContact","WAWebModelStorageUtils","WAWebSendMsgCommonApi","WAWebStatusContactUtils","WAWebUserPrefsIndexedDBStorage","WAWebUserPrefsKeys","WAWebUserPrefsMeUser","WAWebUserPrefsStatusType","WAWebWidFactory","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s;function u(e){var t=e.setting,n=e.list;if(t===o("WAWebUserPrefsStatusType").StatusPrivacySettingType.Contact)return o("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.set(o("WAWebUserPrefsKeys").BACKEND_ONLY_KEYS.STATUS_PRIVACY_SETTING,t);var r=c({setting:t,allowList:t===o("WAWebUserPrefsStatusType").StatusPrivacySettingType.AllowList?n:void 0,denyList:t===o("WAWebUserPrefsStatusType").StatusPrivacySettingType.DenyList?n:void 0});return o("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.bulkSetItemsToIndexedDB(r)}function c(e){var t=[],n=e.setting,r=e.allowList,a=e.denyList;return n!=null&&t.push({key:o("WAWebUserPrefsKeys").BACKEND_ONLY_KEYS.STATUS_PRIVACY_SETTING,value:n}),r!=null&&t.push({key:o("WAWebUserPrefsKeys").BACKEND_ONLY_KEYS.STATUS_ALLOW_LIST,value:Array.from(new Set(r.map(function(e){return String(o("WAWebWidFactory").asUserWidOrThrow(e))})))}),a!=null&&t.push({key:o("WAWebUserPrefsKeys").BACKEND_ONLY_KEYS.STATUS_DENY_LIST,value:Array.from(new Set(a.map(function(e){return String(o("WAWebWidFactory").asUserWidOrThrow(e))})))}),t}function d(){return m.apply(this,arguments)}function m(){return m=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){return o("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.get(o("WAWebUserPrefsKeys").BACKEND_ONLY_KEYS.STATUS_PRIVACY_SETTING)||o("WAWebUserPrefsStatusType").StatusPrivacySettingType.Contact}),m.apply(this,arguments)}function p(){return _.apply(this,arguments)}function _(){return _=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["UserPrefsStatus: staring to getStatusAllowList"])));var t=o("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.get(o("WAWebUserPrefsKeys").BACKEND_ONLY_KEYS.STATUS_ALLOW_LIST);return t!=null?t.map(o("WAWebWidFactory").createWid):[]}),_.apply(this,arguments)}function f(){return g.apply(this,arguments)}function g(){return g=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["UserPrefsStatus: staring to getStatusDenyList"])));var e=o("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.get(o("WAWebUserPrefsKeys").BACKEND_ONLY_KEYS.STATUS_DENY_LIST);return e!=null?e.map(o("WAWebWidFactory").createWid):[]}),g.apply(this,arguments)}function h(){return y.apply(this,arguments)}function y(){return y=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){return o("WAWebModelStorageUtils").getStorage().lock(["user-prefs","contact"],n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=yield d(),t;switch(e){case o("WAWebUserPrefsStatusType").StatusPrivacySettingType.AllowList:return{setting:o("WAWebUserPrefsStatusType").StatusPrivacySettingType.AllowList,list:yield p()};case o("WAWebUserPrefsStatusType").StatusPrivacySettingType.DenyList:return t=new Set((yield f()).map(String)),{setting:o("WAWebUserPrefsStatusType").StatusPrivacySettingType.DenyList,list:(yield o("WAWebStatusContactUtils").getStatusContacts()).filter(function(e){var n=e.isUser()?o("WAWebApiContact").getAlternateUserWid(o("WAWebWidFactory").asUserWidOrThrow(e)):null,r=t.has(e.toString()),a=n==null?!1:t.has(n.toString());return!r&&!a})};case o("WAWebUserPrefsStatusType").StatusPrivacySettingType.Contact:return{setting:o("WAWebUserPrefsStatusType").StatusPrivacySettingType.Contact,list:yield o("WAWebStatusContactUtils").getStatusContacts()}}}))}),y.apply(this,arguments)}function C(){return b.apply(this,arguments)}function b(){return b=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){return o("WAWebModelStorageUtils").getStorage().lock(["user-prefs"],n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=yield d(),t=yield p(),n=yield f();return{setting:e,allowList:t,denyList:n}}))}),b.apply(this,arguments)}function v(){return S.apply(this,arguments)}function S(){return S=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=o("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.get(o("WAWebUserPrefsKeys").BACKEND_ONLY_KEYS.STATUS_SENDER_KEY);return e||{rotateKey:!1,senderKey:new Set}}),S.apply(this,arguments)}function R(e){return L.apply(this,arguments)}function L(){return L=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){return o("WAWebModelStorageUtils").getStorage().lock(["user-prefs"],n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var t=yield v(),n=t.rotateKey?new Set:t.senderKey;e.forEach(function(e){n.add(String(e))}),yield o("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.set(o("WAWebUserPrefsKeys").BACKEND_ONLY_KEYS.STATUS_SENDER_KEY,{rotateKey:!1,senderKey:n})}))}),L.apply(this,arguments)}function E(e){return k.apply(this,arguments)}function k(){return k=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){return o("WAWebModelStorageUtils").getStorage().lock(["user-prefs"],n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var t=yield v();if(!t.rotateKey){var n=e.some(function(e){return t.senderKey.has(String(e))});n&&(yield o("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.set(o("WAWebUserPrefsKeys").BACKEND_ONLY_KEYS.STATUS_SENDER_KEY,{rotateKey:!0,senderKey:new Set}))}}))}),k.apply(this,arguments)}function I(e){return T.apply(this,arguments)}function T(){return T=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){return o("WAWebModelStorageUtils").getStorage().lock(["user-prefs"],n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var t=yield v();e.forEach(function(e){if(t.senderKey.delete(String(e)),e.isUser()){var n=o("WAWebApiContact").getAlternateUserWid(o("WAWebWidFactory").asUserWidOrThrow(e));n!=null&&t.senderKey.delete(String(n))}}),yield o("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.set(o("WAWebUserPrefsKeys").BACKEND_ONLY_KEYS.STATUS_SENDER_KEY,{rotateKey:t.rotateKey,senderKey:t.senderKey})}))}),T.apply(this,arguments)}function D(e){return x.apply(this,arguments)}function x(){return x=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=yield v();if(t.rotateKey||t.senderKey.size===0)return{rotateKey:t.rotateKey,skDistribList:e,participantList:[]};var n=[],r=[],a=0;return e.forEach(function(e){t.senderKey.has(String(e))?(o("WAWebSendMsgCommonApi").isPrimaryDevice(e)&&n.push(e),a++):o("WAWebUserPrefsMeUser").isMeDevice(e)||r.push(e)}),a<t.senderKey.size?(yield o("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.set(o("WAWebUserPrefsKeys").BACKEND_ONLY_KEYS.STATUS_SENDER_KEY,{rotateKey:!0,senderKey:new Set}),{rotateKey:!0,skDistribList:e,participantList:[]}):{rotateKey:t.rotateKey,skDistribList:r,participantList:n}}),x.apply(this,arguments)}var $={setStatusPrivacyConfig:u,calculateStatusPrivacyUpdateEntries:c,getStatusPrivacySetting:d,getStatusAllowList:p,getStatusDenyList:f,getStatusSenderKeyMap:v,getStatusSkDistribList:D,markStatusHasSenderKey:R,getStatusContacts:o("WAWebStatusContactUtils").getStatusContacts,getStatusList:h,getStatusPrivacySettingConfig:C,markForgetStatusSenderKey:I,markStatusSenderKeyRotate:E};l.default=$}),98);
__d("WAWebStatusDBMessageInfo",["Promise","WABatcher","WALogger","WAPromiseMap","WAWebApiMessageInfoStore","WAWebLidStatusMigrationUtils","WAWebUserPrefsStatus","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m={delayMs:5e3},p=o("WABatcher").createSimpleBatcher(m,function(e){return _(e)});function _(e){return f.apply(this,arguments)}function f(){return f=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["updatePeerStatusReceiptInfoInBatch: staring to process "," records"])),t.length);var a,i,l,c,m=yield o("WAPromiseMap").promiseMap(t,(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e.msgKey,o=e.setting;switch(o){case"denylist":return a==null&&(a=r("WAWebUserPrefsStatus").getStatusDenyList().then(function(e){return new Set(e.map(String))})),i==null&&(i=r("WAWebUserPrefsStatus").getStatusContacts()),{msgKey:t,receiverIds:yield(d||(d=n("Promise"))).all([i,a]).then(function(e){var t=e[0],n=e[1];return t.filter(function(e){return!n.has(e.toString())})})};case"allowlist":return l==null&&(l=r("WAWebUserPrefsStatus").getStatusAllowList()),{msgKey:t,receiverIds:yield l};case"contacts":return i==null&&(i=r("WAWebUserPrefsStatus").getStatusContacts()),{msgKey:t,receiverIds:yield i};default:return c==null&&(c=r("WAWebUserPrefsStatus").getStatusList()),{msgKey:t,receiverIds:(yield c).list}}});return function(t){return e.apply(this,arguments)}})()),p=[];return m.forEach(function(e){e.receiverIds.forEach(function(t){p.push({msgKey:e.msgKey,receiverId:o("WAWebLidStatusMigrationUtils").matWidConvert(t)})})}),o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["updatePeerStatusReceiptInfoInBatch: staring to update "," records"])),p.length),yield o("WAWebApiMessageInfoStore").createOrMergeReceiptRecords(p),o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["updatePeerStatusReceiptInfoInBatch: complete to update "," records"])),p.length),t.map(function(){})}),f.apply(this,arguments)}function g(e,t,n){return h.apply(this,arguments)}function h(){return h=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n){o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["updatePeerStatusReceiptInfo: adding ",", setting ",", offline ",""])),e.id,n,t);var r=p.accept({msgKey:e,setting:n});return t||p.runActiveBatch(),r}),h.apply(this,arguments)}var y={updatePeerStatusReceiptInfo:g};l.default=y}),98);
__d("WAWebMessageProcessRenderable",["Promise","WALogger","WAWebApiFilterAndReplaceMessages","WAWebBotGating","WAWebBotSystemMsg","WAWebCmd","WAWebCurrentUser","WAWebGalaxyFlowsUtils","WAWebGetPrivacyModeWhenSent","WAWebHandleBizBotMsgs","WAWebHandleMsgTypes.flow","WAWebHandleMsgValidate","WAWebHandlePrivacyModeChange","WAWebHandleSingleMsg","WAWebMessageAssociation.flow","WAWebMessagePostprocessRenderable","WAWebMessageProcessDBPipeline","WAWebMessagingGatingUtils","WAWebMsgGetters","WAWebMsgKey","WAWebMsgSyncConfiguratedTunnel","WAWebMsmsgMsgSecretCache","WAWebOfflineHandler","WAWebOfflineResumeMsgProcessReporter","WAWebOfflineResumeTypes.flow","WAWebPreProcessOrderEphemeralExemption","WAWebSagaSystemMsg","WAWebStatusDBMessageInfo","WAWebWamEnumPlaceholderPopulationType","WAWebWid","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u,c,d;function m(t,n){var a=r("WAWebMsgKey").from({fromMe:t.fromMe,id:t.id,participant:t.participant,remote:n});return o("WAWebCurrentUser").isEmployee()&&o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["processRenderableMessagesForLid: override msgKey: "," --> ",""])),t.toString(),a.toString()),a}function p(e,t,n){return e==null||!t.isRegularUser()?n:n.map(function(e){return o("WAWebMessageAssociation.flow").isAssociatedMsg(e)?babelHelpers.extends({},e,{parentMsgKey:m(e.parentMsgKey,t)}):e})}function _(e,t,n,r){return f.apply(this,arguments)}function f(){return f=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n,a){var i=p(t.preMatChat,t.chat,e),l=yield o("WAWebGetPrivacyModeWhenSent").getPrivacyModeWhenSent(t,n),s=y(a);s!=null&&(i=i.map(function(e){return babelHelpers.extends({},e,{placeholderPopulationType:s})})),i=l==null?i:i.map(function(e){return babelHelpers.extends({},e,{privacyModeWhenSent:l})});var u=t.addressingMode;return i=u==null?i:i.map(function(e){return babelHelpers.extends({},e,{groupAddressingMode:u})}),i=yield o("WAWebPreProcessOrderEphemeralExemption").preProcessOrderEphemeralExemption(i),i=i.map(function(e){var t,n=e.messageSecret!=null?(t=e.mentionedJidList)==null?void 0:t.find(function(e){return e&&r("WAWebWid").isWid(e)&&e.isBot()}):null;return n!=null?babelHelpers.extends({},e,{invokedBotWid:n}):e}),i=yield o("WAWebGalaxyFlowsUtils").maybeAddGalaxyFlowMessageIds(i),o("WAWebApiFilterAndReplaceMessages").filterAndReplaceMessages(i)}),f.apply(this,arguments)}function g(e,t,n,r,o,a,i){return h.apply(this,arguments)}function h(){return h=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,a,i,l,m,p){if(e.length===0){o("WALogger").DEV(s||(s=babelHelpers.taggedTemplateLiteralLoose(["processRenderableMessages: skip for empty msg list"])));return}try{var f,g,h,y=o("WAWebOfflineResumeMsgProcessReporter").msgProcessReporter.startMarker(o("WAWebOfflineResumeMsgProcessReporter").msgProcessReporter.stage.PreProcessing),C=t.chat,b=t.offline!=null&&!p,v="online";p?v="reparsing":b&&(v="offline"),o("WALogger").DEV(u||(u=babelHelpers.taggedTemplateLiteralLoose(["[unify][message] processing "," "," message(s)"])),e.length,v);var S=yield _(e,t,i,m),R=S.newMsgs;if(y==null||y(),o("WAWebMessagingGatingUtils").isWebReportingTokenDelayProcessingEnabled()){var L=o("WAWebOfflineResumeMsgProcessReporter").msgProcessReporter.startMarker(o("WAWebOfflineResumeMsgProcessReporter").msgProcessReporter.stage.ProcessReportingTokenInfo);yield o("WAWebHandleMsgValidate").validateAndProcessReportingTokenInfo({renderableMsgs:R}),L==null||L()}var E=o("WAWebOfflineResumeMsgProcessReporter").msgProcessReporter.startMarker(o("WAWebOfflineResumeMsgProcessReporter").msgProcessReporter.stage.Processing);R.forEach(function(e){e.id.fromMe&&o("WAWebMsgGetters").getIsStatus(e)&&r("WAWebStatusDBMessageInfo").updatePeerStatusReceiptInfo(e.id,b,t.statusSetting)});var k=null;if(R.forEach(function(e){var t,n,r,a=e.messageSecret,i=!!(a&&((t=e.id.remote)!=null&&t.isBot())),l=(n=(r=e.invokedBotWid)==null?void 0:r.isBot())!=null?n:!1;a&&(i||l)&&e.isForwarded!==!0&&(l&&(k=e),o("WAWebMsmsgMsgSecretCache").msmsgMsgSecretCache.addMsmsgMsgSecretToCache(e.id.toString(),a))}),k!=null){var I=yield o("WAWebBotSystemMsg").createSysMsgForIncomingBotInvoke(k);I&&R.unshift(I)}if(o("WAWebBotGating").isBotEnabled()){var T=R.filter(function(e){return!!e.bizBotType&&!o("WAWebMsgGetters").getIsCAPISupport(e)});if(T.length){var D=yield o("WAWebHandleBizBotMsgs").handleBizBotMsgs(T);R.unshift.apply(R,D)}}var x;if(C.isUser()&&(x=yield o("WAWebHandlePrivacyModeChange").handlePrivacyModeChangeAndCreateChat({msgs:R,chatWid:C,bizInfo:i,msgMeta:l,msgInfo:t})),r("WAWebWid").isCAPISupportAccount(C)){var $=R.some(function(e){return e.shouldShowSupportAISystemMessage===!0});$===!0&&(yield o("WAWebHandleSingleMsg").handleSingleMsg({chatId:C,newMsg:o("WAWebSagaSystemMsg").genSagaInitSystemMsg(C),handleSingleMsgOrigin:"supportSagaInit"}))}var P={msgInfo:t,messageOverwriteOption:m,msgs:R,isOffline:b,latestPrivacyMode:(f=x)==null?void 0:f.latestPrivacyMode,shouldQueryContactInfo:(g=(h=x)==null?void 0:h.shouldQueryContactInfo)!=null?g:!1},N=o("WAWebMessageProcessDBPipeline").processMsgDataDBPipeline(R,!b);if(o("WAWebCmd").Cmd.isMainStreamReadyMd||p){E==null||E(),o("WAWebCmd").Cmd.isOfflineDeliveryEnd&&(yield N);var M=!o("WAWebCmd").Cmd.isOfflineDeliveryEnd&&o("WAWebMsgSyncConfiguratedTunnel").msgSyncTunnel.isEnabled()?o("WAWebMsgSyncConfiguratedTunnel").msgSyncTunnel.accept(P):o("WAWebMessagePostprocessRenderable").postprocessRenderableMessages(P);if(b&&o("WAWebOfflineHandler").OfflineMessageHandler.getResumeType()===o("WAWebOfflineResumeTypes.flow").ResumeType.NonBlocking)return;yield M;return}}catch(e){o("WALogger").ERROR(c||(c=babelHelpers.taggedTemplateLiteralLoose(["processRenderableMessage: msgId:",", failed with error: ",""])),t.externalId,e).tags("messaging").sendLogs("handle_msg: error storing/processing single message")}return(d||(d=n("Promise"))).resolve()}),h.apply(this,arguments)}function y(e){switch(e){case o("WAWebHandleMsgTypes.flow").MessageOverwriteOption.NO_OVERWRITE:case o("WAWebHandleMsgTypes.flow").MessageOverwriteOption.FUTURE_PROOF:case o("WAWebHandleMsgTypes.flow").MessageOverwriteOption.VOIP_CALL_LOG:return null;case o("WAWebHandleMsgTypes.flow").MessageOverwriteOption.RETRY:return o("WAWebWamEnumPlaceholderPopulationType").PLACEHOLDER_POPULATION_TYPE.RETRY;case o("WAWebHandleMsgTypes.flow").MessageOverwriteOption.PEER_RETRY:return o("WAWebWamEnumPlaceholderPopulationType").PLACEHOLDER_POPULATION_TYPE.PEER_MESSAGE}}l.overrideParentKeyForAssociations=p,l.processRenderableMessages=g}),98);
__d("WAWebParsedProtocolMsgType",[],(function(t,n,r,o,a,i){var e=Object.freeze({HISTORY:"history",APP_STATE_SYNC_KEY_SHARE:"appStateSyncKeyShare",APP_STATE_SYNC_KEY_REQUEST:"appStateSyncKeyRequest",PEER_DATA_OPERATION_REQUEST_RESPONSE_MESSAGE:"peerDataOperationRequestResponseMessage",PEER_DATA_OPERATION_REQUEST_MESSAGE:"peerDataOperationRequestMessage"});i.PARSED_PROTOCOL_MESSAGE_TYPE=e}),66);
__d("WAWebHandleMsgProcess",["Promise","WACryptoPkcs7","WALogger","WAWebABProps","WAWebAddonGatingUtils","WAWebAddonProcessMsgsUtils","WAWebApiDeferredMessagesStorage","WAWebBackendApi","WAWebBackendJobs.flow","WAWebBizCoexGatingUtils","WAWebCmd","WAWebCurrentUser","WAWebDBMsgUtils","WAWebGetGroupAddressingMode","WAWebGetMessageCache","WAWebHandleCloudApiThreadControlNotification","WAWebHandleMsgError","WAWebHandleMsgProcessUtils","WAWebHandleMsgTypes.flow","WAWebHandleMsgValidate","WAWebHandlePushnameUpdate","WAWebLid1X1ThreadAccountMigrations","WAWebLogMissingGroupParticipantMappings","WAWebLogReceivedMessages","WAWebMessageEditGatingUtils","WAWebMessageProcessPlaceholder","WAWebMessageProcessRenderable","WAWebMessageProcessorCache","WAWebMessagingGatingUtils","WAWebMsgProcessingApiUtils","WAWebMsgType","WAWebOfflineResumeMsgProcessReporter","WAWebParsedProtocolMsgType","WAWebProtobufsE2E.pb","WAWebRuntimeEnvironmentUtils","WAWebSignal","WAWebUserPrefsMeUser","WAWebUserPrefsNotifications","WAWebVerifyProtobufMsgObjectKeys","WAWebWamEnumDsmError","WAWebWid","WAWebWidFactory","WAWebWorkerSafeBackendApi","asyncToGeneratorRuntime","cr:10197","decodeProtobuf","isStringNullOrEmpty"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p,_,f,g,h,y,C;function b(e){return v.apply(this,arguments)}function v(){return v=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e.decrypted,a=e.info,i=e.paymentInfo,l=e.e2eInfo,s=e.bizInfo,u=e.hsmInfo,c=e.isPadded,d=c===void 0?!0:c,m=e.msgMeta,b=e.reparsing,v=b===void 0?!1:b,R=e.msgBotInfo,L=e.reportingTokenInfo,E=l.e2eType===o("WAWebBackendJobs.flow").CiphertextType.Msmsg?!1:d,k=E?o("WACryptoPkcs7").unpadPkcs7(new Uint8Array(t)):new Uint8Array(t),I=o("decodeProtobuf").decodeProtobuf(o("WAWebProtobufsE2E.pb").MessageSpec,k);o("WAWebVerifyProtobufMsgObjectKeys").verifyProtobufMessageObjectKeys(I);var T=o("WAWebMsgProcessingApiUtils").getFrom(a),$=l.retryCount>0&&o("WAWebMsgProcessingApiUtils").isRevokeInfo(a)||v,P=$?o("WAWebHandleMsgTypes.flow").MessageOverwriteOption.RETRY:o("WAWebHandleMsgTypes.flow").MessageOverwriteOption.NO_OVERWRITE;if(v){o("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["Reparsing processDecryptedMessageProto: msgId::",", message decrypted:"])),a.externalId).tags("messaging").devConsole(I);var N=yield o("WAWebMsgProcessingApiUtils").parseMessage({info:a,ciphertextType:l.e2eType,msgProtobuf:I,paymentInfo:i,bizInfo:s,hsmInfo:u,hidePlaceholder:l.hideFail,processDecryptedProtoParams:e,msgBotInfo:R,meta:m,reportingTokenInfo:L,isMessageRetry:l.retryCount>0,isOffline:a.offline!=null,protobufBytes:k});if(N.renderableMsgs==null)o("WALogger").ERROR(_||(_=babelHelpers.taggedTemplateLiteralLoose(["parsed render able msgs not reparsed as expected"])));else{var M=N.renderableMsgs;o("WAWebHandleMsgValidate").renderableMessagesValidation({renderableMsgs:M,msgMeta:m,info:a,proto:I,bizInfo:s}),o("WAWebMessagingGatingUtils").isWebReportingTokenDelayProcessingEnabled()||(yield o("WAWebHandleMsgValidate").validateAndProcessReportingTokenInfo({renderableMsgs:M}));var w=S({renderableMsgs:M,reparsing:v,bizInfo:s,msgMeta:m,paymentInfo:i,info:a,messageOverwriteOption:P}),A=w.tasks,F=w.hasInactiveMsg;return yield(C||(C=n("Promise"))).all(A),o("WALogger").LOG(f||(f=babelHelpers.taggedTemplateLiteralLoose(["Reparsed processDecryptedMessageProto: msgId::",", message decrypted:"])),a.externalId).tags("messaging").devConsole(I),{hasInactiveMsg:F}}}var O=yield o("WAWebHandleMsgProcessUtils").preProcessMsg(a,I);if(o("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()&&((O==null?void 0:O.senderOrRecipientAccountTypeHosted)===!0&&(a.senderOrRecipientAccountTypeHosted=!0),(O==null?void 0:O.hostedBizEncMismatch)===!0&&(a.hostedBizEncStateMismatch=!0)),a.type===o("WAWebHandleMsgTypes.flow").MESSAGE_TYPE.PEER_BROADCAST&&l.retryCount>0){var B=yield o("WAWebDBMsgUtils").getMsgByMsgKey(o("WAWebMsgProcessingApiUtils").messageInfoToKey(a));(B==null?void 0:B.bclParticipants)!=null?a.bclParticipants=B.bclParticipants:(B==null?void 0:B.broadcastParticipants)!=null&&(a.bclParticipants=B.broadcastParticipants.map(function(e){return{wid:o("WAWebWidFactory").asUserWidOrThrow(e)}}))}var W=o("WAWebOfflineResumeMsgProcessReporter").msgProcessReporter.startMarker(o("WAWebOfflineResumeMsgProcessReporter").msgProcessReporter.stage.Parsing),q=yield o("WAWebMsgProcessingApiUtils").parseMessage({info:a,ciphertextType:l.e2eType,msgProtobuf:I,paymentInfo:i,bizInfo:s,hsmInfo:u,hidePlaceholder:l.hideFail,processDecryptedProtoParams:e,msgBotInfo:R,meta:m,reportingTokenInfo:L,isMessageRetry:l.retryCount>0,isOffline:a.offline!=null,protobufBytes:k});if(o("WAWebCurrentUser").isEmployee()&&o("WAWebABProps").getABPropConfigValue("wa_web_debug_color_code_retry_messages")){var U;(U=q.renderableMsgs)==null||U.forEach(function(e){l.retryCount>0&&(e.backgroundColor=16711680)})}W==null||W();var V=null;if(q.history?V=o("WAWebParsedProtocolMsgType").PARSED_PROTOCOL_MESSAGE_TYPE.HISTORY:q.appStateSyncKeyShare?V=o("WAWebParsedProtocolMsgType").PARSED_PROTOCOL_MESSAGE_TYPE.APP_STATE_SYNC_KEY_SHARE:q.appStateSyncKeyRequest?V=o("WAWebParsedProtocolMsgType").PARSED_PROTOCOL_MESSAGE_TYPE.APP_STATE_SYNC_KEY_REQUEST:q.peerDataOperationRequestResponseMessage?V=o("WAWebParsedProtocolMsgType").PARSED_PROTOCOL_MESSAGE_TYPE.PEER_DATA_OPERATION_REQUEST_RESPONSE_MESSAGE:q.peerDataOperationRequestMessage&&(V=o("WAWebParsedProtocolMsgType").PARSED_PROTOCOL_MESSAGE_TYPE.PEER_DATA_OPERATION_REQUEST_MESSAGE),o("WAWebRuntimeEnvironmentUtils").isWorker()&&V)yield r("WAWebApiDeferredMessagesStorage").updateDeferredMessages([{id:a.externalId,type:V,plaintext:k,info:a,paymentInfo:i,bizInfo:s}]);else if(q.history)o("WAWebWorkerSafeBackendApi").workerSafeSendAndReceive("handleHistorySyncNotification",{historySyncMetaData:q.history,from:T,externalId:a.externalId});else if(q.appStateSyncKeyShare)yield o("WAWebWorkerSafeBackendApi").workerSafeSendAndReceive("handleAppStateSyncKeyShare",{keyShare:q.appStateSyncKeyShare,from:T});else if(q.appStateSyncKeyRequest)o("WAWebWorkerSafeBackendApi").workerSafeSendAndReceive("handleAppStateSyncKeyRequest",{keyRequest:q.appStateSyncKeyRequest,from:T});else if(q.peerDataOperationRequestResponseMessage)o("WAWebWorkerSafeBackendApi").workerSafeSendAndReceive("handlePeerDataOperationRequestResponse",{stanzaId:a.externalId,response:q.peerDataOperationRequestResponseMessage});else if(q.peerDataOperationRequestMessage)o("WAWebWorkerSafeBackendApi").workerSafeSendAndReceive("handlePeerDataOperationRequest",{stanzaId:a.externalId,request:q.peerDataOperationRequestMessage});else if(q.securityNotificationEnabled)o("WAWebUserPrefsMeUser").getMaybeMeDevicePn()==null?o("WALogger").ERROR(g||(g=babelHelpers.taggedTemplateLiteralLoose(["Me wid is empty during security notification parsing"]))).sendLogs("Me wid is empty during security notification parsing"):T==null||!(T instanceof r("WAWebWid"))?o("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Handle security notification empty wid error"]))).sendLogs("Handle security notification empty wid error"):o("WAWebUserPrefsMeUser").isMePrimaryNonLid(T)?o("WAWebUserPrefsNotifications").setGlobalSecurityNotifications(q.securityNotificationEnabled.isEnabled):o("WALogger").ERROR(y||(y=babelHelpers.taggedTemplateLiteralLoose(["Handle security notification payload wid error"]))).sendLogs("Handle security notification payload wid error");else if(q.cloudApiThreadControlNotification)r("WAWebHandleCloudApiThreadControlNotification")(q.cloudApiThreadControlNotification);else if(q.lidMigrationSyncMessage!=null){var H;yield o("WAWebLid1X1ThreadAccountMigrations").setLidMigrationMappings((H=q.lidMigrationSyncMessage)==null?void 0:H.encodedMappingPayload)}else{var G=!1;if(q.deviceSent==null?G=!0:q.deviceSent.phash?G=yield o("WAWebHandleMsgValidate").validateBclHash(q.deviceSent.phash,q.deviceSent.info):q.deviceSent.destination&&(G=yield o("WAWebHandleMsgValidate").validateMsgDestination(q.deviceSent.destination,a)),!G)throw new(o("WAWebHandleMsgError")).DeviceSentMessageError(o("WAWebMsgProcessingApiUtils").getDeviceType(a.author),o("WAWebWamEnumDsmError").DSM_ERROR.INVALID_DSM);var z=q.renderableMsgs;if(o("WAWebHandleMsgValidate").renderableMessagesValidation({renderableMsgs:z,msgMeta:m,info:a,proto:I,bizInfo:s}),!o("WAWebMessagingGatingUtils").isWebReportingTokenDelayProcessingEnabled()){var j=o("WAWebOfflineResumeMsgProcessReporter").msgProcessReporter.startMarker(o("WAWebOfflineResumeMsgProcessReporter").msgProcessReporter.stage.ProcessReportingTokenInfo);yield o("WAWebHandleMsgValidate").validateAndProcessReportingTokenInfo({renderableMsgs:z}),j==null||j()}var K=S({renderableMsgs:z,reparsing:v,bizInfo:s,msgMeta:m,paymentInfo:i,info:a,messageOverwriteOption:P}),Q=K.tasks,X=K.hasInactiveMsg;q.storeMsg!=null&&o("WAWebMessageProcessorCache").messageProcessorCache.addMessages([{msg:q.storeMsg}],!1);var Y=q.senderKey;Y!=null&&Q.push(o("WAWebSignal").Session.createGroupSignalSession(a.author,Y.groupId,Y.key)),r("isStringNullOrEmpty")(a.pushname)||o("WAWebHandlePushnameUpdate").updatePushname(a.author,a.pushname,a.offline!=null);var J=D(a.chat);yield(C||(C=n("Promise"))).all(Q);var Z=yield J;return o("WAWebLogMissingGroupParticipantMappings").logMissingGroupParticipantMappings(a.chat,a.author,a.addressingMode,Z),o("WAWebLogReceivedMessages").logReceivedMessagesInWAM({msgs:q.renderableMsgs,offline:x(a.offline),tsMillis:a.ts*1e3,clientReceivedTsMillis:a.clientReceivedTsMillis,msgProcessStartTsMillis:a.msgProcessStartTsMillis,serverAddressingMode:a.addressingMode,localAddressingMode:Z}),{hasInactiveMsg:X}}return{hasInactiveMsg:!1}}),v.apply(this,arguments)}function S(t){var n,r,a,i,l,p=t.renderableMsgs,_=t.reparsing,f=t.bizInfo,g=t.msgMeta,h=t.paymentInfo,y=t.info,C=t.messageOverwriteOption,b=[],v=!1,S=p[0],L=o("WAWebAddonGatingUtils").isUnifiedInfraEnabledForType(S==null?void 0:S.type)?o("WAWebAddonProcessMsgsUtils").castToAddonMsgData(S):null;return L!=null?(o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["processMsgs: addon"]))),v=!0,b.push(I(L,y,_,C))):S!=null&&S.kind===o("WAWebMsgType").MsgKind.PollVoteEncrypted?(o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["processMsgs: pollVote"]))),b.push(E(S,y,_))):((n=p[0])==null?void 0:n.type)===o("WAWebMsgType").MSG_TYPE.KEEP_IN_CHAT?(o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["processMsgs: keepInChat"]))),v=!0,b.push(o("WAWebHandleMsgProcessUtils").processKeepInChatMsg(p[0],y,_))):o("WAWebMessageEditGatingUtils").receiveTextEditEnabled()&&((r=p[0])==null?void 0:r.type)===o("WAWebMsgType").MSG_TYPE.PROTOCOL&&((a=p[0])==null?void 0:a.subtype)==="message_edit"?(o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["processMsgs: messageEdit"]))),b.push(o("WAWebHandleMsgProcessUtils").processEditProtocolMsg(p[0],y,_))):((i=p[0])==null?void 0:i.type)===o("WAWebMsgType").MSG_TYPE.PROTOCOL&&((l=p[0])==null?void 0:l.subtype)==="ephemeral_sync_response"?(o("WALogger").LOG(d||(d=babelHelpers.taggedTemplateLiteralLoose(["processMsgs: ephemeralSyncResponse"]))),b.push(o("WAWebHandleMsgProcessUtils").processEphemeralSyncResponseMsg({msg:p[0],msgInfo:y,reparsing:_}))):p.length>0&&(o("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["processMsgs: renderableMsgs"]))),b.push(R(p,y,h,f,g,C,_))),{tasks:b,hasInactiveMsg:v}}function R(e,t,n,r,a,i,l){return o("WAWebMessageProcessRenderable").processRenderableMessages(e,t,n,r,a,i,l)}function L(e){return o("WAWebMessageProcessPlaceholder").processPlaceholderMessage(e)}function E(e,t,n){return k.apply(this,arguments)}function k(){return k=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n){var r=t.offline!=null&&!n,a=e,i=o("WAWebGetMessageCache").getMessageCache().addMessages([{msg:a}],!r);(n||o("WAWebCmd").Cmd.isMainStreamReadyMd&&o("WAWebCmd").Cmd.isOfflineDeliveryEnd)&&(yield i)}),k.apply(this,arguments)}function I(e,t,n,r){return T.apply(this,arguments)}function T(){return T=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n,r){var a=t.offline!=null&&!n,i=e,l=o("WAWebGetMessageCache").getMessageCache().addMessages([{msg:i}],!a);(n||o("WAWebCmd").Cmd.isMainStreamReadyMd&&o("WAWebCmd").Cmd.isOfflineDeliveryEnd)&&(yield l),r===o("WAWebHandleMsgTypes.flow").MessageOverwriteOption.RETRY&&o("WAWebBackendApi").frontendFireAndForget("removePlaceholder",{msg:e})}),T.apply(this,arguments)}function D(e){return o("WAWebGetGroupAddressingMode").getGroupAddressingMode(e)}function x(e){var t=parseInt(e,10);return Number.isNaN(t)?null:t}l.processDecryptedMessageProto=b,l.processMsgs=S,l.processRenderableMsg=R,l.processPlaceholderMsg=L}),98);
__d("WAWebMessageHighRetryCountWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumE2eDeviceType","WAWebWamEnumInvisibleMessageCategoryType","WAWebWamEnumMediaType","WAWebWamEnumMessageType","WAWebWamEnumSizeBucket"],(function(t,n,r,o,a,i,l){var e,s=(e=o("WAWebWamCodegenUtils")).defineEvents({MessageHighRetryCount:[3132,{deviceSizeBucket:[5,o("WAWebWamEnumSizeBucket").SIZE_BUCKET],e2eSenderType:[3,o("WAWebWamEnumE2eDeviceType").E2E_DEVICE_TYPE],invisibleMessageCategory:[6,o("WAWebWamEnumInvisibleMessageCategoryType").INVISIBLE_MESSAGE_CATEGORY_TYPE],isPq:[9,e.TYPES.BOOLEAN],isReceiverLidBased:[7,e.TYPES.BOOLEAN],isSenderLidBased:[8,e.TYPES.BOOLEAN],mediaType:[1,o("WAWebWamEnumMediaType").MEDIA_TYPE],messageType:[4,o("WAWebWamEnumMessageType").MESSAGE_TYPE],retryCount:[2,e.TYPES.INTEGER]},[1,20,20],"regular"]},{MessageHighRetryCount:[]});l.MessageHighRetryCountWamEvent=s}),98);
__d("WAWebPostMessageHighRetryCountMetric",["WAWebMessageHighRetryCountWamEvent","WAWebMessagingGatingUtils","WAWebWamGroupMetricCache","WAWebWamMsgUtils","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e=5;function s(e,t){return u.apply(this,arguments)}function u(){return u=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,n){if(!(t<e)){var r=new(o("WAWebMessageHighRetryCountWamEvent")).MessageHighRetryCountWamEvent({retryCount:t,messageType:o("WAWebWamMsgUtils").getMessageTypeFromMsgInfoType(n.type)}),a=o("WAWebWamMsgUtils").getWamE2eSenderType(n.author);a!=null&&(r.e2eSenderType=a);var i=n.chat;if(i!=null&&i.isGroup()){var l=yield o("WAWebWamGroupMetricCache").getGroupMetrics(i);(l==null?void 0:l.deviceSizeBucket)!=null&&(r.deviceSizeBucket=l.deviceSizeBucket),(l==null?void 0:l.participantCount)!=null&&l.participantCount>o("WAWebMessagingGatingUtils").getGroupSizeBypassingSampling()&&(r.weight=0)}r.commit()}}),u.apply(this,arguments)}l.MAX_RETRY=e,l.maybePostMessageHighRetryCountMetric=s}),98);
__d("WAWebSendDeliveryReceiptJob",["WADeprecatedSendIq","WAJids","WAWap","WAWebCommsWapMd","WAWebOnlineDanglingReceipts","WAWebSendReceiptJobCommon","WAWebUserPrefsMeUser","WAWebWidToJid","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){function e(e,t,n,r,o,a){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n,r,a,i){var l=t.isUser()&&o("WAWebUserPrefsMeUser").isMeAccount(t)||r!=null&&o("WAWebUserPrefsMeUser").isMeAccount(r),s=i.hasInactiveMsg===!0&&!l,c=!s;u(e,t,n,r,c,l,a)}),s.apply(this,arguments)}function u(e,t,n,r,o,a,i){return c.apply(this,arguments)}function c(){return c=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n,r,a,i,l){var s=o("WAWap").DROP_ATTR;l?s=o("WAWebSendReceiptJobCommon").RECEIPT_TYPE.PEER_MSG:i?(s=o("WAWebSendReceiptJobCommon").RECEIPT_TYPE.SENDER,n&&o("WAWebSendReceiptJobCommon").logMixedSenderReceipt(n,t)):a||(s=o("WAWebSendReceiptJobCommon").RECEIPT_TYPE.INACTIVE);var u=o("WAJids").extractJidFromJidWithType(o("WAWebWidToJid").widToJidWithType(t)),c=o("WAWap").wap("receipt",{id:o("WAWap").CUSTOM_STRING(e),to:o("WAWap").JID(u),participant:(t.isGroup()||t.isBroadcast())&&r?o("WAWebCommsWapMd").DEVICE_JID(r):o("WAWap").DROP_ATTR,recipient:!l&&i&&n?o("WAWebCommsWapMd").USER_JID(n):o("WAWap").DROP_ATTR,type:s});o("WAWebOnlineDanglingReceipts").addOnlineDanglingReceipts(t,r||t,e),o("WADeprecatedSendIq").deprecatedCastStanza(c)}),c.apply(this,arguments)}l.sendDeliveryReceiptsAfterDecryption=e}),98);
__d("WAWebSendRetryReceiptJob",["$InternalEnum","Promise","WADeprecatedSendIq","WALogger","WAWap","WAWebAdvSignatureApi","WAWebCommsAckParser","WAWebCommsWapMd","WAWebConstantsDeprecated","WAWebCryptoCurve25519","WAWebEphemeralDecodeBroadcastSetting","WAWebHandleMsgError","WAWebSignalCommonErrors","WAWebSignalKeyApi","WAWebSignalProtocolStore","WAWebSignalStoreApi","WAWebSignalUtilsApi","WAWebUserPrefsMeUser","WAWebWidFactory","asyncToGeneratorRuntime","cr:10198","cr:4533","err","gkx"],(function(t,n,r,o,a,i,l){var e,s,u,c,d=2,m=n("$InternalEnum")({UnknownError:0,SignalErrorNoSession:1,SignalErrorInvalidKey:2,SignalErrorInvalidKeyId:3,SignalErrorInvalidMessage:4,SignalErrorInvalidSignature:5,SignalErrorFutureMessage:6,SignalErrorBadMac:7,SignalErrorInvalidSession:8,SignalErrorInvalidMsgKey:9,BadBroadcastEphemeralSetting:10,UnknownCompanionNoPrekey:11,AdvFailure:12,StatusRevokeDelay:13});function p(e){return _.apply(this,arguments)}function _(){return _=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var a=t.retryCount,i=t.to,l=t.participant,u=t.recipient,d=t.externalId,m=t.rawTs,p=t.isPeer,_=p===void 0?!1:p,g=t.retryReason;if(r("gkx")("26258")||n("cr:10198")==null||n("cr:10198").injectDebug(i,"RetryReceiptSent","externalId:"+d),!r("gkx")("26258")){var h=n("cr:4533")==null?void 0:n("cr:4533").getDebugDoNotSendRetryReceipt();if(h!=null&&h>0)return n("cr:4533")==null||n("cr:4533").setDebugDoNotSendRetryReceipt(h-1),(c||(c=n("Promise"))).resolve()}try{var y=o("WAWebSignalProtocolStore").getSignalProtocolStore(),C=yield(c||(c=n("Promise"))).all([y.getLocalRegistrationId(),y.getIdentityKeyPair()]),b=C[0],v=C[1];if(b==null||v==null)throw r("err")("No registration info found");var S;try{S=yield f(a,o("WAWebCryptoCurve25519").toCurveKeyPair(v))}catch(t){o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["error: ",""])),t).sendLogs("sendRetryReceipt: error while creating key section in retry receipt")}var R=!i.isBot()&&!!(l!=null&&l.isBot());if(R)return;var L=o("WAWap").DROP_ATTR,E=o("WAWap").DROP_ATTR,k=o("WAWap").DROP_ATTR,I;if(i.isUser()){if(I=o("WAWebCommsWapMd").DEVICE_JID(i),o("WAWebUserPrefsMeUser").isMeAccount(o("WAWebWidFactory").asUserWidOrThrow(i)))if(_)L="peer";else if(u)E=o("WAWebCommsWapMd").USER_JID(u);else return(c||(c=n("Promise"))).reject(r("err")("sendRetryReceipt: send retry to peer device without recipient"))}else I=o("WAWebCommsWapMd").CHAT_JID(i),k=l?o("WAWebCommsWapMd").DEVICE_JID(l):o("WAWap").DROP_ATTR;var T=o("WAWap").wap("receipt",{id:o("WAWap").CUSTOM_STRING(d),to:I,participant:k,recipient:E,type:"retry",category:L},o("WAWap").wap("retry",{v:"1",count:o("WAWap").INT(a),id:o("WAWap").CUSTOM_STRING(d),t:o("WAWap").CUSTOM_STRING(m),error:g!=null?o("WAWap").INT(g):o("WAWap").DROP_ATTR}),o("WAWap").wap("registration",null,o("WAWap").BIG_ENDIAN_CONTENT(b)),S);return o("WADeprecatedSendIq").deprecatedSendStanzaAndWaitForAck(T,o("WAWebCommsAckParser").toCoreAckTemplate({id:d,class:"receipt",from:i,participant:l,type:"retry"}))}catch(e){o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["error: ",""])),e).sendLogs("sendRetryReceipt: error while creating or sending the retry message")}}),_.apply(this,arguments)}function f(e,t){return g.apply(this,arguments)}function g(){return g=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=yield h(e,t),r=n[0],a=n[1];return a&&(yield o("WAWebSignalStoreApi").waSignalStore.markKeyAsUploaded(a.keyId),yield o("WAWebSignalStoreApi").waSignalStore.markPreKeyAsDirectDistribution(a.keyId)),r}),g.apply(this,arguments)}function h(e,t){return y.apply(this,arguments)}function y(){return y=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){if(e<d)return(c||(c=n("Promise"))).resolve([null,null]);try{var a=yield(c||(c=n("Promise"))).all([o("WAWebSignalStoreApi").waSignalStore.getSignedPreKey(),o("WAWebSignalStoreApi").waSignalStore.getOrGenSinglePreKey(o("WAWebSignalKeyApi").generatePreKeyPair),o("WAWebAdvSignatureApi").getADVEncodedIdentity().then(function(e){return(e==null||e.byteLength===0)&&o("WALogger").ERROR(u||(u=babelHelpers.taggedTemplateLiteralLoose(["getADVEncodedIdentity: sending empty device-identity"]))).sendLogs("sending-retry-response-with-empty-device-identity",{sampling:r("gkx")("26259")?1:.1}),o("WAWap").wap("device-identity",null,e)})]),i=a[0],l=a[1],s=a[2];if(!i)throw r("err")("Signed pre key is not available");var m=o("WAWap").wap("keys",null,o("WAWap").wap("type",null,r("WAWebConstantsDeprecated").KEY_BUNDLE_TYPE),o("WAWap").wap("identity",null,t.pubKey),o("WAWebSignalUtilsApi").xmppPreKey(l),o("WAWebSignalUtilsApi").xmppSignedPreKey(i),s);return[m,l]}catch(e){throw r("err")("Could not create keys section for retry")}}),y.apply(this,arguments)}function C(e){if(e instanceof o("WAWebHandleMsgError").UnknownDeviceMessageError)return m.UnknownCompanionNoPrekey;if(e instanceof o("WAWebSignalCommonErrors").SignalDecryptionError)switch(e.message){case"errSignalNoSession":case"errLoadSenderKeySession":return m.SignalErrorNoSession;case"errSignalInvalidMsg":return m.SignalErrorInvalidMessage;case"errSignalInvalidKey":return m.SignalErrorInvalidKey;case"errSignalTooManyMessagesInFuture":case"errSignalGrpTooManyMessagesInFuture":return m.SignalErrorFutureMessage;case"errInvalidMacWithDecryptedPlaintext":case"errInvalidMacInvalidCipherKey":case"errInvalidMacInvalidCipherKeyNewChain":return m.SignalErrorBadMac}else if(e instanceof o("WAWebEphemeralDecodeBroadcastSetting").BroadcastEphSettingsError)return m.BadBroadcastEphemeralSetting}l.RetryReason=m,l.sendRetryReceipt=p,l.getRetryReasonFromError=C}),98);
__d("WAWebHandleMsgSendReceipt",["WALogger","WAWebBizCoexGatingUtils","WAWebCreateNackFromStanza","WAWebHandleMsgCommon","WAWebHandleMsgSendAck","WAWebHandleMsgTypes.flow","WAWebMsgProcessingApiUtils","WAWebPostMessageHighRetryCountMetric","WAWebSendDeliveryReceiptJob","WAWebSendReceiptJobCommon","WAWebSendRetryReceiptJob","WAWebUserPrefsMeUser","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u,c;function d(e,t,n){return m.apply(this,arguments)}function m(){return m=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,n,r){var a;o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["sendReceipt"])));var i=t.externalId,l=n.rawTs,d=n.type,m=o("WAWebMsgProcessingApiUtils").getFrom(t),p=null;if(t.type===o("WAWebHandleMsgTypes.flow").MESSAGE_TYPE.CHAT&&o("WAWebUserPrefsMeUser").isMeAccount(t.author))if(t.originalBotRecipient!=null)p=t.originalBotRecipient;else{var _;p=(_=t.preMatChat)!=null?_:t.chat}var f=t.type===o("WAWebHandleMsgTypes.flow").MESSAGE_TYPE.CHAT?null:(a=t.preMatChat)!=null?a:t.author,g=t.category===o("WAWebHandleMsgCommon").CATEGORY_PEER,h=!t.chat.isBot()&&t.author.isBot();switch(r.result){case o("WAWebHandleMsgTypes.flow").E2EProcessResult.SUCCESS:case o("WAWebHandleMsgTypes.flow").E2EProcessResult.SIGNAL_OLD_COUNTER_ERROR:if(h){var y,C,b;return t.type===o("WAWebHandleMsgTypes.flow").MESSAGE_TYPE.CHAT?(y=t.author,C=t.chat):(y=t.chat,b=t.author),o("WAWebSendReceiptJobCommon").sendBotInvokeResponseAcks([i],y,C,b)}else if(n.type===o("WAWebHandleMsgCommon").STANZA_MSG_TYPES.medianotify)return o("WAWebHandleMsgSendAck").sendAck(i,m,d,f);return o("WAWebSendDeliveryReceiptJob").sendDeliveryReceiptsAfterDecryption(i,m,p,f,g,r);case o("WAWebHandleMsgTypes.flow").E2EProcessResult.HSM_MISMATCH:o("WALogger").WARN(s||(s=babelHelpers.taggedTemplateLiteralLoose(['sendReceipt: HSM mismatch, no receipt sent for "','"'])),i).sendLogs("send-receipt-skipping-hsm-mismatch-result");return;case o("WAWebHandleMsgTypes.flow").E2EProcessResult.RETRY:{if(m!=null&&m.isHosted()&&!o("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled())return o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["Drop retry for coex when feature is disabled"]))),o("WAWebHandleMsgSendAck").sendAck(i,m,d,f);var v=r.retryCount==null?1:r.retryCount+1;yield o("WAWebSendRetryReceiptJob").sendRetryReceipt({retryCount:v,to:m,participant:f,recipient:p,externalId:i,rawTs:l,isPeer:g,retryReason:r.retryReason}),o("WAWebPostMessageHighRetryCountMetric").maybePostMessageHighRetryCountMetric(v,t);return}case o("WAWebHandleMsgTypes.flow").E2EProcessResult.BACKFILL:return o("WAWebHandleMsgSendAck").sendAck(i,m,d,f);case o("WAWebHandleMsgTypes.flow").E2EProcessResult.PARSE_VALIDATION_ERROR:return o("WAWebHandleMsgSendAck").sendNack(i,m,d,f,o("WAWebCreateNackFromStanza").NackReason.InvalidProtobuf,r.e2eFailureReason);case o("WAWebHandleMsgTypes.flow").E2EProcessResult.PARSE_ERROR:return o("WAWebHandleMsgSendAck").sendNack(i,m,d,f,o("WAWebCreateNackFromStanza").NackReason.ParsingError)}return o("WALogger").ERROR(c||(c=babelHelpers.taggedTemplateLiteralLoose(['sendReceipt: invalid e2eProcessResult "','"'])),r.result).sendLogs("send-receipt-missing-e2e-process-result"),o("WAWebHandleMsgSendAck").sendAck(i,m,d,f)}),m.apply(this,arguments)}l.sendReceipt=d}),98);
__d("WAWebWamEnumCallStanzaType",[],(function(t,n,r,o,a,i){var e=Object.freeze({OFFER:0,ACCEPT:1,REJECT:2,VIDEO:3,TERMINATE:4,ENC_REKEY:5,RELAYLATENCY:6,TRANSPORT:7,PREACCEPT:8,GROUP_UPDATE:9,MUTE_V2:10,INTERRUPTION:11,FLOWCONTROL:12,NOTIFY:13,OFFER_NOTICE:14,CALL_RELAY:15,MUTE:16,SCREEN_SHARE:17,UNKNOWN:18});i.CALL_STANZA_TYPE=e}),66);
__d("WAWebWamEnumStanzaType",[],(function(t,n,r,o,a,i){var e=Object.freeze({MESSAGE:1,RECEIPT:2,CALL:3,NOTIFICATION:4,APPDATA:5});i.STANZA_TYPE=e}),66);
__d("WAWebOfflineCountTooHighWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumCallStanzaType","WAWebWamEnumEncryptionTypeCode","WAWebWamEnumInvisibleMessageCategoryType","WAWebWamEnumMediaType","WAWebWamEnumMessageType","WAWebWamEnumStanzaType"],(function(t,n,r,o,a,i,l){var e,s=(e=o("WAWebWamCodegenUtils")).defineEvents({OfflineCountTooHigh:[2638,{callStanzaType:[7,o("WAWebWamEnumCallStanzaType").CALL_STANZA_TYPE],encryptionType:[9,o("WAWebWamEnumEncryptionTypeCode").ENCRYPTION_TYPE_CODE],invisibleMessageCategory:[8,o("WAWebWamEnumInvisibleMessageCategoryType").INVISIBLE_MESSAGE_CATEGORY_TYPE],mediaType:[3,o("WAWebWamEnumMediaType").MEDIA_TYPE],messageType:[4,o("WAWebWamEnumMessageType").MESSAGE_TYPE],notificationStanzaType:[6,e.TYPES.STRING],offlineCount:[2,e.TYPES.INTEGER],receiptStanzaType:[5,e.TYPES.STRING],stanzaType:[1,o("WAWebWamEnumStanzaType").STANZA_TYPE]},[1,1,1],"regular"]},{OfflineCountTooHigh:[]});l.OfflineCountTooHighWamEvent=s}),98);
__d("WAWebMaybePostOfflineCountTooHighMetric",["WALogger","WAWebBackendJobsCommon","WAWebOfflineCountTooHighWamEvent","WAWebWamEnumStanzaType","WAWebWamMsgUtils"],(function(t,n,r,o,a,i,l){var e,s=11;function u(t){var n,r=t.msgInfo,a=t.msgMeta,i=t.encs,l=parseInt(r.offline,10);if(!(Number.isNaN(l)||l<s)){var u=new(o("WAWebOfflineCountTooHighWamEvent")).OfflineCountTooHighWamEvent({offlineCount:l,stanzaType:o("WAWebWamEnumStanzaType").STANZA_TYPE.MESSAGE,mediaType:o("WAWebBackendJobsCommon").getMetricMediaType({encMediaType:(n=i.find(function(e){return e.encMediaType!=null}))==null?void 0:n.encMediaType,msgType:a.type,msgPollType:a.pollType})}),c=o("WAWebWamMsgUtils").getMessageTypeFromMsgInfoType(r.type);c!=null&&(u.messageType=c),u.commitAndWaitForFlush().catch(function(t){o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["Failed to post OfflineCountTooHigh metric: ",""])),t).tags("messaging")})}}l.OFFLINE_COUNT_TOO_HIGH_THRESHOLD=s,l.maybePostOfflineCountTooHigh=u}),98);
__d("WAWebMsgProcessingDecryptEnc",["Promise","WAWebBackendJobs.flow","WAWebBotMessageSecret","WAWebMsgProcessingApiUtils","WAWebSignal","err"],(function(t,n,r,o,a,i,l){var e;function s(t,a,i,l){var s=t.e2eType,u=t.ciphertext;switch(s){case o("WAWebBackendJobs.flow").CiphertextType.Skmsg:return a.isGroup()||a.isBroadcast()?i?o("WAWebSignal").Cipher.decryptGroupSignalProto(a,i,u):(e||(e=n("Promise"))).reject(r("err")("['messaging'] decryptEnc: receive msg from "+a.toString()+" without participant")):(e||(e=n("Promise"))).reject(r("err")("['messaging'] decryptEnc: Can not do skmsg for non group "+a.toString()));case o("WAWebBackendJobs.flow").CiphertextType.Pkmsg:case o("WAWebBackendJobs.flow").CiphertextType.Msg:{var c=a.isUser()?a:i;if(!c)return(e||(e=n("Promise"))).reject(r("err")("['messaging'] decryptEnc: receive msg from "+a.toString()+" without participant"));var d=o("WAWebMsgProcessingApiUtils").shouldOmitSessionPersistence(s,l);return o("WAWebSignal").Cipher.decryptSignalProto(c,s,u,d)}case o("WAWebBackendJobs.flow").CiphertextType.Msmsg:return o("WAWebBotMessageSecret").decryptMsmsgBotMessage(u,l)}}l.decryptEnc=s}),98);
__d("WAWebIsOfficialClient",["WALogger","WAWebUA","WAWebWamGlobals","gkx"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m=function(){var e=typeof self!="undefined"?self.navigator:null;return!!e.webdriver},p=function(){return!(m()||o("WAWebUA").UA.isChrome&&/HeadlessChrome/.test(window.navigator.userAgent))},_=function(){try{var t=new Error,n=t.stack,a=n.split("\n").filter(function(e){return!!e.trim()}).pop();if(a==null)return o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["A caller is not found ",""])),n).tags("uc"),!0;if(!a.includes(".whatsapp.com"))return r("gkx")("26258")?o("WALogger").WARN(u||(u=babelHelpers.taggedTemplateLiteralLoose(["Caller ",""])),a).tags("uc"):o("WALogger").WARN(s||(s=babelHelpers.taggedTemplateLiteralLoose(["Caller ",""])),a).tags("uc").sendLogs("Unexpectedly detected UC"),!1}catch(e){o("WALogger").WARN(c||(c=babelHelpers.taggedTemplateLiteralLoose(["Cannot analyze UC ",""])),e.stack).tags("uc")}return!0},f="webpackChunkwhatsapp_web_client";f in window||(window[f]=[]);var g=window[f];g!=null&&Object.defineProperty(window,f,{get:function(){if(!_())try{o("WAWebWamGlobals").Global.set({ocVersion:0})}catch(e){o("WALogger").WARN(d||(d=babelHelpers.taggedTemplateLiteralLoose(["Cannot set ocVersion ",""])),e.stack).tags("uc")}return g}});var h=p(),y=function(t){return!!t.startsWith("BA")};l.isOfficialClient=h,l.isUnofficialStanzaId=y}),98);
__d("WAWebWamEnumGroupEncryptionType",[],(function(t,n,r,o,a,i){var e=Object.freeze({E2EE:1,HOSTED:2});i.GROUP_ENCRYPTION_TYPE=e}),66);
__d("WAWebWamEnumMessageDistributionEnumType",[],(function(t,n,r,o,a,i){var e=Object.freeze({REGULAR_MESSAGE:0,DIRECT_MESSAGE:1,SENDER_KEY_DISTRIBUTION_MESSAGE:2});i.MESSAGE_DISTRIBUTION_ENUM_TYPE=e}),66);
__d("WAWebE2eMessageRecvWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumAddressingMode","WAWebWamEnumAgentEngagementEnumType","WAWebWamEnumBotType","WAWebWamEnumE2eCiphertextType","WAWebWamEnumE2eDestination","WAWebWamEnumE2eDeviceType","WAWebWamEnumE2eFailureReason","WAWebWamEnumEditType","WAWebWamEnumEncryptionTypeCode","WAWebWamEnumGroupEncryptionType","WAWebWamEnumInvisibleMessageCategoryType","WAWebWamEnumMediaType","WAWebWamEnumMessageDistributionEnumType","WAWebWamEnumRevokeType","WAWebWamEnumStanzaType","WAWebWamEnumTypeOfGroupEnum"],(function(t,n,r,o,a,i,l){var e,s=(e=o("WAWebWamCodegenUtils")).defineEvents({E2eMessageRecv:[478,{agentEngagementType:[15,o("WAWebWamEnumAgentEngagementEnumType").AGENT_ENGAGEMENT_ENUM_TYPE],botType:[19,o("WAWebWamEnumBotType").BOT_TYPE],e2eCiphertextType:[5,o("WAWebWamEnumE2eCiphertextType").E2E_CIPHERTEXT_TYPE],e2eCiphertextVersion:[6,e.TYPES.INTEGER],e2eDestination:[4,o("WAWebWamEnumE2eDestination").E2E_DESTINATION],e2eFailureReason:[2,o("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON],e2eSenderType:[8,o("WAWebWamEnumE2eDeviceType").E2E_DEVICE_TYPE],e2eSuccessful:[1,e.TYPES.BOOLEAN],editType:[13,o("WAWebWamEnumEditType").EDIT_TYPE],encryptionType:[25,o("WAWebWamEnumEncryptionTypeCode").ENCRYPTION_TYPE_CODE],groupEncryptionState:[23,o("WAWebWamEnumGroupEncryptionType").GROUP_ENCRYPTION_TYPE],invisibleMessageCategory:[22,o("WAWebWamEnumInvisibleMessageCategoryType").INVISIBLE_MESSAGE_CATEGORY_TYPE],isHostedChat:[20,e.TYPES.BOOLEAN],isLid:[11,e.TYPES.BOOLEAN],isPq:[27,e.TYPES.BOOLEAN],isSimpleSignal:[26,e.TYPES.BOOLEAN],localAddressingMode:[16,o("WAWebWamEnumAddressingMode").ADDRESSING_MODE],messageAddressingMode:[17,o("WAWebWamEnumAddressingMode").ADDRESSING_MODE],messageDistributionType:[21,o("WAWebWamEnumMessageDistributionEnumType").MESSAGE_DISTRIBUTION_ENUM_TYPE],messageMediaType:[7,o("WAWebWamEnumMediaType").MEDIA_TYPE],offline:[9,e.TYPES.BOOLEAN],retryCount:[3,e.TYPES.INTEGER],revokeType:[10,o("WAWebWamEnumRevokeType").REVOKE_TYPE],serverAddressingMode:[18,o("WAWebWamEnumAddressingMode").ADDRESSING_MODE],stanzaType:[14,o("WAWebWamEnumStanzaType").STANZA_TYPE],typeOfGroup:[12,o("WAWebWamEnumTypeOfGroupEnum").TYPE_OF_GROUP_ENUM]},[1,1,20],"regular"]},{E2eMessageRecv:[]});l.E2eMessageRecvWamEvent=s}),98);
__d("WAWebPostE2eMessageRecvMetric",["WAWebBackendApi","WAWebBackendJobsCommon","WAWebE2eMessageRecvWamEvent","WAWebGroupType","WAWebHandleMsgCommon","WAWebWamAddressingModeUtils","WAWebWamEnumAgentEngagementEnumType","WAWebWamMsgUtils","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){function e(e){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e.enc,n=e.from,r=e.msgMeta,a=e.msgInfo,i=e.msgBotInfo,l=e.error,s=r.type===o("WAWebHandleMsgCommon").STANZA_MSG_TYPES.reaction,u=a.chat,c=new(o("WAWebE2eMessageRecvWamEvent")).E2eMessageRecvWamEvent({e2eCiphertextType:o("WAWebBackendJobsCommon").getMetricE2eCiphertextType(t.e2eType),e2eCiphertextVersion:o("WAWebBackendJobsCommon").CIPHERTEXT_VERSION,e2eFailureReason:l==null?void 0:l.e2eFailureReason,e2eSuccessful:!1,messageMediaType:o("WAWebBackendJobsCommon").getMetricMediaType({encMediaType:t.encMediaType,msgType:r.type,msgPollType:r.pollType}),retryCount:t.retryCount,editType:o("WAWebBackendJobsCommon").getMetricEditType(a.edit),botType:o("WAWebWamMsgUtils").getWamBotType(u,i==null?void 0:i.bizBotType)}),d=o("WAWebBackendJobsCommon").getMetricE2eDestination(n);if(d!=null&&(c.e2eDestination=d),a.addressingMode!=null&&(c.serverAddressingMode=o("WAWebWamAddressingModeUtils").getWamAddressingModeFromString(a.addressingMode)),u.isGroup()){var m=yield o("WAWebBackendApi").frontendSendAndReceive("getGroupMetadata",{groupWid:u});if(m!=null){c.isLid=m.isCag&&s||!!m.isLidAddressingMode;var p=o("WAWebGroupType").groupTypeToWamEnum(o("WAWebGroupType").getGroupTypeFromGroupMetadata(m));c.typeOfGroup=p;var _=o("WAWebWamAddressingModeUtils").getAddressingModeMetricsFromGroupMetadata(m);_!=null&&(c.localAddressingMode=_)}}else u.isBroadcast()?c.isLid=a.author.isLid():c.isLid=u.isLid();return a.author.isBot()&&(a.chat.isBot()?c.agentEngagementType=o("WAWebWamEnumAgentEngagementEnumType").AGENT_ENGAGEMENT_ENUM_TYPE.DIRECT_CHAT:c.agentEngagementType=o("WAWebWamEnumAgentEngagementEnumType").AGENT_ENGAGEMENT_ENUM_TYPE.INVOKED),c}),s.apply(this,arguments)}function u(e){return c.apply(this,arguments)}function c(){return c=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var n=yield e(t);n.e2eSuccessful=!0,n.weight=1e3,n.commit()}),c.apply(this,arguments)}function d(e){return m.apply(this,arguments)}function m(){return m=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var n=yield e(t);n.e2eSuccessful=!1,n.weight=1,n.commit()}),m.apply(this,arguments)}l.postSuccessE2eMessageRecvMetric=u,l.postFailureE2eMessageRecvMetric=d}),98);
__d("WAWebMsgProcessingDecryptionHandler",["$InternalEnum","WALogger","WATimeUtils","WAWebABProps","WAWebBackendJobs.flow","WAWebBackendJobsCommon","WAWebCreateNackFromStanza","WAWebEphemeralDecodeBroadcastSetting","WAWebHandleMsgCommon","WAWebHandleMsgError","WAWebHandleMsgProcess","WAWebHandleMsgTypes.flow","WAWebIsOfficialClient","WAWebMessagingGatingUtils","WAWebMsgProcessingApiUtils","WAWebMsgType","WAWebPostE2eMessageRecvMetric","WAWebPostIncomingMessageDropMetric","WAWebSendRetryReceiptJob","WAWebSignalCommonErrors","WAWebWamEnumE2eFailureReason","asyncToGeneratorRuntime","cr:4122","gkx"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p,_,f,g,h,y,C=n("$InternalEnum").Mirrored(["SignalRetryable","SignalDuplicateMessage","UnknownDevice","DeviceSentMessage","InvalidProtobuf","HsmMismatch","BroadcastEphSettings","Unknown"]),b=new Set([C.SignalRetryable]);function v(e){return e.message==="errDuplicateMsg"?C.SignalDuplicateMessage:C.SignalRetryable}function S(e){return e instanceof o("WAWebHandleMsgError").UnknownDeviceMessageError?C.UnknownDevice:e instanceof o("WAWebSignalCommonErrors").SignalDecryptionError?v(e):e instanceof o("WAWebSignalCommonErrors").SignalMessageCounterError?C.SignalDuplicateMessage:e instanceof o("WAWebHandleMsgError").DeviceSentMessageError?C.DeviceSentMessage:e instanceof o("WAWebHandleMsgError").MessageValidationError?C.InvalidProtobuf:e instanceof o("WAWebHandleMsgCommon").HsmMismatchError?C.HsmMismatch:e instanceof o("WAWebEphemeralDecodeBroadcastSetting").BroadcastEphSettingsError?C.BroadcastEphSettings:C.Unknown}function R(e){var t={accessedEncs:new Set,pkOrMsgFailedEnc:null,skMsgFailedEnc:null};return{handleError:function(r,a){var n=S(a);r.e2eType===o("WAWebBackendJobs.flow").CiphertextType.Skmsg?t.skMsgFailedEnc={enc:r,error:a,errorType:n}:t.pkOrMsgFailedEnc={enc:r,error:a,errorType:n},D(e,{enc:r,error:a,errorType:n})},canDecryptNext:function(n){var e;r("gkx")("26258")||$();var o=(e=t.pkOrMsgFailedEnc)==null?void 0:e.errorType;return o!=null&&b.has(o)?!1:(t.accessedEncs.add(n.e2eType),!0)},getResult:function(r){return k(e,t,r)}}}function L(e){var t=e.ciphertext.byteLength;return t===0?"empty":t<100?"small":"large"}function E(t,n,r){var a=t.msgInfo,i=t.encs;r===void 0&&(r=!1);var l=a.chat,s=a.ts;if(l.isStatus()){var u=o("WATimeUtils").unixTimeWithoutClockSkewCorrection()-(s+o("WATimeUtils").DAY_SECONDS),c=u>0;if(c&&r&&i.length===2){var d=o("WATimeUtils").unixTime()-(s+o("WATimeUtils").DAY_SECONDS);o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["decryptE2EPayload: expired status has 2 encs, expired for ","s client time or for ","s with a clock skew, enc is "," and is ",""])),u,d,n.enc.e2eType,L(n.enc)).tags("messaging").sendLogs("handleMsg: expired status multiple encs",{sampling:.01})}return c}return!1}function k(e,t,n){return I.apply(this,arguments)}function I(){return I=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n){var r,a=(r=t.skMsgFailedEnc)!=null?r:t.pkOrMsgFailedEnc,i=a!=null&&t.accessedEncs.has(o("WAWebBackendJobs.flow").CiphertextType.Skmsg)&&t.skMsgFailedEnc==null;if(a==null||i||E(e,a,!0)&&o("WAWebABProps").getABPropConfigValue("web_skip_expired_status_error"))return{result:o("WAWebHandleMsgTypes.flow").E2EProcessResult.SUCCESS,hasInactiveMsg:n};T(e,t),x(e,t);var l=a.enc,s=a.error,u=a.errorType,c;switch((s instanceof o("WAWebSignalCommonErrors").SignalDecryptionError||s instanceof o("WAWebHandleMsgError").UnknownDeviceMessageError||s instanceof o("WAWebEphemeralDecodeBroadcastSetting").BroadcastEphSettingsError)&&(c=o("WAWebSendRetryReceiptJob").getRetryReasonFromError(s),u!==C.SignalDuplicateMessage&&(l.hideFail||(yield o("WAWebHandleMsgProcess").processPlaceholderMsg({type:o("WAWebMsgType").MSG_TYPE.CIPHERTEXT,msgMeta:e.msgMeta,msgInfo:e.msgInfo,placeholderType:o("WAWebHandleMsgTypes.flow").PlaceholderType.E2E,placeholderAddReason:o("WAWebBackendJobsCommon").getPlaceholderAddReason(s)})))),u){case C.SignalRetryable:case C.UnknownDevice:return{result:o("WAWebHandleMsgTypes.flow").E2EProcessResult.RETRY,retryCount:l.retryCount,retryReason:c};case C.SignalDuplicateMessage:return{result:o("WAWebHandleMsgTypes.flow").E2EProcessResult.SIGNAL_OLD_COUNTER_ERROR,failedEnc:l};case C.DeviceSentMessage:return{result:o("WAWebHandleMsgTypes.flow").E2EProcessResult.PARSE_VALIDATION_ERROR};case C.InvalidProtobuf:return{result:o("WAWebHandleMsgTypes.flow").E2EProcessResult.PARSE_VALIDATION_ERROR,e2eFailureReason:s instanceof o("WAWebHandleMsgError").MessageValidationError?s.e2eFailureReason:void 0};case C.HsmMismatch:return{result:o("WAWebHandleMsgTypes.flow").E2EProcessResult.HSM_MISMATCH};case C.BroadcastEphSettings:return{result:o("WAWebHandleMsgTypes.flow").E2EProcessResult.RETRY,retryCount:l.retryCount,retryReason:c,e2eFailureReason:o("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_BROADCAST_STANZA_ATTRIBUTE};case C.Unknown:return{result:o("WAWebHandleMsgTypes.flow").E2EProcessResult.PARSE_ERROR}}}),I.apply(this,arguments)}function T(e,t){var n=t.skMsgFailedEnc,r=t.pkOrMsgFailedEnc,a=e.msgInfo,i=e.msgMeta,l=n!=null?n:r;if(l!=null){var s=l.enc,u=l.errorType,c=l.error;if(E(e,l)){o("WAWebABProps").getABPropConfigValue("web_skip_expired_status_error")||o("WAWebPostIncomingMessageDropMetric").postIncomingMessageDropExpired({msgInfo:a,msgMeta:i,enc:s,error:c instanceof o("WAWebHandleMsgError").MessageValidationError?c:void 0});return}switch(u){case C.SignalRetryable:case C.UnknownDevice:case C.HsmMismatch:case C.BroadcastEphSettings:case C.SignalDuplicateMessage:break;case C.InvalidProtobuf:case C.DeviceSentMessage:{o("WAWebPostIncomingMessageDropMetric").postIncomingMessageDropInvalidProtobuf({msgInfo:a,msgMeta:i,enc:s,error:c instanceof o("WAWebHandleMsgError").MessageValidationError?c:void 0});break}case C.Unknown:o("WAWebPostIncomingMessageDropMetric").postIncomingMessageDropInvalidStanzaFromDecryptedMessageInfo({msgInfo:a,msgMeta:i,enc:s})}}}function D(e,t){var n=e.msgInfo,a=e.msgMeta,i=e.msgBotInfo,l=t.enc,h=t.error,y=t.errorType,b=o("WAWebMsgProcessingApiUtils").getFrom(n);switch(o("WAWebPostE2eMessageRecvMetric").postFailureE2eMessageRecvMetric({enc:l,from:b,msgMeta:a,msgInfo:n,msgBotInfo:i,error:h instanceof o("WAWebHandleMsgError").MessageValidationError?h:null}),o("WALogger").WARN(s||(s=babelHelpers.taggedTemplateLiteralLoose(["decryptE2EPayload: msgId::"," e2eType:"," error:",""])),n.externalId,l.e2eType,h.stack).tags("messaging"),y){case C.SignalDuplicateMessage:break;case C.SignalRetryable:case C.UnknownDevice:{r("gkx")("26258")||o("WALogger").WARN(u||(u=babelHelpers.taggedTemplateLiteralLoose(["decryptE2EPayload: e2eType:"," error:",""])),l.e2eType,h).tags("messaging").sendLogs("handleMsg: decryption error");break}case C.InvalidProtobuf:{h instanceof o("WAWebHandleMsgError").MessageValidationError&&(o("WAWebIsOfficialClient").isUnofficialStanzaId(n.externalId)?o("WALogger").WARN(c||(c=babelHelpers.taggedTemplateLiteralLoose(["decryptE2EPayload: e2eType:"," error:",""])),l.e2eType,h).tags("messaging").sendLogs("handleMsg from UC: "+h.name,{sampling:h.sendLogs===!0?.01:h.sendLogs}):r("gkx")("26259")&&h instanceof o("WAWebHandleMsgError").MessageProtobufInvalidMessageTypes?o("WALogger").WARN(d||(d=babelHelpers.taggedTemplateLiteralLoose(["decryptE2EPayload: e2eType:"," error:",""])),l.e2eType,h).tags("messaging").sendLogs("(intern) handleMsg: "+h.name):o("WALogger").WARN(m||(m=babelHelpers.taggedTemplateLiteralLoose(["decryptE2EPayload: e2eType:"," error:",""])),l.e2eType,h).tags("messaging").sendLogs("handleMsg: "+h.name,h.sendLogs===!0?void 0:{sampling:h.sendLogs}));break}case C.DeviceSentMessage:{o("WALogger").WARN(p||(p=babelHelpers.taggedTemplateLiteralLoose(["decryptE2EPayload: e2eType:"," infoType:"," isDirect:"," error:",""])),l.e2eType,n.type,n.isDirect,h).tags("messaging").sendLogs("handleMsg: parse device sent message error");break}case C.HsmMismatch:{o("WALogger").WARN(_||(_=babelHelpers.taggedTemplateLiteralLoose(["decryptE2EPayload: e2eType:"," error:",""])),l.e2eType,h).tags("messaging").sendLogs("handleMsg: hsm mismatch error");break}case C.BroadcastEphSettings:{o("WALogger").WARN(f||(f=babelHelpers.taggedTemplateLiteralLoose(["decryptE2EPayload: e2eType:"," error:",""])),l.e2eType,h).tags("messaging").sendLogs("handleMsg: failed to decrypt broadcast ephemeral settings");break}case C.Unknown:{o("WALogger").WARN(g||(g=babelHelpers.taggedTemplateLiteralLoose(["decryptE2EPayload: e2eType:"," error:",""])),l.e2eType,h).tags("messaging").sendLogs("handleMsg: parse decrypted message error");break}}}function x(e,t){var n=t.skMsgFailedEnc,r=t.pkOrMsgFailedEnc,a=n!=null?n:r;if(a!=null&&o("WAWebMessagingGatingUtils").isMessageDropPlaceholderEnabled()){var i=e.msgInfo.chat;if((i.isUser()||i.isGroup())&&!E(e,a)){var l=null;switch(a.errorType){case C.SignalRetryable:case C.SignalDuplicateMessage:case C.BroadcastEphSettings:case C.UnknownDevice:break;case C.DeviceSentMessage:case C.InvalidProtobuf:{l=o("WAWebCreateNackFromStanza").NackReason.InvalidProtobuf;break}case C.HsmMismatch:case C.Unknown:{l=o("WAWebCreateNackFromStanza").NackReason.ParsingError;break}}if(l!=null){var s=e.msgInfo.externalId;o("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["messageDrop: insert a debug placeholder for ",", reason: ",""])),s,a.errorType).tags("messaging"),o("WAWebHandleMsgProcess").processPlaceholderMsg({type:o("WAWebMsgType").MSG_TYPE.DEBUG_PLACEHOLDER,msgInfo:e.msgInfo,nackReason:l})}}}}function $(){if(!r("gkx")("26258")){var e,t=(e=n("cr:4122")==null?void 0:n("cr:4122").isNextMessageDropped())!=null?e:null;if(t==null)return;switch(o("WALogger").LOG(y||(y=babelHelpers.taggedTemplateLiteralLoose(["Dropping incoming message with "," error"])),t),t){case C.SignalRetryable:throw new(o("WAWebSignalCommonErrors")).SignalDecryptionError("errSignalErr");case C.SignalDuplicateMessage:throw new(o("WAWebSignalCommonErrors")).SignalDecryptionError("errDuplicateMsg");case C.InvalidProtobuf:throw new(o("WAWebHandleMsgError")).MessageValidationError("test",o("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON.INVALID_MESSAGE);case C.DeviceSentMessage:throw new(o("WAWebHandleMsgError")).DeviceSentMessageError(1,1);default:return}}}l.DecryptionErrorType=C,l.createDecryptionHandler=R}),98);
__d("WAWebMsgProcessingDecryptApi",["WALogger","WAWebAdvSignatureApi","WAWebBackendJobs.flow","WAWebHandleMsgTypes.flow","WAWebMsgProcessingApiUtils","WAWebMsgProcessingDecryptEnc","WAWebMsgProcessingDecryptionHandler","WAWebOfflineResumeMsgProcessReporter","WAWebPostE2eMessageRecvMetric","WAWebSendRetryReceiptJob","WAWebSignalProtocolStore","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u,c;function d(e,t){return m.apply(this,arguments)}function m(){return m=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=e.bizInfo,r=e.msgInfo,a=e.paymentInfo,i=e.deviceIdentity,l=e.encs,d=e.msgMeta,m=e.rcat,_=e.hsmInfo,f=e.msgBotInfo,g=e.reportingTokenInfo,h=o("WAWebMsgProcessingApiUtils").getFrom(r);if(p(l,r),r.author.device!=null&&r.author.device!==0){var y=yield o("WAWebAdvSignatureApi").validateADVwithEncs(r.author,i,l,!!r.offline);if(!y)return o("WALogger").WARN(s||(s=babelHelpers.taggedTemplateLiteralLoose(["decryptE2EPayload: msgId::",", validateADVIdentity failed"])),r.externalId).tags("messaging"),{result:o("WAWebHandleMsgTypes.flow").E2EProcessResult.RETRY,retryCount:l[0].retryCount,retryReason:o("WAWebSendRetryReceiptJob").RetryReason.AdvFailure}}var C=!1,b=o("WAWebMsgProcessingDecryptionHandler").createDecryptionHandler(e);for(var v of l)try{if(!b.canDecryptNext(v))continue;var S=o("WAWebOfflineResumeMsgProcessReporter").msgProcessReporter.startMarker(o("WAWebOfflineResumeMsgProcessReporter").msgProcessReporter.stage.Decryption),R=yield o("WAWebMsgProcessingDecryptEnc").decryptEnc(v,h,r.author,e);S==null||S(),o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["decryptE2EPayload: msgId::"," e2eType:"," done"])),r.externalId,v.e2eType).tags("messaging"),o("WAWebPostE2eMessageRecvMetric").postSuccessE2eMessageRecvMetric({enc:v,from:h,msgMeta:d,msgInfo:r,msgBotInfo:f,error:null});var L={retryCount:v.retryCount,e2eType:v.e2eType,encMediaType:v.encMediaType,hideFail:v.hideFail},E=yield t({decrypted:R,info:r,paymentInfo:a,e2eInfo:L,bizInfo:n,hsmInfo:_,msgMeta:d,rcat:m,msgBotInfo:f,reportingTokenInfo:g});E.hasInactiveMsg&&(C=!0),o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["processDecryptedProto: msgId::"," e2eType:"," done"])),r.externalId,v.e2eType).tags("messaging")}catch(e){b.handleError(v,e)}return yield o("WAWebSignalProtocolStore").getSignalProtocolStore().flushBufferToDiskIfNotMemOnlyMode(),b.getResult(C)}),m.apply(this,arguments)}function p(t,n){t.length===2&&t[0].e2eType===o("WAWebBackendJobs.flow").CiphertextType.Skmsg&&o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["decryptE2EPayload: msgId::"," skMsg is out of order"])),n.externalId).tags("messaging").sendLogs("handleMsg: invalid encs order",{sampling:.01})}l.decryptE2EPayload=d}),98);
__d("WAWebMessageProcessUtils",["WALogger","WANullthrows","WAWebApiChat","WAWebApiContact","WAWebCurrentUser","WAWebLid1X1MigrationGating","WAWebLidMigrationUtils","WAWebWidFactory","asyncToGeneratorRuntime","err"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p,_,f,g;function h(e){return y.apply(this,arguments)}function y(){return y=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e.lid,n=e.lidOrigin;if(o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["selectChatForOneOnOneMessage input: ",", ",""])),t.toLogString(),n),o("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.isLidMigrated()){var r=yield b(t);return o("WAWebCurrentUser").isEmployee()&&o("WALogger").LOG(d||(d=babelHelpers.taggedTemplateLiteralLoose(["selectChatForOneOnOneMessage migrated output: ",", ",""])),r.accountLid,r.chatId),r}var a=C(t,n);return o("WAWebCurrentUser").isEmployee()&&o("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["selectChatForOneOnOneMessage pre-migrated output: ",", ",""])),a.accountLid,a.chatId),a}),y.apply(this,arguments)}function C(t,n){if(o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["select chat (unmigrated): select for ",""])),t.toLogString()),n==null){o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["select chat (unmigrated): this is a general Lid chat, return phone number"])));var a=r("WANullthrows")(o("WAWebApiContact").getPhoneNumber(t),"cannot select chat for incoming general Lid chat: no PN for Lid");return{chatId:a}}return o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["select chat (unmigrated): this is a non-general Lid chat, return Lid"]))),{chatId:t}}function b(e){return v.apply(this,arguments)}function v(){return v=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){o("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["select chat (migrated): select for lid ",""])),e.toLogString());var t=yield o("WAWebApiChat").getChatRecordByAccountLid(e);if(t.length>1)throw o("WALogger").LOG(_||(_=babelHelpers.taggedTemplateLiteralLoose(["select chat (migrated): error: multiple chats for account_lid."]))),r("err")("selectChatForOneOnOneMessageAfterMigration: found multiple chats for unique index account_lid");if(t.length===1){var n=r("WANullthrows")(t[0].id,"chat id should never be null");return o("WALogger").LOG(f||(f=babelHelpers.taggedTemplateLiteralLoose(["select chat (migrated): found by account_lid. chat id: ",", lid ",""])),n.toString(),e.toLogString()),{accountLid:e,chatId:o("WAWebWidFactory").asUserWidOrThrow(o("WAWebWidFactory").createWid(n))}}return o("WALogger").LOG(g||(g=babelHelpers.taggedTemplateLiteralLoose(["select chat (migrated): assigning lid for new chat"]))),{accountLid:e,chatId:e}}),v.apply(this,arguments)}l.selectChatForOneOnOneMessage=h}),98);
__d("WAWebProcessPhoneNumberMapping",["Promise","WAArrayUtils","WALogger","WAWebApiContact","WAWebDBCreateLidPnMappings","WAWebHandleMsgTypes.flow","WAWebUpdateLidMetadataJob","WAWebUserPrefsMeUser","WAWebUsernameGatingUtils","WAWebWidFactory","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u;function c(e){var t=e.lid,n=e.data,r=e.shouldWaitForJob,o=e.processingResult;o.push({jobArgs:{lid:t,data:n},shouldWaitForJob:r})}function d(t){return t.preMatChat!=null?(o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[extractMapping] using preMatChat"]))),t.preMatChat):t.chat}function m(e,t){return p.apply(this,arguments)}function p(){return p=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n,r=[],a=e.recipientPn,i=e.author,l=e.peerRecipientPn,s=e.recipientLatestLid,u=d(e),m=o("WAWebWidFactory").asUserLidOrThrow(i);if(o("WAWebUserPrefsMeUser").isMeAccount(i)){var p=t==null?void 0:t.origin;if(a!=null)n={lid:o("WAWebWidFactory").asUserLidOrThrow(u),pn:o("WAWebWidFactory").asUserWidOrThrow(a),learningSource:"other"},c({lid:o("WAWebWidFactory").asUserLidOrThrow(u),data:{shareOwnPn:!1},shouldWaitForJob:!0,processingResult:r});else if(l!=null)s!=null?n={lid:o("WAWebWidFactory").asUserLidOrThrow(u),pn:l,latestLid:s,learningSource:"recipient-latest-lid"}:n={lid:o("WAWebWidFactory").asUserLidOrThrow(u),pn:l,learningSource:"peer-lid-message"};else{var _=yield o("WAWebApiContact").getContactRecord(u);(_==null||(_==null?void 0:_.shareOwnPn)!==!0)&&c({lid:o("WAWebWidFactory").asUserLidOrThrow(u),data:{shareOwnPn:!0},shouldWaitForJob:!1,processingResult:r})}if(p!=="ctwa"){var f=o("WAWebUsernameGatingUtils").usernameDisplayedEnabled()&&e.author.isLid()&&e.chat.isLid();l==null&&!f&&(n="missing-peer-recipient-pn")}return{mapping:n,lidMetadataUpdates:r}}var g=e.displayName;g!=null&&c({lid:m,data:{displayNameLID:g},shouldWaitForJob:!0,processingResult:r});var h=e.senderPn;return h!=null&&(n={lid:m,pn:o("WAWebWidFactory").asUserWidOrThrow(h),learningSource:"other"}),h==null&&c({lid:m,data:{shareOwnPn:!0},shouldWaitForJob:!0,processingResult:r}),{mapping:n,lidMetadataUpdates:r}}),p.apply(this,arguments)}function _(e){return f.apply(this,arguments)}function f(){return f=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t,n=e.recipientLid,r=e.author,a=e.peerRecipientLid,i=e.recipientLatestLid,l=d(e);if(o("WAWebUserPrefsMeUser").isMeAccount(r)){var s=o("WAWebWidFactory").asUserWidOrThrow(l);n!=null?t={lid:n,pn:s,learningSource:"other"}:a!=null?i!=null?t={pn:s,lid:a,latestLid:i,learningSource:"recipient-latest-lid"}:t={lid:a,pn:s,learningSource:"peer-pn-message"}:t="missing-peer-recipient-lid"}var u=e.senderLid;return u!=null&&(t={lid:o("WAWebWidFactory").asUserLidOrThrow(u),pn:o("WAWebWidFactory").asUserWidOrThrow(r),learningSource:"other"}),{mapping:t,lidMetadataUpdates:[]}}),f.apply(this,arguments)}function g(e){return h.apply(this,arguments)}function h(){return h=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e.msgInfo,n=e.msgMeta,r=t.author;return r.isLid()?m(t,n):_(t)}),h.apply(this,arguments)}function y(e){return C.apply(this,arguments)}function C(){return C=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e.msgInfo,n=o("WAWebUsernameGatingUtils").usernameDisplayedEnabled()&&t.participantUsername!=null;if(!n&&t.chat.isGroup()&&t.author.isLid()&&!o("WAWebUserPrefsMeUser").isMeAccount(t.author)&&t.participantPn==null&&t.displayName==null&&o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[extractMappingsForGroupOrStatusBroadcastMessage] participantPn is missing for group message from LID author"]))),e.bclParticipant){e.msgInfo;var r=b(e.bclParticipant);return r==null?{lidMetadataUpdates:[]}:{mapping:r,lidMetadataUpdates:[]}}var a,i=[],l=t.participantPn,u=t.participantLid,d=t.author;l!=null?a={lid:o("WAWebWidFactory").asUserLidOrThrow(d),pn:l,learningSource:"other"}:u!=null&&!n&&(a={lid:u,pn:o("WAWebWidFactory").asUserWidOrThrow(d),learningSource:"other"});var m=t.displayName;return!o("WAWebUserPrefsMeUser").isMeAccount(d)&&m!=null&&c({lid:o("WAWebWidFactory").asUserLidOrThrow(d),data:{displayNameLID:m},shouldWaitForJob:!0,processingResult:i}),{mapping:a,lidMetadataUpdates:i}}),C.apply(this,arguments)}function b(e){var t=e.wid,n=e.recipientLatestLid;if(t.isLid()){var r=t,a=e.peerRecipientPn;if(a==null){var i=o("WAWebUsernameGatingUtils").usernameDisplayedEnabled();return i?null:"missing-peer-recipient-pn"}return n?{lid:r,latestLid:n,pn:a,learningSource:"recipient-latest-lid"}:{lid:r,pn:a,learningSource:"peer-lid-message"}}var l=e.peerRecipientLid,s=t;return l==null?"missing-peer-recipient-lid":n?{lid:l,latestLid:n,pn:s,learningSource:"recipient-latest-lid"}:{lid:l,pn:s,learningSource:"peer-pn-message"}}function v(e){var t=e.mapping,n=e.flushImmediately;return t.learningSource==="recipient-latest-lid"?o("WAWebDBCreateLidPnMappings").createLidPnMappings({mappings:[{lid:t.lid,pn:t.pn},{lid:t.latestLid,pn:t.pn}],flushImmediately:n,learningSource:"recipient-latest-lid"}):o("WAWebDBCreateLidPnMappings").createLidPnMappings({mappings:[{lid:t.lid,pn:t.pn}],flushImmediately:n,learningSource:t.learningSource})}function S(e){return R.apply(this,arguments)}function R(){return R=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e.msgInfo.chat;return t.isUser()?g(e):t.isGroup()||t.isBroadcast()?y(e):{lidMetadataUpdates:[]}}),R.apply(this,arguments)}function L(e,t,n){return E.apply(this,arguments)}function E(){return E=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,r){if(e.type===o("WAWebHandleMsgTypes.flow").MESSAGE_TYPE.PEER_BROADCAST){var a=e.bclParticipants.map(function(n){return k({msgInfo:e,msgMeta:t,bclParticipant:n},r)}),i=yield(u||(u=n("Promise"))).all(a);return{type:"peer-broadcast",mappings:i}}return{type:"not-peer-broadcast",mapping:yield k({msgInfo:e,msgMeta:t},r)}}),E.apply(this,arguments)}function k(e,t){return I.apply(this,arguments)}function I(){return I=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n,r,a=yield S(e),i=a.mapping,l=a.lidMetadataUpdates,s=o("WAArrayUtils").groupByAndMap(l,function(e){return e.shouldWaitForJob?"waitForJob":"fireAndForget"},function(e){return e.jobArgs}),u=(n=s.get("waitForJob"))!=null?n:[],c=(r=s.get("fireAndForget"))!=null?r:[];return c.length>0&&o("WAWebUpdateLidMetadataJob").updateLidMetadataJob(c),u.length>0&&(yield o("WAWebUpdateLidMetadataJob").updateLidMetadataJob(u)),i!=null&&typeof i=="object"&&(yield v({mapping:i,flushImmediately:t})),i}),I.apply(this,arguments)}l.processPhoneNumberMappings=L}),98);
__d("WAWebProcessMsgInfoForLid",["Promise","WAJids","WALogger","WAWebApiContact","WAWebHandleMsgCommon","WAWebHandleMsgTypes.flow","WAWebLid1X1MigrationGating","WAWebLidMigrationUtils","WAWebLidStatusMigrationGating","WAWebLidStatusMigrationUtils","WAWebMessageProcessUtils","WAWebProcessPhoneNumberMapping","WAWebUsernameGatingUtils","WAWebWidFactory","WAWebWorkerSafeBackendApi","asyncToGeneratorRuntime","err"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m;function p(e){return _.apply(this,arguments)}function _(){return _=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var n=t.mapping,a=t.chatWid,i=t.msgMeta,l=t.msgInfo,d=null,m=i==null?void 0:i.origin,p=m==="ctwa";if(p){if(!a.isLid())throw r("err")("received ctwa message but remote id is not Lid");d=a}else if((i==null?void 0:i.targetSenderJid)!=null)d=o("WAWebLidMigrationUtils").toUserLidOrThrow(o("WAWebWidFactory").asUserWidOrThrow(l.chat));else if(n==null){var _=o("WAWebUsernameGatingUtils").usernameDisplayedEnabled(),f=_&&l.type===o("WAWebHandleMsgTypes.flow").MESSAGE_TYPE.CHAT&&l.author.isLid()&&a.isLid(),g=f&&l.username!=null,h=f&&l.username==null;if(g||h)d=o("WAWebLidMigrationUtils").toUserLidOrThrow(a);else if(_&&l.type===o("WAWebHandleMsgTypes.flow").MESSAGE_TYPE.PEER_BROADCAST&&a.isLid())d=o("WAWebLidMigrationUtils").toUserLidOrThrow(a);else throw o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["findDestinationChatForSingleMapping: missing pn-lid mapping in 1-1 message"]))).sendLogs("misssing-pn-lid-mapping-in-1-1-message").devConsole("msg id:",l.externalId),r("err")("findDestinationChatForSingleMapping: missing pn-lid mapping in 1-1 message")}else if(n==="missing-peer-recipient-pn"){var y;if(o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["findDestinationChatForSingleMapping: missing peer recipient pn in 1-1 message from device ",""])),(y=l.author.device)!=null?y:0).sendLogs("misssing-peer-recipient-pn-in-1-1-message"),a.isLid()&&o("WAWebApiContact").lidPnCache.getPhoneNumber(a)!=null&&(d=a),d==null){o("WALogger").WARN(u||(u=babelHelpers.taggedTemplateLiteralLoose(["findDestinationChatForSingleMapping: missing peer recipient pn and local mapping, processing message anyway"])));return}}else if(n==="missing-peer-recipient-lid"){if(o("WALogger").ERROR(c||(c=babelHelpers.taggedTemplateLiteralLoose(["findDestinationChatForSingleMapping: missing peer recipient lid in 1-1 message"]))).sendLogs("misssing-peer-recipient-lid-in-1-1-message"),o("WAWebWorkerSafeBackendApi").workerSafeFireAndForget("syncContactListJob",{contactIds:[a],shouldSyncDevice:!1,mode:"query"}),d=o("WAWebApiContact").lidPnCache.getCurrentLid(a),d==null)throw r("err")("findDestinationChatForSingleMapping: missing peer recipient lid in 1-1 message")}else d=n.lid;var C=yield o("WAWebMessageProcessUtils").selectChatForOneOnOneMessage({lid:d,lidOrigin:m}),b=C.chatId;return b.isSameAccountAndAddressingMode(a)?{accountLid:C.accountLid}:{newRemote:b,accountLid:C.accountLid}}),_.apply(this,arguments)}function f(e){return g.apply(this,arguments)}function g(){return g=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e.msgInfo,a=e.msgMeta,i=yield o("WAWebProcessPhoneNumberMapping").processPhoneNumberMappings(t,a,t.offline==null);if(t.category!==o("WAWebHandleMsgCommon").CATEGORY_PEER){if(t.type===o("WAWebHandleMsgTypes.flow").MESSAGE_TYPE.OTHER_STATUS){var l=o("WAWebWidFactory").asUserWidOrThrow(t.author),s=o("WAWebWidFactory").asUserWidOrThrow(o("WAWebLidStatusMigrationUtils").matWidConvert(l));if(!l.equals(s)){var u;o("WALogger").LOG(d||(d=babelHelpers.taggedTemplateLiteralLoose(["maybeProcesMsgInfoForLid: converting status message from "," to "," based on migration stage ",""])),t.author.toLogString(),s.toLogString(),o("WAWebLidStatusMigrationGating").getLidStatusMigrationStage()),t.author=o("WAWebWidFactory").createDeviceWidFromUserAndDevice(s.user,s.server,(u=t.author.device)!=null?u:o("WAJids").DEFAULT_DEVICE_ID)}return}var c=o("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.isLidMigrated()||t.author.isLid()||t.chat.isLid();if(c)if(t.type===o("WAWebHandleMsgTypes.flow").MESSAGE_TYPE.PEER_BROADCAST){if(i.type!=="peer-broadcast")throw r("err")("maybeProcesMsgInfoForLid: mappings type is not the expected peer-broadcast");i.type;var _=i.mappings.map((function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,n){var r=t.bclParticipants[n],i=yield p({msgInfo:t,msgMeta:a,mapping:e,chatWid:r.wid});(i==null?void 0:i.newRemote)!=null&&(r.preMatWid=r.wid,r.wid=o("WAWebWidFactory").asUserWidOrThrow(i.newRemote))});return function(t,n){return e.apply(this,arguments)}})());yield(m||(m=n("Promise"))).all(_)}else{if(i.type!=="not-peer-broadcast")throw r("err")("maybeProcesMsgInfoForLid: mappings type is not the expected not-peer-broadcast");i.type;var f=t.type===o("WAWebHandleMsgTypes.flow").MESSAGE_TYPE.OTHER_BROADCAST,g=f?t.author:t.chat;if(!g.isRegularUser())return;var h=yield p({msgInfo:t,msgMeta:a,mapping:i.mapping,chatWid:g});if(h==null)return;var y=h.accountLid,C=h.newRemote;if(y!=null&&(t.accountLid=y),C==null)return;f?(t.preMatChat=t.author,t.author=C):(t.preMatChat=g,t.chat=C)}}}),g.apply(this,arguments)}l.maybeProcesMsgInfoForLid=f}),98);
__d("WAWebHandleMsg",["Promise","WALogger","WAParsableWapNode","WATimeUtils","WAWebCreateNackFromStanza","WAWebDBReportingTokenUtils","WAWebGetMessageCache","WAWebHandleMsgCommon","WAWebHandleMsgMetaUtils","WAWebHandleMsgParser","WAWebHandleMsgProcess","WAWebHandleMsgSendReceipt","WAWebHandleMsgTypes.flow","WAWebMaybePostOfflineCountTooHighMetric","WAWebMessageDedupUtils","WAWebMessageInsertDebugPlaceholder","WAWebMessageQueue","WAWebMsgProcessingApiUtils","WAWebMsgProcessingDecryptApi","WAWebMsgType","WAWebOfflineHandler","WAWebPostIncomingMessageDropMetric","WAWebPostUnknownStanzaMetric","WAWebProcessMsgInfoForLid","WAWebSetUsernameJob","WAWebUsernameGatingUtils","WAWebWidFactory","asyncToGeneratorRuntime","cr:4122","gkx"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p,_,f,g,h,y;function C(e){return b.apply(this,arguments)}function b(){return b=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var a=o("WAWebHandleMsgParser").incomingMsgParser.parse(t);if(a.error){var i;r("gkx")("26258")?o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["handleMsg: error while parsing message stanza"]))).tags("messaging"):o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["handleMsg: error while parsing message stanza: ",", node: ",""])),a.error,t.toString()).tags("messaging"),o("WAWebPostUnknownStanzaMetric").postUnknownStanzaMetric(t);var l=o("WAWebHandleMsgParser").incomingMsgParserForAckOnly.parse(t);if(l.error)return l.error instanceof o("WAParsableWapNode").XmppParsingFailure?o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["failedParsingMessage: ",""])),l.error).tags("messaging").sendLogs("failedParsing: ack not parsed XMPP",{sampling:.01}):o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["failedParsingMessage:"]))).tags("messaging").sendLogs("failedParsing: ack not parsed",{sampling:.01}),o("WAWebPostIncomingMessageDropMetric").postIncomingMessageDropInvalidStanza(t),(y||(y=n("Promise"))).resolve(o("WAWebCreateNackFromStanza").createNackFromStanza(t,o("WAWebCreateNackFromStanza").NackReason.ParsingError));var b=l.success,S=b.type,R=b.externalId,L=b.msgInfo,E=b.offline,k=o("WAWebCreateNackFromStanza").NackReason.ParsingError;return S==null?(k=o("WAWebCreateNackFromStanza").NackReason.UnrecognizedStanzaType,o("WAWebPostIncomingMessageDropMetric").postIncomingMessageDropUnknownMessageType(t)):a.error instanceof o("WAParsableWapNode").XmppParsingFailure&&((i=a.error)==null?void 0:i.reason)===""+o("WAWebCreateNackFromStanza").NackReason.InvalidHostedCompanionStanza?(k=o("WAWebCreateNackFromStanza").NackReason.InvalidHostedCompanionStanza,o("WAWebPostIncomingMessageDropMetric").postIncomingMessageDropInvalidHostedCompanionStanza(t)):o("WAWebPostIncomingMessageDropMetric").postIncomingMessageDropInvalidStanza(t),o("WAWebMessageInsertDebugPlaceholder").maybeInsertDebugPlaceholder({externalId:R,nackReason:k,msgInfo:L,offline:E}),E!=null&&(a.error instanceof o("WAParsableWapNode").XmppParsingFailure?o("WALogger").LOG(d||(d=babelHelpers.taggedTemplateLiteralLoose(["failedParsingMessage: "," ",""])),R,a.error).tags("messaging").sendLogs("failedParsing: ack parsed XMPP",{sampling:.01}):o("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["failedParsingMessage: ",""])),R).tags("messaging").sendLogs("failedParsing: ack parsed",{sampling:.01})),(y||(y=n("Promise"))).resolve(o("WAWebCreateNackFromStanza").createNackFromStanza(t,k))}var I=a.success;o("WAWebMaybePostOfflineCountTooHighMetric").maybePostOfflineCountTooHigh(I);var T=I.msgMeta,D=I.msgInfo,x=I.msgBotInfo,$=I.encs,P=o("WAWebMsgProcessingApiUtils").messageInfoToKey(D);D.clientReceivedTsMillis=o("WATimeUtils").unixTimeMs(),D.offline!=null&&(o("WAWebOfflineHandler").OfflineMessageHandler.addOfflinePendingMessage(),o("WAWebOfflineHandler").OfflineMessageHandler.offlineStanzaReceivedAfterComplete());var N=1;return o("WAWebMessageDedupUtils").isPengingMessageCacheEnabled()&&(N=o("WAWebMessageDedupUtils").addPendingMessage(P,D.ts,$)),o("WAWebOfflineHandler").OfflineMessageHandler.isResumeFromRestartComplete()&&delete I.msgInfo.offline,n("cr:4122")!=null&&n("cr:4122").isNextMessagePostponed(t,C)?(o("WAWebHandleMsgSendReceipt").sendReceipt(I.msgInfo,I.msgMeta,{result:o("WAWebHandleMsgTypes.flow").E2EProcessResult.SUCCESS}),null):o("WAWebMessageQueue").onMessageQueue({chatWid:D.chat,isOffline:!!I.msgInfo.offline,msgCategory:D.category,action:(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e;if(o("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["handleMessage: chat::"," msgId::",', start processing message, offline="','"'])),D.chat.toLogString(),D.externalId,(e=D.offline)!=null?e:"").tags("messaging"),D.msgProcessStartTsMillis=o("WATimeUtils").unixTimeMs(),yield o("WAWebProcessMsgInfoForLid").maybeProcesMsgInfoForLid({msgInfo:D,msgMeta:T}),o("WAWebUsernameGatingUtils").usernameDisplayedEnabled()){var t=[];if(D.type===o("WAWebHandleMsgTypes.flow").MESSAGE_TYPE.GROUP){var n=o("WAWebSetUsernameJob").maybeCreateSetUsernameInfoJobArg({userId:o("WAWebWidFactory").asUserWidOrThrow(D.author),username:D.participantUsername});n&&t.push(n)}else if(D.type===o("WAWebHandleMsgTypes.flow").MESSAGE_TYPE.PEER_BROADCAST)D.bclParticipants.forEach(function(e){var n,r=o("WAWebSetUsernameJob").maybeCreateSetUsernameInfoJobArg({userId:o("WAWebWidFactory").asUserWidOrThrow((n=e.peerRecipientLid)!=null?n:e.wid),username:e.peerRecipientUsername});r&&t.push(r)});else{var r=o("WAWebSetUsernameJob").maybeCreateSetUsernameInfoJobArg({userId:o("WAWebWidFactory").asUserWidOrThrow(D.author),username:D.username,usernameCountryCode:D.senderCountryCode});r&&t.push(r);var a;D.peerRecipientLid?a=o("WAWebWidFactory").asUserWidOrThrow(D.peerRecipientLid):D.chat.isLid()&&(a=o("WAWebWidFactory").asUserWidOrThrow(D.chat));var i=o("WAWebSetUsernameJob").maybeCreateSetUsernameInfoJobArg({userId:a,username:D.peerRecipientUsername});i&&t.push(i)}t.length>0&&(yield o("WAWebSetUsernameJob").setUsernamesJob(t))}var l=o("WAWebMsgProcessingApiUtils").messageInfoToKey(D);if(T.isUnavailable){o("WAWebDBReportingTokenUtils").maybeStoreReportingTag({msgKey:l,stanzaId:D.externalId,msgTs:D.ts,incomingMsgReportingTokenInfo:I.reportingTokenInfo}),o("WALogger").LOG(_||(_=babelHelpers.taggedTemplateLiteralLoose(["handleMessage: msgId::",", get fanout placeholder"])),D.externalId).tags("messaging");var s=o("WAWebHandleMsgTypes.flow").PlaceholderType.FANOUT;return x!=null?(o("WALogger").DEV(f||(f=babelHelpers.taggedTemplateLiteralLoose(["setting fanout placeholder type to bot fanout future proofing"]))),s=o("WAWebHandleMsgTypes.flow").PlaceholderType.BOT_UNAVAILABLE_FANOUT):T.isHostedMsgUnavailable===!0?(o("WALogger").DEV(g||(g=babelHelpers.taggedTemplateLiteralLoose(["setting fanout placeholder type to hosted fanout"]))),s=o("WAWebHandleMsgTypes.flow").PlaceholderType.HOSTED_UNAVAILABLE_FANOUT):T.isViewOnceUnavailable===!0&&(o("WALogger").DEV(h||(h=babelHelpers.taggedTemplateLiteralLoose(["setting fanout placeholder type to view once"]))),s=o("WAWebHandleMsgTypes.flow").PlaceholderType.VIEW_ONCE_UNAVAILABLE_FANOUT),yield o("WAWebHandleMsgProcess").processPlaceholderMsg({type:o("WAWebMsgType").MSG_TYPE.CIPHERTEXT,msgMeta:T,msgInfo:D,placeholderType:s}),o("WAWebHandleMsgSendReceipt").sendReceipt(D,T,{result:o("WAWebHandleMsgTypes.flow").E2EProcessResult.BACKFILL}),null}var u=yield o("WAWebMsgProcessingDecryptApi").decryptE2EPayload(I,o("WAWebHandleMsgProcess").processDecryptedMessageProto);return D.offline!=null&&o("WAWebOfflineHandler").OfflineMessageHandler.processMessageDecryptResult(u.result),u.result!==o("WAWebHandleMsgTypes.flow").E2EProcessResult.SUCCESS&&o("WAWebDBReportingTokenUtils").maybeStoreReportingTag({msgKey:l,stanzaId:D.externalId,msgTs:D.ts,incomingMsgReportingTokenInfo:I.reportingTokenInfo}),u.result===o("WAWebHandleMsgTypes.flow").E2EProcessResult.SIGNAL_OLD_COUNTER_ERROR&&v(I)?o("WAWebGetMessageCache").getMessageCache().addMessages([{duplicateMsgReceiptInfo:{externalId:D.externalId,from:o("WAWebMsgProcessingApiUtils").getFrom(D),author:D.author,msgInfo:D,msgMeta:T,enc:u.failedEnc||$[0],hasHideFailEnc:$.some(function(e){return e.hideFail}),msgReceivedTimes:N}}],D.offline==null):D.offline==null||D.category===o("WAWebHandleMsgCommon").CATEGORY_PEER||T.type===o("WAWebHandleMsgCommon").STANZA_MSG_TYPES.medianotify||u.result!==o("WAWebHandleMsgTypes.flow").E2EProcessResult.SUCCESS&&u.result!==o("WAWebHandleMsgTypes.flow").E2EProcessResult.SIGNAL_OLD_COUNTER_ERROR?o("WAWebHandleMsgSendReceipt").sendReceipt(D,T,u):o("WAWebGetMessageCache").getMessageCache().addMessages([{receiptInfo:{externalId:D.externalId,from:o("WAWebMsgProcessingApiUtils").getFrom(D),author:D.author}}],!1),null});function t(){return e.apply(this,arguments)}return t})()})}),b.apply(this,arguments)}function v(e){var t=e.msgMeta,n=e.encs,r=n.some(function(e){return e.hideFail});return r?o("WAWebHandleMsgMetaUtils").isReactionMsgMeta(t)||o("WAWebHandleMsgMetaUtils").isPollVoteMsgMeta(t):t.type===o("WAWebHandleMsgCommon").STANZA_MSG_TYPES.text||t.type===o("WAWebHandleMsgCommon").STANZA_MSG_TYPES.media||t.type===o("WAWebHandleMsgCommon").STANZA_MSG_TYPES.medianotify||t.type===o("WAWebHandleMsgCommon").STANZA_MSG_TYPES.poll}l.default=C}),98);
__d("WAWebHandleMsgReceiptParser",["WADeprecatedWapParser","WALogger","WAWebAck","WAWebHandleMsgTypes.flow","WAWebJidToWid","WAWebUserPrefsMeUser"],(function(t,n,r,o,a,i,l){var e,s,u={delivery:(s=o("WAWebAck")).ACK.RECEIVED,read:s.ACK.READ,played:s.ACK.PLAYED,inactive:s.ACK.INACTIVE,"server-error":s.ACK.CONTENT_GONE,sender:s.ACK.RECEIVED,"read-self":s.ACK.READ,"played-self":s.ACK.PLAYED,peer_msg:s.ACK.PEER},c=new(r("WADeprecatedWapParser"))("incomingMsgReceiptParser",function(e){e.assertTag("receipt"),e.hasAttr("to")&&e.assertAttr("to",o("WAWebUserPrefsMeUser").getMeDevicePnOrThrow().toJid());var t=e.hasAttr("type")?e.attrEnumOrNullIfUnknown("type",u):o("WAWebAck").ACK.RECEIVED,n={stanzaId:e.attrString("id"),from:o("WAWebJidToWid").jidWithTypeToWid(e.attrJidWithType("from")),offline:e.hasAttr("offline")?e.attrString("offline"):null},r=babelHelpers.extends({},n,{ack:t!=null?t:o("WAWebAck").ACK.RECEIVED,ackString:e.hasAttr("type")?e.attrString("type"):null}),a=e.maybeChild("error");a!=null&&a.hasAttr("reason")&&a.attrString("reason")==="lid"&&a.attrString("type")==="feature-incapable"&&(r.ack=o("WAWebAck").ACK.SENT);var i=e.maybeChild("participants");if(i==null)return p(r,e);var l=i.hasAttr("message_id");return l?m(n,i):d(r,i)});function d(e,t){var n=t.mapChildrenWithTag("user",function(e){try{var t=o("WAWebJidToWid").deviceJidToDeviceWid(e.attrDeviceJid("jid")),n=e.attrTime("t");return{participant:t,ts:n}}catch(e){return null}}),r=n.filter(Boolean);return babelHelpers.extends({},e,{type:"aggregated_by_type",externalId:t.attrString("key"),receipts:r})}function m(t,n){var r=[];return n.forEachChildWithTag("user",function(t){try{var n=o("WAWebJidToWid").deviceJidToDeviceWid(t.attrDeviceJid("jid")),a=t.attrTime("t"),i=t.hasAttr("type")?t.attrString("type"):null,l=t.attrEnumOrDefault("type",u,o("WAWebAck").ACK.RECEIVED);r.push({participant:n,ack:l,ackString:i,ts:a})}catch(t){o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["parseAggregateByMessageReceipt: failed: ",""])),t).sendLogs("failed-to-parse-aggregeated-by-message-receipt",{sampling:.001})}}),babelHelpers.extends({},t,{type:"aggregated_by_message",externalId:n.attrString("message_id"),receipts:r})}function p(e,t){var n=t.hasAttr("participant")?o("WAWebJidToWid").deviceJidToDeviceWid(t.attrDeviceJid("participant")):null,r=t.hasAttr("recipient")?o("WAWebJidToWid").userJidToUserWid(t.attrUserJid("recipient")):null,a=t.maybeAttrString("type")==="view",i;t.hasChild("list")?i=t.child("list").mapChildrenWithTag("item",function(e){return a?e.attrString("server_id"):e.attrString("id")}):i=[];var l;if(t.hasChild("biz")){var s=t.child("biz"),u=o("WAWebHandleMsgTypes.flow").ActualActorsEnumType.cast(s.maybeAttrInt("actual_actors")),c=o("WAWebHandleMsgTypes.flow").HostStorageEnumType.cast(s.maybeAttrInt("host_storage")),d=s.maybeAttrInt("privacy_mode_ts");u!=null&&c!=null&&d!=null&&(l={actualActors:u,hostStorage:c,privacyModeTs:d})}a||i.push(e.stanzaId);var m=!1;return n!=null&&n.isBot()&&t.hasAttr("is_lid")&&(m=t.attrString("is_lid")==="true"),babelHelpers.extends({},e,{type:"simple",externalIds:i,participant:n,recipient:r,ts:t.attrTime("t"),biz:l,isLidBot:m})}l.RECEIPT_TYPES_TO_ACK=u,l.msgReceiptParser=c}),98);
__d("WAWebWamEnumReceiptAggregationType",[],(function(t,n,r,o,a,i){var e=Object.freeze({NONE:0,MULTI_MESSAGES:1,MULTI_PARTICIPANTS:2,AGGREGATE_BY_ID:3});i.RECEIPT_AGGREGATION_TYPE=e}),66);
__d("WAWebWamEnumReceiptStanzaStage",[],(function(t,n,r,o,a,i){var e=Object.freeze({OVERALL:0,WAITING_IN_E2E_QUEUE:6,WAITING_IN_UNORDERED_QUEUE:7,PARSE:1,WAITING_TO_PROCESS:2,PROCESS:3,WAITING_TO_ACK:5,ACK:4});i.RECEIPT_STANZA_STAGE=e}),66);
__d("WAWebReceiptStanzaReceiveWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumMediaType","WAWebWamEnumMessageType","WAWebWamEnumReceiptAggregationType","WAWebWamEnumReceiptStanzaStage"],(function(t,n,r,o,a,i,l){var e,s=(e=o("WAWebWamCodegenUtils")).defineEvents({ReceiptStanzaReceive:[2496,{dbReadsCount:[12,e.TYPES.INTEGER],dbWritesCount:[13,e.TYPES.INTEGER],mediaType:[2,o("WAWebWamEnumMediaType").MEDIA_TYPE],messageType:[10,o("WAWebWamEnumMessageType").MESSAGE_TYPE],processingDeferred:[14,e.TYPES.BOOLEAN],receiptAggregation:[11,o("WAWebWamEnumReceiptAggregationType").RECEIPT_AGGREGATION_TYPE],receiptStanzaDuration:[1,e.TYPES.TIMER],receiptStanzaHasOrphaned:[6,e.TYPES.BOOLEAN],receiptStanzaOfflineCount:[3,e.TYPES.INTEGER],receiptStanzaProcessedCount:[8,e.TYPES.INTEGER],receiptStanzaRetryVer:[5,e.TYPES.INTEGER],receiptStanzaStage:[9,o("WAWebWamEnumReceiptStanzaStage").RECEIPT_STANZA_STAGE],receiptStanzaTotalCount:[7,e.TYPES.INTEGER],receiptStanzaType:[4,e.TYPES.STRING],stanzaBatchSize:[15,e.TYPES.INTEGER],stanzaProcessCount:[16,e.TYPES.INTEGER]},[1,1e3,2e3],"regular"]},{ReceiptStanzaReceive:[]});l.ReceiptStanzaReceiveWamEvent=s}),98);
__d("WAWebCreateReceiptStanzaReceiveMetric",["WAWebAck","WAWebHandleMsgReceiptParser","WAWebReceiptStanzaReceiveWamEvent","WAWebWamEnumMessageType","WAWebWamEnumReceiptStanzaStage","WAWebWid"],(function(t,n,r,o,a,i,l){function e(){var e=new(o("WAWebReceiptStanzaReceiveWamEvent")).ReceiptStanzaReceiveWamEvent({receiptStanzaStage:o("WAWebWamEnumReceiptStanzaStage").RECEIPT_STANZA_STAGE.OVERALL,receiptStanzaTotalCount:1});return function(t){var n=t.ackString,r=t.from,a=t.offline,i=t.receipts;if(e.messageType=s(r),a!=null){var l=parseInt(a,10);Number.isNaN(l)||(e.receiptStanzaOfflineCount=l)}n==null?e.receiptStanzaType=o("WAWebAck").ACK_STRING.DELIVERY:o("WAWebHandleMsgReceiptParser").RECEIPT_TYPES_TO_ACK[n]!=null&&(e.receiptStanzaType=n),(i==null?void 0:i.length)!=null&&(e.receiptStanzaTotalCount=i.length),e.markReceiptStanzaDuration(),e.commit()}}function s(e){return r("WAWebWid").isStatus(e)?o("WAWebWamEnumMessageType").MESSAGE_TYPE.STATUS:r("WAWebWid").isGroup(e)?o("WAWebWamEnumMessageType").MESSAGE_TYPE.GROUP:r("WAWebWid").isBroadcast(e)?o("WAWebWamEnumMessageType").MESSAGE_TYPE.BROADCAST:r("WAWebWid").isNewsletter(e)?o("WAWebWamEnumMessageType").MESSAGE_TYPE.CHANNEL:o("WAWebWamEnumMessageType").MESSAGE_TYPE.INDIVIDUAL}l.createReceiptStanzaReceiveMetric=e}),98);
__d("WAWebHandleAckPeerSimpleReceipt",["WAWebApiPeerMessageStore","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){function e(e){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){yield o("WAWebApiPeerMessageStore").deletePeerMessage(e.stanzaId)}),s.apply(this,arguments)}l.handleAckPeerSimpleReceipt=e}),98);
__d("WAWebHandleBotInvokeMsgReceipt",["WALogger","WAWebAck","WAWebMessageReceiptBatcher","WAWebMsgKey","WAWebOfflineHandler","WAWebOrchestratorNonPersistedJob","asyncToGeneratorRuntime","err"],(function(t,n,r,o,a,i,l){var e;function s(e){return u.apply(this,arguments)}function u(){return u=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var n=t.ack,a=t.from,i=t.externalIds,l=t.ts,s=t.ackString,u=t.recipient,c=t.offline,d=c!=null&&!o("WAWebOfflineHandler").OfflineMessageHandler.isResumeFromRestartComplete();if(s!==o("WAWebAck").ACK_STRING.READ||u==null||!a.isBot())throw r("err")("handleBotOneToOneInvokeSimpleReadReceipt: unexpected receipt");var m=i.map(function(e){return new(r("WAWebMsgKey"))({id:e,remote:u,fromMe:!0})}),p=m.map(function(e){return e.toString()});o("WALogger").DEV(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[unify][batcher] adding receipt ",""])),p.join(","));var _=o("WAWebMessageReceiptBatcher").receiptBatcher.acceptOtherReceipt({ack:n,ts:l,receiverId:a,msgKeys:p,isBotInvoke:!0});return d||(yield o("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("receiptBatcherRunActiveBatches",function(){return o("WAWebMessageReceiptBatcher").receiptBatcher.runActiveBatches()}).waitUntilCompleted()),_}),u.apply(this,arguments)}l.handleBotOneToOneInvokeSimpleReadReceipt=s}),98);
__d("WAWebHandleMsgReceiptUtils",["WAWebAck"],(function(t,n,r,o,a,i,l){function e(e){return e===o("WAWebAck").ACK_STRING.READ||e===o("WAWebAck").ACK_STRING.READ_SELF||e===o("WAWebAck").ACK_STRING.PLAYED||e===o("WAWebAck").ACK_STRING.PLAYED_SELF}function s(e){return e.receipts.map(function(t){return{type:"simple",stanzaId:e.externalId,externalIds:[e.externalId],from:e.from,participant:t.participant,recipient:null,ts:t.ts,ack:e.ack,ackString:e.ackString,offline:e.offline,biz:null,isLidBot:!1}})}function u(e){return e.receipts.map(function(t){return{type:"simple",stanzaId:e.externalId,externalIds:[e.externalId],from:e.from,participant:t.participant,recipient:null,ts:t.ts,ack:t.ack,ackString:t.ackString,offline:e.offline,biz:null,isLidBot:!1}})}l.isReadOrPlayedReceipt=e,l.deaggregateGroupedByTypeReceipt=s,l.deaggregateGroupedByMessageReceipt=u}),98);
__d("WAWebHandleDirectChatReceipt",["Promise","WAJids","WALogger","WAWebAck","WAWebHandleMsgReceiptCommon","WAWebHandleMsgReceiptUtils","WAWebMessageReceiptBatcher","WAWebMsgKey","WAWebOfflineHandler","WAWebSimpleSignalPNToFBIDMigration","WAWebUserPrefsIndexedDBStorage","WAWebUserPrefsKeys","WAWebUserPrefsMeUser","WAWebWid","WAWebWidFactory","asyncToGeneratorRuntime","err","gkx"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m;function p(e){return _.apply(this,arguments)}function _(){return _=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var a=t.from,i=t.externalIds,l=t.ts,p=t.recipient,_=t.ackString,f=t.offline,g=t.biz,h=t.ack,y=_===o("WAWebAck").ACK_STRING.SENDER,C=!y&&o("WAWebUserPrefsMeUser").isMeAccount(a),b;if(C||y){if(!p)throw r("gkx")("26258")?o("WALogger").WARN(s||(s=babelHelpers.taggedTemplateLiteralLoose(["error: invalid sender/peer receipt without recipient"]))):o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["error: invalid sender/peer receipt without recipient"]))).sendLogs("handleChatSimpleReceipt: failed"),r("err")("handleChatSimpleReceipt: invalid sender/peer receipt without recipient");b=p}else{var v;b=o("WAWebWidFactory").asUserWidOrThrow(a);var S=((v=o("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.get(o("WAWebUserPrefsKeys").HASHED_KEYS.USER_PRIVACY_SETTINGS))==null?void 0:v.readReceipts)==="none";S&&(h===o("WAWebAck").ACK.READ||h===o("WAWebAck").ACK.PLAYED)&&(h=o("WAWebAck").ACK.RECEIVED)}var R=o("WAWebSimpleSignalPNToFBIDMigration").getDeprecatedPnChatForFbidThread(b);R!=null&&(o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["handleChatSimpleReceipt: forwarding "," to ",""])),b.toLogString(),R.toLogString()),b=o("WAWebWidFactory").asUserWidOrThrow(R));var L;b!=null&&r("WAWebWid").isWid(b)&&b===o("WAWebWidFactory").createWid(o("WAJids").PSA_JID)&&(L=o("WAWebWidFactory").createWid(o("WAJids").PSA_JID));var E=i.map(function(e){return new(r("WAWebMsgKey"))({id:e,remote:b,fromMe:!C,participant:L})});C&&h===o("WAWebAck").ACK.PLAYED&&o("WAWebHandleMsgReceiptCommon").handleViewOnceOpenedIfNecessary(E);var k=E.map(function(e){return e.toString()});f!=null&&o("WAWebOfflineHandler").OfflineMessageHandler.offlineStanzaReceivedAfterComplete();var I=f!=null&&!o("WAWebOfflineHandler").OfflineMessageHandler.isResumeFromRestartComplete(),T=(m||(m=n("Promise"))).resolve();return C?p!=null&&o("WAWebHandleMsgReceiptUtils").isReadOrPlayedReceipt(_)&&i.length>0&&(o("WALogger").DEV(d||(d=babelHelpers.taggedTemplateLiteralLoose(["[unify][batcher] adding peer receipt ",""])),k.join(",")),T=o("WAWebMessageReceiptBatcher").receiptBatcher.acceptPeerReceipt({ack:h,ts:l,msgKeys:k,isOffline:I,remote:b})):(o("WALogger").DEV(c||(c=babelHelpers.taggedTemplateLiteralLoose(["[unify][batcher] adding receipt ",""])),k.join(",")),T=o("WAWebMessageReceiptBatcher").receiptBatcher.acceptOtherReceipt({ack:h,ts:l,receiverId:a,msgKeys:k,privacyMode:g,isSender:y})),I||o("WAWebMessageReceiptBatcher").receiptBatcher.runActiveBatches(),T}),_.apply(this,arguments)}l.handleChatSimpleReceipt=p}),98);
__d("WAWebHandleGroupChatReceipt",["WALogger","WAWebAck","WAWebHandleMsgReceiptCommon","WAWebHandleMsgReceiptUtils","WAWebMessageReceiptBatcher","WAWebMsgKey","WAWebOfflineHandler","WAWebOrchestratorNonPersistedJob","WAWebUserPrefsMeUser","WAWebWidFactory","asyncToGeneratorRuntime","err","gkx"],(function(t,n,r,o,a,i,l){var e,s,u,c,d;function m(e){return p.apply(this,arguments)}function p(){return p=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var n=t.ack,a=t.from,i=t.externalIds,l=t.ts,m=t.ackString,p=t.participant,_=t.recipient,f=t.offline,g=t.isLidBot;if(!p)throw o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["error: got group ack without participant."]))).sendLogs("handleGroupSimpleReceipt: failed"),r("err")("handleGroupSimpleReceipt: got group ack without participant.");var h=o("WAWebWidFactory").asUserWidOrThrow(p),y=m===o("WAWebAck").ACK_STRING.SENDER,C=!y&&o("WAWebUserPrefsMeUser").isMeAccount(h),b;if(C){if(!_)throw r("gkx")("26258")?o("WALogger").WARN(u||(u=babelHelpers.taggedTemplateLiteralLoose(["error: invalid sender/peer receipt without recipient"]))):o("WALogger").WARN(s||(s=babelHelpers.taggedTemplateLiteralLoose(["error: invalid sender/peer receipt without recipient"]))).sendLogs("handleGroupSimpleReceipt: failed"),r("err")("handleGroupSimpleReceipt: invalid sender/peer receipt without recipient");b=_}else b=h.isLid()||g?o("WAWebUserPrefsMeUser").getMeLidUserOrThrow():o("WAWebUserPrefsMeUser").getMePnUserOrThrow();var v=i.map(function(e){return new(r("WAWebMsgKey"))({id:e,remote:a,fromMe:!C,participant:b})});C&&n===o("WAWebAck").ACK.PLAYED&&o("WAWebHandleMsgReceiptCommon").handleViewOnceOpenedIfNecessary(v);var S=v.map(function(e){return e.toString()});f!=null&&o("WAWebOfflineHandler").OfflineMessageHandler.offlineStanzaReceivedAfterComplete();var R=f!=null&&!o("WAWebOfflineHandler").OfflineMessageHandler.isResumeFromRestartComplete(),L;return C?_!=null&&o("WAWebHandleMsgReceiptUtils").isReadOrPlayedReceipt(m)&&i.length>0&&(o("WALogger").DEV(d||(d=babelHelpers.taggedTemplateLiteralLoose(["[unify][batcher] adding peer receipt ",""])),S.join(",")),L=o("WAWebMessageReceiptBatcher").receiptBatcher.acceptPeerReceipt({isOffline:R,ack:n,ts:l,msgKeys:S,remote:a})):(o("WALogger").DEV(c||(c=babelHelpers.taggedTemplateLiteralLoose(["[unify][batcher] adding receipt ",""])),S.join(",")),L=o("WAWebMessageReceiptBatcher").receiptBatcher.acceptOtherReceipt({ack:n,ts:l,receiverId:p,msgKeys:S})),R||(yield o("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("receiptBatcherRunActiveBatches",function(){return o("WAWebMessageReceiptBatcher").receiptBatcher.runActiveBatches()}).waitUntilCompleted()),L}),p.apply(this,arguments)}l.handleGroupSimpleReceipt=m}),98);
__d("WAWebHandleNewsletterReceipt",["WAAckLevel","WALogger","WAWebAck","WAWebHandleMsgReceiptCommon","WAWebMessageReceiptBatcher","WAWebMsgKey","WAWebOfflineHandler","WAWebUserPrefsMeUser","WAWebWidFactory","asyncToGeneratorRuntime","err"],(function(t,n,r,o,a,i,l){var e,s,u,c;function d(e){return m.apply(this,arguments)}function m(){return m=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var n=t.ack,a=t.from,i=t.externalIds,l=t.ts,d=t.ackString,m=t.participant,p=t.offline,_=t.stanzaId,f="[receipt][newsletter]["+_+"]";if(o("WALogger").DEV(e||(e=babelHelpers.taggedTemplateLiteralLoose([""," handling newsletter receipt"])),f).devConsole(t),d==="view")return o("WAWebHandleMsgReceiptCommon").updateMsgViewed(i.map(function(e){return parseInt(e,10)}),a);if(n!==o("WAAckLevel").ACK.READ&&n!==o("WAAckLevel").ACK.PLAYED)throw o("WALogger").WARN(s||(s=babelHelpers.taggedTemplateLiteralLoose([""," ACK should be READ or PLAYED, "," received instead"])),f,n),r("err")("handleNewsletterSimpleReceipt: only READ/PLAYED ack for newsletters");var g=(d===o("WAWebAck").ACK_STRING.READ_SELF||d===o("WAWebAck").ACK_STRING.PLAYED_SELF)&&m!=null&&o("WAWebWidFactory").asUserWidOrThrow(m).equals(o("WAWebUserPrefsMeUser").getMePnUserOrThrow());if(!g)throw o("WALogger").WARN(u||(u=babelHelpers.taggedTemplateLiteralLoose([""," only peer receipts are accepted"])),f).devConsole(m),r("err")("handleNewsletterSimpleReceipt: only peer receipts for newsletters");var h=i.map(function(e){return new(r("WAWebMsgKey"))({id:e,remote:a,fromMe:!1})}),y=h.map(function(e){return e.toString()});p!=null&&o("WAWebOfflineHandler").OfflineMessageHandler.offlineStanzaReceivedAfterComplete();var C=p!=null&&!o("WAWebOfflineHandler").OfflineMessageHandler.isResumeFromRestartComplete(),b=o("WAWebMessageReceiptBatcher").receiptBatcher.acceptPeerReceipt({isOffline:C,ack:n,ts:l,remote:a,msgKeys:y});return C||(o("WALogger").DEV(c||(c=babelHelpers.taggedTemplateLiteralLoose(["","  online, updating the UI"])),f),yield o("WAWebMessageReceiptBatcher").receiptBatcher.runActiveBatches()),b}),m.apply(this,arguments)}l.handleNewsletterSimpleReceipt=d}),98);
__d("WAWebHandleStatusReceipt",["Promise","WAJids","WALogger","WAWebAck","WAWebMessageReceiptBatcher","WAWebMsgKey","WAWebOfflineHandler","WAWebUserPrefsIndexedDBStorage","WAWebUserPrefsKeys","WAWebUserPrefsMeUser","WAWebWidFactory","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u,c;function d(e){return m.apply(this,arguments)}function m(){return m=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var a,i=t.externalIds,l=t.ts,d=t.ackString,m=t.ack,p=t.participant,_=t.recipient,f=t.offline,g=i[0];if(!p){o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["error: got status ack without participant"]))).sendLogs("handleStatusSimpleReceipt: failed");return}var h=o("WAWebUserPrefsMeUser").getMePnUserOrThrow(),y=o("WAWebWidFactory").asUserWidOrThrow(p),C=o("WAWebUserPrefsMeUser").isMeAccount(y),b=((a=o("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.get(o("WAWebUserPrefsKeys").HASHED_KEYS.USER_PRIVACY_SETTINGS))==null?void 0:a.readReceipts)==="none";if(!(!C&&(b||d!==o("WAWebAck").ACK_STRING.READ))){var v=o("WAWebWidFactory").createWid(o("WAJids").STATUS_JID),S=new(r("WAWebMsgKey"))({id:g,remote:v,fromMe:!C,participant:_!=null?_:h}),R=[S.toString()],L=f!=null&&!o("WAWebOfflineHandler").OfflineMessageHandler.isResumeFromRestartComplete(),E=(c||(c=n("Promise"))).resolve();return C?(o("WALogger").DEV(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[unify][batcher] adding (",") status peer receipt ",""])),L?"offline":"online",R.join(",")),E=o("WAWebMessageReceiptBatcher").receiptBatcher.acceptPeerReceipt({ts:l,msgKeys:R,ack:m,isOffline:L,remote:v})):(o("WALogger").DEV(u||(u=babelHelpers.taggedTemplateLiteralLoose(["[unify][batcher] adding (",") receipt ",""])),L?"offline":"online",R.join(",")),E=o("WAWebMessageReceiptBatcher").receiptBatcher.acceptOtherReceipt({ack:m,ts:l,receiverId:y,msgKeys:R})),L||o("WAWebMessageReceiptBatcher").receiptBatcher.runActiveBatches(),E}}),m.apply(this,arguments)}l.handleStatusSimpleReceipt=d}),98);
__d("WAWebReceiptAck",["WAWap","WAWebCommsWapMd"],(function(t,n,r,o,a,i,l){function e(e,t,n,r){return o("WAWap").wap("ack",{to:o("WAWebCommsWapMd").JID(e),id:o("WAWap").CUSTOM_STRING(t),class:"receipt",type:o("WAWap").MAYBE_CUSTOM_STRING(n),participant:r&&r!==e?o("WAWebCommsWapMd").DEVICE_JID(r):o("WAWap").DROP_ATTR})}l.buildReceiptAck=e}),98);
__d("WAWebHandleMsgReceipt",["Promise","WALogger","WAWebAck","WAWebCreateReceiptStanzaReceiveMetric","WAWebHandleAckPeerSimpleReceipt","WAWebHandleBotInvokeMsgReceipt","WAWebHandleDirectChatReceipt","WAWebHandleGroupChatReceipt","WAWebHandleMsgReceiptParser","WAWebHandleMsgReceiptUtils","WAWebHandleNewsletterReceipt","WAWebHandleStatusReceipt","WAWebNewsletterGatingUtils","WAWebReceiptAck","asyncToGeneratorRuntime","err","gkx"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p,_,f,g,h,y;function C(e){return b.apply(this,arguments)}function b(){return b=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=o("WAWebCreateReceiptStanzaReceiveMetric").createReceiptStanzaReceiveMetric(),n=o("WAWebHandleMsgReceiptParser").msgReceiptParser.parse(e);if(n.error)throw o("WALogger").DEV(d||(d=babelHelpers.taggedTemplateLiteralLoose(["error while parsing: ",""])),e.toString()),o("WALogger").ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["Parsing Error: ",""])),n.error.toString()),n.error;var a=n.success,i=a.ack,l=a.ackString,s=a.from,u=a.stanzaId,c=a.offline,y;if(a.type==="simple")if(i===o("WAWebAck").ACK.CONTENT_GONE)y=o("WAWebReceiptAck").buildReceiptAck(s,u,l,null);else{try{o("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(['handleSimpleReceipt: receipt "','" for msg: ',""])),i,r("gkx")("26258")?"...":u),yield v(a)}catch(e){o("WALogger").WARN(_||(_=babelHelpers.taggedTemplateLiteralLoose(['handleSimpleReceipt: receipt "','" for msg: '," failed: ",""])),i,r("gkx")("26258")?"...":u,r("gkx")("26258")?"...":e).tags("messaging")}y=o("WAWebReceiptAck").buildReceiptAck(s,u,l,a.participant)}else if(a.type==="aggregated_by_type"){try{o("WALogger").LOG(f||(f=babelHelpers.taggedTemplateLiteralLoose(["handleAggregateReceipt: ",' receipt(s) "','" for msg: ',""])),a.receipts.length,i,r("gkx")("26258")?"...":a.externalId),yield S(a)}catch(e){}y=o("WAWebReceiptAck").buildReceiptAck(s,u,l,null)}else if(a.type==="aggregated_by_message"){try{o("WALogger").LOG(g||(g=babelHelpers.taggedTemplateLiteralLoose(["handleAggregateByMessageReceipt: "," receipt(s) for msg: ",""])),a.receipts.length,r("gkx")("26258")?"...":a.externalId),yield R(a)}catch(e){o("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["handleAggregateByMessageReceipt: failed: ",""])),e).sendLogs("handle-aggregate-by-message-receipt-failed",{sampling:.001})}y=o("WAWebReceiptAck").buildReceiptAck(s,u,l,null)}else a.type;return c==null&&t(a),y}),b.apply(this,arguments)}function v(t){var a=t.from,i=t.ack,l=t.recipient,u=t.ackString;if(i===o("WAWebAck").ACK.PEER)return o("WAWebHandleAckPeerSimpleReceipt").handleAckPeerSimpleReceipt(t);if(a.isNewsletter())return o("WAWebNewsletterGatingUtils").isNewsletterEnabled()?o("WAWebHandleNewsletterReceipt").handleNewsletterSimpleReceipt(t):(y||(y=n("Promise"))).resolve();if(a.isBot()&&l!=null&&u===o("WAWebAck").ACK_STRING.READ)return o("WAWebHandleBotInvokeMsgReceipt").handleBotOneToOneInvokeSimpleReadReceipt(t);if(a.isStatus())return o("WAWebHandleStatusReceipt").handleStatusSimpleReceipt(t);if(a.isUser())return o("WAWebHandleDirectChatReceipt").handleChatSimpleReceipt(t);if(a.isGroup())return o("WAWebHandleGroupChatReceipt").handleGroupSimpleReceipt(t);if(a.isBroadcast()){if(!t.participant)return o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["error: missing participant for broadcast receipt ",""])),a.toString()).sendLogs("handleSimpleReceipt: failed"),(y||(y=n("Promise"))).reject(r("err")("handleSimpleReceipt: missing participant for broadcast receipt "+a.toString()));var c=babelHelpers.extends({},t,{from:t.participant,participant:null});return o("WAWebHandleDirectChatReceipt").handleChatSimpleReceipt(c)}return o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["error: unsupported type for ",""])),a.toString()).sendLogs("handleSimpleReceipt: failed"),(y||(y=n("Promise"))).reject(r("err")("handleSimpleReceipt: unsupported type for "+a.toString()))}function S(e){var t=e.ack,a=e.from;return t===o("WAWebAck").ACK.CONTENT_GONE?(o("WALogger").ERROR(u||(u=babelHelpers.taggedTemplateLiteralLoose(["error: reupload receipts cannot be aggregated"]))).sendLogs("handleAggregateReceipt: failed"),(y||(y=n("Promise"))).reject(r("err")("handleAggregateReceipt: failed"))):!a.isGroup()&&!a.isBroadcast()?(o("WALogger").ERROR(c||(c=babelHelpers.taggedTemplateLiteralLoose(["handleAggregateReceipt: aggregate receipts should come only from group, broadcast"]))).sendLogs("handleAggregateReceipt: failed"),(y||(y=n("Promise"))).reject(r("err")("handleAggregateReceipt: failed"))):(y||(y=n("Promise"))).all(o("WAWebHandleMsgReceiptUtils").deaggregateGroupedByTypeReceipt(e).map(v))}function R(e){return(y||(y=n("Promise"))).all(o("WAWebHandleMsgReceiptUtils").deaggregateGroupedByMessageReceipt(e).map(v))}l.default=C}),98);
__d("WAWebCommsHandleMessagingStanza",["WAParsableWapNode","WAWebCommsHandleStanzaUtils","WAWebCreateNackFromStanza","WAWebHandleMsg","WAWebHandleMsgReceipt","WAWebPostUnknownStanzaMetric","WAWebWid"],(function(t,n,r,o,a,i,l){function e(e){var t=e.attrs;switch(e.tag){case"message":{var n=e.attrs.from;if(!r("WAWebWid").isNewsletter(n==null?void 0:n.toString()))return r("WAWebHandleMsg")(e).catch(function(t){return o("WAWebCommsHandleStanzaUtils").handleMessageParsingFailure(e,t)})}break;case"receipt":try{if(!o("WAWebCommsHandleStanzaUtils").isCallReceipt(e)&&t.type!=="retry")return r("WAWebHandleMsgReceipt")(e)}catch(t){return t instanceof o("WAParsableWapNode").XmppParsingFailure?(o("WAWebPostUnknownStanzaMetric").postUnknownStanzaMetric(e),o("WAWebCreateNackFromStanza").createNackFromStanza(e,o("WAWebCreateNackFromStanza").NackReason.ParsingError)):o("WAWebCreateNackFromStanza").createNackFromStanza(e,o("WAWebCreateNackFromStanza").NackReason.UnhandledError)}}}l.handleMessagingStanza=e}),98);
__d("WAWebGroupApiConst",[],(function(t,n,r,o,a,i){var e={superadmin:"superadmin",admin:"admin",participant:"participant"};i.GROUP_PARTICIPANT_TYPES=e}),66);
__d("WAWebGroupJoinCWamEvent",["WAWebWamCodegenUtils"],(function(t,n,r,o,a,i,l){var e=o("WAWebWamCodegenUtils").defineEvents({GroupJoinC:[158,{},[1,1,1],"regular"]},{GroupJoinC:[]});l.GroupJoinCWamEvent=e}),98);
__d("WAWebHandleGroupCreation",["Promise","WALogger","WAWebApiChat","WAWebBackendApi","WAWebCreateChat","WAWebGroupDatabaseJob","WAWebGroupJoinCWamEvent","WAWebGroupParticipantsJob","WAWebHandleMsgTypes.flow","WAWebHandlePushnameUpdate","WAWebUserPrefsMeUser","WAWebWorkerSafeBackendApi","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u,c;function d(e,t,n,r){return m.apply(this,arguments)}function m(){return m=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,r,a,i){a===void 0&&(a=!1),i===void 0&&(i=!1),o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["inside handleGroupCreation"]))).tags("groups");var l=t.chatId,d=t.author,m=t.pushname,p=r.id,_=r.participants,f=r.subject,g=r.creation,h=r.hasCapi;(t.author==null||!t.author.equals(o("WAWebUserPrefsMeUser").getMaybeMePnUser()))&&new(o("WAWebGroupJoinCWamEvent")).GroupJoinCWamEvent().commit(),d&&m&&o("WAWebHandlePushnameUpdate").updatePushname(d,m,a),yield(c||(c=n("Promise"))).all([o("WAWebGroupDatabaseJob").updateGroupMetadataTableJob([r]),o("WAWebGroupParticipantsJob").updateParticipantsJob({group:p,participants:_,isOffline:a,groupInfo:r})]),o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["updated GroupMetadata and participants tables"]))).tags("groups"),(yield o("WAWebApiChat").getChatRecord(l))!=null?o("WAWebBackendApi").frontendFireAndForget("updateGroupSubject",{id:l,subject:f}):(yield o("WAWebCreateChat").createChat({chatId:l},"groupCreation",babelHelpers.extends({t:g,pendingInitialLoading:!1,createdLocally:!1},i===!0&&{notSpam:!0}),babelHelpers.extends({createdOffline:a},h===!0&&{nextPrivacyMode:{actualActors:o("WAWebHandleMsgTypes.flow").ActualActorsEnumType.Capi,hostStorage:o("WAWebHandleMsgTypes.flow").HostStorageEnumType.Facebook,privacyModeTs:0}})),o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["updated chat model and table"]))).tags("groups"),o("WAWebBackendApi").frontendFireAndForget("updateGroupSubject",{id:p,subject:f})),o("WAWebBackendApi").frontendFireAndForget("setGroupMetadata",r),o("WAWebBackendApi").frontendFireAndForget("markProfilePicStale",{profilePicThumbWid:p}),!a&&o("WAWebWorkerSafeBackendApi").workerSafeFireAndForget("maybeSendKeyDistributionMsgToNewGroup",{groupId:p})}),m.apply(this,arguments)}l.handleGroupCreation=d}),98);
__d("WAWebMemberLabelGroupRemoveHandler",["WALogger","WAWebBackendApi","WAWebLidMigrationUtils","WAWebMemberLabelGating","WAWebMemberLabelJob","WAWebUserPrefsMeUser","WAWebWidToJid","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){"use strict";var e;function s(e,t){return u.apply(this,arguments)}function u(){return u=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,n){if(o("WAWebMemberLabelGating").isMemberLabelInfraEnabled())try{var r=[],a=t.chatId,i=o("WAWebWidToJid").widToGroupJid(a),l=[],s=n.participants.some(function(e){return o("WAWebUserPrefsMeUser").isMeAccount(e.id)});if(s){var u=yield o("WAWebMemberLabelJob").deleteAllMemberLabelsForGroup({chatId:i});for(var c of u)r.push({type:"DELETE",data:{chatId:i,member:c}})}else{for(var d of n.participants){var m=o("WAWebLidMigrationUtils").toUserLid(d.id);if(m){var p=o("WAWebWidToJid").userLidtoLidUserJid(m);l.push(p)}}var _=yield o("WAWebMemberLabelJob").deleteMemberLabelsForGroup({chatId:i,members:l});for(var f of _)r.push({type:"DELETE",data:{chatId:i,member:f}})}r.length>0&&o("WAWebBackendApi").frontendFireAndForget("updateMemberLabelCollection",{updates:r})}catch(t){o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[Member Labels] Failed to cleanup member labels for removed participants"]))).devConsole(t)}}),u.apply(this,arguments)}l.handleMemberLabelUpdatesOnGroupParticipantRemoval=s}),98);
__d("WAWebIsAddressingModeMismatch",[],(function(t,n,r,o,a,i){function e(e,t){return!!t.isLidAddressingMode!=!!e.isLidAddressingMode}i.isAddressingModeMismatch=e}),66);
__d("WAWebShouldTriggerQueryGroupInfo",["WAWebIsAddressingModeMismatch","WAWebSchemaGroupMetadata","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){function e(e){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e.groupWid,n=e.action,r=e.disableForCAGs,a=yield o("WAWebSchemaGroupMetadata").getGroupMetadataTable().get(t.toString());if(a==null)return!1;var i=(a==null?void 0:a.defaultSubgroup)===!0;return i&&r?!1:o("WAWebIsAddressingModeMismatch").isAddressingModeMismatch(a,n)}),s.apply(this,arguments)}l.shouldTriggerQueryGroupInfo=e}),98);
__d("WAWebHandleGroupNotificationV2",["Promise","WALogger","WAWap","WAWebBackendApi","WAWebCmd","WAWebCommsWapMd","WAWebGetMessageCache","WAWebGroupDatabaseJob","WAWebGroupSystemMsg","WAWebHandleGroupNotificationConst","WAWebHandleSingleMsg","WAWebLidMappingUsernameLearnUtils","WAWebMemberLabelGroupRemoveHandler","WAWebMessageQueue","WAWebShouldTriggerQueryGroupInfo","WAWebUpdateDbForGroupActionApi","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u,c,d;function m(e,t){return g(e,t)!=null}function p(e){return o("WAWap").wap("ack",{to:o("WAWebCommsWapMd").GROUP_JID(e.chatId),id:o("WAWap").CUSTOM_STRING(e.externalId),class:"notification",type:"w:gp2",participant:e.author?o("WAWebCommsWapMd").USER_JID(e.author):o("WAWap").DROP_ATTR})}function _(e,t){return f.apply(this,arguments)}function f(){return f=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,r){yield o("WAWebLidMappingUsernameLearnUtils").processParsedGroupNotificationForLidMappingAndUsernames({notification:t,flushImmediately:!r}),yield(d||(d=n("Promise"))).all(t.actions.map((function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){e.actionType===o("WAWebHandleGroupNotificationConst").GROUP_NOTIFICATION_TAG.REMOVE&&(yield o("WAWebMemberLabelGroupRemoveHandler").handleMemberLabelUpdatesOnGroupParticipantRemoval(t,e))});return function(t){return e.apply(this,arguments)}})()));var a=g(t,r);return a==null?(o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["no handler for group notification ",""])),t.chatId.toLogString()),p(t)):(o("WALogger").DEV(s||(s=babelHelpers.taggedTemplateLiteralLoose(["handle_group_notification_v2: handling notification for ",""])),t.chatId.toString()),yield d.all([a.writeSystemMessages(),a.writeGroupInfoUpdates()]),p(t))}),f.apply(this,arguments)}function g(e,t){var r=[];for(var a of e.actions){var i=l(e,a);if(i==null)return null;r.push(i)}return{writeSystemMessages:(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){yield(d||(d=n("Promise"))).all(r.map(function(e){return e.writeSystemMessages()}))});function t(){return e.apply(this,arguments)}return t})(),writeGroupInfoUpdates:(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){yield(d||(d=n("Promise"))).all(r.map(function(e){return e.writeGroupInfoUpdates()}))});function t(){return e.apply(this,arguments)}return t})()};function l(e,r){return r.actionType===o("WAWebHandleGroupNotificationConst").GROUP_NOTIFICATION_TAG.CREATE?null:{writeGroupInfoUpdates:(function(){var a=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){if((r.actionType===o("WAWebHandleGroupNotificationConst").GROUP_NOTIFICATION_TAG.ADD||r.actionType===o("WAWebHandleGroupNotificationConst").GROUP_NOTIFICATION_TAG.REMOVE)&&(yield o("WAWebShouldTriggerQueryGroupInfo").shouldTriggerQueryGroupInfo({groupWid:e.chatId,action:r}))){o("WAWebGroupDatabaseJob").markGroupParticipantStaleJob(e.chatId);return}yield o("WAWebUpdateDbForGroupActionApi").updateDBForGroupAction(e,r,t),o("WAWebBackendApi").frontendFireAndForget("updateModelForGroupAction",{groupMeta:e,groupAction:r})});function i(){return a.apply(this,arguments)}return i})(),writeSystemMessages:(function(){var a=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){return C(e.chatId,yield h(e,r),t,function(){return o("WAWebHandleGroupNotificationConst").shouldSkipGenMsg(e,r)})});function i(){return a.apply(this,arguments)}return i})()}}}function h(e,t){return y.apply(this,arguments)}function y(){return y=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=[];if((t.actionType===o("WAWebHandleGroupNotificationConst").GROUP_NOTIFICATION_TAG.ADD||t.actionType===o("WAWebHandleGroupNotificationConst").GROUP_NOTIFICATION_TAG.REMOVE)&&(yield o("WAWebShouldTriggerQueryGroupInfo").shouldTriggerQueryGroupInfo({groupWid:e.chatId,action:t})))return[];if(t.actionType===o("WAWebHandleGroupNotificationConst").GROUP_NOTIFICATION_TAG.ADD){var r=yield o("WAWebHandleGroupNotificationConst").notAlreadyInGroup(e.chatId,t.participants),a=r.filter(function(e){var t=e.id;return!t.isLid()});a.length>0&&(o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["[system message][v2] participantsWithoutLids = "," - ADD"])),a.length),n=[yield o("WAWebGroupSystemMsg").genGroupNotificationMsg({meta:e,action:babelHelpers.extends({},t,{participants:a})})])}else t.actionType!==o("WAWebHandleGroupNotificationConst").GROUP_NOTIFICATION_TAG.CREATE&&(o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["[system message][v2] genSystemNotificationsImpl - actionType = ",""])),t.actionType),n=[yield o("WAWebGroupSystemMsg").genGroupNotificationMsg({meta:e,action:t})]);return n}),y.apply(this,arguments)}function C(e,t,r,a){var i=function(){},l=new(d||(d=n("Promise")))(function(e){return i=e});return o("WAWebMessageQueue").onMessageQueue({chatWid:e,isOffline:r,msgCategory:null,action:(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(yield a()){i();return}var e=s(t).then(function(){i()});return r?(d||(d=n("Promise"))).resolve():e});function o(){return e.apply(this,arguments)}return o})()}),l;function s(e){return u.apply(this,arguments)}function u(){return u=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){if(e.length!==0){if(r)return o("WAWebCmd").Cmd.isMainStreamReadyMd&&e.forEach(function(e){o("WAWebBackendApi").frontendFireAndForget("updateMessageUI",{chatId:e.id.remote,msg:e})}),o("WAWebGetMessageCache").getMessageCache().addMessages(e.map(function(e){return{msg:e}}),!1);yield(d||(d=n("Promise"))).all(e.map(function(e){return o("WAWebHandleSingleMsg").handleSingleMsg({chatId:e.from,newMsg:e,handleSingleMsgOrigin:"handleGroupNotificationV2"})}))}}),u.apply(this,arguments)}}l.isGroupNotificationOptimizationEligible=m,l.handleGroupNotificationV2=_}),98);
__d("WAWebHandleGroupsDirtyNotification",["WAComms","WALogger","WASmaxGroupsGroupsDirtyNotificationRPC","WAWebEventsWaitForOfflineDeliveryEnd","WAWebPersistedJobDefinitions","WAWebPersistedJobManager","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s;function u(e){return c.apply(this,arguments)}function c(){return c=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var n=o("WASmaxGroupsGroupsDirtyNotificationRPC").receiveGroupsDirtyNotificationRPC(t),r=n.makeGroupsDirtyNotificationResponseAck,a=n.parsedRequest;return o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["handleGroupsDirtyNotification: received groups dirty bit notification"]))),d(a),r()}),c.apply(this,arguments)}function d(e){return m.apply(this,arguments)}function m(){return m=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){try{var t=e.groupsDirtyGroup.map(function(e){return e.jid}),n=yield p(t);yield f(n)}catch(e){o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["handleGroupsDirtyNotification: failed with ",""])),e).sendLogs("handleGroupsDirtyNotificationJob")}}),m.apply(this,arguments)}function p(e){return _.apply(this,arguments)}function _(){return _=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=yield o("WAWebPersistedJobManager").getJobManager().accessors.maybeCreateJob(o("WAWebPersistedJobDefinitions").jobSerializers.queryAndUpdateGroupsMetadataByJids(e));return t.id}),_.apply(this,arguments)}function f(e){return g.apply(this,arguments)}function g(){return g=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){return yield o("WAWebEventsWaitForOfflineDeliveryEnd").waitForOfflineDeliveryEnd(),yield o("WAComms").waitForConnection(),o("WAWebPersistedJobManager").getJobManager().loadAndRunJobFromId(e)}),g.apply(this,arguments)}l.handleGroupsDirtyNotificationJob=u}),98);
__d("WAWebHandleGroupNotification",["Promise","WADeprecatedWapParser","WALogger","WANullthrows","WAWap","WAWebABProps","WAWebApiParticipantStore","WAWebBackendApi","WAWebCommsWapMd","WAWebCountriesUtils","WAWebCurrentUser","WAWebDBGroupsGroupMetadata","WAWebEphemeralityTypes","WAWebEphemeralityUtils","WAWebGetMessageCache","WAWebGroupApiConst","WAWebGroupQueryJob","WAWebGroupSystemMsg","WAWebGroupType","WAWebGroupUtils","WAWebGroupsParticipantsApi","WAWebGroupsQueryApi","WAWebHandleGroupCreation","WAWebHandleGroupNotificationConst","WAWebHandleGroupNotificationV2","WAWebHandleGroupsDirtyNotification","WAWebHandleSingleMsg","WAWebJidToWid","WAWebLidMappingUsernameLearnUtils","WAWebMemberLabelGroupRemoveHandler","WAWebMessageQueue","WAWebOfflineHandler","WAWebRequestMethodType","WAWebSchemaChat","WAWebSchemaGroupMetadata","WAWebShouldTriggerQueryGroupInfo","WAWebUpdateDbForGroupActionApi","WAWebUserPrefsMeUser","WAWebUserPrefsNotifications","WAWebUsernameGatingUtils","asyncToGeneratorRuntime","cr:4533","gkx"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p,_,f,g,h,y,C,b,v,S,R,L,E,k,I,T,D,x;function $(e){if(e.hasChild("description")){var t=e.child("description");if(t.hasChild("body")){var n=t.child("body");if(n.hasContent())return{content:n.contentString(),id:t.attrString("id")}}}return null}function P(e,t){var n=e.hasAttr("creator")?o("WAWebJidToWid").userJidToUserWid(e.attrUserJid("creator")):null;if(e.hasChild("ephemeral")){var r=e.child("ephemeral");if(r.hasAttr("expiration")&&o("WAWebABProps").getABPropConfigValue("dm_initiator_trigger_groups")){var a,i=t?void 0:o("WAWebEphemeralityTypes").DisappearingModeTrigger.UnknownGroups;return{ephemeralDuration:r.attrInt("expiration"),disappearingModeTrigger:(a=o("WAWebEphemeralityUtils").getDisappearingModeTriggerString(r.maybeAttrString("trigger")))!=null?a:i,disappearingModeInitiatedByMe:o("WAWebUserPrefsMeUser").isMeAccount(n)}}return{ephemeralDuration:r.attrInt("expiration")}}return null}function N(e,t,n){return t.mapChildrenWithTag("participant",function(t){var r=t.attrEnumOrDefault("type",o("WAWebGroupApiConst").GROUP_PARTICIPANT_TYPES,"participant"),a=t.maybeAttrLidUserJid("lid"),i=t.maybeAttrPhoneUserJid("phone_number"),l={displayName:t.maybeAttrString("display_name"),id:o("WAWebJidToWid").userJidToUserWid(t.attrUserJid("jid")),isSuperAdmin:r===o("WAWebGroupApiConst").GROUP_PARTICIPANT_TYPES.superadmin,isAdmin:r===o("WAWebGroupApiConst").GROUP_PARTICIPANT_TYPES.admin||r===o("WAWebGroupApiConst").GROUP_PARTICIPANT_TYPES.superadmin,lid:a!=null?o("WAWebJidToWid").userJidToUserWid(a):null,phoneNumber:i!=null?o("WAWebJidToWid").userJidToUserWid(i):null,username:t.maybeAttrString("username")},s=n===o("WAWebHandleGroupNotificationConst").GROUP_NOTIFICATION_TAG.REMOVE;return s||M(e,l,n),l})}function M(t,n,r){try{var a=o("WAWebUsernameGatingUtils").usernameDisplayedEnabled()&&n.username!=null;!a&&n.displayName==null&&n.phoneNumber==null&&n.id.isLid()&&!o("WAWebUserPrefsMeUser").isMeAccount(n.id)&&(o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[lid group] incoming group notification does not have phone mapping for lid. tag: ",",\n            sw worker: ",""])),r,o("WAWebUserPrefsNotifications").getGlobalOfflineNotifications().toString()),o("WAWebCurrentUser").isEmployee()?(o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[lid group] group id=",", lid=",""])),t.toString(),n.id.toString()),o("WALogger").ERROR(u||(u=babelHelpers.taggedTemplateLiteralLoose(["[lid group] missing group mapping in parser for employee"]))).sendLogs("[lid group] missing group mapping in parser for employee")):o("WALogger").ERROR(c||(c=babelHelpers.taggedTemplateLiteralLoose(["[lid group] missing group mapping in action parser"]))).sendLogs("[lid group] missing group mapping in action parser"))}catch(e){o("WALogger").ERROR(d||(d=babelHelpers.taggedTemplateLiteralLoose(["[lid group] could not check missing group mapping in group action parser ",""])),e)}}function w(e){var t=e.child("sub_group_suggestion"),n=o("WAWebJidToWid").groupJidToWid(t.attrGroupJid("jid")),r=o("WAWebJidToWid").userJidToUserWid(t.attrUserJid("creator")),a=t.attrTime("creation"),i=t.child("subject"),l=i.contentString(),s,u,c;if(t.hasChild("description")){var d=t.child("description");if(d.hasChild("body")){var m=d.child("body");m.hasContent()&&(s=m.contentString())}}if(t.hasChild("is_existing_group")){var p=t.child("is_existing_group");p.hasContent()&&(u=p.contentString()==="true")}if(t.hasChild("participant_count")){var _=t.child("participant_count");_.hasContent()&&(c=_.contentInt())}return{id:n,owner:r,subject:l,description:s,t:a,isExistingGroup:u!=null?u:!1,participantCount:c}}var A={invite:(x=o("WAWebGroupType")).ADD_REASON.INVITE,linked_group_join:x.ADD_REASON.LINKED_GROUP_JOIN,auto_add:x.ADD_REASON.AUTO_ADD,default_sub_group_admin_add:x.ADD_REASON.DEFAULT_SUBGROUP_ADMIN_ADD,default_sub_group_promote:x.ADD_REASON.DEFAULT_SUBGROUP_PROMOTE,invite_auto_add:x.ADD_REASON.INVITE_AUTO_ADD,general_chat_auto_add:x.ADD_REASON.GENERAL_CHAT_AUTO_ADD};function F(e){return e==="invite"?o("WAWebGroupType").ADD_REASON.INVITE:e==="linked_group_join"?o("WAWebGroupType").ADD_REASON.LINKED_GROUP_JOIN:e==="auto_add"?o("WAWebGroupType").ADD_REASON.AUTO_ADD:e==="default_sub_group_admin_add"?o("WAWebGroupType").ADD_REASON.DEFAULT_SUBGROUP_ADMIN_ADD:e==="default_sub_group_promote"?o("WAWebGroupType").ADD_REASON.DEFAULT_SUBGROUP_PROMOTE:e==="invite_auto_add"?o("WAWebGroupType").ADD_REASON.INVITE_AUTO_ADD:e==="general_chat_auto_add"?o("WAWebGroupType").ADD_REASON.GENERAL_CHAT_AUTO_ADD:null}function O(e){return e==="default_sub_group_demote"?o("WAWebGroupType").REMOVE_REASON.DEFAULT_SUBGROUP_DEMOTE:null}function B(e){return e==="integrity_delete_parent"?o("WAWebGroupType").DELETE_REASON.INTEGRITY_DELETE_PARENT:e==="delete_parent"?o("WAWebGroupType").DELETE_REASON.DELETE_PARENT:null}var W={invite_link:o("WAWebRequestMethodType").RequestMethod.InviteLink,linked_group_join:o("WAWebRequestMethodType").RequestMethod.LinkedGroupJoin,non_admin_add:o("WAWebRequestMethodType").RequestMethod.NonAdminAdd},q={approved:x.RevokedSubGroupSuggestionReason.APPROVED,rejected:x.RevokedSubGroupSuggestionReason.REJECTED,cancelled:x.RevokedSubGroupSuggestionReason.CANCELLED};function U(e,t,n){var r,a,i,l=t.child("group"),s=t.hasAttr("type")&&t.attrString("type")==="new",u=N(e,l,o("WAWebHandleGroupNotificationConst").GROUP_NOTIFICATION_TAG.CREATE),c=$(l),d=P(l,s),m=o("WAWebGroupsQueryApi").extractLinkedParent(l),p=o("WAWebUsernameGatingUtils").usernameDisplayedEnabled(),_={subject:l.attrString("subject"),restrict:l.hasChild("locked"),announce:l.hasChild("announcement"),noFrequentlyForwarded:l.hasChild("no_frequently_forwarded"),ephemeralDuration:d?d.ephemeralDuration:void 0,disappearingModeTrigger:d&&d.disappearingModeTrigger!=null?d.disappearingModeTrigger:void 0,disappearingModeInitiatedByMe:d?d.disappearingModeInitiatedByMe:void 0,owner:l.hasAttr("creator")?o("WAWebJidToWid").userJidToUserWid(l.attrUserJid("creator")):void 0,creatorPn:l.hasAttr("creator_pn")?o("WAWebJidToWid").userJidToUserWid(l.attrUserJid("creator_pn")):null,creatorCountryCode:p&&l.hasAttr("creator_country_code")?o("WAWebCountriesUtils").asISOCountryCode(l.attrString("creator_country_code")):null,creatorUsername:p&&l.hasAttr("creator_username")?l.attrString("creator_username"):null,creation:l.attrTime("creation"),participants:u,desc:c?c.content:void 0,descId:c?c.id:void 0,subjectOwner:l.hasAttr("s_o")?o("WAWebJidToWid").userJidToUserWid(l.attrUserJid("s_o")):void 0,subjectOwnerPn:l.hasAttr("s_o_pn")?o("WAWebJidToWid").userJidToUserWid(l.attrUserJid("s_o_pn")):void 0,subjectOwnerUsername:p&&l.hasAttr("s_o_username")?l.attrString("s_o_username"):void 0,subjectTime:l.hasAttr("s_t")?l.attrTime("s_t"):void 0,support:l.hasChild("support"),isParentGroup:l.hasChild("parent"),isParentGroupClosed:((r=l.maybeChild("parent"))==null?void 0:r.maybeAttrString("default_membership_approval_mode"))==="request_required",parentGroup:m?m.parentGroup:void 0,defaultSubgroup:l.hasChild("default_sub_group"),generalSubgroup:l.hasChild("general_chat"),size:l.hasAttr("size")?l.attrInt("size"):void 0,incognito:l.hasChild("incognito"),membershipApprovalMode:(l==null||(a=l.maybeChild("membership_approval_mode"))==null||(a=a.maybeChild("group_join"))==null?void 0:a.maybeAttrString("state"))==="on",allowNonAdminSubGroupCreation:l==null?void 0:l.hasChild("allow_non_admin_sub_group_creation"),generalChatAutoAddDisabled:(i=t.hasChild("auto_add_disabled"))!=null?i:void 0,hiddenSubgroup:l==null?void 0:l.hasChild("hidden_group"),groupSafetyCheck:l==null?void 0:l.hasChild("group_safety_check"),groupAdder:n||void 0,hasCapi:l==null?void 0:l.hasChild("capi"),limitSharingEnabled:l.hasChild("limit_sharing_enabled")};return{actionType:o("WAWebHandleGroupNotificationConst").GROUP_NOTIFICATION_TAG.CREATE,reason:t.hasAttr("reason")?t.attrEnumOrNullIfUnknown("reason",A):null,contextGroupId:t.hasAttr("context_group_jid")?o("WAWebJidToWid").groupJidToWid(t.attrGroupJid("context_group_jid")):null,groupInfo:_}}var V=new(r("WADeprecatedWapParser"))("groupNotificationParser",function(e){e.assertTag("notification"),e.hasAttr("to")&&e.assertAttr("to",o("WAWebUserPrefsMeUser").getMeDevicePnOrThrow().toJid());var t=o("WAWebJidToWid").groupJidToWid(e.attrGroupJid("from")),n=e.hasAttr("participant")?o("WAWebJidToWid").userJidToUserWid(e.attrUserJid("participant")):null,a=null;try{var i=e.maybeAttrPhoneUserJid("participant_pn");a=i!=null?o("WAWebJidToWid").userJidToUserWid(i):null}catch(e){o("WALogger").ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["Known error T150827746: ",""])),e.toString())}var l=o("WAWebUsernameGatingUtils").usernameDisplayedEnabled(),s=e.attrTime("t"),u=e.hasAttr("addressing_mode")?e.attrString("addressing_mode")==="lid":!1,c=e.hasAttr("participant_username")&&l?e.attrString("participant_username"):null,d=e.hasAttr("participant_country_code")&&l?o("WAWebCountriesUtils").asISOCountryCode(e.attrString("participant_country_code")):null;function p(e){return{jid:e.hasAttr("jid")?o("WAWebJidToWid").groupJidToWid(e.attrGroupJid("jid")):void 0}}var _,f=e.mapChildren(function(a){var i,c=a.tag();switch(c){case o("WAWebHandleGroupNotificationConst").GROUP_NOTIFICATION_TAG.CREATE:return U(t,a,n);case o("WAWebHandleGroupNotificationConst").GROUP_NOTIFICATION_TAG.ADD:return{actionType:o("WAWebGroupType").GROUP_ACTIONS.ADD,participants:N(t,a,c),reason:a.hasAttr("reason")?F(a.attrString("reason")):null,isLidAddressingMode:u};case o("WAWebHandleGroupNotificationConst").GROUP_NOTIFICATION_TAG.DELETE:return{actionType:o("WAWebGroupType").GROUP_ACTIONS.DELETE,reason:a.hasAttr("reason")?B(a.attrString("reason")):null,groupDatas:[{id:t,subject:""}]};case o("WAWebHandleGroupNotificationConst").GROUP_NOTIFICATION_TAG.REMOVE:return{actionType:o("WAWebHandleGroupNotificationConst").GROUP_NOTIFICATION_TAG.REMOVE,participants:N(t,a,c),reason:a.hasAttr("reason")?O(a.attrString("reason")):null,isLidAddressingMode:u};case o("WAWebHandleGroupNotificationConst").GROUP_NOTIFICATION_TAG.PROMOTE:return{actionType:o("WAWebHandleGroupNotificationConst").GROUP_NOTIFICATION_TAG.PROMOTE,participants:N(t,a,c)};case o("WAWebHandleGroupNotificationConst").GROUP_NOTIFICATION_TAG.DEMOTE:return{actionType:o("WAWebHandleGroupNotificationConst").GROUP_NOTIFICATION_TAG.DEMOTE,participants:N(t,a,c)};case o("WAWebHandleGroupNotificationConst").GROUP_NOTIFICATION_TAG.LINKED_GROUP_PROMOTE:return babelHelpers.extends({actionType:o("WAWebHandleGroupNotificationConst").GROUP_NOTIFICATION_TAG.LINKED_GROUP_PROMOTE,participants:N(t,a,c)},p(a));case o("WAWebHandleGroupNotificationConst").GROUP_NOTIFICATION_TAG.LINKED_GROUP_DEMOTE:return babelHelpers.extends({actionType:o("WAWebHandleGroupNotificationConst").GROUP_NOTIFICATION_TAG.LINKED_GROUP_DEMOTE,participants:N(t,a,c)},p(a));case o("WAWebHandleGroupNotificationConst").GROUP_NOTIFICATION_TAG.MODIFY:return{actionType:o("WAWebGroupType").GROUP_ACTIONS.MODIFY,participants:N(t,a,c)};case o("WAWebHandleGroupNotificationConst").GROUP_NOTIFICATION_TAG.SUBJECT:return{actionType:o("WAWebGroupType").GROUP_ACTIONS.SUBJECT,subject:a.attrString("subject"),s_o:a.hasAttr("s_o")?o("WAWebJidToWid").userJidToUserWid(a.attrUserJid("s_o")):null,subjectOwnerPn:a.hasAttr("s_o_pn")?o("WAWebJidToWid").userJidToUserWid(a.attrUserJid("s_o_pn")):null,subjectOwnerUsername:a.hasAttr("s_o_username")?a.attrString("s_o_username"):null,s_t:a.hasAttr("s_t")?a.attrTime("s_t"):null};case o("WAWebHandleGroupNotificationConst").GROUP_NOTIFICATION_TAG.DESC:return a.hasChild("delete")?{actionType:o("WAWebGroupType").GROUP_ACTIONS.DESC_REMOVE,descId:a.attrString("id")}:{actionType:o("WAWebGroupType").GROUP_ACTIONS.DESC_ADD,descId:a.attrString("id"),desc:a.hasChild("body")?a.child("body").contentString():null,descTime:s};case o("WAWebHandleGroupNotificationConst").GROUP_NOTIFICATION_TAG.SUSPENDED:return{actionType:o("WAWebGroupType").GROUP_ACTIONS.SUSPEND,value:!0};case o("WAWebHandleGroupNotificationConst").GROUP_NOTIFICATION_TAG.UNSUSPENDED:return{actionType:o("WAWebGroupType").GROUP_ACTIONS.SUSPEND,value:!1};case o("WAWebHandleGroupNotificationConst").GROUP_NOTIFICATION_TAG.LOCKED:return{actionType:o("WAWebGroupType").GROUP_ACTIONS.RESTRICT,value:!0,threshold:(i=a.maybeAttrString("threshold"))!=null?i:void 0};case o("WAWebHandleGroupNotificationConst").GROUP_NOTIFICATION_TAG.UNLOCKED:return{actionType:o("WAWebGroupType").GROUP_ACTIONS.RESTRICT,value:!1};case o("WAWebHandleGroupNotificationConst").GROUP_NOTIFICATION_TAG.ANNOUNCE:return{actionType:o("WAWebGroupType").GROUP_ACTIONS.ANNOUNCE,value:!0};case o("WAWebHandleGroupNotificationConst").GROUP_NOTIFICATION_TAG.NOT_ANNOUNCE:return{actionType:o("WAWebGroupType").GROUP_ACTIONS.ANNOUNCE,value:!1};case o("WAWebHandleGroupNotificationConst").GROUP_NOTIFICATION_TAG.NO_FREQUENTLY_FORWARDED:return{actionType:o("WAWebGroupType").GROUP_ACTIONS.NO_FORWARD,value:!0};case o("WAWebHandleGroupNotificationConst").GROUP_NOTIFICATION_TAG.FREQUENTLY_FORWARDED_OK:return{actionType:o("WAWebGroupType").GROUP_ACTIONS.NO_FORWARD,value:!1};case o("WAWebHandleGroupNotificationConst").GROUP_NOTIFICATION_TAG.INVITE:return{actionType:o("WAWebGroupType").GROUP_ACTIONS.INVITE_CODE,code:a.attrString("code")};case o("WAWebHandleGroupNotificationConst").GROUP_NOTIFICATION_TAG.EPHEMERAL:return o("WAWebABProps").getABPropConfigValue("dm_initiator_trigger_groups")?{actionType:o("WAWebGroupType").GROUP_ACTIONS.EPHEMERAL,duration:a.attrInt("expiration"),trigger:a.hasAttr("trigger")?a.attrInt("trigger"):void 0,initiatedByMe:o("WAWebUserPrefsMeUser").isMeAccount(n)}:{actionType:o("WAWebGroupType").GROUP_ACTIONS.EPHEMERAL,duration:a.attrInt("expiration")};case o("WAWebHandleGroupNotificationConst").GROUP_NOTIFICATION_TAG.NOT_EPHEMERAL:return{actionType:o("WAWebGroupType").GROUP_ACTIONS.EPHEMERAL,duration:0};case o("WAWebHandleGroupNotificationConst").GROUP_NOTIFICATION_TAG.REVOKE_INVITE:return{actionType:o("WAWebGroupType").GROUP_ACTIONS.REVOKE_INVITE,participants:a.mapChildrenWithTag("participant",function(e){return{id:o("WAWebJidToWid").userJidToUserWid(e.attrUserJid("jid")),expiration:e.attrInt("expiration")}})};case o("WAWebHandleGroupNotificationConst").GROUP_NOTIFICATION_TAG.GROWTH_UNLOCKED:return{actionType:o("WAWebGroupType").GROUP_ACTIONS.GROWTH_UNLOCKED};case o("WAWebHandleGroupNotificationConst").GROUP_NOTIFICATION_TAG.GROWTH_LOCKED:return{actionType:o("WAWebGroupType").GROUP_ACTIONS.GROWTH_LOCKED,expiration:a.attrInt("expiration"),type:a.attrString("type")};case o("WAWebHandleGroupNotificationConst").GROUP_NOTIFICATION_TAG.LINK:{var d=a.attrString("link_type"),m={sub_group:o("WAWebGroupType").GROUP_ACTIONS.SUB_GROUP_LINK,parent_group:o("WAWebGroupType").GROUP_ACTIONS.PARENT_GROUP_LINK,sibling_group:o("WAWebGroupType").GROUP_ACTIONS.SIBLING_GROUP_LINK};return{actionType:m[d],groupDatas:a.mapChildrenWithTag("group",function(e){return{id:o("WAWebJidToWid").groupJidToWid(e.attrGroupJid("jid")),subject:e.attrString("subject"),subjectTime:e.attrInt("s_t"),hiddenSubgroup:d!=="parent_group"?e.hasChild("hidden_group"):void 0}})}}case o("WAWebHandleGroupNotificationConst").GROUP_NOTIFICATION_TAG.UNLINK:{var f=a.attrString("unlink_type"),g=a.hasAttr("unlink_reason")?a.attrString("unlink_reason"):null,h=a.mapChildrenWithTag("group",function(e){return{id:o("WAWebJidToWid").groupJidToWid(e.attrGroupJid("jid")),subject:e.attrString("subject"),subjectTime:e.attrInt("s_t")}});if(f==="parent_group"){if(g===o("WAWebGroupType").DELETE_REASON.DELETE_PARENT)return{actionType:o("WAWebGroupType").GROUP_ACTIONS.DELETE_PARENT_GROUP_UNLINK,groupDatas:h};if(g===o("WAWebGroupType").DELETE_REASON.INTEGRITY_DELETE_PARENT)return{actionType:o("WAWebGroupType").GROUP_ACTIONS.INTEGRITY_PARENT_GROUP_UNLINK,groupDatas:h}}else if(f==="sub_group"){if(g===o("WAWebGroupType").DELETE_REASON.DELETE_PARENT)return{actionType:o("WAWebGroupType").GROUP_ACTIONS.DELETE_PARENT_GROUP_UNLINK,groupDatas:h};if(g===o("WAWebGroupType").DELETE_REASON.INTEGRITY_DELETE_PARENT)return{actionType:o("WAWebGroupType").GROUP_ACTIONS.INTEGRITY_SUB_GROUP_UNLINK,groupDatas:h}}var y={sub_group:o("WAWebGroupType").GROUP_ACTIONS.SUB_GROUP_UNLINK,parent_group:o("WAWebGroupType").GROUP_ACTIONS.PARENT_GROUP_UNLINK,sibling_group:o("WAWebGroupType").GROUP_ACTIONS.SIBLING_GROUP_UNLINK};return{actionType:y[f],groupDatas:h}}case o("WAWebHandleGroupNotificationConst").GROUP_NOTIFICATION_TAG.MEMBERSHIP_APPROVAL_MODE:{var C;return{actionType:o("WAWebGroupType").GROUP_ACTIONS.MEMBERSHIP_APPROVAL_MODE,value:((C=a.child("group_join"))==null?void 0:C.attrString("state"))==="on",triggered:a.hasAttr("triggered")?a.attrString("triggered"):void 0}}case o("WAWebHandleGroupNotificationConst").GROUP_NOTIFICATION_TAG.MEMBERSHIP_APPROVAL_REQUEST:{var b;return{actionType:o("WAWebGroupType").GROUP_ACTIONS.MEMBERSHIP_APPROVAL_REQUEST,requestMethod:(b=W[a.attrString("request_method")])!=null?b:o("WAWebRequestMethodType").RequestMethod.InviteLink,parentGroupId:a.hasAttr("parent_group_jid")?o("WAWebJidToWid").groupJidToWid(a.attrGroupJid("parent_group_jid")):void 0}}case o("WAWebHandleGroupNotificationConst").GROUP_NOTIFICATION_TAG.ALLOW_ADMIN_REPORTS:return{actionType:o("WAWebGroupType").GROUP_ACTIONS.ALLOW_ADMIN_REPORTS,shouldSkipGenMsg:!o("WAWebABProps").getABPropConfigValue("report_to_admin_kill_switch"),value:!0,author:n,triggered:a.hasAttr("triggered")?a.attrString("triggered"):void 0};case o("WAWebHandleGroupNotificationConst").GROUP_NOTIFICATION_TAG.NOT_ALLOW_ADMIN_REPORTS:return{actionType:o("WAWebGroupType").GROUP_ACTIONS.ALLOW_ADMIN_REPORTS,shouldSkipGenMsg:!o("WAWebABProps").getABPropConfigValue("report_to_admin_kill_switch"),value:!1,author:n,triggered:a.hasAttr("triggered")?a.attrString("triggered"):void 0};case o("WAWebHandleGroupNotificationConst").GROUP_NOTIFICATION_TAG.REPORTS:return{actionType:o("WAWebGroupType").GROUP_ACTIONS.ADMIN_REPORT_RECIEVED,shouldSkipGenMsg:!0,value:s};case o("WAWebHandleGroupNotificationConst").GROUP_NOTIFICATION_TAG.CREATED_MEMBERSHIP_REQUESTS:{var v;return{actionType:o("WAWebGroupType").GROUP_ACTIONS.CREATED_MEMBERSHIP_REQUESTS,requestMethod:(v=W[a.attrString("request_method")])!=null?v:o("WAWebRequestMethodType").RequestMethod.InviteLink,parentGroupId:a.hasAttr("parent_group_jid")?o("WAWebJidToWid").groupJidToWid(a.attrGroupJid("parent_group_jid")):void 0,requests:a.hasChildren()?a.mapChildrenWithTag("requested_user",function(e){return{wid:o("WAWebJidToWid").userJidToUserWid(e.attrUserJid("jid")),username:l&&e.hasAttr("username")?e.attrString("username"):void 0,phoneNumber:e.hasAttr("phone_number")?o("WAWebJidToWid").userJidToUserWid(e.attrUserJid("phone_number")):void 0}}):[{wid:r("WANullthrows")(n)}],skipGenMsg:a.maybeAttrString("suppress_sys_msg")==="true"}}case o("WAWebHandleGroupNotificationConst").GROUP_NOTIFICATION_TAG.REVOKED_MEMBERSHIP_REQUESTS:return{actionType:o("WAWebGroupType").GROUP_ACTIONS.REVOKED_MEMBERSHIP_REQUESTS,requests:a.mapChildrenWithTag("participant",function(e){return o("WAWebJidToWid").userJidToUserWid(e.attrUserJid("jid"))})};case o("WAWebHandleGroupNotificationConst").GROUP_NOTIFICATION_TAG.ALLOW_NON_ADMIN_SUB_GROUP_CREATION:return{actionType:o("WAWebGroupType").GROUP_ACTIONS.ALLOW_NON_ADMIN_SUB_GROUP_CREATION,value:!0};case o("WAWebHandleGroupNotificationConst").GROUP_NOTIFICATION_TAG.NOT_ALLOW_NON_ADMIN_SUB_GROUP_CREATION:return{actionType:o("WAWebGroupType").GROUP_ACTIONS.ALLOW_NON_ADMIN_SUB_GROUP_CREATION,value:!1};case o("WAWebHandleGroupNotificationConst").GROUP_NOTIFICATION_TAG.CREATED_SUBGROUP_SUGGESTION:return babelHelpers.extends({actionType:o("WAWebGroupType").GROUP_ACTIONS.CREATED_SUBGROUP_SUGGESTION,parentGroupId:t},w(a));case o("WAWebHandleGroupNotificationConst").GROUP_NOTIFICATION_TAG.REVOKED_SUB_GROUP_SUGGESTIONS:return{actionType:o("WAWebGroupType").GROUP_ACTIONS.REVOKED_SUB_GROUP_SUGGESTIONS,parentGroupId:t,subgroupSuggestions:a.mapChildrenWithTag("sub_group_suggestion",function(e){return{id:o("WAWebJidToWid").groupJidToWid(e.attrGroupJid("jid")),owner:o("WAWebJidToWid").userJidToUserWid(e.attrUserJid("creator")),reason:e.hasAttr("reason")?q[e.attrString("reason")]:void 0}})};case o("WAWebHandleGroupNotificationConst").GROUP_NOTIFICATION_TAG.CHANGE_NUMBER:return{actionType:o("WAWebGroupType").GROUP_ACTIONS.SUBGROUP_SUGGESTIONS_CHANGE_NUMBER,subgroupSuggestions:a.mapChildrenWithTag("sub_group_suggestion",function(e){return o("WAWebJidToWid").groupJidToWid(e.attrGroupJid("jid"))}),parentGroupId:t,oldOwner:o("WAWebJidToWid").userJidToUserWid(e.attrUserJid("participant")),newOwner:o("WAWebJidToWid").userJidToUserWid(a.attrUserJid("jid"))};case o("WAWebHandleGroupNotificationConst").GROUP_NOTIFICATION_TAG.MEMBER_ADD_MODE:return{actionType:o("WAWebGroupType").GROUP_ACTIONS.MEMBER_ADD_MODE,memberAddMode:o("WAWebSchemaGroupMetadata").MemberAddMode.cast(a.contentString())};case o("WAWebHandleGroupNotificationConst").GROUP_NOTIFICATION_TAG.AUTO_ADD_DISABLED:return{actionType:o("WAWebGroupType").GROUP_ACTIONS.GENERAL_CHAT_AUTO_ADD_DISABLED};case o("WAWebHandleGroupNotificationConst").GROUP_NOTIFICATION_TAG.GROUP_SAFETY_CHECK:return{actionType:o("WAWebGroupType").GROUP_ACTIONS.GROUP_SAFETY_CHECK,value:!0};case o("WAWebHandleGroupNotificationConst").GROUP_NOTIFICATION_TAG.MISSING_PARTICIPANT_IDENTIFICATION:{_=!0;return}default:throw e.createParseError("Unrecognized group action "+c)}}).filter(Boolean);return{externalId:e.attrString("id"),chatId:t,isLidAddressingMode:u,author:n,authorPhoneNumber:a,authorUsername:c,authorUsernameCountryCode:d,ts:e.attrTime("t"),pushname:e.hasAttr("notify")?e.attrString("notify"):null,offline:e.hasAttr("offline")?e.attrString("offline"):null,actions:f,hasIncompleteParticipantInformation:l&&_===!0}});function H(e){return G.apply(this,arguments)}function G(){return G=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=yield(D||(D=n("Promise"))).all([o("WAWebDBGroupsGroupMetadata").getGroupMetadata(e),o("WAWebSchemaChat").getChatTable().get(e.toString(),!1)]),r=t[0],a=t[1];return!!r||!!a&&!!a.t}),G.apply(this,arguments)}function z(e){return j.apply(this,arguments)}function j(){return j=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e.meta,n=e.action,r=e.actionShouldBeHiddenFromNonAdmins,a=(yield o("WAWebHandleGroupNotificationConst").getIsCagById(t.chatId))===!0;if(a&&r){var i=yield o("WAWebGroupsParticipantsApi").getParticipants(t.chatId),l=i?o("WAWebGroupUtils").amIGroupAdmin(i.admins):!1;return l?n.participants:[]}return n.participants}),j.apply(this,arguments)}function K(e,t,n){return Q.apply(this,arguments)}function Q(){return Q=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,a){if(a===void 0&&(a=!1),!!t){o("WALogger").LOG(f||(f=babelHelpers.taggedTemplateLiteralLoose(["handle action ",""])),t.actionType).tags("groups");var i=[];try{if(yield o("WAWebLidMappingUsernameLearnUtils").processParsedGroupNotificationForLidMappingAndUsernames({notification:e,flushImmediately:!a}),t.actionType===o("WAWebGroupType").GROUP_ACTIONS.REMOVE&&(yield o("WAWebMemberLabelGroupRemoveHandler").handleMemberLabelUpdatesOnGroupParticipantRemoval(e,t)),t.actionType===o("WAWebHandleGroupNotificationConst").GROUP_NOTIFICATION_TAG.CREATE){var l=babelHelpers.extends({},t.groupInfo,{id:e.chatId,isLidAddressingMode:e.isLidAddressingMode}),s=Z(e,t,l),u=yield H(l.id);o("WALogger").LOG(g||(g=babelHelpers.taggedTemplateLiteralLoose(["group id "," exists in storage = ",""])),l.id,u).tags("groups"),yield Y(e,l,a,s,t.reason==="invite"),o("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["handleGroupCreation done for group id ",""])),l.id).tags("groups");var c=yield o("WAWebGroupSystemMsg").genMsgsForGroupCreation(e,l,u,s);i.push.apply(i,c)}else if(t.actionType===o("WAWebGroupType").GROUP_ACTIONS.ADD){if(!r("gkx")("26258")){var d,m=(d=n("cr:4533")==null?void 0:n("cr:4533").getDebugIgnoreParticipantAdd())!=null?d:0;if(m>0){o("WALogger").DEV(y||(y=babelHelpers.taggedTemplateLiteralLoose(["handleGroupNotification debug: ignoring participant add for "," times"])),m),n("cr:4533")==null||n("cr:4533").setDebugIgnoreParticipantAdd(m-1);return}}var p=yield o("WAWebHandleGroupNotificationConst").notAlreadyInGroup(e.chatId,t.participants),_=yield o("WAWebShouldTriggerQueryGroupInfo").shouldTriggerQueryGroupInfo({groupWid:e.chatId,action:t});if(_?yield o("WAWebGroupQueryJob").queryAndUpdateGroupMetadataById({id:e.chatId,actionType:o("WAWebGroupType").GROUP_ACTIONS.ADD}):(yield o("WAWebUpdateDbForGroupActionApi").updateDBForGroupAction(e,t,a),X(e,t),o("WALogger").DEV(C||(C=babelHelpers.taggedTemplateLiteralLoose(["updateDBForGroupAction done for ",""])),JSON.stringify(t)).tags("groups")),p.length||t.reason){var x=yield z({meta:e,action:t,actionShouldBeHiddenFromNonAdmins:!0});x.length>0&&(o("WALogger").LOG(b||(b=babelHelpers.taggedTemplateLiteralLoose(["[system message] eligible participants = "," - ADD"])),x.length),i.push(yield o("WAWebGroupSystemMsg").genGroupNotificationMsg({meta:e,action:babelHelpers.extends({},t,{participants:x})})))}}else if(!(t.actionType===o("WAWebGroupType").GROUP_ACTIONS.INTEGRITY_PARENT_GROUP_UNLINK||t.actionType===o("WAWebGroupType").GROUP_ACTIONS.INTEGRITY_SUB_GROUP_UNLINK)){if(!(t.actionType===o("WAWebGroupType").GROUP_ACTIONS.DELETE_PARENT_GROUP_UNLINK||t.actionType===o("WAWebGroupType").GROUP_ACTIONS.DELETE_PARENT_SUB_GROUP_UNLINK))if(t.actionType===o("WAWebGroupType").GROUP_ACTIONS.DELETE&&t.reason===o("WAWebGroupType").DELETE_REASON.INTEGRITY_DELETE_PARENT){var $=yield o("WAWebGroupSystemMsg").genIntegrityDeleteParentNotificationMsgs(e,t);$.forEach(function(e){i.push(e)}),yield o("WAWebUpdateDbForGroupActionApi").updateDBForGroupAction(e,t,a),X(e,t),o("WALogger").DEV(v||(v=babelHelpers.taggedTemplateLiteralLoose(["updateDBForGroupAction done for ",""])),JSON.stringify(t)).tags("groups")}else if(t.actionType===o("WAWebGroupType").GROUP_ACTIONS.DESC_ADD||t.actionType===o("WAWebGroupType").GROUP_ACTIONS.DESC_REMOVE)i.push(yield o("WAWebGroupSystemMsg").genDescriptionNotificationMsg(e,t)),yield o("WAWebUpdateDbForGroupActionApi").updateDBForGroupAction(e,t,a),X(e,t),o("WALogger").DEV(S||(S=babelHelpers.taggedTemplateLiteralLoose(["updateDBForGroupAction done for ",""])),JSON.stringify(t)).tags("groups");else if(t.actionType===o("WAWebGroupType").GROUP_ACTIONS.DELETE&&t.reason===o("WAWebGroupType").DELETE_REASON.DELETE_PARENT){var P=yield o("WAWebGroupSystemMsg").generateDeleteParentNotificationMessages(e);if(P.length===0)return;P.forEach(function(e){i.push(e)}),yield o("WAWebUpdateDbForGroupActionApi").updateDBForGroupAction(e,t,a),X(e,t),o("WALogger").DEV(R||(R=babelHelpers.taggedTemplateLiteralLoose(["updateDBForGroupAction done for ",""])),JSON.stringify(t)).tags("groups")}else{var N=!1;if(t.actionType===o("WAWebGroupType").GROUP_ACTIONS.REMOVE){var M=yield o("WAWebShouldTriggerQueryGroupInfo").shouldTriggerQueryGroupInfo({groupWid:e.chatId,action:t,disableForCAGs:!0});M&&(N=!0,o("WAWebGroupQueryJob").queryAndUpdateGroupMetadataById({id:e.chatId,actionType:o("WAWebGroupType").GROUP_ACTIONS.REMOVE}))}if(!N){var w=yield o("WAWebHandleGroupNotificationConst").shouldSkipGenMsg(e,t);if(yield o("WAWebUpdateDbForGroupActionApi").updateDBForGroupAction(e,t,a),X(e,t),o("WALogger").DEV(L||(L=babelHelpers.taggedTemplateLiteralLoose(["updateDBForGroupAction done for ",""])),JSON.stringify(t)).tags("groups"),!w){var A=yield o("WAWebApiParticipantStore").isCurrentUserGroupAdmin(e.chatId.toString());if(t.actionType===o("WAWebGroupType").GROUP_ACTIONS.REMOVE){var F=yield z({meta:e,action:t,actionShouldBeHiddenFromNonAdmins:!0});F.length>0&&(o("WALogger").LOG(E||(E=babelHelpers.taggedTemplateLiteralLoose(["[system message] eligible participants = "," - REMOVE"])),F.length),i.push(yield o("WAWebGroupSystemMsg").genGroupNotificationMsg({meta:babelHelpers.extends({},e,{isAdmin:A}),action:babelHelpers.extends({},t,{participants:F})})))}else if(t.actionType===o("WAWebGroupType").GROUP_ACTIONS.CREATED_SUBGROUP_SUGGESTION){var O=yield o("WAWebGroupSystemMsg").genCreatedSubgroupSuggestionNotificationMsg(e,t);O&&i.push(O)}else if(t.actionType===o("WAWebGroupType").GROUP_ACTIONS.PROMOTE||t.actionType===o("WAWebGroupType").GROUP_ACTIONS.DEMOTE||t.actionType===o("WAWebGroupType").GROUP_ACTIONS.MODIFY||t.actionType===o("WAWebGroupType").GROUP_ACTIONS.LINKED_GROUP_PROMOTE||t.actionType===o("WAWebGroupType").GROUP_ACTIONS.LINKED_GROUP_DEMOTE){var B=t.actionType===o("WAWebGroupType").GROUP_ACTIONS.DEMOTE||t.actionType===o("WAWebGroupType").GROUP_ACTIONS.LINKED_GROUP_DEMOTE,W=yield z({meta:e,action:t,actionShouldBeHiddenFromNonAdmins:B});W.length>0&&(o("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["[system message] eligible participants = "," - actionType = ",""])),W.length,t.actionType),i.push(yield o("WAWebGroupSystemMsg").genGroupNotificationMsg({meta:babelHelpers.extends({},e,{isAdmin:A}),action:babelHelpers.extends({},t,{participants:W})})))}else if(t.actionType===o("WAWebGroupType").GROUP_ACTIONS.ALLOW_NON_ADMIN_SUB_GROUP_CREATION){var q=yield o("WAWebGroupSystemMsg").genAllowNonAdminSubGroupCreationNotificationMsg(e,t);q&&i.push(q)}else if(t.actionType===o("WAWebGroupType").GROUP_ACTIONS.COMMUNITY_OWNER_UPDATE){var U=yield o("WAWebGroupSystemMsg").genCommunityOwnerUpdateNotificationMsg(e,t);U&&i.push(U)}else o("WALogger").LOG(I||(I=babelHelpers.taggedTemplateLiteralLoose(["[system message] another action => ",""])),t.actionType),i.push(yield o("WAWebGroupSystemMsg").genGroupNotificationMsg({meta:babelHelpers.extends({},e,{isAdmin:A}),action:t}))}}}}a?o("WAWebGetMessageCache").getMessageCache().addMessages(i.map(function(e){return{msg:e}}),!1):yield(D||(D=n("Promise"))).all(i.map(function(e){return o("WAWebHandleSingleMsg").handleSingleMsg({chatId:e.from,newMsg:e,handleSingleMsgOrigin:"handleGroupNotification"})}))}catch(e){o("WALogger").LOG(T||(T=babelHelpers.taggedTemplateLiteralLoose(["handleGroupNotification: failed with ",""])),e)}}}),Q.apply(this,arguments)}function X(e,t){return o("WAWebBackendApi").frontendSendAndReceive("updateModelForGroupAction",{groupMeta:e,groupAction:t})}function Y(e,t,n,r,o){return J.apply(this,arguments)}function J(){return J=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n,r,a){n===void 0&&(n=!1),a===void 0&&(a=!1),yield o("WAWebHandleGroupCreation").handleGroupCreation(e,t,n,a),r!=null&&(yield o("WAWebUpdateDbForGroupActionApi").updateDBForGroupAction(e,r,n),X(e,r))}),J.apply(this,arguments)}function Z(e,t,n){var r=n.defaultSubgroup===!0&&n.incognito===!0||n.isLidAddressingMode===!0?o("WAWebUserPrefsMeUser").getMeLidUserOrThrow():o("WAWebUserPrefsMeUser").getMePnUserOrThrow();if((!o("WAWebUserPrefsMeUser").isMeAccount(e.author)||t.reason===o("WAWebGroupType").ADD_REASON.INVITE_AUTO_ADD)&&r!=null){var a=o("WAWebGroupUtils").amIGroupAdminGivenParticipants(n.participants);return{actionType:o("WAWebGroupType").GROUP_ACTIONS.ADD,participants:[{id:r,isAdmin:a,isSuperAdmin:!1}],reason:t.reason,parentGroupId:n.parentGroup,isParentGroup:n.isParentGroup,contextGroupId:t.contextGroupId,groupName:n.subject,defaultSubgroup:n.defaultSubgroup,generalSubgroup:n.generalSubgroup,hiddenSubgroup:n.hiddenSubgroup}}}function ee(e){var t=e.content;if(t!=null&&Array.isArray(t)&&t.length>0){var r=t[0],a=r.tag;if(a==="groups_dirty")return(D||(D=n("Promise"))).resolve(o("WAWebHandleGroupsDirtyNotification").handleGroupsDirtyNotificationJob(e))}var i=V.parse(e);return i.error?(o("WALogger").DEV(p||(p=babelHelpers.taggedTemplateLiteralLoose(["error while parsing: ",""])),e.toString()),o("WALogger").ERROR(_||(_=babelHelpers.taggedTemplateLiteralLoose(["Parsing Error: ",""])),i.error.toString()),(D||(D=n("Promise"))).reject(i.error)):te(i.success)}function te(e){var t=!!e.offline&&!o("WAWebOfflineHandler").OfflineMessageHandler.isResumeFromRestartComplete();return o("WAWebHandleGroupNotificationV2").isGroupNotificationOptimizationEligible(e,t)&&t?o("WAWebHandleGroupNotificationV2").handleGroupNotificationV2(e,t):o("WAWebMessageQueue").onMessageQueue({chatWid:e.chatId,isOffline:t,msgCategory:null,action:(function(){var r=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){return yield(D||(D=n("Promise"))).all(e.actions.map(function(n){return K(e,n,t)})),o("WAWap").wap("ack",{to:o("WAWebCommsWapMd").GROUP_JID(e.chatId),id:o("WAWap").CUSTOM_STRING(e.externalId),class:"notification",type:"w:gp2",participant:e.author?o("WAWebCommsWapMd").USER_JID(e.author):o("WAWap").DROP_ATTR})});function a(){return r.apply(this,arguments)}return a})()})}l.handleAction=K,l.handleGroupNotification=ee,l.handleParsedGroupNotification=te}),98);
__d("WAWebProcessKeyBundle",["Promise","WAJids","WALogger","WAWebSignal","WAWebSignalCommonUtils","WAWebSignalProtocolStore","asyncToGeneratorRuntime","err"],(function(t,n,r,o,a,i,l){var e,s,u,c,d;function m(e){return p.apply(this,arguments)}function p(){return p=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var a=null,i=0,l=0,m=[],p=[];if(t.forEach(function(t){t instanceof Error?(o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["establishE2ESession: error: ",""])),t),a=t):(t.wid.device!=null&&t.wid.device!==o("WAJids").DEFAULT_DEVICE_ID?p.push(t):m.push(t),!t.key&&!t.wid.isBot()&&i++)}),m.length===0&&p.length===0)throw r("err")("establishE2ESession: no keys in the response");try{var _=[].concat(m,p).map(function(e){return o("WAWebSignalCommonUtils").createSignalAddress(e.wid).toString()});yield o("WAWebSignalProtocolStore").getPersistSignalProtocolStore().bulkLoadIdentityKey(_),o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["establishE2ESession: warmed up identity cache: "," records"])),_.length)}catch(e){o("WALogger").WARN(u||(u=babelHelpers.taggedTemplateLiteralLoose(["establishE2ESession: failed to warm up identity cache: ",""])),e).devConsole(e)}var f=function(t){return o("WAWebSignal").Session.createSignalSession(t).then(function(){l++}).catch(function(e){o("WALogger").WARN(c||(c=babelHelpers.taggedTemplateLiteralLoose(["createSignalSession: failed for device "," with error ",""])),t.wid,e).sendLogs("createSignalSession-fail")})};if(yield(d||(d=n("Promise"))).all(m.map(f)),yield d.all(p.map(f)),a!=null)throw a;return{depletedPrekeyCount:i,processedPrekeyCount:l}}),p.apply(this,arguments)}l.processKeyBundles=m}),98);
__d("WAWebFetchPrekeysJob",["WAJids","WALogger","WAParsableXmlNode","WASmaxPreKeysFetchKeyBundlesRPC","WAWebBackendErrors","WAWebProcessKeyBundle","WAWebWidFactory","WAWebWidToJid","asyncToGeneratorRuntime","err"],(function(t,n,r,o,a,i,l){var e;function s(e,t){return u.apply(this,arguments)}function u(){return u=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,n){n===void 0&&(n=!1);var r=yield c(t,n),a=yield o("WAWebProcessKeyBundle").processKeyBundles(r),i=a.depletedPrekeyCount,l=a.processedPrekeyCount;return o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["fetchPrekeys: successfully established "," E2E sessions out of "," requested"])),l,t.length),{depletedPrekeyCount:i}}),u.apply(this,arguments)}function c(e,t){return d.apply(this,arguments)}function d(){return d=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){t===void 0&&(t=!1);var n=yield o("WASmaxPreKeysFetchKeyBundlesRPC").sendFetchKeyBundlesRPC({userArgs:e.map(function(e){return{userJid:o("WAWebWidToJid").widToDeviceJid(e),hasUserReasonIdentity:t}})});if(n.name==="FetchKeyBundlesResponseServerError"){var a=n.value.errorServerErrors.value;throw new(o("WAWebBackendErrors")).ServerStatusCodeError(Number(a.code),"fetchPrekeys: server error: "+a.code+" "+a.text)}else if(n.name==="FetchKeyBundlesResponseRequestError"){var i=n.value.errorRequestErrorsFetch.value;throw new(o("WAWebBackendErrors")).ServerStatusCodeError(Number(i.code),"fetchPrekeys: request error: "+i.code+" "+i.text)}var l=n.value.listUser.map(function(e){var t=e.userFetchKeyBundlesSuccessOrFetchKeyBundlesErrorOrFetchKeyBundlesErrorFallbackMixinGroup;switch(t.name){case"FetchKeyBundlesUserSuccess":{var n,a,i=t.value,l=i.preKeyMixin,s=i.elementValue,u=i.deviceIdentityMixin,c=i.skeyIdKeyIDMixin,d=i.skeyValueKeyDataMixin,m=i.skeySignatureElementValue,p=i.registrationElementValue;return{deviceIdentity:(n=u==null?void 0:u.deviceIdentityElementValue)!=null?n:null,identity:s,skey:{id:o("WAParsableXmlNode").convertBytesToUint(c.elementValue,3),pubkey:d.elementValue,signature:m},key:l?{id:o("WAParsableXmlNode").convertBytesToUint(l.keyIdKeyIDMixin.elementValue,3),pubkey:(a=l.keyValueKeyDataMixin)==null?void 0:a.elementValue}:null,regId:o("WAParsableXmlNode").convertBytesToUint(p,4),wid:o("WAWebWidFactory").createWid(e.jid)}}case"FetchKeyBundlesUserErrorFallback":case"FetchKeyBundlesUserError":{var _=t.value,f=_.errorCode,g=_.errorText;return r("err")("fetchPrekeys: list item error: "+f+" "+g)}}});if(l.length===0)throw r("err")("fetchPrekeys: empty key info");return l}),d.apply(this,arguments)}function m(e){var t=[],n=[],r=[];return e.forEach(function(e){e instanceof Error?r.push(e):e.wid.device!=null&&e.wid.device!==o("WAJids").DEFAULT_DEVICE_ID?n.push(e):t.push(e)}),[].concat(t,n,r)}l.fetchPrekeys=s,l.fetchPrekeyBundles=c,l.sortPrekeyBundles=m}),98);
__d("WAWebManagePhoneNumberMappingJob",["WALogger","WAWebApiContact","WAWebWidFactory","WAWebWorkerSafeBackendApi","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u;function c(e){return d.apply(this,arguments)}function d(){return d=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var n=new Set;o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["ensurePhoneNumberToLidMapping: ",""])),t.length),t.forEach(function(e){if(e.isUser()&&!(e.isBot()||e.isHosted()||e.isLid()||e.isPSA())){var t=o("WAWebApiContact").getCurrentLid(o("WAWebWidFactory").asUserWidOrThrow(e));t==null&&n.add(e.user)}});var r=Array.from(n).map(function(e){return o("WAWebWidFactory").createUserWidOrThrow(e)});if(o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["ensurePhoneNumberToLidMapping: "," wids: ",""])),r.length,r.map(function(e){return e.toString()}).join()),r.length!==0){var a=!1;yield o("WAWebWorkerSafeBackendApi").workerSafeSendAndReceive("syncContactListJob",{contactIds:r,shouldSyncDevice:a,mode:"query"})}}),d.apply(this,arguments)}l.ensurePhoneNumberToLidMapping=c}),98);
__d("WAWebManageE2ESessionsJob",["Promise","WALogger","WAResolvable","WAWebABProps","WAWebAppTracker","WAWebEventsWaitForOfflineDeliveryEnd","WAWebFetchPrekeysJob","WAWebManagePhoneNumberMappingJob","WAWebProcessKeyBundle","WAWebRunInBatches","WAWebSignal","WAWebWid","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p,_,f,g=new Map,h=new Set,y=new Set,C={SESSION_CHECK:50,PROCESS_KEY_BUNDLES:1};function b(e,t,n){return v.apply(this,arguments)}function v(){return v=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,a,i){a===void 0&&(a=!1),i===void 0&&(i=!1);var l=o("WAWebABProps").getABPropConfigValue("web_anr_throttle_message_send_prekeys_processing")||i;yield o("WAWebEventsWaitForOfflineDeliveryEnd").waitForOfflineDeliveryEnd(),o("WAWebAppTracker").AppTracker.start(o("WAWebAppTracker").AppTrackerType.PreKeyProcessing),o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["ensureE2ESessions: "," wids, background:",": ",""])),t.length,l,t.map(function(e){return e.toString()}).join());try{yield o("WAWebManagePhoneNumberMappingJob").ensurePhoneNumberToLidMapping(t)}catch(e){o("WALogger").WARN(s||(s=babelHelpers.taggedTemplateLiteralLoose(["ensureE2ESessions: "," wids, background:",": ensurePhoneNumberToLidMapping call have failed: ",""])),t.length,l,e).sendLogs("ensureE2ESessions",{sampling:.01})}var b=new(o("WAResolvable")).Resolvable,v=[],S=[];l||(y.forEach(function(e){return e.abort()}),h.forEach(function(e){S.push(e),g.set(e,b.promise)}),h.clear()),t.forEach(function(e){if(!e.isUserNotPSA()){o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["ensureE2ESessions: "," wids, background:",": can only estabilish session with user wid"])),t.length,l);return}var n=g.get(e);n?v.push(n):(S.push(e),g.set(e,b.promise))});var R=0,L=0,E=null;try{if(S.length>0){var k=[];l?(E=new AbortController,y.add(E),S.forEach(function(e){h.add(e)}),yield o("WAWebRunInBatches").runInBatches(S,(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t,n=yield o("WAWebSignal").Session.hasSignalSessions(e);(t=k).push.apply(t,n)});return function(t){return e.apply(this,arguments)}})(),{batchSize:C.SESSION_CHECK,abortController:E})):k=yield o("WAWebSignal").Session.hasSignalSessions(S);var I=[];if(S.forEach(function(e,t){k[t]?h.delete(e):I.push(e)}),I.length>0){if(o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["ensureE2ESessions: "," wids, background:",": fetch prekeys for "," wids"])),t.length,l,I.length),l){var T=yield o("WAWebFetchPrekeysJob").fetchPrekeyBundles(I,a),D=o("WAWebFetchPrekeysJob").sortPrekeyBundles(T),x=0;yield o("WAWebRunInBatches").runInBatches(D,(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t,n;e.forEach(function(e){(e==null?void 0:e.wid)instanceof r("WAWebWid")&&h.delete(e.wid)});var a=yield o("WAWebProcessKeyBundle").processKeyBundles([].concat(e));L+=(t=a.depletedPrekeyCount)!=null?t:0,x+=(n=a.processedPrekeyCount)!=null?n:0});return function(t){return e.apply(this,arguments)}})(),{batchSize:C.PROCESS_KEY_BUNDLES,abortController:E}),o("WALogger").LOG(d||(d=babelHelpers.taggedTemplateLiteralLoose(["ensureE2ESessions: "," wids, background:",": successfully established "," E2E sessions out of "," requested"])),t.length,l,x,t.length)}else{var $,P=yield o("WAWebFetchPrekeysJob").fetchPrekeys(I,a);L=($=P.depletedPrekeyCount)!=null?$:0}R=I.length}}b.resolve()}catch(e){throw o("WALogger").WARN(m||(m=babelHelpers.taggedTemplateLiteralLoose(["ensureE2ESessions: "," wids, background:",": request failed: ",""])),t.length,l,e),b.resolve(e),o("WAWebAppTracker").AppTracker.stop(o("WAWebAppTracker").AppTrackerType.PreKeyProcessing),e}finally{S.forEach(function(e){g.delete(e),h.delete(e)}),E&&y.delete(E)}try{var N=(yield(f||(f=n("Promise"))).all(v)).find(Boolean);if(N)throw N}catch(e){throw o("WALogger").WARN(p||(p=babelHelpers.taggedTemplateLiteralLoose(["ensureE2ESessions: "," wids, background:",": deduped requests failed: ",""])),t.length,l,e),o("WAWebAppTracker").AppTracker.stop(o("WAWebAppTracker").AppTrackerType.PreKeyProcessing),e}finally{o("WAWebAppTracker").AppTracker.stop(o("WAWebAppTracker").AppTrackerType.PreKeyProcessing)}return o("WALogger").LOG(_||(_=babelHelpers.taggedTemplateLiteralLoose(["ensureE2ESessions: "," wids, background:",": "," existing sessions, "," requested, "," requests deduplicated"])),t.length,l,S.length-R,R,v.length),{missedPrekeyCount:R,depletedPrekeyCount:L}}),v.apply(this,arguments)}l.ensureE2ESessions=b}),98);
__d("WAWebHandleIdentityChange",["Promise","WADeprecatedWapParser","WAJids","WALogger","WAWap","WAWebBackendApi","WAWebCommsWapMd","WAWebCreateOrReplaceDisplayNamesAndLidPnMappingsJob","WAWebIdentityChangeApi","WAWebJidToWid","WAWebManageE2ESessionsJob","WAWebMessageQueue","WAWebOfflineHandler","WAWebSecurityCodeApi","WAWebSendTcTokenWhenDeviceIdentityChange","WAWebSignal","WAWebSignalCommonUtils","WAWebSignalProtocolStore","WAWebUserPrefsMeUser","WAWebUserPrefsStatus","WAWebWidFactory","asyncToGeneratorRuntime","isStringNullOrEmpty"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p,_=new(r("WADeprecatedWapParser"))("identityChange",function(e){return e.assertTag("notification"),e.assertAttr("type","encrypt"),e.child("identity"),{wid:o("WAWebJidToWid").deviceJidToDeviceWid(e.attrDeviceJid("from")),stanzaId:e.attrString("id"),displayName:e.maybeAttrString("display_name"),lid:e.hasAttr("lid")?o("WAWebJidToWid").deviceJidToDeviceWid(e.attrDeviceJid("lid")):null,offline:e.hasAttr("offline")?e.attrString("offline"):null}});function f(t){var a=_.parse(t);if(a.error)return o("WALogger").DEV(e||(e=babelHelpers.taggedTemplateLiteralLoose(["error while parsing: ",""])),t.toString()),o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["Parsing Error: ",""])),a.error.toString()),(p||(p=n("Promise"))).reject(a.error);var i=a.success,l=i.wid,f=i.stanzaId,g=i.displayName,h=i.lid,y=i.offline,C=o("WAWap").wap("ack",{to:o("WAWebCommsWapMd").DEVICE_JID(l),id:o("WAWap").CUSTOM_STRING(f),class:"notification"});if(l.device!=null&&l.device!==o("WAJids").DEFAULT_DEVICE_ID)return o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["handleNewIdentity: ignore identity change from companion device"]))),(p||(p=n("Promise"))).resolve(C);if(o("WAWebUserPrefsMeUser").isMePrimary(l))return o("WAWebBackendApi").frontendFireAndForget("handleSelfPrimaryIdentityChange",{}),(p||(p=n("Promise"))).resolve(C);var b=!r("isStringNullOrEmpty")(y)&&!o("WAWebOfflineHandler").OfflineMessageHandler.isResumeFromRestartComplete();return o("WAWebMessageQueue").onMessageQueue({chatWid:l,isOffline:b,msgCategory:null,action:(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=h?o("WAWebWidFactory").asUserLidOrThrow(h):null;yield o("WAWebIdentityChangeApi").clearDeviceRecordForIdentityChange({wid:l,stanzaLid:e,offline:b});var t=yield o("WAWebSignalProtocolStore").getSignalProtocolStore().loadIdentityKey(o("WAWebSignalCommonUtils").createSignalAddress(l).toString());if(!r("isStringNullOrEmpty")(t)){o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["handleE2eIdentityChange: "," has old identity, establishing new session"])),l.toString());var n=o("WAWebWidFactory").asUserWidOrThrow(l);yield o("WAWebSignal").Session.deleteRemoteInfo(l),o("WAWebSecurityCodeApi").addSecurityCodeChangedNotifications({user:n,stanzaLid:e,offline:b}).catch(function(e){o("WALogger").WARN(d||(d=babelHelpers.taggedTemplateLiteralLoose(["handleE2eIdentityChange: addSecurityCodeChangedNotifications failed with: ",""])),e)}),o("WAWebSendTcTokenWhenDeviceIdentityChange").sendTcTokenWhenDeviceIdentityChange(n),r("WAWebUserPrefsStatus").markStatusSenderKeyRotate([l]),b||o("WAWebManageE2ESessionsJob").ensureE2ESessions([l],!0).catch(function(e){o("WALogger").WARN(m||(m=babelHelpers.taggedTemplateLiteralLoose(["handleE2eIdentityChange: ensureE2ESessions failed with: ",""])),e)}),yield o("WAWebCreateOrReplaceDisplayNamesAndLidPnMappingsJob").createOrReplaceDisplayNamesAndLidPnMappings([{id:n,lid:e,displayName:g}],!y)}return C});function t(){return e.apply(this,arguments)}return t})()})}l.handleE2eIdentityChange=f}),98);
__d("WAWebHandleNewsletterMsgAddOns",["Promise","WAAckLevel","WAWebBackendApi","WAWebCRUDOperationsNewsletterMyVotes","WAWebDBCreateOrUpdateReactions","WAWebNewsletterDBUtils","WAWebPollOptionHashUtils","WAWebUserPrefsMeUser","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e;function s(t,r){switch(t.type){case"reaction":return u(t);case"poll_update":return d(t,r);default:return(e||(e=n("Promise"))).resolve()}}function u(e){return c.apply(this,arguments)}function c(){return c=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e.reactionText,n=e.id,r=e.serverId,a=e.from,i=e.t;if(!(r==null||i==null||a==null||t==null)){var l={msgKey:n.toString(),parentMsgKey:o("WAWebNewsletterDBUtils").craftNewsletterMsgKeyFromServerId(r,a).toString(),senderUserJid:o("WAWebUserPrefsMeUser").getMePnUserOrThrow().toString(),reactionText:t,timestamp:i*1e3,orphan:0,read:!0,ack:o("WAAckLevel").ACK.SENT};yield o("WAWebDBCreateOrUpdateReactions").createOrUpdateReactions([l]);var s=yield o("WAWebNewsletterDBUtils").getMessageByServerId(r,a.toJid());s!=null&&(yield o("WAWebBackendApi").frontendFireAndForget("updateChatPreviewFromReaction",{reactionMsgObj:l,parentMsgKey:s.id}))}}),c.apply(this,arguments)}function d(e,t){return m.apply(this,arguments)}function m(){return m=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=e.id,r=e.serverId,a=e.from,i=e.t,l=e.selectedOptionLocalIds,s=t.pollVotes;if(!(r==null||i==null||a==null||s==null)){var u={chatJid:n.remote.toJid(),msgServerId:r,msgKey:e.id.toString(),serverTimestampMs:i*1e3,t:i,votes:s.map(o("WAWebPollOptionHashUtils").bufferToHex)};yield o("WAWebCRUDOperationsNewsletterMyVotes").createOrUpdateMyVote(u);var c=yield o("WAWebNewsletterDBUtils").getMessageByServerId(r,a.toJid());c!=null&&(yield o("WAWebBackendApi").frontendFireAndForget("updateChatPreviewFromVote",{voteMsgObj:{ack:o("WAAckLevel").ACK.SENT,read:!0,msgKey:e.id,parentMsgKey:c.id,selectedOptionLocalIds:l!=null?l:[],sender:o("WAWebUserPrefsMeUser").getMePnUserOrThrow(),senderTimestampMs:i*1e3,t:i},parentMsgKey:c.id}))}}),m.apply(this,arguments)}l.maybeHandleNewsletterMsgAddOns=s}),98);
__d("WAWebHandleNewsletterMsgLogger",["WASmaxMessageDeliverNewsletterRPC","WAWebHandleMsgError","WAWebIncomingMessageDropWamEvent","WAWebWamEnumE2eDestination","WAWebWamEnumMediaType","WAWebWamEnumMessageDropReasonType","WAWebWamEnumRevokeType"],(function(t,n,r,o,a,i,l){function e(e){try{return o("WASmaxMessageDeliverNewsletterRPC").receiveNewsletterRPC(e)}catch(e){return null}}function s(t,n){var r=e(n.stanza);t instanceof o("WAWebHandleMsgError").MessageValidationError&&u(r,t)}function u(e,t){var n,r=new(o("WAWebIncomingMessageDropWamEvent")).IncomingMessageDropWamEvent({messageDropReason:o("WAWebWamEnumMessageDropReasonType").MESSAGE_DROP_REASON_TYPE.INVALID_PROTOBUF,e2eDestination:o("WAWebWamEnumE2eDestination").E2E_DESTINATION.CHANNEL,offline:(e==null||(n=e.parsedRequest)==null||(n=n.offlineMixin)==null?void 0:n.offline)!=null,e2eFailureReason:t==null?void 0:t.e2eFailureReason,messageMediaType:c(e),revokeType:(e==null?void 0:e.parsedRequest.newsletterMessageFanoutContent.name)==="NewsletterRevoke"?o("WAWebWamEnumRevokeType").REVOKE_TYPE.ADMIN:void 0});r.commit()}function c(e){var t=e==null?void 0:e.parsedRequest.newsletterMessageFanoutContent;if(t==null)return o("WAWebWamEnumMediaType").MEDIA_TYPE.NONE;switch(t.name){case"NewsletterReaction":return o("WAWebWamEnumMediaType").MEDIA_TYPE.REACTION;case"NewsletterMedia":return d(t.value.plaintextMediatype);case"NewsletterEdit":{var n,r=t.value.newsletterQuestionReplyOrTextOrMediaMixinGroup;return((n=r.value.newsletterTextOrMediaMixinGroup)==null?void 0:n.value.type)==="media"?d(r.value.newsletterTextOrMediaMixinGroup.value.plaintextMediatype):o("WAWebWamEnumMediaType").MEDIA_TYPE.NONE}case"NewsletterText":return o("WAWebWamEnumMediaType").MEDIA_TYPE.NONE;case"NewsletterRevoke":case"NewsletterReactionRevoke":case"NewsletterWAMOEmpty":return o("WAWebWamEnumMediaType").MEDIA_TYPE.NONE;case"NewsletterPollCreation":return o("WAWebWamEnumMediaType").MEDIA_TYPE.POLL_CREATE;case"NewsletterPollVote":return o("WAWebWamEnumMediaType").MEDIA_TYPE.POLL_VOTE;case"NewsletterPollResultSnapshot":return o("WAWebWamEnumMediaType").MEDIA_TYPE.POLL_RESULT_SNAPSHOT;case"NewsletterQuestion":case"NewsletterQuestionReply":return t.value.newsletterTextOrMediaMixinGroup.value.type==="media"?d(t.value.newsletterTextOrMediaMixinGroup.value.plaintextMediatype):o("WAWebWamEnumMediaType").MEDIA_TYPE.NONE;case"NewsletterQuestionResponse":return o("WAWebWamEnumMediaType").MEDIA_TYPE.NONE;case"NewsletterQuizCreation":return o("WAWebWamEnumMediaType").MEDIA_TYPE.POLL_CREATE;default:return t.name,o("WAWebWamEnumMediaType").MEDIA_TYPE.NONE}}function d(e){switch(e){case"video":return o("WAWebWamEnumMediaType").MEDIA_TYPE.VIDEO;case"vcard":return o("WAWebWamEnumMediaType").MEDIA_TYPE.CONTACT;case"url":return o("WAWebWamEnumMediaType").MEDIA_TYPE.URL;case"sticker":case"genai_sticker":case"1p_sticker":case"avatar_sticker":case"user_created_sticker":return o("WAWebWamEnumMediaType").MEDIA_TYPE.STICKER;case"ptt":return o("WAWebWamEnumMediaType").MEDIA_TYPE.PTT;case"ptv":return o("WAWebWamEnumMediaType").MEDIA_TYPE.PUSH_TO_VIDEO;case"productlink":return o("WAWebWamEnumMediaType").MEDIA_TYPE.PRODUCT_LINK;case"image":return o("WAWebWamEnumMediaType").MEDIA_TYPE.PHOTO;case"gif":return o("WAWebWamEnumMediaType").MEDIA_TYPE.GIF;case"document":return o("WAWebWamEnumMediaType").MEDIA_TYPE.DOCUMENT;case"cataloglink":return o("WAWebWamEnumMediaType").MEDIA_TYPE.CATALOG_LINK;case"sticker_pack":return o("WAWebWamEnumMediaType").MEDIA_TYPE.STICKER_PACK;case"collection":return o("WAWebWamEnumMediaType").MEDIA_TYPE.MEDIA_ALBUM;case"motion_photo":return o("WAWebWamEnumMediaType").MEDIA_TYPE.MOTION_PHOTO;case"motion_video":return o("WAWebWamEnumMediaType").MEDIA_TYPE.MOTION_VIDEO;default:return o("WAWebWamEnumMediaType").MEDIA_TYPE.AUDIO}}l.handleNewsletterMsgError=s}),98);
__d("WAWebNewsletterMsgParser",["WASmaxMessageDeliverNewsletterRPC","WASmaxParsingFailure","WAWebJidToWid","WAWebNewsletterGatingUtils","WAWebReactionsBEUtils","WAWebUserPrefsMeUser"],(function(t,n,r,o,a,i,l){function e(e){var t,n,r=o("WASmaxMessageDeliverNewsletterRPC").receiveNewsletterRPC(e),a=r.parsedRequest,i=r.makeNewsletterResponseSuccess,l={id:a.id,t:a.t,isSender:a.isSender==="true",serverId:a.serverId,offline:(t=a.offlineMixin)==null?void 0:t.offline,from:o("WAWebJidToWid").jidWithTypeToWid({jidType:"newsletter",newsletterJid:a.from}),to:o("WAWebUserPrefsMeUser").getMePnUserOrThrow()},s=(n=a.newsletterMessageFanoutContent.value.wAMOSubMixin)==null?void 0:n.metaIsWamoSub;return s!=null&&o("WAWebNewsletterGatingUtils").isWamoSubMessagesProcessingEnabled()&&(l.isWamoSub=s==="true"),{ack:i(),msg:d(l,a)}}function s(e){return e.reactionCode}function u(e){return e.votesVote.map(function(e){var t=e.elementValue;return t})}function c(e){return e.plaintextPayloadMixin.elementValue}function d(e,t){var n=t.newsletterMessageFanoutContent;switch(n.name){case"NewsletterPollVote":return babelHelpers.extends({},e,{type:"NewsletterPollVote",pollVote:u(n.value)});case"NewsletterReaction":return babelHelpers.extends({},e,{type:"NewsletterReaction",reactionCode:s(n.value)});case"NewsletterReactionRevoke":return babelHelpers.extends({},e,{type:"NewsletterReactionRevoke",reactionCode:o("WAWebReactionsBEUtils").REVOKED_REACTION_TEXT});case"NewsletterRevoke":return babelHelpers.extends({},e,{type:"NewsletterRevoke"});case"NewsletterMedia":return babelHelpers.extends({},e,{type:n.name,payload:c(n.value)});case"NewsletterQuestion":case"NewsletterQuestionReply":{var r=babelHelpers.extends({},e,{payload:c(n.value.newsletterTextOrMediaMixinGroup.value)});return n.value.newsletterTextOrMediaMixinGroup.name==="NewsletterText"?babelHelpers.extends({},r,{type:"NewsletterText"}):babelHelpers.extends({},r,{type:"NewsletterMedia"})}case"NewsletterQuestionResponse":case"NewsletterText":return babelHelpers.extends({},e,{type:"NewsletterText",payload:c(n.value)});case"NewsletterPollCreation":return babelHelpers.extends({},e,{type:"NewsletterPollCreation",payload:c(n.value)});case"NewsletterEdit":{var a,i,l=n.value.newsletterQuestionReplyOrTextOrMediaMixinGroup,d;switch(l.name){case"NewsletterQuestionReply":d=c(l.value.newsletterTextOrMediaMixinGroup.value);break;case"NewsletterText":case"NewsletterMedia":d=c(l.value);break;default:throw l.name,new(o("WASmaxParsingFailure")).SmaxParsingFailure("unrecognized-newsletter-edit-type")}return babelHelpers.extends({},e,{type:"NewsletterEdit",payload:d,msgEditT:(a=t.newsletterMessageLastEditTimestampMixin)==null?void 0:a.metaMsgEditT,msgOriginalT:(i=t.newsletterMessageOriginalTimestampMixin)==null?void 0:i.metaOriginalMsgT})}case"NewsletterPollResultSnapshot":return babelHelpers.extends({},e,{type:"NewsletterPollResultSnapshot",payload:c(n.value)});case"NewsletterWAMOEmpty":return babelHelpers.extends({},e,{type:"NewsletterWAMOEmpty"});case"NewsletterQuizCreation":return babelHelpers.extends({},e,{type:"NewsletterPollCreation",payload:c(n.value)});default:throw n.name,new(o("WASmaxParsingFailure")).SmaxParsingFailure("unrecognized-newsletter-message-type")}}l.default=e}),98);
__d("WAWebNewsletterMsgEditUtils",["WAWebMsgKey","WAWebMsgType"],(function(t,n,r,o,a,i,l){function e(e){return babelHelpers.extends({},e,{type:o("WAWebMsgType").MSG_TYPE.PROTOCOL,kind:o("WAWebMsgType").MsgKind.Protocol,subtype:"message_edit",protocolMessageKey:e.id,latestEditMsgKey:e.id,latestEditSenderTimestampMs:e.t})}function s(e,t){var n=e.id.clone(),a=new(r("WAWebMsgKey"))({remote:e.id.remote,fromMe:e.id.fromMe,id:r("WAWebMsgKey").newId_DEPRECATED()});return babelHelpers.extends({},e,{id:a,type:o("WAWebMsgType").MSG_TYPE.PROTOCOL,kind:o("WAWebMsgType").MsgKind.Protocol,subtype:"message_edit",editMsgType:e.type,protocolMessageKey:n,latestEditMsgKey:a,latestEditSenderTimestampMs:t.latestEditSenderTimestampMs})}l.mapMsgToEditProtocolMsgLegacy=e,l.mapMsgToEditProtocolMsg=s}),98);
__d("WAWebNewsletterMsgStanzaAdapters",["WAAckLevel","WAWebMsgKey","WAWebMsgType","WAWebNewsletterMsgEditUtils","WAWebUserPrefsMeUser","WAWebViewMode.flow","err"],(function(t,n,r,o,a,i,l){function e(e,t,n){if(n.addOnParentKey==null)throw r("err")("Reaction message without parent");return{id:e,reactionParentKey:n.addOnParentKey,type:o("WAWebMsgType").MSG_TYPE.REACTION,kind:o("WAWebMsgType").MsgKind.ReactionDecrypted,viewMode:o("WAWebViewMode.flow").ViewModeType.VISIBLE,t:t.t,from:t.from,to:t.to,serverId:t.serverId,isNewMsg:!1,ack:o("WAAckLevel").ACK.SENT,read:!1,reactionText:t.reactionCode,reactionTimestamp:t.t*1e3}}function s(e,t,n){var a;if(n.addOnParentKey==null)throw r("err")("Reaction message without parent");return{id:e,t:t.t,from:t.from,to:t.to,serverId:t.serverId,isNewMsg:!1,ack:o("WAAckLevel").ACK.SENT,type:o("WAWebMsgType").MSG_TYPE.POLL_UPDATE,kind:o("WAWebMsgType").MsgKind.PollVoteDecrypted,viewMode:o("WAWebViewMode.flow").ViewModeType.VISIBLE,subtype:"poll_vote",pollUpdateParentKey:n.addOnParentKey,selectedOptionLocalIds:(a=n.pollVotesAsLocalIds)!=null?a:[],senderTimestampMs:t.t*1e3,read:!1}}function u(e){var t=e.msgKey,n=e.msg,a=e.msgContext,i=e.baseMsgData,l=e.parsingContext,s=o("WAWebViewMode.flow").ViewModeType.NEWSLETTER_TOMBSTONE;if(l==="history"){var u,c;return{id:new(r("WAWebMsgKey"))({remote:n.from,fromMe:n.isSender,id:n.id}),from:n.from,to:n.isSender?n.from:o("WAWebUserPrefsMeUser").getMePnUserOrThrow(),t:(u=a.metaOriginalMsgT)!=null?u:n.t,serverId:n.serverId,lastUpdateFromServerTs:(c=a.lastUpdateFromServerTs)!=null?c:void 0,type:"revoked",kind:o("WAWebMsgType").MsgKind.RevokedMessage,viewMode:s,revokeSender:n.from,subtype:"admin"}}return babelHelpers.extends({},i,{serverId:n.serverId,id:new(r("WAWebMsgKey"))({remote:n.from,fromMe:n.isSender,id:r("WAWebMsgKey").newId_DEPRECATED()}),type:o("WAWebMsgType").MSG_TYPE.PROTOCOL,kind:o("WAWebMsgType").MsgKind.ProtocolRevoke,subtype:"admin_revoke",protocolMessageKey:t,viewMode:s})}function c(e,t,n){return t!=="history"?o("WAWebNewsletterMsgEditUtils").mapMsgToEditProtocolMsg(e,{latestEditSenderTimestampMs:n.latestEditSenderTimestampMs}):e}l.mapReactionMsgStanza=e,l.mapPollVoteMsgStanza=s,l.mapRevokeMsgStanza=u,l.mapEditMsgStanza=c}),98);
__d("WAWebNewsletterBackendMsgUtils",["WAAckLevel","WATimeUtils","WAWebE2EProtoParser","WAWebMsgKey","WAWebMsgType","WAWebNewsletterFutureProofUtils","WAWebNewsletterGatingUtils","WAWebNewsletterMsgStanzaAdapters","WAWebProtobufsE2E.pb","WAWebUserPrefsMeUser","WAWebViewMode.flow","decodeProtobuf","err"],(function(t,n,r,o,a,i,l){function e(e,t){var n,a,i,l=e.msg,u=e.msgContext,d=new(r("WAWebMsgKey"))({remote:l.from,fromMe:l.isSender,id:l.id});switch(l.type){case"NewsletterReaction":case"NewsletterReactionRevoke":return o("WAWebNewsletterMsgStanzaAdapters").mapReactionMsgStanza(d,l,u);case"NewsletterPollVote":return o("WAWebNewsletterMsgStanzaAdapters").mapPollVoteMsgStanza(d,l,u)}var m=c(d,l);if(l.type==="NewsletterRevoke")return o("WAWebNewsletterMsgStanzaAdapters").mapRevokeMsgStanza({msgKey:d,msg:l,msgContext:u,baseMsgData:m,parsingContext:t});var p=o("decodeProtobuf").decodeProtobuf(o("WAWebProtobufsE2E.pb").MessageSpec,l.payload),_=o("WAWebE2EProtoParser").parseMsgProto({messageProtobuf:p,message:m,msgContext:t}),f=s(babelHelpers.extends({},_,{isNewMsg:u.isNewMsg,viewCount:(n=u.viewCount)!=null?n:void 0,questionResponsesCount:(a=u.questionResponsesCount)!=null?a:0,hasReaction:!!u.hasReaction,latestEditSenderTimestampMs:u.latestEditSenderTimestampMs,lastUpdateFromServerTs:(i=u.lastUpdateFromServerTs)!=null?i:void 0,latestEditMsgKey:u.isEdited===!0?d:void 0,serverId:l.serverId}));if(u.isWamoSub!=null&&o("WAWebNewsletterGatingUtils").isWamoSubMessagesProcessingEnabled()){var g;f.isWamoSub=(g=u.isWamoSub)!=null?g:void 0}var h=o("WAWebNewsletterFutureProofUtils").isMsgSupported(_),y=h.supported,C=h.reason;switch(y||(f.type=o("WAWebMsgType").MSG_TYPE.UNKNOWN,f.subtype=C,f.kind=o("WAWebMsgType").MsgKind.Unknown,f.futureproofType=_.type,f.futureproofSubtype=_.subtype),l.type){case"NewsletterEdit":return o("WAWebNewsletterMsgStanzaAdapters").mapEditMsgStanza(f,t,u);case"NewsletterPollCreation":case"NewsletterPollResultSnapshot":case"NewsletterText":case"NewsletterMedia":return f;case"NewsletterWAMOEmpty":return babelHelpers.extends({},f,{isWamoSub:!0,viewMode:o("WAWebViewMode.flow").ViewModeType.HIDDEN});default:throw l.type,r("err")("unreachable code")}}function s(e){return e.streamingSidecar=null,e.mediaKey=null,e.mediaKeyTimestamp=null,e}function u(t,n,r,a){var i,l,s;r===void 0&&(r=!1);var u=t.newsletterMessageHistoryContent,c=t.id,d=t.t,m=t.serverId;if(u==null||c==null||d==null)return null;var p=t.isSender==="true",_={id:c,from:n,isSender:p,to:p?n:o("WAWebUserPrefsMeUser").getMePnUserOrThrow(),t:d,serverId:m,offline:null},f=(i=t.newsletterMessageOriginalTimestampMixin)==null?void 0:i.metaOriginalMsgT,g={hasReaction:r,lastUpdateFromServerTs:a,viewCount:(l=t.newsletterViewsCountMixin)==null?void 0:l.viewsCountCount,questionResponsesCount:(s=t.newsletterResponsesCountMixin)==null?void 0:s.responsesCountCount,isEdited:u.name==="NewsletterEdit",metaOriginalMsgT:f};if(o("WAWebNewsletterGatingUtils").isWamoSubMessagesProcessingEnabled()){var h;g.isWamoSub=((h=t.newsletterMessageHistoryContent)==null||(h=h.value.wAMOSubMixin)==null?void 0:h.metaIsWamoSub)==="true"}var y="history";switch(u.name){case"NewsletterEdit":{var C,b=(C=t.newsletterMessageLastEditTimestampMixin)==null?void 0:C.metaMsgEditT,v=b!=null?o("WATimeUtils").castToMillisTime(b):void 0,S=f!=null?f:d;return e({msg:babelHelpers.extends({},_,{type:u.name,t:S,payload:u.value.newsletterTextOrMediaMixinGroup.value.plaintextPayloadMixin.elementValue,msgEditT:b,msgOriginalT:d}),msgContext:babelHelpers.extends({},g,{latestEditSenderTimestampMs:v})},y)}case"NewsletterQuestion":case"NewsletterQuestionReply":{var R=u.value.newsletterTextOrMediaMixinGroup.value.plaintextPayloadMixin.elementValue;return u.value.newsletterTextOrMediaMixinGroup.name==="NewsletterMedia"?e({msg:babelHelpers.extends({},_,{payload:R,type:"NewsletterMedia"}),msgContext:g},y):e({msg:babelHelpers.extends({},_,{payload:R,type:"NewsletterText"}),msgContext:g},y)}case"NewsletterText":return e({msg:babelHelpers.extends({},_,{payload:u.value.plaintextPayloadMixin.elementValue,type:"NewsletterText"}),msgContext:g},y);case"NewsletterPollCreation":return e({msg:babelHelpers.extends({},_,{payload:u.value.plaintextPayloadMixin.elementValue,type:u.name}),msgContext:g},y);case"NewsletterPollResultSnapshot":return e({msg:babelHelpers.extends({},_,{payload:u.value.plaintextPayloadMixin.elementValue,type:u.name}),msgContext:g},y);case"NewsletterMedia":return e({msg:babelHelpers.extends({},_,{payload:u.value.plaintextPayloadMixin.elementValue,type:u.name}),msgContext:g},y);case"NewsletterRevoke":return e({msg:babelHelpers.extends({},_,{type:u.name}),msgContext:g},y);case"NewsletterWAMOEmpty":return e({msg:babelHelpers.extends({},_,{type:u.name}),msgContext:g},y);default:return u.name,null}}function c(e,t){return{ack:o("WAAckLevel").ACK.SENT,from:t.from,t:t.t,to:t.to,id:e,type:o("WAWebMsgType").MSG_TYPE.UNKNOWN,viewMode:o("WAWebViewMode.flow").ViewModeType.VISIBLE,count:null,invis:!1}}l.mapMsgStanzaToMsgData=e,l.mapNewsletterMsgToMsgData=u}),98);
__d("WAWebNewsletterMsgProcessor",["WATimeUtils","WAWebApiFilterAndReplaceMessages","WAWebNewsletterBackendMsgUtils","WAWebNewsletterDBUtils","WAWebNewsletterGatingUtils","WAWebPollsCreateOptionLocalIdMap","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){function e(e){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e.offline!=null,n=e.type==="NewsletterRevoke",r=e.serverId,a=u(e.type),i=a&&r!=null?yield o("WAWebNewsletterDBUtils").getMessageByServerId(r,e.from.toJid()):null,l=a&&i==null,s=yield d(i,e.pollVote),m={isNewMsg:!t&&!n,addOnParentKey:a?c({addOnParentMsg:i,serverId:r,remote:e.from}):void 0,pollVotesAsLocalIds:s,latestEditSenderTimestampMs:e.msgEditT!=null?o("WATimeUtils").castToMillisTime(e.msgEditT):null};e.isWamoSub!=null&&o("WAWebNewsletterGatingUtils").isWamoSubMessagesProcessingEnabled()&&(m.isWamoSub=e.isWamoSub);var p=o("WAWebNewsletterBackendMsgUtils").mapMsgStanzaToMsgData({msg:e,msgContext:m},"relay"),_=yield o("WAWebApiFilterAndReplaceMessages").filterAndReplaceMessages([p]),f=_.newMsgs,g=f[0];return{msgData:g,isOrphan:l}}),s.apply(this,arguments)}function u(e){switch(e){case"NewsletterReaction":case"NewsletterReactionRevoke":case"NewsletterPollVote":return!0;default:return!1}}function c(e){var t=e.addOnParentMsg,n=e.serverId,r=e.remote;return t!=null?t.id:o("WAWebNewsletterDBUtils").craftNewsletterMsgKeyFromServerId(n,r.toJid())}function d(e,t){return m.apply(this,arguments)}function m(){return m=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=e==null?void 0:e.pollOptions;if(!(n==null||t==null)){var r=yield o("WAWebPollsCreateOptionLocalIdMap").createOptionLocalIdMap(n);return t.map(function(e){return r.getLocalIdForHash(e.slice().buffer)})}}),m.apply(this,arguments)}l.preprocessNewsletterMsg=e,l.isAddOnType=u}),98);
__d("WAWebHandleNewsletterMsg",["Promise","WALogger","WATimeUtils","WAWebBackendApi","WAWebCmd","WAWebHandleMsgTypes.flow","WAWebHandleNewsletterMsgAddOns","WAWebHandleNewsletterMsgLogger","WAWebLogReceivedMessages","WAWebMessageProcessorCache","WAWebMessageQueue","WAWebNewsletterGatingUtils","WAWebNewsletterMsgParser","WAWebNewsletterMsgProcessor","WAWebOfflineHandler","WAWebWamWorkerOfflineProcessReporter","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p,_;function f(e){return g.apply(this,arguments)}function g(){return g=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){try{o("WALogger").DEV(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[newsletter][message] Message received, parsing and decoding"])));var a=r("WAWebNewsletterMsgParser")(t),i=a.msg,l=a.ack;if(!o("WAWebNewsletterGatingUtils").isNewsletterEnabled())return o("WALogger").DEV(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[newsletter][message] Newsletter not enabled, drop & ack"]))),l;var f=o("WATimeUtils").unixTimeMs(),g=i.offline!=null;g&&(o("WAWebOfflineHandler").OfflineMessageHandler.addOfflinePendingMessage(),o("WAWebOfflineHandler").OfflineMessageHandler.offlineStanzaReceivedAfterComplete()),o("WAWebOfflineHandler").OfflineMessageHandler.isResumeFromRestartComplete()&&(i.offline=null,g=!1);var h=!o("WAWebNewsletterMsgProcessor").isAddOnType(i.type);return yield o("WAWebMessageQueue").onMessageQueue({chatWid:i.from,isOffline:g,msgCategory:null,action:(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=o("WATimeUtils").unixTimeMs(),t=yield o("WAWebNewsletterMsgProcessor").preprocessNewsletterMsg(i),r=t.msgData,a=t.isOrphan,s=h?o("WAWebMessageProcessorCache").messageProcessorCache.addMessages([{msg:r}],!g).then(function(){o("WALogger").DEV(u||(u=babelHelpers.taggedTemplateLiteralLoose(["[newsletter][message] Message stored to DB"]))),o("WAWebWamWorkerOfflineProcessReporter").WorkerOfflineResumeReporter.updateProcessedMessageCount(),o("WAWebLogReceivedMessages").logReceivedMessagesInWAM({msgs:[r],offline:i.offline,tsMillis:i.t*1e3,clientReceivedTsMillis:f,msgProcessStartTsMillis:e,serverAddressingMode:null,localAddressingMode:null})}).catch(function(e){o("WALogger").ERROR(c||(c=babelHelpers.taggedTemplateLiteralLoose(["[newsletter] Failed to handle newsletter message"]))).tags("newsletter").devConsole(e).sendLogs("newsletter-failed-to-store-incoming-message")}):(_||(_=n("Promise"))).resolve();return yield o("WAWebHandleNewsletterMsgAddOns").maybeHandleNewsletterMsgAddOns(r,{pollVotes:i.pollVote}),o("WAWebCmd").Cmd.isMainStreamReadyMd&&(o("WAWebCmd").Cmd.isOfflineDeliveryEnd&&(yield s),o("WALogger").DEV(d||(d=babelHelpers.taggedTemplateLiteralLoose(["[newsletter][message] Message decoded, UI update started"]))),o("WAWebBackendApi").frontendFireAndForget("updateNewsletterMessageUI",{chatID:i.from,msg:r,isOrphan:a})),g?(o("WAWebOfflineHandler").OfflineMessageHandler.processMessageDecryptResult(o("WAWebHandleMsgTypes.flow").E2EProcessResult.SUCCESS),o("WAWebMessageProcessorCache").messageProcessorCache.addMessages([{receiptInfo:{externalId:i.id,from:i.from,author:i.from}}]).catch(function(e){var t=e instanceof Error?e:{},n=t.name,r=t.message;o("WALogger").ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["[newsletter] Failed to handle newsletter offline ack ","-",""])),n,r).tags("newsletter").devConsole(e).sendLogs("newsletter-failed-to-store-offline-ack")}),null):l});function t(){return e.apply(this,arguments)}return t})()})}catch(e){throw o("WAWebHandleNewsletterMsgLogger").handleNewsletterMsgError(e,{stanza:t}),o("WALogger").ERROR(p||(p=babelHelpers.taggedTemplateLiteralLoose(["[newsletter] Failed to handle newsletter message ","-",""])),e.name,e.message).tags("newsletter").devConsole(e).sendLogs("failed-handle-newsletter-message"),e}}),g.apply(this,arguments)}l.default=f}),98);
__d("WAWebHandleVoipCallReceipt",["Promise","WADeprecatedWapParser","WALogger","WAParsableWapNode","WAWap","WAWebBackendApi","WAWebCommsWapMd","WAWebJidToWid","WAWebUserPrefsMeUser","WAWebVoipStackInterface","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u,c=new(r("WADeprecatedWapParser"))("callReceiptParser",function(e){e.assertTag("receipt");var t=e.maybeChild("offer")||e.maybeChild("accept")||e.maybeChild("reject");if(!t)throw e.createParseError("Unrecognized call stanza");return{stanzaId:e.attrString("id"),type:e.hasAttr("type")?e.attrString("type"):null,from:o("WAWebJidToWid").jidWithTypeToWid(e.attrJidWithType("from"))}});function d(e){return m.apply(this,arguments)}function m(){return m=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var r=c.parse(t);if(r.error)return o("WALogger").DEV(e||(e=babelHelpers.taggedTemplateLiteralLoose(["voip: error while parsing: ",""])),t.toString()),o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["Parsing Error: ",""])),r.error.toString()),(u||(u=n("Promise"))).reject(r.error);var a=r.success,i=a.stanzaId,l=a.type,d=a.from,m=yield(u||(u=n("Promise"))).all([o("WAWebVoipStackInterface").getVoipStackInterface(),o("WAWebBackendApi").frontendSendAndReceive("getTcToken",{wid:d})]),p=m[0],_=m[1].tcToken;return yield p==null?void 0:p.handleIncomingSignalingReceipt(new(o("WAParsableWapNode")).ParsableWapNode("receipt",t),d.toString({legacy:!0,formatIncludeDevice:!0}),_),o("WAWap").wap("ack",{id:o("WAWap").CUSTOM_STRING(i),to:o("WAWebCommsWapMd").JID(d),from:o("WAWebCommsWapMd").JID(o("WAWebUserPrefsMeUser").getMePnUserOrThrow()),class:"receipt",type:o("WAWap").MAYBE_CUSTOM_STRING(l)})}),m.apply(this,arguments)}l.handleCallReceipt=d}),98);
__d("WAWebCommsHandleWorkerCompatibleStanza",["WAParsableWapNode","WAWebCommsHandleMessagingStanza","WAWebCommsHandleStanzaUtils","WAWebCreateNackFromStanza","WAWebHandleGroupNotification","WAWebHandleIdentityChange","WAWebHandleNewsletterMsg","WAWebHandleVoipCallReceipt","WAWebPostUnknownStanzaMetric","WAWebRuntimeEnvironmentUtils","WAWebWamWorkerOfflineProcessReporter","WAWebWid","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){function e(e){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){if(!o("WAWebRuntimeEnvironmentUtils").isWorker())return e;var t=yield e;return o("WAWebWamWorkerOfflineProcessReporter").WorkerOfflineResumeReporter.updateProcessedNotificationCount(),t}),s.apply(this,arguments)}function u(t){var n=o("WAWebCommsHandleMessagingStanza").handleMessagingStanza(t);if(n!=null)return n;var a=t.attrs;switch(t.tag){case"notification":{switch(a.type){case"w:gp2":return e(o("WAWebHandleGroupNotification").handleGroupNotification(t)).catch(function(e){return c(t,e)});case"encrypt":{var i=t.content;if(!Array.isArray(i)||!i.length)break;var l=i[0].tag;switch(l){case"identity":return e(o("WAWebHandleIdentityChange").handleE2eIdentityChange(t)).catch(function(e){return c(t,e)})}break}}break}case"message":{var s=t.attrs.from;if(r("WAWebWid").isNewsletter(s==null?void 0:s.toString()))return r("WAWebHandleNewsletterMsg")(t).catch(function(e){return o("WAWebCommsHandleStanzaUtils").handleMessageParsingFailure(t,e)});break}case"receipt":try{if(o("WAWebCommsHandleStanzaUtils").isCallReceipt(t))return o("WAWebHandleVoipCallReceipt").handleCallReceipt(t)}catch(e){return e instanceof o("WAParsableWapNode").XmppParsingFailure?(o("WAWebPostUnknownStanzaMetric").postUnknownStanzaMetric(t),o("WAWebCreateNackFromStanza").createNackFromStanza(t,o("WAWebCreateNackFromStanza").NackReason.ParsingError)):o("WAWebCreateNackFromStanza").createNackFromStanza(t,o("WAWebCreateNackFromStanza").NackReason.UnhandledError)}}}function c(e,t){return t instanceof o("WAParsableWapNode").XmppParsingFailure?(o("WAWebPostUnknownStanzaMetric").postUnknownStanzaMetric(e),o("WAWebCreateNackFromStanza").createNackFromStanza(e,o("WAWebCreateNackFromStanza").NackReason.ParsingError)):o("WAWebCreateNackFromStanza").createNackFromStanza(e,o("WAWebCreateNackFromStanza").NackReason.UnhandledError)}l.handleWorkerCompatibleStanza=u}),98);
__d("WAWebCopyToClipboard",["WALogger","WANullthrows","WAWebMiscErrors","WAWebUA","asyncToGeneratorRuntime","err"],(function(t,n,r,o,a,i,l){var e,s;function u(e){try{r("WANullthrows")(window.getSelection()).removeAllRanges();var t=document.createRange();t.selectNode(e),r("WANullthrows")(window.getSelection()).addRange(t);var n=document.execCommand("copy");return r("WANullthrows")(window.getSelection()).removeAllRanges(),n}catch(e){return!1}}function c(){return d.apply(this,arguments)}function d(){return d=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){try{var e=yield navigator.permissions.query({name:"clipboard-write"});return e.state==="granted"}catch(e){return!1}}),d.apply(this,arguments)}function m(){return!(!("clipboard"in navigator)||!("ClipboardItem"in window)||o("WAWebUA").UA.browser===o("WAWebUA").BROWSER_TYPE.SAFARI)}function p(e){return _.apply(this,arguments)}function _(){return _=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=yield c();if(t)try{return yield navigator.clipboard.writeText(e),!0}catch(e){if(e instanceof o("WAWebMiscErrors").NotAllowedError)return!1}var n=!1,r=document.body;if(r){var a=document.createElement("textarea");a.textContent=e,r.appendChild(a),a.focus(),a.select();try{document.execCommand("copy"),n=!0}catch(e){n=!1}finally{r.removeChild(a)}}return n}),_.apply(this,arguments)}function f(e){return g.apply(this,arguments)}function g(){return g=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){if(!m())throw r("err")("Clipboard API not supported");if(e.type==="image/png"){var t=new window.ClipboardItem({"image/png":e});navigator.clipboard.write([t]).catch(function(e){return o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["Write image to clipboard failed"]))).sendLogs(e)})}else{var n=new Image;n.onload=function(e){var t=e.target,n=document.createElement("canvas"),r=n.getContext("2d");n.width=t.naturalWidth,n.height=t.naturalHeight,r.drawImage(t,0,0),h(n)},n.src=URL.createObjectURL(e)}}),g.apply(this,arguments)}function h(t){var n="image/png",r=1;t.toBlob(function(t){var n,r=new window.ClipboardItem((n={},n[t.type]=t,n));navigator.clipboard.write([r]).catch(function(t){return o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["Write image to clipboard failed"]))).sendLogs(t)})},n,r)}l.copyElementContentsToClipboard=u,l.supportsCopyImageToClipboard=m,l.copyTextToClipboard=p,l.copyImageToClipboard=f,l.copyCanvasToClipboard=h}),98);
__d("WAWebCryptoDecryptPartialMedia",["Promise","WALogger","WATypedArraysConcat","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m=16,p=10,_=(function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var n=t.ciphertext,r=t.iv,a=t.mediaKeys,i=a.encKey,l={name:"AES-CBC",iv:r};try{var u=yield self.crypto.subtle.importKey("raw",new Uint8Array(i),"AES-CBC",!1,["decrypt"]).catch(function(t){throw o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["decryptPartialMedia:decrypt importKey error: ",""])),String(t)),t});return self.crypto.subtle.decrypt(l,u,n)}catch(e){throw o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["decryptPartialMedia:decrypt decrypt error: ",""])),String(e)),e}});return function(n){return t.apply(this,arguments)}})(),f=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e.ciphertext,n=e.mediaKeys,r=n.encKey,a=t instanceof Uint8Array?t:new Uint8Array(t),i={name:"AES-CBC",iv:a.slice(0-m)};try{var l=yield self.crypto.subtle.importKey("raw",new Uint8Array(r),"AES-CBC",!1,["encrypt"]).catch(function(e){o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["decryptPartialMedia:getEncryptedPadding importKey error: ",""])),String(e))}),s=new Uint8Array([]);return self.crypto.subtle.encrypt(i,l,s)}catch(e){o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["decryptPartialMedia:getEncryptedPadding encrypt error: ",""])),String(e));return}});return function(n){return e.apply(this,arguments)}})(),g=function(t){var e=t.serverRangeStart,r=t.ciphertext,a=t.mediaKeys,i=r instanceof Uint8Array?r:new Uint8Array(r),l=e===0,s=i.byteLength%m===0,u=!s,c;return l?c=new Uint8Array(a.iv):(c=i.slice(0,m),i=i.slice(m)),u&&(i=i.slice(0,i.byteLength-p)),s?f({ciphertext:i,mediaKeys:a}).then(function(e){return i=o("WATypedArraysConcat").concatTypedArrays(Uint8Array,[i,new Uint8Array(e)]),{ciphertext:i,iv:c}}):(d||(d=n("Promise"))).resolve({ciphertext:i,iv:c})},h=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e.mediaKeys,n=e.ciphertext,r=yield g({serverRangeStart:0,ciphertext:n,mediaKeys:t}),o=r.ciphertext,a=r.iv;return _({ciphertext:o,iv:a,mediaKeys:t})});return function(n){return e.apply(this,arguments)}})();l.BLOCK_SIZE=m,l.HMAC_SIZE=p,l.decrypt=_,l.cleanupCiphertextAndIv=g,l.decryptPartialMedia=h}),98);
__d("WAWebCryptoEncryptionSaltHelper",["Promise","WALogger","WAWebLogoutReasonConstants","WAWebSocketLogoutJob","WAWebUserPrefsMeUser","WAWebUserPrefsMultiDevice","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s;function u(){return c.apply(this,arguments)}function c(){return c=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var t=128,r=!!o("WAWebUserPrefsMeUser").getMaybeMePnUser(),a=null;return r||(a=new Uint8Array(t),self.crypto.getRandomValues(a),a=btoa(String.fromCharCode.apply(String,Array.from(new Uint8Array(a)))),yield o("WAWebUserPrefsMultiDevice").setWebEncSalt(a)),a=o("WAWebUserPrefsMultiDevice").getWebEncSalt(),a==null&&(o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[DB ENC CRITICAL ERROR] null returned for local enc salt"]))),o("WAWebSocketLogoutJob").socketLogout(o("WAWebLogoutReasonConstants").LogoutReason.MissingEncSalt)),a=Uint8Array.from(atob(a),function(e){return e.charCodeAt(0)}),(s||(s=n("Promise"))).resolve(a)}),c.apply(this,arguments)}function d(){return m.apply(this,arguments)}function m(){return m=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){yield o("WAWebUserPrefsMultiDevice").setWebEncSalt(null)}),m.apply(this,arguments)}l.getOrGenSalt=u,l.deleteSalt=d}),98);
__d("WAWebInvocationInterface",["WANullthrows"],(function(t,n,r,o,a,i,l){var e;function s(t){e=t}function u(){return r("WANullthrows")(e,"InvocationInterface was not inited")}function c(e,t){return u().sendLogs(e,t)}l.set=s,l.get=u,l.sendLogs=c}),98);
__d("WAWebCryptoEncKeyHelper",["Promise","WAWebCmd","WAWebCryptoEncryptionSaltHelper","WAWebDbEncryptionKey","WAWebInvocationInterface","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s=null;function u(){return c.apply(this,arguments)}function c(){return c=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){s==null&&(s=o("WAWebCryptoEncryptionSaltHelper").getOrGenSalt());var e=yield s;if(!(!e||e.constructor!==Uint8Array))return o("WAWebDbEncryptionKey").DbEncKeyStore.init(e)}),c.apply(this,arguments)}function d(){return m.apply(this,arguments)}function m(){return m=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){s==null&&(s=o("WAWebCryptoEncryptionSaltHelper").getOrGenSalt());var e=yield s;!e||e.constructor!==Uint8Array||o("WAWebInvocationInterface").get().initDatabaseEncnKey(e)}),m.apply(this,arguments)}function p(e){return o("WAWebInvocationInterface").get().generateFinalDbEncryptionAndFtsKey(e)}function _(){return f.apply(this,arguments)}function f(){return f=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){yield(e||(e=n("Promise"))).all([o("WAWebDbEncryptionKey").DbEncKeyStore.deleteKeys(),o("WAWebInvocationInterface").get().deleteDbEncKeyCache()])}),f.apply(this,arguments)}o("WAWebCmd").Cmd.on("logout",function(){s=(e||(e=n("Promise"))).resolve(null)}),l.initEncSalt=u,l.initEncSaltForInvoker=d,l.generateFinalDbEncryptionAndFtsKeyForInvoker=p,l.deleteEncKeysAndCache=_}),98);
__d("WAWebDBDeviceListFanout",["WALogger","WAWebApiDeviceList","WAWebBizCoexGatingUtils","WAWebUserPrefsMeUser","WAWebWidFactory","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e;function s(e){return u.apply(this,arguments)}function u(){return u=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var n=t.wids,r=t.chatWidSetToIncludeHostedInFanoutOneToOneChatOnly,a=t.shouldMergeAltDevices,i=a===void 0?!1:a,l=yield o("WAWebApiDeviceList").getDeviceIds(n,i),s=new Map;return l.forEach(function(t,a){if(t){var i=t.devices;i.forEach(function(e){var n=e.id===99||e.isHosted===!0,a=!1;if(o("WAWebBizCoexGatingUtils").bizHostedDevicesEnabled()&&r!=null&&(a=(r==null?void 0:r.isUser())===!0),!(n&&!a)){var i=o("WAWebWidFactory").createDeviceWidFromDeviceListPk(t.id,e.id,e.isHosted);o("WAWebUserPrefsMeUser").isMeDevice(i)||s.set(i.toString(),i)}})}else{var l=o("WAWebWidFactory").asUserWidOrThrow(n[a]);o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["getFanOutList: no device is found for ",", just send to the primary device"])),l.toString()).tags("messaging"),o("WAWebUserPrefsMeUser").isMeAccount(l)||s.set(l.toString(),l)}}),Array.from(s.values())}),u.apply(this,arguments)}l.getFanOutList=s}),98);
__d("WAWebDbUsageApiUtils",["Promise","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i){var e;function l(e){return e!=null&&e!==0?Math.round(e/1e6).toString():"0"}function s(t){return new(e||(e=n("Promise")))(function(e,n){t.onsuccess=function(t){e(t.target.result)},t.onerror=function(e){n(e.target.result)}})}function u(e){return c.apply(this,arguments)}function c(){return c=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t,n=yield s(e.open("__dbnames"));if((t=n.objectStoreNames)!=null&&t.length){var r=n.transaction(n.objectStoreNames,"readonly"),o=r.objectStore(r.objectStoreNames[0]),a=yield s(o.getAll());return a}else if(e.databases)return e.databases()}),c.apply(this,arguments)}function d(e,t){return m.apply(this,arguments)}function m(){return m=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=yield s(e.open(t));return n}),m.apply(this,arguments)}function p(t,r){return new(e||(e=n("Promise")))(function(e,n){var o=t.openCursor(null,"prev");o.onsuccess=function(t){var n=t.target.result;n&&r(n.value)?n.continue():e()},o.onerror=function(e){n(e.target.result)}})}i.convertToMBToString=l,i.promisifyRequest=s,i.getAllDatabases=u,i.getDatabase=d,i.objectStoreIterator=p}),66);
__d("WAWebDeleteAllCacheStorage",["Promise","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i){var e;function l(){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var t=window.caches;if(t!=null){var r=yield t.keys();yield(e||(e=n("Promise"))).all(r.map(function(e){return t.delete(e)}))}}),s.apply(this,arguments)}i.default=l}),66);
__d("WAWebDexieBootstrap",["WAWeb-dexie","WAWebNoop"],(function(t,n,r,o,a,i,l){"use strict";function e(){r("WAWeb-dexie").Promise.PSD.onunhandled=r("WAWebNoop"),r("WAWeb-dexie").Promise.PSD.txRelaxedDurabilityEnabled=!0}l.patchDexie=e}),98);
__d("WAWebDirtyBitsConsts",[],(function(t,n,r,o,a,i){var e={groups:"groups",account_sync:"account_sync",syncd_app_state:"syncd_app_state",newsletter_metadata:"newsletter_metadata"},l={devices:"devices",picture:"picture",privacy:"privacy",blocklist:"blocklist",notice:"notice"};i.SUPPORTED_DIRTY_TYPE=e,i.SUPPORTED_DIRTY_PROTOCOLS=l}),66);
__d("WAWebDisplayType",[],(function(t,n,r,o,a,i){var e={CONVERSATION:"CONVERSATION",MSG_INFO:"MSG_INFO",STARRED_MSGS:"STARRED_MSGS",KEPT_MSGS:"KEPT_MSGS",GALLERY:"GALLERY",GALLERY_LINKS:"GALLERY_LINKS",REPLY_STAGE:"REPLY_STAGE",QUOTED_MSG:"QUOTED_MSG",CONTACT_CARD:"CONTACT_CARD",ORDER:"ORDER",STATUS:"STATUS",EDITING:"EDITING",ANNOUNCEMENT:"ANNOUNCEMENT",NEWSLETTER:"NEWSLETTER",NEWSLETTER_PREVIEW:"NEWSLETTER_PREVIEW",CHANNEL_ALERTS_MSGS:"CHANNEL_ALERTS_MSGS",REPORTED_MSG:"REPORTED_MSG",BOT_INVOKE_RESPONSE:"BOT_INVOKE_RESPONSE",ALL_REPLIES:"ALL_REPLIES",BOT_REELS_PLUGIN:"BOT_REELS_PLUGIN",COMMENT:"COMMENT",MESSAGE_HISTORY_BUNDLE:"MESSAGE_HISTORY_BUNDLE"};function l(t){return t===e.ANNOUNCEMENT||t===e.NEWSLETTER}var s=[e.CONVERSATION,e.ANNOUNCEMENT,e.NEWSLETTER,e.BOT_INVOKE_RESPONSE,e.ALL_REPLIES];function u(e){return c.includes(e)}var c=[e.STARRED_MSGS,e.REPORTED_MSG,e.CONTACT_CARD,e.GALLERY,e.GALLERY_LINKS];function d(e){return s.includes(e)}i.DISPLAY_TYPE=e,i.isWideDisplay=l,i.isMsgGalleryDisplay=u,i.isConversationDisplay=d}),66);
__d("WAWebDropdownItem.scss",["cx"],(function(t,n,r,o,a,i,l,s){var e={item:"_aj-q",text:"_aj-r",hover:"_aj-s",itemMaterial:"_ap51",fixedHeight:"_alxo",action:"_aj-t",compact:"_aj-u",icon:"_aj-v",emoji:"_aj-w",emojiGrid:"_aj-x",emojiPreview:"_aj-y",ellipsify:"_aj-z",disabled:"_aj--",shortcut:"_aj-_",checkmark:"_aj_0",attachMenuPopup:"_ak_v",defaultRefreshed:"_asi6",negative:"_asi3"},u=e;l.default=u}),98);
__d("WAWebPill.react",["WAWebFlex.react","WAWebUISpacing","react","stylex"],(function(t,n,r,o,a,i,l){var e=["children","pillText"],s,u,c=s||(s=r("react")),d={pill:{display:"x3nfvp2",boxSizing:"x9f619",height:"x17rw0jw",fontSize:"x190qgfh",fontWeight:"x1xlr1w8",borderStartStartRadius:"x1g83kfv",borderStartEndRadius:"x3qq2k7",borderEndEndRadius:"x2x8art",borderEndStartRadius:"x1qor8vf",$$css:!0},gray:{color:"x1pse0pq",backgroundColor:"x1518k6t",$$css:!0},green:{color:"x1pse0pq",backgroundColor:"xfn3atn",$$css:!0},yellow:{color:"x1pse0pq",backgroundColor:"x18um00n",$$css:!0},blue:{color:"x1pse0pq",backgroundColor:"x4e28k3",$$css:!0}};function m(e){var t=e.children,n=e.color,a=n===void 0?"gray":n,i=e.inline;return c.jsx(o("WAWebFlex.react").FlexRow,{align:"center",className:(u||(u=r("stylex")))([d.pill,a?d[a]:null,o("WAWebUISpacing").uiPadding.vert4,o("WAWebUISpacing").uiPadding.horiz8,o("WAWebUISpacing").uiMargin.vertAuto,i===!0?o("WAWebUISpacing").uiMargin.start8:null]),children:t})}m.displayName=m.name+" [from "+i.id+"]";function p(t){var n=t.children,r=t.pillText,a=babelHelpers.objectWithoutPropertiesLoose(t,e);return c.jsxs(o("WAWebFlex.react").FlexRow,{align:"center",children:[n,c.jsx(m,babelHelpers.extends({},a,{inline:n!=null||a.inline,children:r}))]})}p.displayName=p.name+" [from "+i.id+"]",l.Pill=m,l.LabelPill=p}),98);
__d("WAWebDropdownItem.react",["$InternalEnum","WAWebCheckmarkIcon.react","WAWebClassnames","WAWebDropdownItem.scss","WAWebFlex.react","WAWebKeyboardHotKeys.react","WAWebL10NFbtTypeUtils","WAWebNoop","WAWebPill.react","WAWebTooltip.react","WAWebUISpacing","WDSFocusStateStyles","react","stylex","useWAWebUIM"],(function(t,n,r,o,a,i,l){var e=["icon"],s,u,c,d=c||(c=o("react")),m=s||(s=r("react")),p=d.useRef,_=d.useState,f={container:{cursor:"x1ypdohk",minWidth:"x5w4yej",height:"x1vqgdyp",width:"xh8yej3",$$css:!0},icon:{minWidth:"xt4ypqs",$$css:!0},text:{lineHeight:"x1o2sk6j",fontSize:"x6prxxf",overflowX:"x6ikm8r",overflowY:"x10wlt62",textOverflow:"xlyipyv",whiteSpace:"xuxw1ft",$$css:!0}},g=n("$InternalEnum").Mirrored(["Compact","Muted","Negative"]),h={checkmarkIcon:{color:"x1v5yvga",$$css:!0}};function y(e){var t,n,a=e.children,i=e.tooltip,l=e.tooltipPosition,s=l===void 0?o("WAWebTooltip.react").PopoverPosition.Start:l,c=e.tooltipAlignment,d=c===void 0?o("WAWebTooltip.react").PopoverAlignment.Center:c,f=e.type,y=f===void 0?"text":f,C=e.disabled,b=C===void 0?!1:C,S=e.theme,R=e.action,L=e.testid,E=e.tabIndex,k=e.addSpacing,I=k===void 0?!1:k,T=e.ariaLabel,D=e.selected,x=D===void 0?!1:D,$=e.pillText,P=e.showTooltipOnOverflow,N=P===void 0?!1:P,M=e.fixedHeight,w=M===void 0?!0:M,A=_(!1),F=A[0],O=A[1],B=_(!1),W=B[0],q=B[1],U=p(),V=p(null),H=r("useWAWebUIM")(),G=function(){if(U.current==null)return!1;var e=U.current.style.overflow;(!e||e==="visible")&&(U.current.style.overflow="hidden");var t=U.current.clientWidth<U.current.scrollWidth||U.current.clientHeight<U.current.scrollHeight;return U.current.style.overflow=e,t},z;if(i!=null||G()&&N){var j,K=s,Q=d;i!=null?j=i:i==null&&o("WAWebL10NFbtTypeUtils").isStringOrFbt(a)&&G()&&(j=a,K=o("WAWebTooltip.react").PopoverPosition.Bottom),z=m.jsx(o("WAWebTooltip.react").WAWebHoverTooltip,{targetRef:V,position:K,alignment:Q,buffer:8,children:j})}var X=function(t){var e=R(t)===!1;e||H&&H.requestDismiss()},Y=function(){O(!0)},J=function(){O(!1)},Z=function(){q(!0)},ee=function(){q(!1)},te=function(t){X(t)},ne=function(t){t.repeat||X(t)},re=o("WAWebL10NFbtTypeUtils").isStringOrFbt(a)||I?m.jsxs("div",{ref:U,className:o("WAWebClassnames").classnamesConvertMeToStylexPlease(r("WAWebDropdownItem.scss").ellipsify,r("WAWebDropdownItem.scss").action,(t={},t[r("WAWebDropdownItem.scss").compact]=S===g.Compact,t[r("WAWebDropdownItem.scss").fixedHeight]=w,t.xti2d7y=b,t),(u||(u=r("stylex")))(e.xstyle)),"aria-label":T!=null?T:a,children:[a,x&&m.jsx(o("WAWebCheckmarkIcon.react").CheckmarkIcon,{className_DONOTUSE:r("WAWebDropdownItem.scss").checkmark,xstyle:h.checkmarkIcon}),$!=null?m.jsx(o("WAWebPill.react").Pill,{inline:!0,children:$}):null]}):a,oe={enter:ne,space:ne},ae=F||W,ie=o("WAWebClassnames").classnamesConvertMeToStylexPlease((n={},n[r("WAWebDropdownItem.scss").hover]=ae&&S!==g.Negative,n[r("WAWebDropdownItem.scss").text]=y==="text"||y==="attach-menu-popup"||y==="newsletter-wamo-message-type",n[r("WAWebDropdownItem.scss").emoji]=y==="emoji"||y==="emoji-grid"||y==="emoji-preview",n[r("WAWebDropdownItem.scss").emojiGrid]=y==="emoji-grid",n[r("WAWebDropdownItem.scss").emojiPreview]=y==="emoji-preview",n[r("WAWebDropdownItem.scss").icon]=y==="icon",n[r("WAWebDropdownItem.scss").disabled]=b||S===g.Muted,n[r("WAWebDropdownItem.scss").item]=!0,n[r("WAWebDropdownItem.scss").shortcut]=!0,n[r("WAWebDropdownItem.scss").attachMenuPopup]=y==="attach-menu-popup",n[r("WAWebDropdownItem.scss").defaultRefreshed]=!0,n[r("WAWebDropdownItem.scss").negative]=S===g.Negative&&ae,n[r("WAWebDropdownItem.scss").itemMaterial]=!0,n),y==="newsletter-wamo-message-type"&&"xyi3aci xwf5gio x1p453bz x1suzm8a"),le=b?{}:{handlers:oe,onContextMenu:v,onMouseDown:v,onClick:te,onMouseEnter:Y,onMouseLeave:J,onFocus:Z,onBlur:ee};return m.jsxs(o("WAWebKeyboardHotKeys.react").HotKeys,babelHelpers.extends({ref:V,component:"li",className:ie,xstyle:W&&o("WDSFocusStateStyles").WDSFocusStateStyles.genericFocusPersistent,"data-animate-dropdown-item":!0,"data-testid":void 0,tabIndex:E!=null?E:0,role:b?void 0:"button"},le,{children:[re,z]}))}y.displayName=y.name+" [from "+i.id+"]";function C(e){var t=e.action,n=e.children,a=e.disabled,i=e.icon,l=e.testid,s=e.theme,c=e.tooltip,d=e.xstyle;return m.jsx("div",babelHelpers.extends({},{0:{},1:{className:"xti2d7y x1h6gzvc"}}[(a===!0)<<0],{children:m.jsx(y,{testid:void 0,action:a===!0?r("WAWebNoop"):t,tooltip:c,theme:s,children:m.jsxs(o("WAWebFlex.react").FlexRow,{align:"center",xstyle:f.container,children:[m.jsx(o("WAWebFlex.react").FlexRow,{justify:"center",xstyle:[f.icon,o("WAWebUISpacing").uiMargin.start8,o("WAWebUISpacing").uiMargin.end10,d],children:i}),m.jsx("span",babelHelpers.extends({},(u||(u=r("stylex"))).props(f.text,o("WAWebUISpacing").uiMargin.end24,d),{children:n}))]})})}))}C.displayName=C.name+" [from "+i.id+"]";function b(t){var n=t.icon,r=babelHelpers.objectWithoutPropertiesLoose(t,e);return n?m.jsx(C,{action:r.action,disabled:r.disabled,icon:n,testid:void 0,tooltip:r.tooltip,theme:r.theme,xstyle:r.xstyle,children:r.children}):m.jsx(y,babelHelpers.extends({},r,{children:r.children}))}b.displayName=b.name+" [from "+i.id+"]";function v(e){e.preventDefault()}l.DropdownItemThemeType=g,l.DropdownItem=b}),98);
__d("WAWebE2ETestPairingConstants",[],(function(t,n,r,o,a,i){var e="jest_e2e_pairing_attempt_ongoing",l="jest_e2e_first_read_done";i.PAIRING_ATTEMPT_ONGOING_KEY=e,i.FIRST_QRCODE_READ_DONE=l}),66);
__d("WAWebE2eMessageSendWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumAddressingMode","WAWebWamEnumAgentEngagementEnumType","WAWebWamEnumBotType","WAWebWamEnumDeviceType","WAWebWamEnumE2eCiphertextType","WAWebWamEnumE2eDestination","WAWebWamEnumE2eDeviceType","WAWebWamEnumE2eFailureReason","WAWebWamEnumEditType","WAWebWamEnumEncryptionTypeCode","WAWebWamEnumGroupEncryptionType","WAWebWamEnumInvisibleMessageCategoryType","WAWebWamEnumMediaType","WAWebWamEnumMessageDistributionEnumType","WAWebWamEnumRevokeType","WAWebWamEnumTypeOfGroupEnum"],(function(t,n,r,o,a,i,l){var e,s=(e=o("WAWebWamCodegenUtils")).defineEvents({E2eMessageSend:[476,{agentEngagementType:[15,o("WAWebWamEnumAgentEngagementEnumType").AGENT_ENGAGEMENT_ENUM_TYPE],botType:[17,o("WAWebWamEnumBotType").BOT_TYPE],e2eBackfill:[18,e.TYPES.BOOLEAN],e2eCiphertextType:[5,o("WAWebWamEnumE2eCiphertextType").E2E_CIPHERTEXT_TYPE],e2eCiphertextVersion:[6,e.TYPES.INTEGER],e2eDestination:[4,o("WAWebWamEnumE2eDestination").E2E_DESTINATION],e2eFailureReason:[2,o("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON],e2eReceiverDeviceType:[19,o("WAWebWamEnumE2eDeviceType").E2E_DEVICE_TYPE],e2eReceiverType:[8,o("WAWebWamEnumDeviceType").DEVICE_TYPE],e2eSuccessful:[1,e.TYPES.BOOLEAN],editType:[14,o("WAWebWamEnumEditType").EDIT_TYPE],encRetryCount:[9,e.TYPES.INTEGER],encryptionType:[23,o("WAWebWamEnumEncryptionTypeCode").ENCRYPTION_TYPE_CODE],groupEncryptionState:[22,o("WAWebWamEnumGroupEncryptionType").GROUP_ENCRYPTION_TYPE],invisibleMessageCategory:[21,o("WAWebWamEnumInvisibleMessageCategoryType").INVISIBLE_MESSAGE_CATEGORY_TYPE],isLid:[12,e.TYPES.BOOLEAN],isPq:[25,e.TYPES.BOOLEAN],isSimpleSignal:[24,e.TYPES.BOOLEAN],localAddressingMode:[16,o("WAWebWamEnumAddressingMode").ADDRESSING_MODE],messageDistributionType:[20,o("WAWebWamEnumMessageDistributionEnumType").MESSAGE_DISTRIBUTION_ENUM_TYPE],messageIsInvisible:[10,e.TYPES.BOOLEAN],messageMediaType:[7,o("WAWebWamEnumMediaType").MEDIA_TYPE],retryCount:[3,e.TYPES.INTEGER],revokeType:[11,o("WAWebWamEnumRevokeType").REVOKE_TYPE],typeOfGroup:[13,o("WAWebWamEnumTypeOfGroupEnum").TYPE_OF_GROUP_ENUM]},[1,20,20],"regular"]},{E2eMessageSend:[]});l.E2eMessageSendWamEvent=s}),98);
__d("WAWebEditMessageSendWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumEditType","WAWebWamEnumMediaType","WAWebWamEnumMessageType","WAWebWamEnumTypeOfGroupEnum"],(function(t,n,r,o,a,i,l){var e,s=(e=o("WAWebWamCodegenUtils")).defineEvents({EditMessageSend:[3990,{editDuration:[1,e.TYPES.INTEGER],editType:[2,o("WAWebWamEnumEditType").EDIT_TYPE],mediaType:[8,o("WAWebWamEnumMediaType").MEDIA_TYPE],messageSendResultIsTerminal:[3,e.TYPES.BOOLEAN],messageType:[4,o("WAWebWamEnumMessageType").MESSAGE_TYPE],resendCount:[5,e.TYPES.INTEGER],retryCount:[6,e.TYPES.INTEGER],typeOfGroup:[9,o("WAWebWamEnumTypeOfGroupEnum").TYPE_OF_GROUP_ENUM]},[1,1,1],"regular"]},{EditMessageSend:[]});l.EditMessageSendWamEvent=s}),98);
__d("WAWebEmojiAssetLoaderCompletionTracker",["WALogger","WAWebAssetLoaderSingleton","react"],(function(t,n,r,o,a,i,l){var e,s,u=(s||(s=o("react"))).createContext,c=1e3,d=5e3,m=function(){var t=this;this.$1=0,this.$2=!1,this.$3=!1,this.beginPreload=function(e){e===void 0&&(e=!1),!t.$2&&(t.$2=!0,self.setTimeout(function(){o("WAWebAssetLoaderSingleton").AssetLoader.loadEmojis()},e?c:0))},this.beginPreloadFallback=function(){self.setTimeout(function(){t.beginPreload(!1)},d)},this.incrementLoadingEmojisCount=function(){t.$2||(t.$3||(t.$3=!0,t.$4=self.performance.now()),t.$1+=1)},this.decrementLoadingEmojisCount=function(){t.$2||(t.$1-=1,t.$1===0&&t.$3&&(t.beginPreload(!0),o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["EmojiCompletionTracker:firstScreenEmojis complete in "," ms"])),Math.ceil(self.performance.now()-t.$4))))}},p=new m,_=u(p);l.EmojiCompletionTracker=m,l.emojiCompletionTracker=p,l.InitialEmojisCompletionContext=_}),98);
__d("WAWebWebcImgErrorWamEvent",["WAWebWamCodegenUtils"],(function(t,n,r,o,a,i,l){var e=o("WAWebWamCodegenUtils").defineEvents({WebcImgError:[1700,{webcImgErrorCode:[1,o("WAWebWamCodegenUtils").TYPES.NUMBER]},[1,1,1],"regular"]},{WebcImgError:[]});l.WebcImgErrorWamEvent=e}),98);
__d("WAWebImgRetry",["Promise","WAAbortError","WALogger","WAPromiseTimeout","WAWebMiscErrors","WAWebWebcImgErrorWamEvent","WAWebXHR"],(function(t,n,r,o,a,i,l){var e,s,u,c=3e4,d=(function(){function t(e,t,n,r){this.src=e,this.crossOrigin=t,this.noXHR=n,this.hasPrivacyChecks=r,this.generation=0,this.refCount=0,this.inProgress=!1}var a=t.prototype;return a.key=function(){var e=this.crossOrigin?"Y":"N",t=this.noXHR?"Y":"N";return"co:"+e+",noXHR:"+t+",src:"+this.src},a.sendXHR=function(){var t=this;if(this.noXHR)return(u||(u=n("Promise"))).resolve(!0);var a=this.src;this.inProgress=!0;var i=new AbortController,l=o("WAPromiseTimeout").promiseTimeout(r("WAWebXHR").get(a,void 0,void 0,i.signal),c,"ImgRetryTimeout");return this.$1={promise:l,controller:i},this.$1.promise.then(function(t){var n=t.status;if(n>=200&&n<400)return!0;if(n>=500){o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["Img:Retry "," failed with error code ",". Retrying."])),a,n);var r=new(o("WAWebWebcImgErrorWamEvent")).WebcImgErrorWamEvent({webcImgErrorCode:n});return r.commit(),!1}o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["Img:Retry "," failed with error code ",". Not retrying."])),a,n);var i=new(o("WAWebWebcImgErrorWamEvent")).WebcImgErrorWamEvent({webcImgErrorCode:n});throw i.commit(),new(o("WAWebMiscErrors")).ServerStatusError(null,a,n)}).catch(function(e){if(e instanceof o("WAWebMiscErrors").ServerStatusError||e.name===o("WAAbortError").ABORT_ERROR)throw e;return!1}).finally(function(){t.inProgress=!1})},a.release=function(){return this.refCount--,this.refCount<=0?(this.$1&&this.$1.controller.abort(),!0):!1},a.shouldRetain=function(){return this.refCount>0},t})();l.default=d}),98);
__d("WAWebImgRetryQueue",["Promise","WAAbortError","WABackoffUtils","WANullthrows","WAPromiseRaceAbort","WAResolvable","WAWebIdleTaskRunner","WAWebMiscErrors","WAWebNetworkStatus","WAWebNoop"],(function(t,n,r,o,a,i,l){var e,s=20,u=10,c=(function(){function t(){this.$1=new Map,this.$2=new Map,this.$3=0}t.maxInProgressRetry=function(){return s};var a=t.prototype;return a.enqueue=function(r){var t=this.$1.get(r.key());if(t){if(r.hasPrivacyChecks!==t.hasPrivacyChecks){var a="Img:hasPrivacyChecks shouldn't change "+r.key();return(e||(e=n("Promise"))).reject(a)}return t.refCount++,t.deferred.promise}return r.deferred=new(o("WAResolvable")).Resolvable,r.refCount++,this.$5(r),r.deferred.promise},a.remove=function(t){var e=t.key();this.$1.delete(e);var n=this.$2.get(e);n&&(n.controller.abort(),this.$2.delete(e))},a.$5=function(t){var e=this,n=t.generation;if(t.generation++,n>u){var a="Stop retrying "+t.src+" after "+u+" times";throw new(o("WAWebMiscErrors")).GaveUpRetry(a)}var i=t.key();if(n===0)this.$1.set(i,t),this.$6();else{var l=new AbortController,s=l.signal,c=r("WAPromiseRaceAbort")(o("WABackoffUtils").expDelaySec(n,60,0),s).catch(o("WAAbortError").catchAbort(r("WAWebNoop")));this.$2.set(t.key(),{promise:c,controller:l}),c.then(function(){e.$2.delete(i),s.aborted||e.$1.set(i,t),e.$6()})}},a.$6=function(){var e=this;this.$4||(this.$4=r("WAWebNetworkStatus").waitIfOffline().then(function(){e.$4=null,o("WAWebIdleTaskRunner").UIBusyTasks.enqueue(function(){e.$7()})}))},a.$7=function(){for(var e=this.$1.values(),n;(n=e.next())&&!n.done&&!(this.$3>t.maxInProgressRetry());){var o=n.value;this.$8(r("WANullthrows")(o))}},a.$8=function(t){var e=this;if(!t.inProgress){if(t.deferred.resolveWasCalled()){this.$1.delete(t.key());return}this.$3++,t.sendXHR().then(function(n){e.$1.delete(t.key()),n?t.deferred.resolve():t.shouldRetain()&&e.$5(t)}).catch(function(n){e.$1.delete(t.key()),t.deferred.reject(n)}).finally(function(){e.$3--})}},t})();l.default=c}),98);
__d("WAWebImg.react",["WAAbortError","WAFilteredCatch","WAWebConstantsDeprecated","WAWebCopyPasteSelectable.react","WAWebImgRetry","WAWebImgRetryQueue","WAWebMiscErrors","WAWebNoop","WAWebURLUtils","react","useMergeRefs","useWAWebUnmountSignal"],(function(t,n,r,o,a,i,l){var e=["ref"],s,u,c=u||(u=o("react")),d=s||(s=r("react")),m=c.useEffect,p=c.useRef,_=c.useState,f=new(r("WAWebImgRetryQueue"));function g(t){var n=t.ref,a=babelHelpers.objectWithoutPropertiesLoose(t,e),i=a.alt,l=a.className,s=a.crossOrigin,u=s===void 0?!0:s,c=a.draggable,g=a.onClick,C=a.onMouseMove,b=a.onFocus,v=a.onBlur,S=a.plainText,R=a.selectable,L=a.style,E=a.renderLoading,k=a.renderError,I=a.disableContextMenu,T=I===void 0?!1:I,D=a.noXHR,x=D===void 0?!1:D,$=a.hasPrivacyChecks,P=$===void 0?!0:$,N=a.onError,M=a.onLoad,w=p(null),A=r("useMergeRefs")(n,w),F=p(null),O=_(a.src),B=O[0],W=O[1],q=_(!0),U=q[0],V=q[1],H=_(null),G=H[0],z=H[1],j=_(!0),K=j[0],Q=j[1],X=r("useWAWebUnmountSignal")();a.src!==B&&(W(a.src),V(!0));var Y=function(t){T&&t.preventDefault()},J=function(t){if(V(!1),!B||!y(B)){z(t.error);return}var e=F.current,n;if(e)if(h(e,a)){if(!e.noXHR)return;n=e}else{var i=e.release();i&&f.remove(e),n=new(r("WAWebImgRetry"))(B,u,x,P)}else n=new(r("WAWebImgRetry"))(B,u,x,P);F.current=n;var l=f.enqueue(n);l.then(function(){n===n&&(X.aborted||V(!0))}).catch(o("WAFilteredCatch").filteredCatch([o("WAWebMiscErrors").ServerStatusError,o("WAWebMiscErrors").GaveUpRetry],function(e){n===n&&(X.aborted||(V(!1),z(e),N&&N(e)))})).catch(o("WAFilteredCatch").filteredCatch(o("WAWebMiscErrors").Unmount,r("WAWebNoop"))).catch(o("WAAbortError").catchAbort(r("WAWebNoop")))},Z=function(t){if(t.target instanceof HTMLImageElement){var e=w.current;e!=null&&e.complete&&(e.style.visibility="visible"),M&&M(t),Q(!1)}};if(m(function(){if(B){var e=w.current;return e&&!e.complete&&(e.style.visibility="hidden"),function(){var e=F.current;if(e){var t=e.release();t&&f.remove(e)}}}},[B]),G&&k)return k(G);var ee=!!(U&&B);return d.jsxs(d.Fragment,{children:[d.jsx(o("WAWebCopyPasteSelectable.react").SelectableImg,{onFocus:b,onBlur:v,ref:A,plainText:S||"",selectable:!!R,crossOrigin:u?"anonymous":void 0,onError:ee?J:r("WAWebNoop"),onLoad:ee?Z:r("WAWebNoop"),src:ee&&B!=null?B:r("WAWebConstantsDeprecated").ONE_BY_ONE_TRANS_GIF,alt:i,className:l,draggable:c,onClick:g,onMouseMove:C,style:L,onContextMenu:Y,"data-testid":void 0}),K&&(E==null?void 0:E())]})}g.displayName=g.name+" [from "+i.id+"]";function h(e,t){return e.src===t.src&&e.crossOrigin===t.crossOrigin&&e.noXHR===t.noXHR&&e.hasPrivacyChecks===t.hasPrivacyChecks}function y(e){return e[0]==="/"||r("WAWebURLUtils").isHttp(e)}l.default=g}),98);
__d("WAWebEmoji.react",["WAWebAssetLoader","WAWebAssetLoaderSingleton","WAWebClassnames","WAWebEmoji","WAWebEmojiAssetLoaderCompletionTracker","WAWebImg.react","WDSFocusStateStyles","react","stylex","useWAWebFocusState"],(function(t,n,r,o,a,i,l){var e,s,u,c=u||(u=o("react")),d=e||(e=r("react")),m=c.useContext,p=c.useEffect;function _(e){var t=m(o("WAWebEmojiAssetLoaderCompletionTracker").InitialEmojisCompletionContext),n=r("useWAWebFocusState")(),a=n[0],i=n[1];p(function(){var n=o("WAWebEmoji").EmojiUtil.getGlyphId(e.emoji);n!=null&&(t.incrementLoadingEmojisCount(),o("WAWebAssetLoaderSingleton").AssetLoader.loadEmoji(n,o("WAWebAssetLoader").LOAD_PRIORITY.LAZY_LOAD_EMOJI).finally(function(){t.decrementLoadingEmojisCount()}))},[t,e.emoji]);var l=e.DEPRECATED_className,u=e.element,c=e.emoji,_=e.selectable,f=e.selected,g=e.size,h=e.src,y=e.onLoad,C=e.tabIndex,b=e.xstyle,v=o("WAWebEmoji").EmojiUtil.getGlyphId(c);if(v==null)return null;var S,R;h||(S=o("WAWebEmoji").EmojiUtil.getStyle(v,g),R=o("WAWebEmoji").EmojiUtil.getCssClasses(v,g));var L=o("WAWebClassnames").classnamesConvertMeToStylexPlease(l,R),E=[b,f===!0||i===!0?o("WDSFocusStateStyles").WDSFocusStateStyles.genericFocusPersistent:void 0];return u==="span"?d.jsx("span",{role:"button",ref:a,id:e["data-emoji-index"],"data-testid":void 0,"data-emoji":c,className:L+" "+(s||(s=r("stylex")))(E),"aria-label":c,style:S,onLoad:y,tabIndex:C,"data-unicode":e["data-unicode"],"data-variant":e["data-variant"],"data-emoji-index":e["data-emoji-index"]}):d.jsx(r("WAWebImg.react"),{ref:a,alt:c,className:L+" "+(s||(s=r("stylex")))(E),draggable:!1,onLoad:y,plainText:c,selectable:_,style:S,src:h,onClick:e.onClick,testid:void 0})}_.displayName=_.name+" [from "+i.id+"]",l.default=_}),98);
__d("getPlatformByGK",["gkx"],(function(t,n,r,o,a,i,l){"use strict";var e=r("gkx")("6470")?"android":r("gkx")("6488")?"ios":"wa_web",s=r("gkx")("6470")?"android":r("gkx")("6488")?"iOS":navigator.userAgent.includes("Mac OS X")?"macWeb":"windowsWeb";function u(){return e}l.getPlatformByGK=u,l.FLOWS_PLATFORM=e,l.WDS_PLATFORM=s}),98);
__d("WAWebKeyboardConstants",[],(function(t,n,r,o,a,i){var e={UNIDENTIFIED:"Unidentified",ALT:"Alt",ALT_GRAPH:"AltGraph",CAPS_LOCK:"CapsLock",CONTROL:"Control",FN:"Fn",FN_LOCK:"FnLock",HYPER:"Hyper",META:"Meta",NUM_LOCK:"NumLock",SCROLL_LOCK:"ScrollLock",SHIFT:"Shift",SUPER:"Super",SYMBOL:"Symbol",SYMBOL_LOCK:"SymbolLock",OS:"OS",ENTER:"Enter",TAB:"Tab",SPACE:" ",ARROW_DOWN:"ArrowDown",ARROW_LEFT:"ArrowLeft",ARROW_RIGHT:"ArrowRight",ARROW_UP:"ArrowUp",LEFT:"Left",RIGHT:"Right",UP:"Up",DOWN:"Down",END:"End",HOME:"Home",PAGE_DOWN:"PageDown",PAGE_UP:"PageUp",BACKSPACE:"Backspace",CLEAR:"Clear",COPY:"Copy",CR_SEL:"CrSel",CRSEL:"Crsel",CUT:"Cut",DELETE:"Delete",ERASE_EOF:"EraseEof",EX_SEL:"ExSel",EXSEL:"Exsel",INSERT:"Insert",PASTE:"Paste",REDO:"Redo",UNDO:"Undo",ESCAPE:"Escape"};i.KEYBOARD_EVENT_KEY_VALUE=e}),66);
__d("WAWebToastManager",["$InternalEnum","WAWebEventEmitter"],(function(t,n,r,o,a,i,l){var e=n("$InternalEnum").Mirrored(["LEFT","CENTER","RIGHT"]),s=(function(e){function t(){return e.apply(this,arguments)||this}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.open=function(t,n){this.trigger("open_toast",t,n)},n.close=function(t){this.trigger("close_toast",t)},t})(r("WAWebEventEmitter")),u=new s;l.ToastPosition=e,l.ToastManager=u}),98);
__d("useLazyRef",["react"],(function(t,n,r,o,a,i,l){var e,s=(e||(e=o("react"))).useRef,u={};function c(e){var t=s(u);return t.current===u&&(t.current=e()),t}l.default=c}),98);
__d("WAWebToast.react",["WAWebAccessibility.react","WAWebFbtCommon","WAWebFocusTracer","WAWebKeyboardConstants","WAWebKeyboardTabUtils","WAWebToastManager","WAWebUISpacing","WAWebXAltIcon.react","WDSFocusStateStyles","react","stylex","uniqueID","useLazyRef","useWAWebTimeout"],(function(t,n,r,o,a,i,l){var e=["ref"],s,u,c,d=c||(c=o("react")),m=s||(s=r("react")),p=d.useEffect,_=d.useImperativeHandle,f=d.useRef,g=4e3,h={btnSuccess:{color:"x1du590y",fontWeight:"x117nqv4",$$css:!0},button:{color:"x17daq4n",cursor:"x1ypdohk",fontSize:"x1f6kntn",lineHeight:"x1evy7pa",flexShrink:"x2lah0s",":focus-visible_borderStartStartRadius":"xfuo7wg",":focus-visible_borderStartEndRadius":"xepj7l6",":focus-visible_borderEndEndRadius":"x1911790",":focus-visible_borderEndStartRadius":"xpxzo57",$$css:!0},close:{color:"xil0kgl",":focus-visible_borderStartStartRadius":"xfuo7wg",":focus-visible_borderStartEndRadius":"xepj7l6",":focus-visible_borderEndEndRadius":"x1911790",":focus-visible_borderEndStartRadius":"xpxzo57",$$css:!0},right:{insetInlineEnd:"xtijo5x",left:null,right:null,$$css:!0},toast:{alignItems:"x6s0dn4",backgroundColor:"x1e6sl3u",borderStartStartRadius:"x2yqj0j",borderStartEndRadius:"x1u1eq46",borderEndEndRadius:"x1fxmhz6",borderEndStartRadius:"xr2wkf5",color:"x17t9dm2",display:"x78zum5",fontSize:"x1f6kntn",lineHeight:"x1evy7pa",$$css:!0}};function y(e){return e===void 0&&(e=""),r("uniqueID")(e||"toast")}function C(t){var n,a=t.ref,i=babelHelpers.objectWithoutPropertiesLoose(t,e),l=i.msg,s=i.action,u=i.duration,c=u===void 0?g:u,d=i.visibile,p=d===void 0?!0:d,f=r("useLazyRef")(function(){return y()}).current,h=(n=i.id)!=null?n:f,C=o("useWAWebTimeout").useTimeout(function(){o("WAWebToastManager").ToastManager.close(h)},c,{immediate:!0}),v=C[0],R=function(){o("WAWebToastManager").ToastManager.close(h)};if(_(a,function(){return{restartDelay:v}}),!p)return m.jsx(o("WAWebAccessibility.react").InvisibleAnnouncement,{text:l,assertive:!0});var L;if(s){var E=Array.isArray(s)?s:[s];L=E.map(function(e,t){return m.jsx(b,{buttonText:e.actionText,onClick:e.dismiss===!0?R:e.onAction,theme:e.theme},e.actionText.toString()+t)})}return m.jsx(S,{actionText:l,actionButtons:L})}C.displayName=C.name+" [from "+i.id+"]";function b(e){var t=e.buttonText,n=e.onClick,a=e.ref,i=e.theme;return m.jsx("button",babelHelpers.extends({},(u||(u=r("stylex"))).props(h.button,o("WDSFocusStateStyles").WDSFocusStateStyles.genericFocus,o("WAWebUISpacing").uiMargin.start15,i==="success"&&h.btnSuccess),{onClick:n,ref:a,children:t}))}b.displayName=b.name+" [from "+i.id+"]";function v(e){var t=e.buttonText,n=e.onClick,a=e.ref;return m.jsx("button",babelHelpers.extends({},(u||(u=r("stylex"))).props(o("WDSFocusStateStyles").WDSFocusStateStyles.genericFocus,h.close,o("WAWebUISpacing").uiMargin.start15),{onClick:n,"aria-label":r("WAWebFbtCommon")("Close"),ref:a,children:m.jsx(o("WAWebXAltIcon.react").XAltIcon,{})}))}v.displayName=v.name+" [from "+i.id+"]";function S(e){var t=e.actionButtons,n=e.actionText,a=e.dismissButton,i=e.focusButtonRef,l=e.toastPosition;p(function(){var e=i==null?void 0:i.current;e instanceof HTMLButtonElement&&e.focus()},[n,i]);var s=f(null),c=function(t){if(t.key===o("WAWebKeyboardConstants").KEYBOARD_EVENT_KEY_VALUE.TAB){var e=s.current;if(e!=null&&e.contains(document.activeElement)){var n=o("WAWebKeyboardTabUtils").getNextTabbableElement(e,t.shiftKey?o("WAWebKeyboardTabUtils").TabDirection.BACKWARD:o("WAWebKeyboardTabUtils").TabDirection.FORWARD,o("WAWebKeyboardTabUtils").FocusType.TABBABLE);n!=null&&(t.stopPropagation(),t.preventDefault(),r("WAWebFocusTracer").focus(n))}}};return m.jsxs("div",babelHelpers.extends({},(u||(u=r("stylex"))).props(h.toast,o("WAWebUISpacing").uiPadding.vert12,o("WAWebUISpacing").uiPadding.horiz16,l==="RIGHT"&&h.right),{ref:s,tabIndex:0,onKeyDown:c,"data-testid":void 0,children:[n,t,a,m.jsx(o("WAWebAccessibility.react").InvisibleAnnouncement,{text:n,assertive:!0})]}))}S.displayName=S.name+" [from "+i.id+"]";function R(e){var t=e.msg,n=e.action,a=y(),i=null;o("WAWebToastManager").ToastManager.open(m.jsx(C,{id:a,msg:t,action:{actionText:r("WAWebFbtCommon")("Undo"),onAction:function(){i&&(window.clearTimeout(i),i=null,o("WAWebToastManager").ToastManager.close(a))}}})),i=window.setTimeout(function(){n()},g)}l.genId=y,l.Toast=C,l.ToastActionBtn=b,l.ToastDismissBtn=v,l.ToastBody=S,l.openUndoToast=R}),98);
__d("WAWebErrorBoundary.react",["WALogger","WAWebButton.react","WAWebCmd","WAWebFlex.react","WAWebModal.react","WAWebModalManager","WAWebText.react","WAWebToast.react","WAWebToastManager","WAWebUISpacing","WAWebUnstyledButton.react","asyncToGeneratorRuntime","gkx","react","stylex"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m=d||(d=r("react")),p=(u||(u=o("react"))).PureComponent,_={redBox:{height:"x5yr21d",width:"xh8yej3",display:"x78zum5",justifyContent:"xl56j7k",alignItems:"x6s0dn4",textAlign:"x2b8uid",backgroundColor:"x76b9fu",color:"xfungia",pointerEvents:"x71s49j",flexDirection:"xdt5ytf",cursor:"x1ypdohk",$$css:!0},codeContainer:{whiteSpace:"x126k92a",backgroundColor:"x1qbu5l5",fontSize:"x190qgfh",height:"xqt63rz",overflowX:"xw2csxc",overflowY:"x1odjw0f",$$css:!0}};function f(e){var t=e.boundaryName,a=e.error,i=a!=null?a:{},l=i.stack,s=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){l!=null&&(yield navigator.clipboard.writeText(l),o("WAWebToastManager").ToastManager.open(m.jsx(o("WAWebToast.react").Toast,{msg:"Stack copied"})))});return function(){return e.apply(this,arguments)}})(),u=function(){var e="Uncaught render error at "+t;o("WAWebCmd").Cmd.trigger("trigger_bugreport_v2",e)};return m.jsx(o("WAWebModal.react").Modal,{title:"Error stack from "+t,type:o("WAWebModal.react").ModalTheme.Multiline,children:l!=null?m.jsxs(m.Fragment,{children:[m.jsx("div",babelHelpers.extends({},(c||(c=r("stylex"))).props([_.codeContainer,o("WAWebUISpacing").uiPadding.all10]),{children:m.jsx("code",{children:l})})),m.jsxs("div",babelHelpers.extends({},(c||(c=r("stylex"))).props(o("WAWebUISpacing").uiPadding.vert10),{children:[m.jsx(o("WAWebText.react").WAWebTextSmall,{xstyle:o("WAWebUISpacing").uiPadding.bottom10,children:"Check the console for more information"}),m.jsxs(o("WAWebFlex.react").FlexRow,{columnGap:8,justify:"end",marginTop:16,children:[m.jsx(o("WAWebButton.react").WAWebButtonSecondary,{onClick:s,children:"Copy error stack"}),m.jsx(o("WAWebButton.react").WAWebButtonSecondary,{onClick:u,children:"Report this bug"})]})]}))]}):"No error stack found, check console"})}f.displayName=f.name+" [from "+i.id+"]";function g(e){var t=e.boundaryName,n=e.handleClick;if(!r("gkx")("26258"))return m.jsxs(r("WAWebUnstyledButton.react"),{xstyle:_.redBox,onClick:n,testid:void 0,children:["Uncaught error at ",t," [Click for more info]"]})}g.displayName=g.name+" [from "+i.id+"]";var h=(function(t){function n(){for(var e,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return e=t.call.apply(t,[this].concat(r))||this,e.state={error:null},e.$1=function(){o("WAWebModalManager").ModalManager.open(m.jsx(f,{error:e.state.error,boundaryName:e.props.name}))},babelHelpers.assertThisInitialized(e)||babelHelpers.assertThisInitialized(e)}babelHelpers.inheritsLoose(n,t),n.getDerivedStateFromError=function(t){return{error:t}};var r=n.prototype;return r.componentDidCatch=function(n,r){var t=this.props,a=t.sendLogs,i=a===void 0?!0:a,l=t.type;if(i===!0){this.props.description!=null&&o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[ErrorBoundary][","] description: ",""])),this.props.name,this.props.description);var u=l==="fatal"?{sendLogsType:o("WALogger").SendLogsType.EXTREMELY_BAD_USER_EXPERIENCE_SAD}:{};o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["","\n","\n",""],["","\\n","\\n",""])),n,n.stack,r.componentStack).sendLogs("[ErrorBoundary]["+this.props.name+"] "+n.message,u).tags("error-boundary")}},r.render=function(){var e,t=this.state.error,n=this.props.fallback,r=n===void 0?g:n;return t!=null?m.jsx(r,{boundaryName:this.props.name,handleClick:this.$1}):(e=this.props.children)!=null?e:null},n})(p);l.ErrorBoundary=h}),98);
__d("WAWebFbtIntlList",["fbt","invariant","err","react"],(function(t,n,r,o,a,i,l,s,u){var e,c=e||(e=r("react")),d={AND:"AND",NONE:"NONE",OR:"OR"},m={BULLET:"BULLET",COMMA:"COMMA",SEMICOLON:"SEMICOLON"},p=500,_=function(t,n,r){var e=t.filter(Boolean),o=e.length;if(o===0)return"";if(o===1)return e[0];for(var a=e[o-1],i=e[0],l=0,u=1;u<o-1;++u){if(u>=p){l=o-u;break}switch(r){case m.SEMICOLON:i=s._(/*BTDS*/"{previous-items}; {following-items}",[s._param("previous-items",i),s._param("following-items",e[u])]);break;case m.BULLET:i=s._(/*BTDS*/"{previous-items} \u2022 {following-items}",[s._param("previous-items",i),s._param("following-items",e[u])]);break;default:i=s._(/*BTDS*/"{previous-items}, {following-items}",[s._param("previous-items",i),s._param("following-items",e[u])])}}return l>0?f(i,l,n||d.AND,r||m.COMMA):g(i,a,n||d.AND,r||m.COMMA)};function f(e,t,n,r){if(r===m.COMMA)switch(n){case d.AND:return s._(/*BTDS*/"{previous-items} y {overflow-item-count} m\u00e1s",[s._param("previous-items",e),s._param("overflow-item-count",t)]);case d.OR:return s._(/*BTDS*/"{previous-items} o {overflow-item-count} m\u00e1s",[s._param("previous-items",e),s._param("overflow-item-count",t)]);case d.NONE:return s._(/*BTDS*/"{previous-items}, {overflow-item-count} m\u00e1s",[s._param("previous-items",e),s._param("overflow-item-count",t)])}return s._(/*BTDS*/"{previous-items}\u2026",[s._param("previous-items",e)])}f.displayName=f.name+" [from "+i.id+"]";function g(e,t,n,o){switch(n){case d.AND:return s._(/*BTDS*/"{list-of-items} y {last-item}",[s._param("list-of-items",e),s._param("last-item",t)]);case d.OR:return s._(/*BTDS*/"{list-of-items} o {last-item}",[s._param("list-of-items",e),s._param("last-item",t)]);case d.NONE:switch(o){case m.SEMICOLON:return s._(/*BTDS*/"{previous-items}; {last-item}",[s._param("previous-items",e),s._param("last-item",t)]);case m.BULLET:return s._(/*BTDS*/"{list-of-items} \u2022 {last-item}",[s._param("list-of-items",e),s._param("last-item",t)]);default:return s._(/*BTDS*/"{list-of-items}, {last-item}",[s._param("list-of-items",e),s._param("last-item",t)])}default:throw r("err")("[intlList] Invalid conjunction "+n+" provided to intlList")}}_.DELIMITERS=m,_.CONJUNCTIONS=d;var h=_,y=h;l.default=y}),226);
__d("WAWebSWBusActions",[],(function(t,n,r,o,a,i){var e={REQUEST_STREAMING_INFO:"GET_STREAMING_INFO",REQUEST_RMR:"REQUEST_RMR",SEND_STREAMING_CHUNK:"SEND_STREAMING_CHUNK",EXP_BACKOFF:"EXP_BACKOFF",LOG:"LOG",UPLOAD_LOGS:"UPLOAD_LOGS",SET_L10N:"SET_L10N",STREAMING_SUPPORTED:"STREAMING_SUPPORTED",REMOVE_PP:"REMOVE_PP",LOGOUT:"LOGOUT",CLEAN_ASSETS:"CLEAN_ASSETS",ACTIVE_TAB:"ACTIVE_TAB",STOP_COMMS:"STOP_COMMS",HEARTBEAT:"HEARTBEAT",WAM_UPLOAD:"WAM_UPLOAD"},l=e;i.default=l}),66);
__d("WAWebSWBus",["Promise","WALogger","WAWebBuildConstants","WAWebNoop","WAWebSWBusActions","asyncToGeneratorRuntime","err"],(function(t,n,r,o,a,i,l){var e,s,u,c=[r("WAWebSWBusActions").HEARTBEAT],d=(function(){function e(t){var o=this;this.$1=function(t){if(!(!t.data||!t.data.action)){var a=t.data;if(!(!t.ports||t.ports.length===0)){var i=t.ports;if(!(!e.isSW()&&window.navigator.serviceWorker&&t.source!==window.navigator.serviceWorker.controller)){var l;typeof t.waitUntil=="function"?l=function(n){return t.waitUntil(n)}:l=r("WAWebNoop"),l((u||(u=n("Promise"))).resolve(o.requestHandler(a)).then(function(e){i[0].postMessage(e)}).catch(function(e){i[0].postMessage({error:e&&e.toString()})}))}}}},this.requestHandler=t}var t=e.prototype;return t.init=function(){var t=e.isSW()?self:window.navigator.serviceWorker;try{if(!t)return;t.addEventListener("message",this.$1)}catch(e){}},e.isSW=function(){return typeof window=="undefined"},e.getRequestor=function(r){if(e.isSW()){if(typeof r=="string")return self.clients.get(r)}else return window.navigator.serviceWorker?window.navigator.serviceWorker.ready.then(function(){return window.navigator.serviceWorker?window.navigator.serviceWorker.controller:null}):(u||(u=n("Promise"))).resolve(null);return(u||(u=n("Promise"))).resolve(r)},e.broadcast=(function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,o){if(!e.isSW())throw r("err")("Broadcast called from non-serviceworker.");var a=yield self.clients.matchAll();return a.length===0?(u||(u=n("Promise"))).reject(r("err")("No clients available.")):(u||(u=n("Promise"))).all(a.map(function(n){return e.request(n,t,o)}))});function o(e,n){return t.apply(this,arguments)}return o})(),e.request=function(a,i,l){var t,s=o("WAWebBuildConstants").VERSION_STR,c=new MessageChannel,d=new(u||(u=n("Promise")))(function(t,n){return c.port1.onmessage=function(e){var r;(r=e.data)!=null&&r.error?n(e.data.error):t(e.data)},e.getRequestor(a).then(function(e){if(!e)return n(r("err")("No ServiceWorker controlling this client."));e.postMessage({action:i,message:l,version:s},[c.port2])})});return d},e})();l.default=d}),98);
__d("WAWebFeatureDetectionSwSupport",["WAPromiseTimeout","WAWebEventEmitter","WAWebModernizr","WAWebSWBus","WAWebSWBusActions","WAWebUA"],(function(t,n,r,o,a,i,l){var e="Modernizr"in window,s=o("WAWebModernizr").getModernizr(),u=(function(t){function n(){var n;n=t.call(this)||this,n.supported=e?s.serviceworker:"serviceWorker"in navigator,n._checkAlive=function(){var e,t=(e=navigator.serviceWorker)==null?void 0:e.controller;return!!t},n._checkStreamingSupport=function(){var e;if(!n.supported||!n.alive||o("WAWebUA").UA.isSafari){n._streamingSupported=!1;return}if(n._streamingSupportedPromise)return n._streamingSupported;var t=(e=navigator.serviceWorker)==null?void 0:e.controller;t&&(n._streamingSupportedPromise=o("WAPromiseTimeout").promiseTimeout(r("WAWebSWBus").request(t,r("WAWebSWBusActions").STREAMING_SUPPORTED),100).catch(function(){return!1}).then(function(e){return delete n._streamingSupportedPromise,n.streamingSupported=e,e}))},n._setSupported=function(e){n.supported=e},e&&s.on("serviceworker",n._setSupported);var a=n;return Object.defineProperty(n,"streamingSupported",{get:function(){return a._checkStreamingSupport(),a._streamingSupported},set:function(t){t!==a._streamingSupported&&a.trigger("change:streamingSupported",t),a._streamingSupported=t}}),Object.defineProperty(n,"alive",{get:function(){return a._checkAlive()}}),n}return babelHelpers.inheritsLoose(n,t),n})(r("WAWebEventEmitter")),c=new u;l.default=c}),98);
__d("WAWebProfilePicPrivacyTokenGating",["WAWebABProps"],(function(t,n,r,o,a,i,l){function e(){return o("WAWebABProps").getABPropConfigValue("profile_scraping_privacy_token_in_photo_iq")}l.isProfilePicIQPrivacyTokenEnabled=e}),98);
__d("WAWebGetProfilePicJob",["Promise","WAJids","WALogger","WASmaxProfilePictureGetRPC","WAWebBackendErrors","WAWebProfilePicPrivacyTokenGating","WAWebWidToJid","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u,c;function d(e,t){return m.apply(this,arguments)}function m(){return m=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,r){if(t.isStatus()||t.isBroadcast())return o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["getProfilePic failed with an invalid WID: ",""])),t.toString()).verbose(),(c||(c=n("Promise"))).reject(new(o("WAWebBackendErrors")).ServerStatusCodeError(401,"getProfilePic failed with an invalid WID: "+t.toString()));var a=r.preview,i=a===void 0?!0:a,l=r.invite,d=r.photoId,m=r.tcToken,f=r.commonGid,g=yield o("WASmaxProfilePictureGetRPC").sendGetRPC({iqTarget:o("WAWebWidToJid").widToChatJid(t),pictureType:i?"preview":"image",pictureId:d!=null?String(d):void 0,pictureQuery:"url",pictureInvite:l,tCTokenMixinArgs:p(m),pictureCommonGid:_(f)});switch(g.name){case"GetResponseSuccessPictureURL":{var h=g.value,y=h.pictureId,C=h.pictureType,b=h.pictureUrl,v=h.pictureDirectPath,S=h.pictureHash;return o("WALogger").DEV(s||(s=babelHelpers.taggedTemplateLiteralLoose(["getProfilePic: "," ",", ",", ",""])),t.toString(),y,C,b),{tag:y,type:C,eurl:b,directPath:v,filehash:S}}case"GetResponseError":{var R=g.value.errorProfilePictureGetErrors.value;return o("WALogger").DEV(u||(u=babelHelpers.taggedTemplateLiteralLoose(["getProfilePic failed: ",":",""])),R.code,R.text),(c||(c=n("Promise"))).reject(new(o("WAWebBackendErrors")).ServerStatusCodeError(Number(R.code),R.text))}case"GetResponseSuccessAvatarURLs":case"GetResponseSuccessNoData":case"GetResponseSuccessPictureBlob":return(c||(c=n("Promise"))).reject(g.value.type)}}),m.apply(this,arguments)}function p(e){var t;return o("WAWebProfilePicPrivacyTokenGating").isProfilePicIQPrivacyTokenEnabled()&&e!=null&&(t={privacyTokenContentsMixinArgs:{anyElementValue:new Uint8Array(e)}}),t}function _(e){return o("WAWebProfilePicPrivacyTokenGating").isProfilePicIQPrivacyTokenEnabled()&&e!=null?o("WAJids").toGroupJid(e.toString()):null}l.getProfilePic=d}),98);
__d("WAWebGetPushServerSettingsJob",["WADeprecatedSendIq","WADeprecatedWapParser","WALogger","WAWap","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u,c=new(r("WADeprecatedWapParser"))("getPushServerSettings",function(t){if(!t.hasChild("error")){o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["getPushServerSettings: success"]))).tags("push-notification");var n=t.child("settings"),r=n.attrString("webserverkey");return r}var a=t.child("error"),i=a.attrInt("code"),l=a.attrString("text");return o("WALogger").WARN(s||(s=babelHelpers.taggedTemplateLiteralLoose(["getPushServerSettingsRequest: server response with ",", ",""])),i,l).tags("push-notification"),{errorCode:i,errorText:l}}),d=(u=o("WAWap")).wap("iq",{to:u.S_WHATSAPP_NET,type:"get",xmlns:"urn:xmpp:whatsapp:push",id:u.generateId()},u.wap("settings",null));function m(){return p.apply(this,arguments)}function p(){return p=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=yield o("WADeprecatedSendIq").deprecatedSendIq(d,c);if(!e.success){var t=e.errorCode,n=e.errorText;return{errorCode:t,errorText:n}}return e.result}),p.apply(this,arguments)}l.getPushServerSettings=m}),98);
__d("WAWebMexFetchReachoutTimelockJobQuery.graphql",[],(function(t,n,r,o,a,i){"use strict";var e=(function(){var e=[{alias:null,args:null,concreteType:"XWA2ReachoutTimelock",kind:"LinkedField",name:"xwa2_fetch_account_reachout_timelock",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"is_active",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"time_enforcement_ends",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"enforcement_type",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"WAWebMexFetchReachoutTimelockJobQuery",selections:e,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"WAWebMexFetchReachoutTimelockJobQuery",selections:e},params:{id:"23983697327930364",metadata:{},name:"WAWebMexFetchReachoutTimelockJobQuery",operationKind:"query",text:null}}})();a.exports=e}),null);
__d("WAWebMexFetchReachoutTimelockJob",["WALogger","WAWebBackendErrors","WAWebMexClient","WAWebMexFetchReachoutTimelockJobQuery.graphql","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=e!==void 0?e:e=n("WAWebMexFetchReachoutTimelockJobQuery.graphql");function c(){return d.apply(this,arguments)}function d(){return d=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e={},t=yield o("WAWebMexClient").fetchQuery(u,e);if((t==null?void 0:t.xwa2_fetch_account_reachout_timelock)==null)throw new(o("WAWebBackendErrors")).ServerStatusCodeError(500,"Mex unexpected null response for fetching reachout timelock");o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[MEX][WA-ICE][RET] fetched reachout timelock"]))).tags("GQL","MEX","wa-ice","RET").devConsole({response:t});var n=t==null?void 0:t.xwa2_fetch_account_reachout_timelock,r=n.is_active,a=n.time_enforcement_ends,i=n.enforcement_type;return{is_active:r,time_enforcement_ends:a,enforcement_type:i}}),d.apply(this,arguments)}l.mexFetchReachoutTimelock=c}),98);
__d("WAWebReachoutTimelockGatingUtils",["WAWebABProps"],(function(t,n,r,o,a,i,l){function e(){return o("WAWebABProps").getABPropConfigValue("enable_reachout_timelocks_web")}l.isReachoutTimelockEnabled=e}),98);
__d("WAWebReachoutTimelockUtils",["WAWebContactGetters","WAWebReachoutTimelockGatingUtils","WAWebUserPrefsIndexedDBStorage","WAWebUserPrefsTypes"],(function(t,n,r,o,a,i,l){var e="WAReachoutTimelockState";function s(){return o("WAWebReachoutTimelockGatingUtils").isReachoutTimelockEnabled()?o("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.get(e)!=null:!1}function u(){if(!o("WAWebReachoutTimelockGatingUtils").isReachoutTimelockEnabled())return!1;var t=o("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.get(e);return(t==null?void 0:t.state)===o("WAWebUserPrefsTypes").ReachoutTimelockState.HIDDEN}function c(){if(!o("WAWebReachoutTimelockGatingUtils").isReachoutTimelockEnabled())return!1;var t=o("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.get(e);return(t==null?void 0:t.state)===o("WAWebUserPrefsTypes").ReachoutTimelockState.VISIBLE}function d(e){var t=e.chat,n=e.contact;return!s()||!o("WAWebContactGetters").getIsUser(n)||o("WAWebContactGetters").getIsMe(n)||o("WAWebContactGetters").getIsEnterprise(n)||o("WAWebContactGetters").getIsSupportAccount(n)||n.id.isBot()?!0:(t==null?void 0:t.getTcToken())!=null}function m(e){if(e==null)return o("WAWebUserPrefsTypes").ReachoutTimelockEnforcementType.DEFAULT;switch(e){case"BIZ_QUALITY":return o("WAWebUserPrefsTypes").ReachoutTimelockEnforcementType.BIZ_QUALITY;case"DEFAULT":default:return o("WAWebUserPrefsTypes").ReachoutTimelockEnforcementType.DEFAULT}}l.REACHOUT_TIMELOCK_IDB_KEY=e,l.isUserReachoutTimelocked=s,l.isUserReachoutTimelockedAndHidden=u,l.isUserReachoutTimelockedAndVisible=c,l.canSendMsgWhileTimelocked=d,l.getReachoutTimelockEnforcementType=m}),98);
__d("WAWebMexReachoutTimelockNotificationHandler",["WALogger","WAWebBackendApi","WAWebReachoutTimelockGatingUtils","WAWebReachoutTimelockUtils","WAWebUserPrefsIndexedDBStorage","WAWebUserPrefsTypes","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e;function s(e,t){return u.apply(this,arguments)}function u(){return u=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){if(o("WAWebReachoutTimelockGatingUtils").isReachoutTimelockEnabled()){var n=t.xwa2_notify_account_reachout_timelock,r=n.is_active,a=n.enforcement_type,i=n.time_enforcement_ends;yield c(r,a,i)}}),u.apply(this,arguments)}function c(e,t,n){return d.apply(this,arguments)}function d(){return d=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,n,r){try{if(!t){var a=o("WAWebReachoutTimelockUtils").isUserReachoutTimelockedAndVisible();yield o("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.remove(o("WAWebReachoutTimelockUtils").REACHOUT_TIMELOCK_IDB_KEY),o("WAWebBackendApi").frontendFireAndForget("reachoutTimelockEnforcementLifted",{shouldPresentRestrictionsLiftedModal:a});return}var i=r!=null?new Date(parseInt(r,10)*1e3).getTime():new Date().getTime()+60*1e3,l=yield o("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.get(o("WAWebReachoutTimelockUtils").REACHOUT_TIMELOCK_IDB_KEY);yield o("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.set(o("WAWebReachoutTimelockUtils").REACHOUT_TIMELOCK_IDB_KEY,{state:l!=null?l.state:o("WAWebUserPrefsTypes").ReachoutTimelockState.HIDDEN,time_enforcement_ends:i,enforcement_type:o("WAWebReachoutTimelockUtils").getReachoutTimelockEnforcementType(n)}),o("WAWebBackendApi").frontendFireAndForget("reachoutTimelockEnforcementSet",{})}catch(t){o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[mex][reachout-timelock] handle reachout timelock notification failed"]))).devConsole(t).sendLogs("mex-handle-reachout-timelock-notification-failed")}}),d.apply(this,arguments)}l.mexHandleReachoutTimelockNotification=s,l.handleReachoutTimelockUpdate=c}),98);
__d("WAWebGetReachoutTimelockJob",["WAJobOrchestratorTypes","WALogger","WAWebMexFetchReachoutTimelockJob","WAWebMexReachoutTimelockNotificationHandler","WAWebOrchestratorNonPersistedJob","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){"use strict";var e;function s(){return u.apply(this,arguments)}function u(){return u=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=yield c();if(e!=null){var t=e.is_active,n=e.time_enforcement_ends,r=e.enforcement_type;yield o("WAWebMexReachoutTimelockNotificationHandler").handleReachoutTimelockUpdate(t,r,n)}}),u.apply(this,arguments)}function c(){return o("WAWebOrchestratorNonPersistedJob").createNonPersistedJob("getReachoutTimelock",n("asyncToGeneratorRuntime").asyncToGenerator(function*(){try{var t=yield o("WAWebMexFetchReachoutTimelockJob").mexFetchReachoutTimelock();return t}catch(t){throw o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[MEX][WA-ICE][RET] GET Reachout Timelock job error"]))).tags("GQL","MEX","wa-ice","RET").devConsole({e:t}),t}}),{priority:o("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION}).waitUntilCompleted()}l.fetchReachoutTimelock=s}),98);
__d("WAWebGuestCommonUtils",["WAWebMiscBrowserUtils","WAWebUA"],(function(t,n,r,o,a,i,l){"use strict";function e(){var e;return(navigator.userAgent.includes("WhatsApp-AppClip")&&typeof window!="undefined"&&((e=window.webkit)==null||(e=e.messageHandlers)==null||(e=e.WAAppClipHandler)==null?void 0:e.postMessage)!==void 0)===!0}function s(){var t=r("WAWebMiscBrowserUtils").info(),n=o("WAWebUA").UA.parser.getResult();return{browserName:e()?"WhatsApp-AppClip":t.name,browserVersion:n.browser.version,osName:t.os,osVersion:t.version}}l.isAppClipWebView=e,l.getBrowserAndOsDetails=s}),98);
__d("WAWebWamEnumGuestUpsellActionType",[],(function(t,n,r,o,a,i){var e=Object.freeze({VIEW:1,CLICK:2,DISMISS:3,DOWNLOAD_CTA_CLICK:4});i.GUEST_UPSELL_ACTION_TYPE=e}),66);
__d("WAWebWamEnumGuestUpsellEntryPointType",[],(function(t,n,r,o,a,i){var e=Object.freeze({BANNER_DOWNLOAD_CTA:1,AUDIO_CALL:2,VIDEO_CALL:3,ATTACHMENT:4,NEW_INVITE:5,LANDING_SCREEN_DOWNLOAD_CTA:6,SESSION_REOPEN:7});i.GUEST_UPSELL_ENTRY_POINT_TYPE=e}),66);
__d("WAWebGuestUpsellInteractionWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumGuestUpsellActionType","WAWebWamEnumGuestUpsellEntryPointType"],(function(t,n,r,o,a,i,l){var e=o("WAWebWamCodegenUtils").defineEvents({GuestUpsellInteraction:[7146,{guestUpsellAction:[1,o("WAWebWamEnumGuestUpsellActionType").GUEST_UPSELL_ACTION_TYPE],guestUpsellEntryPoint:[2,o("WAWebWamEnumGuestUpsellEntryPointType").GUEST_UPSELL_ENTRY_POINT_TYPE]},[1,1,1],"regular"]},{GuestUpsellInteraction:[]});l.GuestUpsellInteractionWamEvent=e}),98);
__d("WAWebGuestUserPrefs",["WAWebUserPrefsKeys","WAWebUserPrefsStore"],(function(t,n,r,o,a,i,l){function e(){var e=r("WAWebUserPrefsStore").get(o("WAWebUserPrefsKeys").UserPrefs.GuestActiveInviteCode);return typeof e=="string"?e:""}function s(e){r("WAWebUserPrefsStore").set(o("WAWebUserPrefsKeys").UserPrefs.GuestActiveInviteCode,e)}function u(){var e=r("WAWebUserPrefsStore").get(o("WAWebUserPrefsKeys").UserPrefs.GuestDeviceId);return typeof e=="string"?e:""}function c(e){r("WAWebUserPrefsStore").set(o("WAWebUserPrefsKeys").UserPrefs.GuestDeviceId,e)}function d(){var e=r("WAWebUserPrefsStore").get(o("WAWebUserPrefsKeys").UserPrefs.GuestSessionId);return typeof e=="string"?e:""}function m(e){r("WAWebUserPrefsStore").set(o("WAWebUserPrefsKeys").UserPrefs.GuestSessionId,e)}l.getActiveGuestInviteCode=e,l.setActiveGuestInviteCode=s,l.getGuestDeviceId=u,l.setGuestDeviceId=c,l.getGuestSessionId=d,l.setGuestSessionId=m}),98);
__d("WAWebGuestWamConstants",[],(function(t,n,r,o,a,i){var e=1,l=2,s="guest";i.WAM_IN_MEMORY_BUFFERING_DURATION_IN_SECS_FOR_GUEST=e,i.WAM_BUFFER_ROTATE_INTERVAL_IN_SECS_FOR_GUEST=l,i.WAM_GUEST_TAB_ID=s}),66);
__d("WAWebGuestWamUtils",["WALogger","WAWebGuestCommonUtils","WAWebGuestUpsellInteractionWamEvent","WAWebGuestWamConstants","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e;function s(e,t,n){return u.apply(this,arguments)}function u(){return u=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,n,r){r===void 0&&(r=!1),o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["Guest upsell action: "," for entrypoint: ",", flushWamBuffers: ",""])),n,t,r);var a=new(o("WAWebGuestUpsellInteractionWamEvent")).GuestUpsellInteractionWamEvent({guestUpsellAction:n,guestUpsellEntryPoint:t});return r?a.commitAndWaitForFlush(r):a.commit()}),u.apply(this,arguments)}function c(){var e=o("WAWebGuestCommonUtils").getBrowserAndOsDetails();return{browser:e.browserName,browserVersion:e.browserVersion,deviceName:e.osName,deviceVersion:e.osVersion,webcTabId:o("WAWebGuestWamConstants").WAM_GUEST_TAB_ID}}l.logUpsellAction=s,l.getGuestWamOverrides=c}),98);
__d("WAWebHandleInfoBulletinTypes.flow",[],(function(t,n,r,o,a,i){var e=Object.freeze({DIRTY:"dirty",ROUTING:"edge_routing",OFFLINE:"offline",OFFLINE_PREVIEW:"offline_preview",TOS:"tos",THREAD_META:"thread_metadata",CLIENT_EXPIRATION:"client_expiration",OFFLINE_PRIORITY_COMPLETE:"priority_offline_complete"});i.INFO_TYPE=e}),66);
__d("WAWebMdAppStateOfflineNotificationsWamEvent",["WAWebWamCodegenUtils"],(function(t,n,r,o,a,i,l){var e=o("WAWebWamCodegenUtils").defineEvents({MdAppStateOfflineNotifications:[2602,{redundantCount:[1,o("WAWebWamCodegenUtils").TYPES.INTEGER]},[1,20,1e3],"regular"]},{MdAppStateOfflineNotifications:[]});l.MdAppStateOfflineNotificationsWamEvent=e}),98);
__d("WAWebHandleReportServerSyncNotification",["WAWebMdAppStateOfflineNotificationsWamEvent"],(function(t,n,r,o,a,i,l){var e=new Map;function s(){if(!(e.size<1)){var t=0;Array.from(e.entries()).forEach(function(e){var n=e[1];t+=n-1}),new(o("WAWebMdAppStateOfflineNotificationsWamEvent")).MdAppStateOfflineNotificationsWamEvent({redundantCount:t}).commit(),e.clear()}}l.offlineNotificationsCount=e,l.reportOfflineNotifications=s}),98);
__d("WAWebHandleRoutingInfo",["WAHex","WALogger","WAWebUserPrefsMultiDevice","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s={fb:"fb",sl:"sl"};function u(e){return c.apply(this,arguments)}function c(){return c=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var n=t.domain;if(!n){var r=yield o("WAWebUserPrefsMultiDevice").getRoutingInfo();n=r?r.domain:s.fb}var a=o("WAHex").bytesToBuffer(t.edgeRouting);yield o("WAWebUserPrefsMultiDevice").setRoutingInfo({domain:n,edgeRouting:a}),o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["handleInfoBulletin setting and domain: "," and edgeRouting:"])),n).devConsole(a)}),c.apply(this,arguments)}l.DOMAINS=s,l.handleRoutingInfo=u}),98);
__d("WAWebUpdaterHardExpireTime",[],(function(t,n,r,o,a,i){var e,l=document.getElementById("hard_expire_time"),s=parseInt(l==null||(e=l.dataset)==null?void 0:e.time,10);Number.isNaN(s)&&(s=1572566400);var u=s;i.default=u}),66);
__d("WAWebHandleServerClientExpiration",["WATimeUtils","WAWebBuildConstants","WAWebCmd","WAWebUpdaterHardExpireTime","WAWebUserPrefsMultiDevice"],(function(t,n,r,o,a,i,l){function e(e){var t=parseInt(r("WAWebUpdaterHardExpireTime"),10);if(e==null)o("WAWebUserPrefsMultiDevice").clearServerClientExpirationOverride();else{var n,a=(n=o("WAWebUserPrefsMultiDevice").getServerClientExpirationOverride())==null?void 0:n.timestamp;if(a!=null&&e>=a||e>=t)return;var i=o("WATimeUtils").futureUnixTime(3*o("WATimeUtils").DAY_SECONDS),l=Math.max(i,Math.min(e,t));o("WAWebUserPrefsMultiDevice").setServerClientExpirationOverride(""+l,o("WAWebBuildConstants").VERSION_BASE),o("WAWebCmd").Cmd.serverUpdatedClientExpiration()}}l.handleServerClientExpiration=e}),98);
__d("WAWebParseThreadMetadata",["WAWebHandleInfoBulletinTypes.flow"],(function(t,n,r,o,a,i,l){function e(e){var t=e.child(o("WAWebHandleInfoBulletinTypes.flow").INFO_TYPE.THREAD_META),n={};return t.forEachChildWithTag("item",function(e){var t=e.attrChatJid("from"),r=e.attrTime("t");n[String(t)]=r}),{chatTimestamp:n}}l.parseThreadMetadata=e}),98);
__d("WAWebHandleInfoBulletin",["WADeprecatedWapParser","WALogger","WASmaxClientExpirationClientExpirationRPC","WATimeUtils","WAWebDirtyBitsConsts","WAWebHandleInfoBulletinTypes.flow","WAWebHandleReportServerSyncNotification","WAWebHandleRoutingInfo","WAWebHandleServerClientExpiration","WAWebMessageDedupUtils","WAWebOfflineHandler","WAWebParseThreadMetadata","WAWebThreadMetadata","WAWebTos","asyncToGeneratorRuntime","cr:1175"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m=(e=n("cr:1175"))!=null?e:{},p=m.handleDirtyBits,_=new(r("WADeprecatedWapParser"))("infoBulletinParser",function(e){if(e.assertTag("ib"),e.assertFromServer(),e.hasChild(o("WAWebHandleInfoBulletinTypes.flow").INFO_TYPE.DIRTY)){var t=[],n=[],r=[];return e.forEachChildWithTag(o("WAWebHandleInfoBulletinTypes.flow").INFO_TYPE.DIRTY,function(e){var a={type:e.attrString("type"),timestamp:e.attrInt("timestamp")};if(a.type==="account_sync"){var i=e.mapChildren(function(e){return e.tag()});i.forEach(function(e){Object.prototype.hasOwnProperty.call(o("WAWebDirtyBitsConsts").SUPPORTED_DIRTY_PROTOCOLS,e)&&r.push(e)}),n.push(a)}else Object.prototype.hasOwnProperty.call(o("WAWebDirtyBitsConsts").SUPPORTED_DIRTY_TYPE,a.type)?n.push(a):t.push(a)}),{type:o("WAWebHandleInfoBulletinTypes.flow").INFO_TYPE.DIRTY,supported:n,unsupported:t,protocols:r}}else if(e.hasChild(o("WAWebHandleInfoBulletinTypes.flow").INFO_TYPE.ROUTING)){var a=e.child(o("WAWebHandleInfoBulletinTypes.flow").INFO_TYPE.ROUTING);return{type:o("WAWebHandleInfoBulletinTypes.flow").INFO_TYPE.ROUTING,edgeRouting:a.child("routing_info").contentBytes(),domain:a.hasChild("dns_domain")?a.child("dns_domain").contentEnum(o("WAWebHandleRoutingInfo").DOMAINS):null}}else{if(e.hasChild(o("WAWebHandleInfoBulletinTypes.flow").INFO_TYPE.OFFLINE))return{count:e.child(o("WAWebHandleInfoBulletinTypes.flow").INFO_TYPE.OFFLINE).attrInt("count"),type:o("WAWebHandleInfoBulletinTypes.flow").INFO_TYPE.OFFLINE};if(e.hasChild(o("WAWebHandleInfoBulletinTypes.flow").INFO_TYPE.OFFLINE_PRIORITY_COMPLETE))return{type:o("WAWebHandleInfoBulletinTypes.flow").INFO_TYPE.OFFLINE_PRIORITY_COMPLETE};if(e.hasChild(o("WAWebHandleInfoBulletinTypes.flow").INFO_TYPE.OFFLINE_PREVIEW)){var i;return{count:{count:e.child((i=o("WAWebHandleInfoBulletinTypes.flow")).INFO_TYPE.OFFLINE_PREVIEW).attrInt("count"),message:e.child(i.INFO_TYPE.OFFLINE_PREVIEW).attrInt("message"),receipt:e.child(i.INFO_TYPE.OFFLINE_PREVIEW).attrInt("receipt"),notification:e.child(i.INFO_TYPE.OFFLINE_PREVIEW).attrInt("notification"),call:e.child(i.INFO_TYPE.OFFLINE_PREVIEW).attrInt("call")},type:i.INFO_TYPE.OFFLINE_PREVIEW}}else if(e.hasChild(o("WAWebHandleInfoBulletinTypes.flow").INFO_TYPE.TOS)){var l=[];return e.child("tos").forEachChildWithTag("notice",function(e){l.push(e.attrString("id"))}),{type:o("WAWebHandleInfoBulletinTypes.flow").INFO_TYPE.TOS,noticeIds:l}}else{if(e.hasChild(o("WAWebHandleInfoBulletinTypes.flow").INFO_TYPE.THREAD_META))return{type:o("WAWebHandleInfoBulletinTypes.flow").INFO_TYPE.THREAD_META,threadMeta:o("WAWebParseThreadMetadata").parseThreadMetadata(e)};if(e.hasChild(o("WAWebHandleInfoBulletinTypes.flow").INFO_TYPE.CLIENT_EXPIRATION)){var s=o("WASmaxClientExpirationClientExpirationRPC").receiveClientExpirationRPC(e.getNode()),u=s.parsedRequest.clientExpirationT,c=u!=null?o("WATimeUtils").castToUnixTime(u):null;return{type:o("WAWebHandleInfoBulletinTypes.flow").INFO_TYPE.CLIENT_EXPIRATION,newClientExpirationTime:c}}}}return null});function f(e){return g.apply(this,arguments)}function g(){return g=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=_.parse(e);if(t.error)throw o("WALogger").DEV(s||(s=babelHelpers.taggedTemplateLiteralLoose(["error while parsing: ",""])),e.toString()),o("WALogger").ERROR(u||(u=babelHelpers.taggedTemplateLiteralLoose(["Parsing Error: ",""])),t.error.toString()),t.error;var n=t.success;if(!n){o("WALogger").WARN(c||(c=babelHelpers.taggedTemplateLiteralLoose(["handleInfoBulletin unrecognized info bulletin"])));return}switch(n.type){case o("WAWebHandleInfoBulletinTypes.flow").INFO_TYPE.DIRTY:if(!p){o("WALogger").WARN(d||(d=babelHelpers.taggedTemplateLiteralLoose(["handleInfoBulletin dirty bits not supported"])));return}return yield p(n),"NO_ACK";case o("WAWebHandleInfoBulletinTypes.flow").INFO_TYPE.ROUTING:return yield o("WAWebHandleRoutingInfo").handleRoutingInfo(n),"NO_ACK";case o("WAWebHandleInfoBulletinTypes.flow").INFO_TYPE.OFFLINE:return o("WAWebOfflineHandler").OfflineMessageHandler.processOfflineIb(n.count),o("WAWebHandleReportServerSyncNotification").reportOfflineNotifications(),o("WAWebMessageDedupUtils").maybeClearPendingMessages(n.count),"NO_ACK";case o("WAWebHandleInfoBulletinTypes.flow").INFO_TYPE.OFFLINE_PREVIEW:return yield o("WAWebOfflineHandler").OfflineMessageHandler.processOfflinePreviewIb(n.count),"NO_ACK";case o("WAWebHandleInfoBulletinTypes.flow").INFO_TYPE.TOS:return o("WAWebTos").TosManager.maybeUpdateServer(n.noticeIds),"NO_ACK";case o("WAWebHandleInfoBulletinTypes.flow").INFO_TYPE.THREAD_META:return o("WAWebThreadMetadata").setOfflineThreadMeta(n.threadMeta),"NO_ACK";case o("WAWebHandleInfoBulletinTypes.flow").INFO_TYPE.CLIENT_EXPIRATION:return o("WAWebHandleServerClientExpiration").handleServerClientExpiration(n.newClientExpirationTime),"NO_ACK";default:return}}),g.apply(this,arguments)}l.default=f}),98);
__d("WAWebIdentityApiUtils",["WABinary","WAWebSignalCommonUtils","WAWebSignalProtocolStore","asyncToGeneratorRuntime","err"],(function(t,n,r,o,a,i,l){function e(e,t){for(var n=0;n<e.length&&n<t.length;++n)if(e[n]!==t[n])return e[n]-t[n];return e.length-t.length}function s(e){return u.apply(this,arguments)}function u(){return u=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=yield c(e);return t.map(function(t,n){if(t==null)throw r("err")("getAllIdentityKeys: missing identity key for device "+String(e[n]));return t})}),u.apply(this,arguments)}function c(e){return d.apply(this,arguments)}function d(){return d=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=yield o("WAWebSignalProtocolStore").getPersistSignalProtocolStore().bulkLoadIdentityKey(e.map(function(e){return o("WAWebSignalCommonUtils").createSignalAddress(e)}));return t.map(function(e){return e==null?null:new Uint8Array(o("WAWebSignalCommonUtils").strToBuffer(e))})}),d.apply(this,arguments)}function m(t){var n=new(o("WABinary")).Binary;return t.sort(e).forEach(function(e){n.writeByteArray(e)}),n.readByteArrayView()}l.getAllIdentityKeysBytesOrThrow=s,l.getAllIdentityKeysBytes=c,l.identityKeysToBinary=m}),98);
__d("WAWebInitWaitForEvents",["WAWebEventsWaitForOfflineDeliveryEnd","WAWebEventsWaitForReadyForOffline"],(function(t,n,r,o,a,i,l){function e(){o("WAWebEventsWaitForReadyForOffline").initWaitForOfflineProcessReady(),o("WAWebEventsWaitForOfflineDeliveryEnd").initWaitForOfflineDeliveryEnd()}l.initOfflineResumeWaitForEvents=e}),98);
__d("WAWebInvocationDispatcher",["invariant","Promise","WANullthrows","WAWebBrokerProtocolInvocation","WAWebBrokerProtocolResponse","WAWebInvocationId","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l,s){var e,u=(function(){function t(){var e=this;this.$2=new Map,this.$3=function(t){var n=o("WAWebBrokerProtocolResponse").unwrapResponsePayload(t.data);if(n!=null){var a=n.invocationId,i=n.result;if(e.$2.has(a)){var l=r("WANullthrows")(e.$2.get(a)),s=l.resolve;s(i),e.$2.delete(a)}}}}var a=t.prototype;return a.setConnectionManager=function(t){var e=this;this.$1=t,t.waitForConnection().then(function(){var n=r("WANullthrows")(t.getPort(),"Port obtained from ConnectionManager after connection");n.addEventListener("message",e.$3),n.start()})},a.invoke=(function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,a){var i=this;this.$1||s(0,56298),yield this.$1.waitForConnection(),this.$1||s(0,56298);var l=r("WANullthrows")(this.$1.getPort(),"Port obtained from ConnectionManager after connection"),u=o("WAWebInvocationId").genInvocationId();return l.postMessage(o("WAWebBrokerProtocolInvocation").buildInvocationPayload({invocationId:u,method:t,args:a})),new(e||(e=n("Promise")))(function(e,t){i.$2.set(u,{resolve:e,reject:t})})});function a(e,n){return t.apply(this,arguments)}return a})(),t})(),c=new u;l.default=c}),98);
__d("WAWebInvocationHandler",["WAWebBrokerProtocolInvocation","WAWebBrokerProtocolResponse","WAWebInvocationInterface"],(function(t,n,r,o,a,i,l){var e=(function(){function e(){this.$1=function(e,t){var n=t.data,r=o("WAWebBrokerProtocolInvocation").unwrapInvocationPayload(n);if(r!=null){var a=r.method,i=r.args,l=r.invocationId,s=o("WAWebInvocationInterface").get();s[a].apply(s,i).then(function(t){e.postMessage(o("WAWebBrokerProtocolResponse").buildResponsePayload(l,t))})}}}var t=e.prototype;return t.respondTo=function(t){var e=this;t.addEventListener("message",function(n){return e.$1(t,n)}),t.start()},e})(),s=new e;l.default=s}),98);
__d("WAWebWamEnumProjectCode",[],(function(t,n,r,o,a,i){var e=Object.freeze({DIT:1,DIRECTORY_SEARCH:2});i.PROJECT_CODE=e}),66);
__d("WAWebWamEnumSignCredentialResult",[],(function(t,n,r,o,a,i){var e=Object.freeze({SUCCESS:1,ERROR_BAD_REQUEST:2,ERROR_SERVER:3,ERROR_OTHER:4,ERROR_CLIENT_NETWORK:5});i.SIGN_CREDENTIAL_RESULT=e}),66);
__d("WAWebSignCredentialWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumApplicationState","WAWebWamEnumProjectCode","WAWebWamEnumSignCredentialResult"],(function(t,n,r,o,a,i,l){var e,s=(e=o("WAWebWamCodegenUtils")).defineEvents({SignCredential:[2242,{applicationState:[6,o("WAWebWamEnumApplicationState").APPLICATION_STATE],isFromWameta:[8,e.TYPES.BOOLEAN],overallT:[4,e.TYPES.TIMER],projectCode:[7,o("WAWebWamEnumProjectCode").PROJECT_CODE],retryCount:[2,e.TYPES.INTEGER],signCredentialResult:[1,o("WAWebWamEnumSignCredentialResult").SIGN_CREDENTIAL_RESULT],signCredentialT:[3,e.TYPES.TIMER],waConnectedToChatd:[5,e.TYPES.BOOLEAN]},[1,1,1],"regular"]},{SignCredential:[]});l.SignCredentialWamEvent=s}),98);
__d("privateStatsToken",["Promise","WAACSTokenUtils","WADeprecatedSendIq","WADeprecatedWapParser","WAErrors","WALogger","WAPromiseRetryLoop","WATimeUtils","WAWamPrivateStatsToken","WAWamStorage","WAWap"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c,d=3,m=new(r("WADeprecatedWapParser"))("issuePrivateStatsToken",function(e){var t=e.child("sign_credential"),n=t.child("signed_credential"),r=n.contentBytes(),o=t.child("acs_public_key"),a=o.contentBytes();return{signedCredential:r,acsPublicKey:a}});function p(e){switch(e.errorCode){case 400:return"bad-request";case 500:return"internal-server-error";case 501:return"feature-not-implemented";case 503:return"service-unavailable";default:return"unknown"}}function _(t){var r=o("WATimeUtils").monotonicTime(),a={overallStartTime:r,retryStartTime:r,retryAttemptsLeft:d},i=o("WAACSTokenUtils").getBlindedToken(),l=i.token,_=i.blindedToken,f=i.blindingFactor,g=function(i){a.retryAttemptsLeft<d&&(a.retryStartTime=o("WATimeUtils").monotonicTime());var r=o("WAWap").wap("iq",{id:o("WAWap").generateId(),to:o("WAWap").S_WHATSAPP_NET,type:"get",xmlns:"privatestats"},o("WAWap").wap("sign_credential",{version:"1"},o("WAWap").wap("blinded_credential",null,_))),g=t||o("WADeprecatedSendIq").deprecatedSendIqWithoutRetry;return g(r,m).then(function(t){if(!t.success){var n=p(t);o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["issuePrivateStatsToken: failed ",""])),n),n!=="internal-server-error"||a.retryAttemptsLeft<=0?i({result:null,metric:babelHelpers.extends({},a,{result:n})}):a.retryAttemptsLeft--;return}var r=t.result,u=r.signedCredential,c=r.acsPublicKey,d=o("WAWamPrivateStatsToken").unblindToken(u,f,c);if(d==null){o("WALogger").WARN(s||(s=babelHelpers.taggedTemplateLiteralLoose(["issuePrivateStatsToken: failed to unblind the signed token"]))),i({result:null,metric:babelHelpers.extends({},a,{result:"decryption-error"})});return}i({result:{token:l,sharedSecret:o("WAACSTokenUtils").getSharedSecret({token:l,unblindedSignedToken:d})},metric:babelHelpers.extends({},a,{result:"success"})})}).catch(function(e){if(e instanceof o("WAErrors").Disconnected)o("WALogger").WARN(u||(u=babelHelpers.taggedTemplateLiteralLoose(["issuePrivateStatsToken: Disconnected"]))),a.retryAttemptsLeft<=0?i({result:null,metric:babelHelpers.extends({},a,{result:"disconnected"})}):a.retryAttemptsLeft--;else return(c||(c=n("Promise"))).reject(e)})},h=new(o("WAPromiseRetryLoop")).PromiseRetryLoop({name:"issuePrivateStatsToken",timer:{algo:{type:"exponential",first:250},max:1e3},code:g});return h.start(),h.promise()}function f(e){return o("WAWamStorage").redeemPrivateStatsToken().then(function(t){return t?{result:t}:_(e).then(function(e){var t=babelHelpers.extends({},e),n=e.result;return n?o("WAWamStorage").savePrivateStatsToken(n).then(function(){return t}):t})})}l.issuePrivateStatsToken=_,l.getToken=f}),98);
__d("WAWebIssuePrivateStatsToken",["WADeprecatedSendIq","WALogger","WASemaphore","WATimeUtils","WAWebSignCredentialWamEvent","WAWebWamEnumApplicationState","WAWebWamEnumSignCredentialResult","asyncToGeneratorRuntime","privateStatsToken"],(function(t,n,r,o,a,i,l){var e,s=3;function u(e){switch(e){case"success":return o("WAWebWamEnumSignCredentialResult").SIGN_CREDENTIAL_RESULT.SUCCESS;case"bad-request":return o("WAWebWamEnumSignCredentialResult").SIGN_CREDENTIAL_RESULT.ERROR_BAD_REQUEST;case"internal-server-error":return o("WAWebWamEnumSignCredentialResult").SIGN_CREDENTIAL_RESULT.ERROR_SERVER;case"disconnected":return o("WAWebWamEnumSignCredentialResult").SIGN_CREDENTIAL_RESULT.ERROR_CLIENT_NETWORK;default:return o("WAWebWamEnumSignCredentialResult").SIGN_CREDENTIAL_RESULT.ERROR_OTHER}}function c(e){var t=e.result,n=e.overallStartTime,r=e.retryStartTime,a=e.retryAttemptsLeft,i=u(t);new(o("WAWebSignCredentialWamEvent")).SignCredentialWamEvent({signCredentialResult:i,overallT:o("WATimeUtils").monotonicTimeSince(n),signCredentialT:o("WATimeUtils").monotonicTimeSince(r),retryCount:s-a,waConnectedToChatd:t!=="disconnected",applicationState:document.visibilityState==="visible"?o("WAWebWamEnumApplicationState").APPLICATION_STATE.FOREGROUND:o("WAWebWamEnumApplicationState").APPLICATION_STATE.BACKGROUND}).commit()}var d=new(o("WASemaphore")).Semaphore(1);function m(){return p.apply(this,arguments)}function p(){return p=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var t=yield d.acquire();try{var n=yield o("privateStatsToken").getToken(o("WADeprecatedSendIq").deprecatedSendIqWithoutRetry),r=n.result,a=n.metric;return a!=null&&c(a),r||o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["Couldn't get a private stats token"]))),r}finally{t.release()}}),p.apply(this,arguments)}l.getToken=m}),98);
__d("WAWebLoadingConfirmPopup.react",["WAWebConfirmPopup.react","WAWebLazyLoadLoading.react","WAWebModalManager","react"],(function(t,n,r,o,a,i,l){var e,s=e||(e=r("react"));function u(e){var t=e.error,n=e.okText,a=e.title,i=function(){},l=function(){return o("WAWebModalManager").ModalManager.close()};return s.jsx(o("WAWebConfirmPopup.react").ConfirmPopup,{title:a,onOK:i,okText:n,okDisabled:!0,onCancel:l,children:s.jsx("div",{className:"x1n2onr6 x1vd4hg5",children:s.jsx(r("WAWebLazyLoadLoading.react"),{error:t})})})}u.displayName=u.name+" [from "+i.id+"]",l.default=u}),98);
__d("WAWebLogoutReason",["WAWebLogoutReasonConstants"],(function(t,n,r,o,a,i,l){var e=null,s=null;function u(e){switch(e){case o("WAWebLogoutReasonConstants").LogoutReason.WebFailAddChat:case o("WAWebLogoutReasonConstants").LogoutReason.WebFailEncSalt:case o("WAWebLogoutReasonConstants").LogoutReason.WebFailOfflineResume:case o("WAWebLogoutReasonConstants").LogoutReason.WebFailStorageInitialization:return o("WAWebLogoutReasonConstants").LOGOUT_REASON_CODE.CLIENT_FATAL;case o("WAWebLogoutReasonConstants").LogoutReason.SyncdFailure:case o("WAWebLogoutReasonConstants").LogoutReason.SyncdErrorDuringBootstrap:case o("WAWebLogoutReasonConstants").LogoutReason.AccountSyncError:case o("WAWebLogoutReasonConstants").LogoutReason.SyncdTimeout:case o("WAWebLogoutReasonConstants").LogoutReason.CriticalSyncTimeout:return o("WAWebLogoutReasonConstants").LOGOUT_REASON_CODE.SYNC_FAIL;case o("WAWebLogoutReasonConstants").LogoutReason.HistorySyncTimeout:return o("WAWebLogoutReasonConstants").LOGOUT_REASON_CODE.INITIAL_HISTORY_SYNC_TIMEOUT;case o("WAWebLogoutReasonConstants").LogoutReason.AccountLocked:return o("WAWebLogoutReasonConstants").LOGOUT_REASON_CODE.ACCOUNT_LOCKED;default:return null}}function c(t){e=t}function d(e){s=e}function m(){return e}function p(){return s}l.getErrorCodeFromLogoutReason=u,l.setPrevLogoutReasonCode=c,l.setPrevCustomLogoutMessage=d,l.getPrevLogoutReasonCode=m,l.getPrevCustomLogoutMessage=p}),98);
__d("WAWebLruMediaStorageUtils",["invariant","WAWebIdb","WAWebStorage","asyncToGeneratorRuntime","err"],(function(t,n,r,o,a,i,l,s){var e="lru-media-storage-idb",u=null;function c(){var t=new(r("WAWebIdb"))(e);u=new(o("WAWebStorage")).Storage(t)}function d(){return u!=null||s(0,56300),u}function m(){return p.apply(this,arguments)}function p(){return p=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(u==null)throw r("err")("[lru-media-storage-idb] Storage should be created first before being destroyed");try{yield u.purge()}finally{u=null}}),p.apply(this,arguments)}c(),l.getStorage=d,l.destroyStorage=m}),98);
__d("WAWebMessageLargeEmoji.scss",["cx"],(function(t,n,r,o,a,i,l,s){var e={highRes:"_ahit",wrapper:"_ahiu",medium:"_ahiv",lowRes:"_ahiw",large:"_ahix",xlarge:"_ahiy",animation:"_ahiz",xlarge60:"_ar4y",invisible:"_ahi-",heartbeat:"_ahi_"},u=e;l.default=u}),98);
__d("useWAWebDevicePixelRatio",["err","once","react"],(function(t,n,r,o,a,i,l){var e,s=e||(e=o("react")),u=s.useEffect,c=s.useState;function d(){var e=c(function(){return m().getValue()}),t=e[0],n=e[1];return u(function(){return m().subscribe(function(e){n(e)})},[]),t}var m=r("once")(function(){return new p}),p=(function(){function e(){this.$1=new Set}var t=e.prototype;return t.subscribe=function(t){var e=this;if(this.$1.has(t))throw r("err")("Callback can only be added once.");return this.$1.add(t),this.$3(),function(){e.$1.delete(t),e.$3()}},t.getValue=function(){var e;return(e=window.devicePixelRatio)!=null?e:1},t.$3=function(){var e=this;if(this.$1.size===0){var t;(t=this.$2)==null||t.call(this);return}if(this.$2==null){var n=matchMedia("(resolution: "+this.getValue()+"dppx)"),r=function(){e.$2==null||e.$2();var t=e.getValue();e.$1.forEach(function(e){e(t)}),e.$3()};n.addListener(r),this.$2=function(){n.removeListener(r),e.$2=null}}},e})();l.default=d}),98);
__d("WAWebMessageLargeEmoji.react",["WAWebAssetLoaderDpiChangeDispatch","WAWebClassnames","WAWebConstantsDeprecated","WAWebCopyPasteSelectable.react","WAWebEmoji","WAWebEmoji.react","WAWebEmojiConst","WAWebImg.react","WAWebMessageLargeEmoji.scss","react","stylex","useWAWebABPropConfigValue","useWAWebDevicePixelRatio"],(function(t,n,r,o,a,i,l){var e,s,u,c=u||(u=o("react")),d=e||(e=r("react")),m=c.useCallback,p=c.useEffect,_=c.useState;function f(e){var t,n,a=e.emoji,i=e.size,l=i===void 0?o("WAWebEmojiConst").LargeEmojiSize.MEDIUM:i,u=e.animation,c=u===void 0?!1:u,f=e.element,g=f===void 0?"div":f,h=e.selectable,y=e.xstyle,C=r("useWAWebDevicePixelRatio")(),b=m(function(){var t=o("WAWebEmoji").EmojiUtil.getGlyphId(e.emoji);return!!(t!=null&&o("WAWebEmoji").EmojiUtil.isGlyphCached(t))},[e.emoji]),v=_(b),S=v[0],R=v[1];o("useWAWebABPropConfigValue").useABPropConfigValue("custom_racing_emoji"),o("useWAWebABPropConfigValue").useABPropConfigValue("custom_racing_emoji_feb2025"),p(function(){R(b())},[C,b]);var L=function(){var e=o("WAWebEmoji").EmojiUtil.getGlyphId(a);e!=null&&o("WAWebEmoji").EmojiUtil.markGlyphCached(e),R(!0)},E=o("WAWebClassnames").classnamesConvertMeToStylexPlease((t={},t[r("WAWebMessageLargeEmoji.scss").medium]=l===o("WAWebEmojiConst").LargeEmojiSize.MEDIUM,t[r("WAWebMessageLargeEmoji.scss").large]=l===o("WAWebEmojiConst").LargeEmojiSize.LARGE,t[r("WAWebMessageLargeEmoji.scss").xlarge]=l===o("WAWebEmojiConst").LargeEmojiSize.XLARGE,t[r("WAWebMessageLargeEmoji.scss").xlarge60]=l===o("WAWebEmojiConst").LargeEmojiSize.XLARGE_60,t)),k;l===o("WAWebEmojiConst").LargeEmojiSize.XLARGE_60?k=160:l===o("WAWebEmojiConst").LargeEmojiSize.XLARGE||r("WAWebAssetLoaderDpiChangeDispatch").currentRes==="high"?k=64:k=40;var I=o("WAWebEmoji").EmojiUtil.getGlyphPath(a,k);if(I==null)return null;if(S&&c){var T,D=g;return d.jsxs(D,{className:o("WAWebClassnames").classnamesConvertMeToStylexPlease((T=r("WAWebMessageLargeEmoji.scss")).animation,(s||(s=r("stylex")))(y)),children:[d.jsx(o("WAWebCopyPasteSelectable.react").SelectableImg,{alt:a,className:o("WAWebClassnames").classnamesConvertMeToStylexPlease(r("WAWebMessageLargeEmoji.scss").highRes,E),draggable:!1,plainText:a,selectable:!!h,src:r("WAWebConstantsDeprecated").ONE_BY_ONE_TRANS_GIF}),d.jsx(r("WAWebImg.react"),{className:o("WAWebClassnames").classnamesConvertMeToStylexPlease(r("WAWebMessageLargeEmoji.scss").highRes,E,r("WAWebMessageLargeEmoji.scss").heartbeat),draggable:!1,selectable:!1,src:I})]})}var x=S?void 0:d.jsx(r("WAWebEmoji.react"),{DEPRECATED_className:o("WAWebClassnames").classnamesConvertMeToStylexPlease(r("WAWebMessageLargeEmoji.scss").lowRes,E),emoji:a,xstyle:y,selectable:h},"low-res"),$=d.jsx(r("WAWebEmoji.react"),{DEPRECATED_className:o("WAWebClassnames").classnamesConvertMeToStylexPlease((n={},n[r("WAWebMessageLargeEmoji.scss").invisible]=!S,n[r("WAWebMessageLargeEmoji.scss").highRes]=!0,n[E]=!0,n)),emoji:a,xstyle:y,selectable:h,src:I,onLoad:L},"high-res");return d.jsxs("span",{className:r("WAWebMessageLargeEmoji.scss").wrapper,children:[x,$]})}f.displayName=f.name+" [from "+i.id+"]",l.SIZE=o("WAWebEmojiConst").LargeEmojiSize,l.LargeEmoji=f}),98);
__d("WAWebMessageSendPerfReporter",["WAWebAndroidMessageSendPerfWamEvent","WAWebMessagingGatingUtils","WAWebWamEnumClientMessageSendStage","WAWebWamEnumMessageType","WAWebWamEnumSizeBucket","gkx"],(function(t,n,r,o,a,i,l){var e=(function(){function e(e){var t=e.chatWid,n=e.mediaType,r=e.messageType;this.$7=!1,this.$8=!1,this.$9=null,this.$11=!1,this.$12=!1,this.$1=Date.now(),this.$2=new Map,this.$5=n,this.$6=r,this.$10=t}var t=e.prototype;return t.setFetchedPrekeyCount=function(t){this.$3=t},t.setSenderKeyDistributionCount=function(t){this.$4=t},t.setMessageIsInvisible=function(t){this.$11=t},t.setMessageIsFirstUserMessage=function(t){this.$12=t},t.setIsRevokeMessage=function(t){this.$7=t},t.setIsDirectedMessage=function(t){this.$8=t},t.setGroupData=function(t){this.$9=t},t.startRenderedStage=function(){this.$13(o("WAWebWamEnumClientMessageSendStage").CLIENT_MESSAGE_SEND_STAGE.CLIENT_RENDERED)},t.postRenderedStage=function(){this.$14(o("WAWebWamEnumClientMessageSendStage").CLIENT_MESSAGE_SEND_STAGE.CLIENT_RENDERED)},t.startSavedStage=function(){this.$13(o("WAWebWamEnumClientMessageSendStage").CLIENT_MESSAGE_SEND_STAGE.CLIENT_SAVED)},t.postSavedStage=function(){this.$14(o("WAWebWamEnumClientMessageSendStage").CLIENT_MESSAGE_SEND_STAGE.CLIENT_SAVED)},t.startPrekeysFetchStage=function(){this.$13(o("WAWebWamEnumClientMessageSendStage").CLIENT_MESSAGE_SEND_STAGE.CLIENT_PREKEYS_FETCH)},t.postPrekeysFetchStage=function(){this.$14(o("WAWebWamEnumClientMessageSendStage").CLIENT_MESSAGE_SEND_STAGE.CLIENT_PREKEYS_FETCH)},t.startWrittenWireStage=function(){this.$13(o("WAWebWamEnumClientMessageSendStage").CLIENT_MESSAGE_SEND_STAGE.CLIENT_WRITTEN_WIRE)},t.postWrittenWireStage=function(){this.$14(o("WAWebWamEnumClientMessageSendStage").CLIENT_MESSAGE_SEND_STAGE.CLIENT_WRITTEN_WIRE)},t.startWaitingToEncryptStage=function(){this.$13(o("WAWebWamEnumClientMessageSendStage").CLIENT_MESSAGE_SEND_STAGE.CLIENT_WAITING_TO_ENCRYPT)},t.postWaitingToEncryptStage=function(){this.$14(o("WAWebWamEnumClientMessageSendStage").CLIENT_MESSAGE_SEND_STAGE.CLIENT_WAITING_TO_ENCRYPT)},t.startReadyToSendStage=function(){this.$13(o("WAWebWamEnumClientMessageSendStage").CLIENT_MESSAGE_SEND_STAGE.CLIENT_READY_TO_SEND)},t.postReadyToSendStage=function(){this.$14(o("WAWebWamEnumClientMessageSendStage").CLIENT_MESSAGE_SEND_STAGE.CLIENT_READY_TO_SEND)},t.startClientEncryptStage=function(){this.$13(o("WAWebWamEnumClientMessageSendStage").CLIENT_MESSAGE_SEND_STAGE.CLIENT_ENCRYPT)},t.postClientEncryptStage=function(){this.$14(o("WAWebWamEnumClientMessageSendStage").CLIENT_MESSAGE_SEND_STAGE.CLIENT_ENCRYPT)},t.$13=function(t){var e=new(o("WAWebAndroidMessageSendPerfWamEvent")).AndroidMessageSendPerfWamEvent({sendStage:t});return this.$2.set(t,e),e},t.$14=function(t){var e,n,a,i,l,s=this.$2.get(t)||this.$13(t);if(s.mediaType=this.$5,s.messageType=this.$6,s.messageIsInvisible=this.$11,s.messageIsFirstUserMessage=this.$12,s.durationRelative=Date.now()-this.$1,s.fetchPrekeys=this.$3!=null&&this.$3>0,s.isRevokeMessage=this.$7,s.isDirectedMessage=this.$8,((e=this.$9)==null?void 0:e.isLid)!=null?s.isLid=this.$9.isLid:this.$6===o("WAWebWamEnumMessageType").MESSAGE_TYPE.INDIVIDUAL&&(s.isLid=this.$10.isLid()),((n=this.$9)==null?void 0:n.wamTypeOfGroup)!=null&&(s.typeOfGroup=this.$9.wamTypeOfGroup),((a=this.$9)==null?void 0:a.participantCount)!=null&&(s.participantCount=this.$9.participantCount),((i=this.$9)==null?void 0:i.deviceSizeBucket)!=null&&(s.deviceSizeBucket=this.$9.deviceSizeBucket),((l=this.$9)==null?void 0:l.deviceCount)!=null){var u=this.$9.deviceCount;s.deviceCount=u,this.$3!=null&&u>0&&(s.fetchPrekeysPercentage=Math.round(this.$3/u*100)),this.$4!=null&&u>0&&(s.senderKeyDistributionCountPercentage=Math.round(this.$4/u*100))}s.participantCount!=null&&s.participantCount>o("WAWebMessagingGatingUtils").getGroupSizeBypassingSampling()||s.fetchPrekeysPercentage!=null&&s.fetchPrekeysPercentage>=50||s.messageIsFirstUserMessage?s.weight=0:s.senderKeyDistributionCountPercentage!=null&&s.senderKeyDistributionCountPercentage>=50?r("gkx")("26258")?s.weight=20:s.weight=1:(s.deviceSizeBucket===o("WAWebWamEnumSizeBucket").SIZE_BUCKET.LT5000||s.deviceSizeBucket===o("WAWebWamEnumSizeBucket").SIZE_BUCKET.LARGEST_BUCKET)&&(r("gkx")("26258")?s.weight=100:s.weight=1),s.markDurationAbs(),s.commit()},e})();l.MessageSendPerfReporter=e}),98);
__d("WAWebWamEnumLogoutReasonType",[],(function(t,n,r,o,a,i){var e=Object.freeze({NETWORK_BLOCKED:1,WRITING_STANZA_ERROR:2,READING_STANZA_ERROR_IO:3,READING_STANZA_READING_IS_OVER:4,READING_STANZA_ERROR_CORRUPT_STREAM:5,PUSH_WITH_SAME_SESSION_ID:6,SCHEDULED_LOGOUT:7,CLIENT_PING_TIMEOUT:8,RECEIPT_TIMEOUT:9,ACTIVE_CONNECTION_TIMEOUT:10,NETWORK_CHANGED:11,SWITCH_ACCOUNT:12,DELETE_ACCOUNT:13,CHANGE_NUMBER:14,MBS_MIGRATION:15,REGISTRATION_RELATED:16,ROADBLOCKED_DETAIL:17,SERVER_ACK_KICK:18,SERVER_PING_KICK:19,CONNECTION_RESET:20});i.LOGOUT_REASON_TYPE=e}),66);
__d("WAWebWamEnumMediaUploadResultType",[],(function(t,n,r,o,a,i){var e=Object.freeze({OK:1,DUPLICATE:3,ERROR_UNKNOWN:2,ERROR_REQUEST:4,ERROR_UPLOAD:5,ERROR_OOM:6,ERROR_IO:7,ERROR_NO_PERMISSIONS:8,ERROR_BAD_MEDIA:9,ERROR_INSUFFICIENT_SPACE:10,ERROR_FNF:11,ERROR_CANCEL:12,ERROR_SERVER:13,ERROR_REQUEST_TIMEOUT:14,ERROR_NOT_FINALIZED:15,ERROR_OPTIMISTIC_HASH:16,ERROR_MEDIA_CONN:17,ERROR_DNS:18,ERROR_THROTTLE:19,ERROR_SSL:20,ERROR_NO_CLIENT_NETWORK:21,SKIPPED_EP_NOT_ONLINE:22,SKIPPED_EP_NOT_1TO1CHAT:23,SKIPPED_EP_UPLOAD_FAILED:24,SKIPPED_EP_MULTI_CHAT:25,SKIPPED_EP_NO_PRIMARY_HOST:26,ERROR_CRONET:27,ERROR_INCOMPLETE_SERVER_RESPONSE:28,ERROR_TRANSCODING:29,ERROR_CANCEL_PROGRAMMATIC:30,ERROR_NO_ROUTE:31,ERROR_TOO_LARGE:32,ERROR_CANNOT_TRANSCODE:33,ERROR_UNKNOWN_MIMETYPE:34,ERROR_UNSUPPORTED_MIMETYPE:35,ERROR_SERVER_REJECTED_MEDIA:36,ERROR_IO_ENCRYPTION:37,ERROR_NO_ENCRYPTION_ALGORITHM:38,ERROR_HOST_SWITCH_REQUIRED:39,ERROR_WAMSYS:40,ERROR_INVALID_URL:41,INTEGRITY_CHECK_FAILURE:42});i.MEDIA_UPLOAD_RESULT_TYPE=e}),66);
__d("WAWebWamEnumMessageSendResultType",[],(function(t,n,r,o,a,i){var e=Object.freeze({OK:1,ERROR_UNKNOWN:3,ERROR_NETWORK:4,ERROR_EXPIRED:5,ERROR_CANCELLED:6,ERROR_UPLOAD:7,ERROR_BACKFILL_USYNC_FAILED:8,ERROR_PAYLOAD_TOO_BIG:9,ERROR_LOCATION:10,ERROR_INVALID_MESSAGE:11,ERROR_E2EE:12,ERROR_INVALID_PROTOBUF:13,SERVER_ERROR:14,EPHEMERALLY_EXPIRED:15,MEDIA_UPLOAD_FAILED:16,ERROR_CLIENT_OUT_OF_MEMORY:17,ERROR_UPLOAD_CANCELLED_MANUALLY:18,ERROR_UPLOAD_CANCELLED_AUTOMATIC:19});i.MESSAGE_SEND_RESULT_TYPE=e}),66);
__d("WAWebWamEnumMessageSendSource",[],(function(t,n,r,o,a,i){var e=Object.freeze({NONE:1,UNANSWERED_CALL_UPSELL:2,UNANSWERED_CALL_UPSELL_REST:3,VIEW_ALL_REPLIES:4});i.MESSAGE_SEND_SOURCE=e}),66);
__d("WAWebMessageSendWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumAddressingMode","WAWebWamEnumAgentEngagementEnumType","WAWebWamEnumBotType","WAWebWamEnumChatOriginsType","WAWebWamEnumDisappearingChatInitiatorType","WAWebWamEnumE2eCiphertextType","WAWebWamEnumE2eFailureReason","WAWebWamEnumEditType","WAWebWamEnumEncryptionTypeCode","WAWebWamEnumEphemeralityInitiatorType","WAWebWamEnumEphemeralityTriggerActionType","WAWebWamEnumInvisibleMessageCategoryType","WAWebWamEnumLogoutReasonType","WAWebWamEnumMediaType","WAWebWamEnumMediaUploadResultType","WAWebWamEnumMessageDistributionEnumType","WAWebWamEnumMessageSendResultType","WAWebWamEnumMessageSendSource","WAWebWamEnumMessageType","WAWebWamEnumOppositeVisibleIdentificationType","WAWebWamEnumPairedMediaType","WAWebWamEnumPrivateAiFeatureName","WAWebWamEnumRevokeType","WAWebWamEnumSizeBucket","WAWebWamEnumStickerMakerSourceType","WAWebWamEnumTypeOfGroupEnum"],(function(t,n,r,o,a,i,l){var e,s=(e=o("WAWebWamCodegenUtils")).defineEvents({MessageSend:[854,{agentEngagementType:[49,o("WAWebWamEnumAgentEngagementEnumType").AGENT_ENGAGEMENT_ENUM_TYPE],appContext:[72,e.TYPES.STRING],appContextBitfield:[73,e.TYPES.INTEGER],botType:[55,o("WAWebWamEnumBotType").BOT_TYPE],chatOrigins:[58,o("WAWebWamEnumChatOriginsType").CHAT_ORIGINS_TYPE],chatSessionId:[67,e.TYPES.STRING],deviceCount:[31,e.TYPES.INTEGER],deviceSizeBucket:[25,o("WAWebWamEnumSizeBucket").SIZE_BUCKET],disappearingChatInitiator:[30,o("WAWebWamEnumDisappearingChatInitiatorType").DISAPPEARING_CHAT_INITIATOR_TYPE],e2eBackfill:[23,e.TYPES.BOOLEAN],e2eCiphertextType:[10,o("WAWebWamEnumE2eCiphertextType").E2E_CIPHERTEXT_TYPE],e2eCiphertextVersion:[9,e.TYPES.INTEGER],e2eFailureReason:[46,o("WAWebWamEnumE2eFailureReason").E2E_FAILURE_REASON],editDuration:[43,e.TYPES.INTEGER],editType:[44,o("WAWebWamEnumEditType").EDIT_TYPE],encryptionType:[76,o("WAWebWamEnumEncryptionTypeCode").ENCRYPTION_TYPE_CODE],ephemeralityDuration:[21,e.TYPES.INTEGER],ephemeralityInitiator:[47,o("WAWebWamEnumEphemeralityInitiatorType").EPHEMERALITY_INITIATOR_TYPE],ephemeralityTriggerAction:[48,o("WAWebWamEnumEphemeralityTriggerActionType").EPHEMERALITY_TRIGGER_ACTION_TYPE],excessPayloadKbSize:[40,e.TYPES.INTEGER],fastForwardEnabled:[15,e.TYPES.BOOLEAN],hasUsername:[59,e.TYPES.BOOLEAN],hasUsernamePin:[74,e.TYPES.BOOLEAN],invisibleMessageCategory:[64,o("WAWebWamEnumInvisibleMessageCategoryType").INVISIBLE_MESSAGE_CATEGORY_TYPE],isAComment:[54,e.TYPES.BOOLEAN],isAReply:[35,e.TYPES.BOOLEAN],isFromWamsys:[19,e.TYPES.BOOLEAN],isLid:[39,e.TYPES.BOOLEAN],isPq:[82,e.TYPES.BOOLEAN],isPremium:[69,e.TYPES.BOOLEAN],isViewOnce:[22,e.TYPES.BOOLEAN],isWhatsapiBuild:[75,e.TYPES.BOOLEAN],localAddressingMode:[53,o("WAWebWamEnumAddressingMode").ADDRESSING_MODE],logoutReason:[70,o("WAWebWamEnumLogoutReasonType").LOGOUT_REASON_TYPE],mediaCaptionPresent:[8,e.TYPES.BOOLEAN],mediaUploadError:[61,o("WAWebWamEnumMediaUploadResultType").MEDIA_UPLOAD_RESULT_TYPE],mediaUploadRetryCount:[62,e.TYPES.INTEGER],messageDistributionType:[41,o("WAWebWamEnumMessageDistributionEnumType").MESSAGE_DISTRIBUTION_ENUM_TYPE],messageForwardAgeT:[14,e.TYPES.TIMER],messageIsFanout:[5,e.TYPES.BOOLEAN],messageIsFastForward:[13,e.TYPES.BOOLEAN],messageIsFirstUserMessage:[26,e.TYPES.BOOLEAN],messageIsForward:[4,e.TYPES.BOOLEAN],messageIsInternational:[7,e.TYPES.BOOLEAN],messageIsInvisible:[29,e.TYPES.BOOLEAN],messageIsRevoke:[24,e.TYPES.BOOLEAN],messageKeyHash:[57,e.TYPES.STRING],messageMediaType:[3,o("WAWebWamEnumMediaType").MEDIA_TYPE],messageSendOptUploadEnabled:[12,e.TYPES.BOOLEAN],messageSendResult:[1,o("WAWebWamEnumMessageSendResultType").MESSAGE_SEND_RESULT_TYPE],messageSendResultIsTerminal:[17,e.TYPES.BOOLEAN],messageSendSource:[66,o("WAWebWamEnumMessageSendSource").MESSAGE_SEND_SOURCE],messageSendT:[11,e.TYPES.TIMER],messageType:[2,o("WAWebWamEnumMessageType").MESSAGE_TYPE],networkWasDisconnected:[37,e.TYPES.BOOLEAN],oppositeVisibleIdentification:[60,o("WAWebWamEnumOppositeVisibleIdentificationType").OPPOSITE_VISIBLE_IDENTIFICATION_TYPE],overallMediaSize:[42,e.TYPES.NUMBER],pairedMediaType:[71,o("WAWebWamEnumPairedMediaType").PAIRED_MEDIA_TYPE],participantCount:[32,e.TYPES.INTEGER],privateAiFeatureName:[81,o("WAWebWamEnumPrivateAiFeatureName").PRIVATE_AI_FEATURE_NAME],receiverDefaultDisappearingDuration:[28,e.TYPES.INTEGER],resendCount:[16,e.TYPES.INTEGER],retryCount:[6,e.TYPES.INTEGER],revokeDuration:[33,e.TYPES.INTEGER],revokeType:[34,o("WAWebWamEnumRevokeType").REVOKE_TYPE],runningTasks:[63,e.TYPES.STRING],sendButtonPressT:[45,e.TYPES.INTEGER],senderDefaultDisappearingDuration:[27,e.TYPES.INTEGER],serverErrorCode:[56,e.TYPES.INTEGER],sharedPhoneNumberContactSize:[77,e.TYPES.INTEGER],sharedPhoneNumberWithUsernameContactSize:[78,e.TYPES.INTEGER],sharedUsernameContactSize:[79,e.TYPES.INTEGER],stickerIsAi:[50,e.TYPES.BOOLEAN],stickerIsAvatar:[38,e.TYPES.BOOLEAN],stickerIsFirstParty:[18,e.TYPES.BOOLEAN],stickerIsFromStickerMaker:[51,e.TYPES.BOOLEAN],stickerMakerSourceType:[52,o("WAWebWamEnumStickerMakerSourceType").STICKER_MAKER_SOURCE_TYPE],thumbSize:[20,e.TYPES.NUMBER],typeOfGroup:[36,o("WAWebWamEnumTypeOfGroupEnum").TYPE_OF_GROUP_ENUM],unifiedSessionId:[68,e.TYPES.STRING],userToDeviceSizeBucket:[65,e.TYPES.STRING]},[1,1,1],"regular"]},{MessageSend:[]});l.MessageSendWamEvent=s}),98);
__d("WAWebRevokeMessageSendWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumMessageType","WAWebWamEnumRevokeType"],(function(t,n,r,o,a,i,l){var e,s=(e=o("WAWebWamCodegenUtils")).defineEvents({RevokeMessageSend:[3656,{messageSendResultIsTerminal:[1,e.TYPES.BOOLEAN],messageType:[2,o("WAWebWamEnumMessageType").MESSAGE_TYPE],resendCount:[3,e.TYPES.INTEGER],retryCount:[4,e.TYPES.INTEGER],revokeDuration:[5,e.TYPES.INTEGER],revokeType:[6,o("WAWebWamEnumRevokeType").REVOKE_TYPE]},[1,1,1],"regular"]},{RevokeMessageSend:[]});l.RevokeMessageSendWamEvent=s}),98);
__d("WAWebMessageSendReporter",["WALogger","WANullthrows","WAWebABProps","WAWebAppTracker","WAWebEditMessageSendWamEvent","WAWebEphemeralityResolver","WAWebFrontendContactGetters","WAWebLidStatusMigrationGating","WAWebMessageSendWamEvent","WAWebMsgGetters","WAWebMsgType","WAWebNewsletterGatingUtils","WAWebRevokeMessageSendWamEvent","WAWebUsernameTypes","WAWebWamAddressingModeUtils","WAWebWamEnumChatOriginsType","WAWebWamEnumEditType","WAWebWamEnumMediaType","WAWebWamEnumMessageDistributionEnumType","WAWebWamEnumMessageSendResultType","WAWebWamEnumMessageType","WAWebWamEnumRevokeType","WAWebWamGroupMetricUtils","WAWebWamMsgUtils","WAWebWamNumberToSizeBucket","cr:17143","cr:17144"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p,_,f=(e=n("cr:17143"))!=null?e:{},g=f.ContactCollection,h=(s=n("cr:17144"))!=null?s:{},y=h.ChatCollection,C=(function(){function e(e,t){var n;this.$3=!1,this.$4=o("WAWebWamEnumMediaType").MEDIA_TYPE.NONE,this.$1=e.to;var a=!!e.caption;e.type===o("WAWebMsgType").MSG_TYPE.DOCUMENT&&(a=o("WAWebMsgGetters").getIsCaptionByUser(e)),this.$2=new(o("WAWebMessageSendWamEvent")).MessageSendWamEvent({messageType:o("WAWebWamMsgUtils").getWamMessageType(e),messageMediaType:o("WAWebWamMsgUtils").getWamMediaType(e),mediaCaptionPresent:a,fastForwardEnabled:!0,messageIsFanout:!0,messageIsForward:!!e.isForwarded,messageIsRevoke:!!o("WAWebMsgGetters").getIsRevoke(e),isViewOnce:!!e.isViewOnce,isAReply:o("WAWebMsgGetters").getIsReply(e),e2eBackfill:!!(t!=null&&t.isResend),messageDistributionType:o("WAWebWamEnumMessageDistributionEnumType").MESSAGE_DISTRIBUTION_ENUM_TYPE.REGULAR_MESSAGE,editType:o("WAWebMsgGetters").getWamEditType(e),botType:o("WAWebWamMsgUtils").getWamBotType(this.$1,e.bizBotType),isAComment:o("WAWebMsgGetters").getType(e)===o("WAWebMsgType").MSG_TYPE.COMMENT});var i=o("WAWebMsgGetters").getIsGroupMsg(e),l=o("WAWebMsgGetters").getIsNewsletterMsg(e),s=e.to.isStatus(),_=g==null?void 0:g.getMeContact();this.$2.hasUsername=(_==null?void 0:_.username)!=null&&_.username!=="",this.$2.hasUsernamePin=(_==null?void 0:_.usernameKey)!=null;var f,h=(n=y==null?void 0:y.get(this.$1))!=null?n:{lidOriginType:o("WAWebUsernameTypes").LidOriginType.GENERAL};if(h!=null&&h.lidOriginType)switch(h==null?void 0:h.lidOriginType){case o("WAWebUsernameTypes").LidOriginType.PNH_CTWA:f=o("WAWebWamEnumChatOriginsType").CHAT_ORIGINS_TYPE.LID_CTWA;break;case o("WAWebUsernameTypes").LidOriginType.GENERAL:f=o("WAWebWamEnumChatOriginsType").CHAT_ORIGINS_TYPE.OTHERS;break}else this.$1.isLid()?f=o("WAWebWamEnumChatOriginsType").CHAT_ORIGINS_TYPE.LID_CTWA:f=o("WAWebWamEnumChatOriginsType").CHAT_ORIGINS_TYPE.OTHERS;if(f&&(this.$2.chatOrigins=f),_){var C=o("WAWebFrontendContactGetters").getDisplayNameAndType(_).type;C&&(this.$2.oppositeVisibleIdentification=C)}if(e.ephemeralDuration!=null&&(this.$2.ephemeralityDuration=e.ephemeralDuration),!i&&o("WAWebABProps").getABPropConfigValue("dm_initiator_trigger")||i&&o("WAWebABProps").getABPropConfigValue("dm_initiator_trigger_groups")){var b=o("WAWebMsgGetters").getWamDisappearingModeTrigger(e);b!=null&&(this.$2.ephemeralityTriggerAction=b);var v=o("WAWebMsgGetters").getWamDisappearingModeInitiatedByMe(e);v!=null&&(this.$2.ephemeralityInitiator=v)}if(!i&&!l&&!s){this.$2.isLid=this.$1.isLid(),o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["MessageSendReporter constructor before get ephemeral for me"])));var S=o("WAWebEphemeralityResolver").getEphemeralDurationForUser(g==null?void 0:g.getMeContact());o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["MessageSendReporter constructor after get ephemeral for me"]))),S!=null&&(this.$2.senderDefaultDisappearingDuration=S),o("WALogger").LOG(d||(d=babelHelpers.taggedTemplateLiteralLoose(["MessageSendReporter constructor before get ephemeral for wid"])));var R=o("WAWebEphemeralityResolver").getEphemeralDurationForUser(g==null?void 0:g.get(this.$1));o("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["MessageSendReporter constructor after get ephemeral for wid"]))),R!=null&&(this.$2.receiverDefaultDisappearingDuration=R)}if(o("WAWebMsgGetters").getIsRevoke(e)){this.$2.revokeType=e.subtype==="admin_revoke"?o("WAWebWamEnumRevokeType").REVOKE_TYPE.ADMIN:o("WAWebWamEnumRevokeType").REVOKE_TYPE.SENDER;var L=o("WAWebMsgGetters").getRevokeDuration(e);L!=null&&(this.$2.revokeDuration=L)}if(o("WAWebMsgGetters").getIsEditProtocolMsg(e)){var E=r("WANullthrows")(t==null?void 0:t.originalMessage);this.$2.editDuration=o("WAWebMsgGetters").getT(e)-o("WAWebMsgGetters").getT(E),this.$4=E.getWamMediaType()}var k=o("WAWebMsgGetters").getWamDisappearingModeInitiator(e);k!=null&&(this.$2.disappearingChatInitiator=k);var I=o("WAWebWamMsgUtils").getWamAgentEngagementType(e);if(I!=null&&(this.$2.agentEngagementType=I),i){var T;this.$2.isLid=!!(!(t==null||(T=t.groupData)==null)&&T.isLidAddressingMode),(t==null?void 0:t.groupData)!=null&&this.setGroupData(t.groupData)}s&&(this.$2.isLid=o("WAWebLidStatusMigrationGating").getLidStatusSendEnabled()),l&&o("WAWebNewsletterGatingUtils").isWamoSubLoggingEnabled()&&(this.$2.isPremium=!!e.isWamoSub),o("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["MessageSendReporter constructor done"])))}var t=e.prototype;return t.setDeviceCount=function(t){this.$2.deviceCount=o("WAWebWamGroupMetricUtils").capCount(t),this.$2.deviceSizeBucket=r("WAWebWamNumberToSizeBucket")(t)},t.setGroupData=function(t){var e=o("WAWebWamAddressingModeUtils").getAddressingModeMetricsFromGroupMetadata(t);e!=null&&(this.$2.localAddressingMode=e),t.wamTypeOfGroup!=null&&(this.$2.typeOfGroup=t.wamTypeOfGroup),t.participantCount!=null&&(this.$2.participantCount=t.participantCount),t.deviceCount!=null&&(this.$2.deviceCount=t.deviceCount),t.deviceSizeBucket!=null&&(this.$2.deviceSizeBucket=t.deviceSizeBucket)},t.setMessageDistributionType=function(t){this.$2.messageDistributionType=t},t.setMessageIsFirstUserMessage=function(t){this.$2.messageIsFirstUserMessage=t},t.postSuccess=function(){o("WAWebAppTracker").AppTracker.stop(o("WAWebAppTracker").AppTrackerType.SendMessage),this.$2.messageSendResult=o("WAWebWamEnumMessageSendResultType").MESSAGE_SEND_RESULT_TYPE.OK,this.$2.messageSendResultIsTerminal=!1,this.$5()},t.postFailure=function(t){var e=t.result,n=t.isTerminal;o("WAWebAppTracker").AppTracker.stop(o("WAWebAppTracker").AppTrackerType.SendMessage),this.$2.messageSendResult=e,this.$2.messageSendResultIsTerminal=n,this.$2.weight=0,this.$5()},t.$6=function(){new(o("WAWebRevokeMessageSendWamEvent")).RevokeMessageSendWamEvent({messageSendResultIsTerminal:this.$2.messageSendResultIsTerminal,messageType:this.$2.messageType,resendCount:this.$2.resendCount,retryCount:this.$2.retryCount,revokeDuration:this.$2.revokeDuration,revokeType:this.$2.revokeType}).commit()},t.$7=function(){new(o("WAWebEditMessageSendWamEvent")).EditMessageSendWamEvent({messageSendResultIsTerminal:this.$2.messageSendResultIsTerminal,messageType:this.$2.messageType,resendCount:this.$2.resendCount,retryCount:this.$2.retryCount,editType:this.$2.editType,editDuration:this.$2.editDuration,typeOfGroup:this.$2.typeOfGroup,mediaType:this.$4}).commit()},t.$5=function(){if(this.$3){o("WALogger").WARN(_||(_=babelHelpers.taggedTemplateLiteralLoose(["MessageSendReporter: skip posting, metric has already been posted"])));return}this.$3=!0,this.$2.markMessageSendT(),this.$2.messageSendT!=null&&o("WAWebAppTracker").attachWAMAppContext(this.$2,this.$2.messageSendT),this.$2.commit(),this.$2.messageIsRevoke&&this.$2.messageType!==o("WAWebWamEnumMessageType").MESSAGE_TYPE.STATUS&&this.$6(),this.$2.editType!==o("WAWebWamEnumEditType").EDIT_TYPE.NOT_EDITED&&this.$7()},e})();function b(e){var t=e.messageIsInvisible,n=new(o("WAWebMessageSendWamEvent")).MessageSendWamEvent({messageIsInvisible:t});return{setGroupData:function(t){t.wamTypeOfGroup!=null&&(n.typeOfGroup=t.wamTypeOfGroup),t.participantCount!=null&&(n.participantCount=t.participantCount),t.deviceCount!=null&&(n.deviceCount=t.deviceCount),t.deviceSizeBucket!=null&&(n.deviceSizeBucket=t.deviceSizeBucket)},post:function(){n.markMessageSendT(),n.commit()}}}l.MessageSendReporter=C,l.createMessageSendMetricReporter=b}),98);
__d("WAWebStorageHooksGatingUtils",["WAWebABProps"],(function(t,n,r,o,a,i,l){function e(){return o("WAWebABProps").getABPropConfigValue("web_dexie_hooks_support_enabled")}l.dexieHooksSupportEnabled=e}),98);
__d("WAWebStorageChatHookExpectAccountLid",["WALogger","WAWebCurrentUser","WAWebLid1X1MigrationGating","WAWebLidMigrationUtils","WAWebSchemaChat","WAWebWid","WAWebWidFactory","err"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m={type:"creating",callback:function(n,a){if(r("WAWebWid").isRegularUserNoImply(a.id)&&(o("WAWebLidMigrationUtils").toLid(o("WAWebWidFactory").createWid(a.id))==null&&(o("WAWebLidMigrationUtils").logLidMetadata(),o("WAWebCurrentUser").isEmployee()&&(o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["lid mapping is missing for ",""])),a.id),o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["Lid mapping is missing during creation"]))).sendLogs("lid-mapping-missing-during-chat-creation")),o("WALogger").WARN(u||(u=babelHelpers.taggedTemplateLiteralLoose(["Lid mapping is missing for chat creation"])))),o("WAWebLid1X1MigrationGating").Lid1X1MigrationUtils.isLidMigrated()&&a.accountLid==null)){o("WAWebLidMigrationUtils").logLidMetadata();var t=o("WAWebWidFactory").createWid(a.id);throw o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["cannot insert chat row for "," because accountLid is missing (migrated). isEmployee? ",". keys: ",""])),t.toLogString(),o("WAWebCurrentUser").isEmployee(),Object.keys(a)),o("WAWebCurrentUser").isEmployee()&&o("WALogger").ERROR(d||(d=babelHelpers.taggedTemplateLiteralLoose(["Lid is missing in chat table"]))).sendLogs("lid-missing-migrated-client"),r("err")("Lid is missing in chat table")}}};function p(){o("WAWebSchemaChat").getChatTable().addHook(m)}l.initializeHook=p}),98);
__d("WAWebStorageChatHookExpectLidOriginType",["WAWebSchemaChat","WAWebWid","err"],(function(t,n,r,o,a,i,l){var e={type:"creating",callback:function(t,n){if(r("WAWebWid").isStringLid(n.id)&&n.lidOriginType==null)throw r("err")("Lid origin type is missing in chat table")}};function s(){o("WAWebSchemaChat").getChatTable().addHook(e)}l.initializeHook=s}),98);
__d("WAWebStorageInitializeHooks",["WAWebStorageChatHookExpectAccountLid","WAWebStorageChatHookExpectLidOriginType"],(function(t,n,r,o,a,i,l){function e(){o("WAWebStorageChatHookExpectAccountLid").initializeHook(),o("WAWebStorageChatHookExpectLidOriginType").initializeHook()}l.initializeHooks=e}),98);
__d("WAWebModelStorage",["WAWebABPropsCache","WAWebModelStorageInitialize","WAWebStorageHooksGatingUtils","WAWebStorageInitializeHooks","WAWebUserPrefsIndexedDBStorage","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){function e(e){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){yield o("WAWebModelStorageInitialize").initializeWithoutGKs(e),yield o("WAWebUserPrefsIndexedDBStorage").userPrefsIdb.init(),o("WAWebABPropsCache").waitForABPropConfigsReady().then(function(){o("WAWebStorageHooksGatingUtils").dexieHooksSupportEnabled()&&o("WAWebStorageInitializeHooks").initializeHooks()})}),s.apply(this,arguments)}Object.keys(o("WAWebModelStorageInitialize")).forEach(function(e){e==="default"||e==="__esModule"||(l[e]=o("WAWebModelStorageInitialize")[e])}),l.initialize=e}),98);
__d("WAWebMsgFanoutTypes",[],(function(t,n,r,o,a,i){var e=Object.freeze({CHAT:"chat",GROUP_DIRECT:"groupDirect"});i.FANOUT_TYPE=e}),66);
__d("WAWebMsgSyncTunnelTimeoutUtils",[],(function(t,n,r,o,a,i){function e(e){var t=[],n=null;function r(){n=self.performance.now()}function o(){if(n==null)return t[t.length-1];var r=self.performance.now(),o=Math.floor(r-n);return n=null,t.length>=e&&t.shift(),t.push(o),o}function a(){if(t.length===0)return 0;var e=t.reduce(function(e,t){return e+t},0);return e/t.length}function i(e){var t=a();return Math.floor(t*(1+e/100))}return{perfStart:r,perfEnd:o,getAverage:a,getAveragePlusNPercent:i,at:function(n){var e;return(e=t.at(n))!=null?e:0}}}i.createPerformanceCache=e}),66);
__d("WAWebMsgSyncTunnelJobThrottler",["WALogger","WAWebMsgSyncTunnelTimeoutUtils","asyncToGeneratorRuntime","lodash"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m;function p(t,a,i){var l=[],c=a.defaultTimeoutMs,m=o("WAWebMsgSyncTunnelTimeoutUtils").createPerformanceCache(3),p=!1;function _(e){return f.apply(this,arguments)}function f(){return f=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){if(e===void 0&&(e=!1),l.length!==0&&!(p&&!e)){p=!0;var n=l;l=[],m.perfStart();try{yield i(n)}catch(e){l=n.concat(l),o("WALogger").WARN(d||(d=babelHelpers.taggedTemplateLiteralLoose(["[msg-tunnel] "," failed ",", cache "," items preserved, error ",""])),t,m.perfEnd(),n.length,e).sendLogs("msg-tunnel-"+t+"-failed",{sampling:.01})}p=!1;var r=m.perfEnd();if(r!=null&&a.defaultTimeoutMs<r){var s=15;if(c>r){var u=m.getAveragePlusNPercent(s);if(u<r)return;h(u);return}var _=m.getAveragePlusNPercent(s);if(c+100>=_)return;h(_)}}}),f.apply(this,arguments)}var g=r("lodash").throttle(_,c,{leading:!1,trailing:!0,maxWait:a.maxWait});function h(n){var i,l=c;if(c=Math.min(n,(i=a.debounceThreshold)!=null?i:15e3),c===a.debounceThreshold){if(l===c)return;g.cancel(),g=r("lodash").debounce(_,c,{leading:!1,trailing:!0,maxWait:a.maxWait}),o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[msg-tunnel] switch "," to debounce"])),t)}else g.cancel(),g=r("lodash").throttle(_,c,{leading:!1,trailing:!0,maxWait:a.maxWait});o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[msg-tunnel] set "," delayMs to ","ms"])),t,c),c>12e3&&o("WALogger").WARN(u||(u=babelHelpers.taggedTemplateLiteralLoose(["[msg-tunnel] "," delayMs is ","ms, config: ","ms"])),t,c,a.defaultTimeoutMs).sendLogs("msg-tunnel-"+t+"-exceeds-12s",{sampling:.01})}return{take:function(t){l.push(t),g()},forceDrain:(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){yield _(!0),h(a.defaultTimeoutMs)});function t(){return e.apply(this,arguments)}return t})()}}l.createJobThrottler=p}),98);
__d("WAWebMsgSyncTunnelBatcher",["Promise","WALogger","WAWebABProps","WAWebAddonLogUtils","WAWebCmd","WAWebMessagePostprocessRenderable","WAWebMessageProcessDBPipeline","WAWebMsgSyncTunnelJobThrottler","WAWebOfflineHandler","WAWebOfflineResumeTypes.flow","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u;function c(){var t,r,a=o("WAWebMsgSyncTunnelJobThrottler").createJobThrottler("write-db",{defaultTimeoutMs:(t=o("WAWebABProps").getABPropConfigValue("web_msg_sync_update_tunnel_timeout_ms"))!=null?t:500,debounceThreshold:5e3},(function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){try{var n=t.reduce(function(e,t){return e.concat(t.msgs)},[]);yield o("WAWebMessageProcessDBPipeline").processMsgDataDBPipeline(n,!0)}catch(t){o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["failed storing messages ",""])),t).tags("messaging").sendLogs("msg-tunnel-storing-failure")}});return function(e){return t.apply(this,arguments)}})()),i=o("WAWebMsgSyncTunnelJobThrottler").createJobThrottler("update-ui",{defaultTimeoutMs:(r=o("WAWebABProps").getABPropConfigValue("web_msg_sync_update_tunnel_timeout_ms"))!=null?r:500,maxWait:5e3},(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=yield(u||(u=n("Promise"))).allSettled(e.map(o("WAWebMessagePostprocessRenderable").postprocessRenderableMessages));o("WAWebAddonLogUtils").hasSettledWithError(t)&&o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["failed incoming addons processing"]))).tags("messaging").sendLogs("msg-tunnel-renderable-msgs-processing")});return function(t){return e.apply(this,arguments)}})()),l=function(t){i.take(t),a.take(t)},c=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){yield a.forceDrain(),yield i.forceDrain()});return function(){return e.apply(this,arguments)}})(),d=function(){var e=o("WAWebOfflineHandler").OfflineMessageHandler.getResumeType();return e===o("WAWebOfflineResumeTypes.flow").ResumeType.NonBlocking?o("WAWebABProps").getABPropConfigValue("web_msg_sync_update_tunnel"):!1};return{isEnabled:d,isActive:function(){return o("WAWebCmd").Cmd.isOfflineDeliveryEnd?!1:d()},accept:function(t){l(t)},drain:(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){yield c()});function t(){return e.apply(this,arguments)}return t})()}}var d=c();l.nonBlockingMsgsSyncTunnel=d}),98);
__d("WAWebNonBlockingOfflineResumeManager",["WALogger","WAShiftTimer","WAWebApiPendingDeviceSync","WAWebBackendApi","WAWebBrokerGlobalAppState","WAWebChatThreadLogging","WAWebCmd","WAWebHandleMsgTypes.flow","WAWebHandleOfflineAbProps","WAWebJSHaltDetector","WAWebMessageQueue","WAWebMsgSyncConfiguratedTunnel","WAWebMsgSyncTunnelBatcher","WAWebOffdStorageUpdateOfflinePeerReceipts","WAWebOfflineResumeConst","WAWebOfflineResumeMsgProcessReporter","WAWebOfflineResumeTypes.flow","WAWebOfflineResumeUtils","WAWebSignalProtocolStore","WAWebThreadMetadata","WAWebUserPrefsGeneral","WAWebWamEnumWebcScenarioType","WAWebWamMemoryStat","WAWebWamOfflineResumeReporter","WAWebWorkerSafeBackendApi","asyncToGeneratorRuntime","gkx"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p,_,f,g,h,y,C,b=100,v;function S(e){return v!=null&&v.updateOptions(e),v==null&&(v=new L(e)),v}function R(){v=null}var L=(function(){function t(e){var t=this;this.$9=null,this.$11=new(o("WAShiftTimer")).ShiftTimer(function(){o("WAWebCmd").Cmd.handleOfflineProgressUpdate(),t.$11.onOrAfter(o("WAWebOfflineResumeConst").UI_UPDATE_TIME_MS)}),this.$12=95,this.resumeType=o("WAWebOfflineResumeTypes.flow").ResumeType.NonBlocking,e!=null&&e.mainScreenLoaded&&(this.$6=!0),this.$13()}var a=t.prototype;return a.updateOptions=function(t){var e;this.$6=(e=t==null?void 0:t.mainScreenLoaded)!=null?e:!1},a.$13=function(){this.offlineMessagePreviewCounter=-1,this.$2=0,this.$3=0,this.$4=!1,this.$5=null,this.$1=o("WAWebOfflineResumeConst").ResumeStatus.INIT},a.$14=function(n){o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[offline-resume][non-blocking] offline resume stage: "," -> ",""])),this.$1,n),this.$1=n},a.processOfflinePreview=function(t){if(o("WAWebWamOfflineResumeReporter").OfflineResumeReporter.logOfflinePreviewT(),this.$6&&(o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[resume-from-open-tab] reset offline delivery end to false"]))),o("WAWebCmd").Cmd.resetOfflineDeliveryState()),this.isResumeFromRestartComplete())o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["[offline-resume][non-blocking] Offline session is complete when receiving offline preview ib."]))),o("WAWebOfflineResumeUtils").exceedResumeWithOpenTabLimit(t.message,t.receipt)&&(o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["[offline-resume][non-blocking] restart client due to exceed the LIMIT, message: ",", receipt: ",""])),t.message,t.receipt),o("WAWebOfflineResumeUtils").refreshWindow()),o("WAWebJSHaltDetector").jsHaltDetector.restartDetection(),this.$14(o("WAWebOfflineResumeConst").ResumeStatus.RESUME_WITH_OPEN_TAB),this.$15(t.message,t.receipt),o("WAWebBackendApi").frontendFireAndForget("updateChatSortListener",{enable:!1}),self.setTimeout(function(){o("WAWebBackendApi").frontendFireAndForget("updateChatSortListener",{enable:!0})},7e3);else if(this.$1===o("WAWebOfflineResumeConst").ResumeStatus.INIT)r("WAWebBrokerGlobalAppState").initOrUpdateTracking(o("WAWebWamEnumWebcScenarioType").WEBC_SCENARIO_TYPE.OFFLINE_RESUME),o("WAWebWamOfflineResumeReporter").OfflineResumeReporter.logOfflineCount(t),o("WAWebOfflineResumeMsgProcessReporter").msgProcessReporter.activate(t),this.offlineMessagePreviewCounter=t.message,this.$5=!1,this.$4=!0,this.$2=0,this.$10=Date.now(),o("WAWebSignalProtocolStore").enableMemSignalStore(),o("WAWebCmd").Cmd.handleOfflineProgressUpdate(),o("WAWebJSHaltDetector").jsHaltDetector.restartDetection(),this.$11.onOrAfter(o("WAWebOfflineResumeConst").UI_UPDATE_TIME_MS),this.$14(o("WAWebOfflineResumeConst").ResumeStatus.RESUME_ON_RESTART),this.$15(t.message,t.receipt),this.$6?o("WALogger").LOG(d||(d=babelHelpers.taggedTemplateLiteralLoose(["[resume-from-open-tab] Main screen is loaded"]))):this.$7=o("WAWebOfflineResumeUtils").loadMainScreen({});else{var e=this.$10;if(e!=null){var n=Date.now()-e;n<o("WAWebOfflineResumeConst").OFFLINE_PREVIEW_PERIOD_MS?(o("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["[offline-resume][non-blocking] Accept multiple offline preview ibs during offline resume, delay ","."])),n),this.offlineMessagePreviewCounter+=t.message,this.$5=!1,this.$4=!0,o("WAWebWamOfflineResumeReporter").OfflineResumeReporter.logOfflineCount(t)):r("gkx")("26258")?o("WALogger").LOG(_||(_=babelHelpers.taggedTemplateLiteralLoose(["[offline-resume][non-blocking] Reject multiple offline preview ib during offline resume, delay ","."])),n):o("WALogger").ERROR(p||(p=babelHelpers.taggedTemplateLiteralLoose(["[offline-resume][non-blocking] Reject multiple offline preview ibs during offline resume, delay ",""])),n).sendLogs("offline-multiple-preview")}this.$16()}},a.getOfflineDeliveryProgress=function(){return this.offlineMessagePreviewCounter===0?this.$12:Math.min(Math.ceil(100*this.$2/this.offlineMessagePreviewCounter),this.$12)},a.processOfflineSessionComplete=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t,n=this;if(self.setTimeout(function(){o("WAWebBackendApi").frontendFireAndForget("updateChatSortListener",{enable:!0})},3e3),(t=this.$9)==null||t.cancel(),this.$9=null,this.$1===o("WAWebOfflineResumeConst").ResumeStatus.COMPLETE){o("WAWebWamOfflineResumeReporter").OfflineResumeReporter.logLastStanzaT(),o("WAWebWamOfflineResumeReporter").OfflineResumeReporter.commit();return}else if(this.$1===o("WAWebOfflineResumeConst").ResumeStatus.RESUME_WITH_OPEN_TAB){yield o("WAWebMessageQueue").waitForOnlineMessageQueue(),yield o("WAWebApiPendingDeviceSync").doPendingDeviceSync(),this.$14(o("WAWebOfflineResumeConst").ResumeStatus.COMPLETE),o("WAWebCmd").Cmd.offlineDeliveryEnd();return}else this.$1===o("WAWebOfflineResumeConst").ResumeStatus.INIT&&(this.$5=!1,this.$4=!0,o("WAWebCmd").Cmd.handleOfflineProgressUpdate(),!this.$6&&!this.$7&&(this.$7=o("WAWebOfflineResumeUtils").loadMainScreen({})));return yield this.$7,this.$8=0,self.setTimeout(function(){n.$8>o("WAWebOfflineResumeConst").OFFLINE_STANZA_COUNT_LIMIT&&(o("WALogger").WARN(f||(f=babelHelpers.taggedTemplateLiteralLoose(["[offline-resume][non-blocking] "," received after offline completion marker. Refreshing window due to potential server issue."])),n.$8),o("WAWebOfflineResumeUtils").refreshWindow())},o("WAWebOfflineResumeConst").OFFLINE_STANZA_COUNT_CHECK_TIMEOUT_MS),this.$14(o("WAWebOfflineResumeConst").ResumeStatus.COMPLETE),this.$17()});function t(t){return e.apply(this,arguments)}return t})(),a.isResumeFromRestartComplete=function(){return this.$1!==o("WAWebOfflineResumeConst").ResumeStatus.RESUME_ON_RESTART&&this.$1!==o("WAWebOfflineResumeConst").ResumeStatus.INIT},a.isResumeFromRestartInProgress=function(){return this.$1!==o("WAWebOfflineResumeConst").ResumeStatus.INIT&&!o("WAWebCmd").Cmd.isOfflineDeliveryEnd},a.isResumeOnSocketDisconnectInProgress=function(){return this.$1===o("WAWebOfflineResumeConst").ResumeStatus.RESUME_WITH_OPEN_TAB},a.isResumeComplete=function(){return this.$1===o("WAWebOfflineResumeConst").ResumeStatus.COMPLETE},a.getHasMessagesToDownload=function(){return this.$5},a.getFinishedDownloading=function(){return this.getOfflineDeliveryProgress()===100},a.shouldUseOfflineResumeScreen=function(){return this.offlineMessagePreviewCounter>this.$2},a.processDecryptResult=function(t){this.$16(),this.$2+=1,t===o("WAWebHandleMsgTypes.flow").E2EProcessResult.RETRY&&(this.$3+=1)},a.offlineStanzaReceivedAfterComplete=function(){this.isResumeFromRestartComplete()&&(this.$8+=1)},a.newOfflineStanza=function(t,n){o("WAWebWamOfflineResumeReporter").OfflineResumeReporter.logAddOfflineSizeBytes(n),o("WAWebWamOfflineResumeReporter").OfflineResumeReporter.logOldestStanzaTime(t),this.$16()},a.getResumeUIProgressBarType=function(){return!o("WAWebCmd").Cmd.isOfflineDeliveryEnd&&this.offlineMessagePreviewCounter>=b?o("WAWebOfflineResumeTypes.flow").ResumeUIProgressBarType.Toastbar:o("WAWebOfflineResumeTypes.flow").ResumeUIProgressBarType.None},a.$16=function(){this.$9&&this.$9.onOrAfter(o("WAWebOfflineResumeConst").OFFLINE_STANZA_TIMEOUT_MS)},a.$15=function(t,n){var e,r=this;(e=this.$9)==null||e.cancel(),this.$9=new(o("WAShiftTimer")).ShiftTimer(function(){if(r.$1!==o("WAWebOfflineResumeConst").ResumeStatus.COMPLETE){o("WALogger").LOG(g||(g=babelHelpers.taggedTemplateLiteralLoose(["[offline-resume][non-blocking]: offline session completed by timeout"])));var e=o("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[offline-resume][non-blocking] offline resume finished by timeout"])));o("WAWebHandleOfflineAbProps").isNonBlockingOfflineResumeExpEnabled()&&(e=e.tags("offline-resume-experimental")),e.sendLogs("non-blocking-offline-resume-timeout",{sampling:.01}),r.processOfflineSessionComplete(t+n),r.$9=null,o("WAWebWamOfflineResumeReporter").OfflineResumeReporter.logMissedOfflineComplete()}}),this.$9.onOrAfter(o("WAWebOfflineResumeConst").OFFLINE_STANZA_TIMEOUT_MS)},a.$17=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){yield o("WAWebMessageQueue").waitForOfflineMessageQueue(),o("WAWebMsgSyncTunnelBatcher").nonBlockingMsgsSyncTunnel.isEnabled()&&(yield o("WAWebMsgSyncTunnelBatcher").nonBlockingMsgsSyncTunnel.drain()),o("WAWebMsgSyncConfiguratedTunnel").isMsgSyncTunnelActive()&&o("WAWebMsgSyncConfiguratedTunnel").msgSyncTunnel.completeUIUpdate(),o("WAWebWamOfflineResumeReporter").OfflineResumeReporter.logOfflineDecryptionErrorCount(this.$3),o("WAWebWamOfflineResumeReporter").OfflineResumeReporter.logLastStanzaT(),o("WAWebThreadMetadata").resetThreadMeta(),o("WALogger").LOG(y||(y=babelHelpers.taggedTemplateLiteralLoose(["[offline-resume][non-blocking] _onOfflineComplete: waitForOfflineMsgThread done, total decryption error: ",""])),this.$3),this.$3=0,yield o("WAWebOfflineResumeUtils").clearOfflineSnapShot(),this.$12=97,yield this.$7,yield o("WAWebOffdStorageUpdateOfflinePeerReceipts").updatePeerReceipts(),this.$12=99,o("WALogger").LOG(C||(C=babelHelpers.taggedTemplateLiteralLoose(["[offline-resume][non-blocking] _onOfflineComplete: clearOfflineSnapShot done."]))),o("WAWebCmd").Cmd.offlineDeliveryEnd(),o("WAWebUserPrefsGeneral").setOfflinePushCount(0),this.$11.forceRunNow(),this.$11.cancel(),o("WAWebWamOfflineResumeReporter").OfflineResumeReporter.commit(),o("WAWebSignalProtocolStore").enablePersistSignalStore(),o("WAWebOfflineResumeUtils").runReceiptCleanUpLoop(),o("WAWebWorkerSafeBackendApi").workerSafeFireAndForget("processAllOrphanPaymentNotifications"),o("WAWebChatThreadLogging").uploadChatThreadLoggingEvents(),r("WAWebBrokerGlobalAppState").initOrUpdateTracking(o("WAWebWamEnumWebcScenarioType").WEBC_SCENARIO_TYPE.IDLE),o("WAWebWamMemoryStat").setCurrentMemoryScenario(o("WAWebWamEnumWebcScenarioType").WEBC_SCENARIO_TYPE.IDLE),self.setTimeout(function(){o("WAWebApiPendingDeviceSync").doPendingDeviceSync()},o("WAWebOfflineResumeConst").OFFLINE_DEVICE_SYNC_DELAY)});function t(){return e.apply(this,arguments)}return t})(),t})();l.getOrCreateInstance=S,l.clearInstance=R,l.OfflineNonBlockingResumeStageManager=L}),98);
__d("WAWebNuxSyncKey",["WAWebNux"],(function(t,n,r,o,a,i,l){function e(e){switch(e){case o("WAWebNux").NUX.EPHEMERAL:return o("WAWebNux").NuxSyncKey.EPHEMERAL;case o("WAWebNux").NUX.EPHEMERAL_VIEW_ONCE:return o("WAWebNux").NuxSyncKey.EPHEMERAL_VIEW_ONCE;case o("WAWebNux").NUX.EPHEMERAL_VIEW_ONCE_RECEIVER:return o("WAWebNux").NuxSyncKey.EPHEMERAL_VIEW_ONCE_RECEIVER;case o("WAWebNux").NUX.STATUS_QUICK_REPLIES:return o("WAWebNux").NuxSyncKey.STATUS_QUICK_REPLIES;case o("WAWebNux").NUX.COMMUNITY:return o("WAWebNux").NuxSyncKey.COMMUNITY;case o("WAWebNux").NUX.COMMUNITY_HOME:return o("WAWebNux").NuxSyncKey.COMMUNITY_HOME;case o("WAWebNux").NUX.KEEP_IN_CHAT:return o("WAWebNux").NuxSyncKey.KEEP_IN_CHAT;case o("WAWebNux").NUX.FORWARD_MEDIA_WITH_CAPTION:return o("WAWebNux").NuxSyncKey.FORWARD_MEDIA_WITH_CAPTION;case o("WAWebNux").NUX.MESSAGE_EDIT:return o("WAWebNux").NuxSyncKey.MESSAGE_EDIT;case o("WAWebNux").NUX.NEWSLETTER_MULTI_ADMIN:return o("WAWebNux").NuxSyncKey.NEWSLETTER_MULTI_ADMIN;case o("WAWebNux").NUX.SUPPORT_AI:return o("WAWebNux").NuxSyncKey.SUPPORT_AI;case o("WAWebNux").NUX.TOOLTIP_STATUS_ENTRY_POINT:return o("WAWebNux").NuxSyncKey.TOOLTIP_STATUS_ENTRY_POINT;case o("WAWebNux").NUX.STATUS_PRIVATE_MENTIONS:return o("WAWebNux").NuxSyncKey.STATUS_PRIVATE_MENTIONS;case o("WAWebNux").NUX.MESSAGE_LABEL_DEPRECATION_MIGRATED_PERMANENT:return o("WAWebNux").NuxSyncKey.MESSAGE_LABEL_DEPRECATION_MIGRATED;case o("WAWebNux").NUX.ADD_TO_LISTS:return o("WAWebNux").NuxSyncKey.ADD_TO_LISTS;case o("WAWebNux").NUX.WEB_UI_REFRESH:return o("WAWebNux").NuxSyncKey.WEB_UI_REFRESH;case o("WAWebNux").NUX.DO_AUTOMATIC_LABEL:return o("WAWebNux").NuxSyncKey.DO_AUTOMATIC_LABEL;case o("WAWebNux").NUX.META_AI_CTA_BANNER:return o("WAWebNux").NuxSyncKey.META_AI_CTA_BANNER;case o("WAWebNux").NUX.META_AI_GLASSES_CTA_BANNER:return o("WAWebNux").NuxSyncKey.META_AI_GLASSES_CTA_BANNER;case o("WAWebNux").NUX.FEEDBACK_INTRO:return o("WAWebNux").NuxSyncKey.FEEDBACK_INTRO;case o("WAWebNux").NUX.NEWSLETTER_QUESTIONS_RESPONSE_PRIVACY_BANNER:return o("WAWebNux").NuxSyncKey.NEWSLETTER_QUESTIONS_RESPONSE_PRIVACY_BANNER;case o("WAWebNux").NUX.NEWSLETTER_QUESTIONS_PRIVACY_BANNER:return o("WAWebNux").NuxSyncKey.NEWSLETTER_QUESTIONS_PRIVACY_BANNER;case o("WAWebNux").NUX.MEDIA_HUB_TOOLTIP:return o("WAWebNux").NuxSyncKey.MEDIA_HUB_TOOLTIP;default:return o("WAWebNux").isCommunityAdminPromotionNuxKey(e)||o("WAWebNux").isChatAutoMutedNuxKey(e)?e:null}}l.getNuxSyncKey=e}),98);
__d("WAWebODS",["promiseDone","requireDeferred"],(function(t,n,r,o,a,i,l){"use strict";var e=r("requireDeferred")("WAWebODSImpl").__setRef("WAWebODS"),s={addListener:function(n){r("promiseDone")(e.load().then(function(e){e.addListener(n)}))},incr:function(n,o){r("promiseDone")(e.load().then(function(e){e.incr(n,o)}))}};l.default=s}),98);
__d("WAWebSchemaReadReceipt",["WAWebOffdStorageUtils","WAWebStorageMutationBuilder"],(function(t,n,r,o,a,i,l){var e=o("WAWebStorageMutationBuilder").columnBuilder(),s=e.addColumn,u=e.addUserDefinedPrimaryKey;function c(){o("WAWebOffdStorageUtils").getStorage().add("read-receipt").version(o("WAWebOffdStorageUtils").getStorage().versions.version(0),[u("id"),s("externalIds")]).delete(o("WAWebOffdStorageUtils").getStorage().versions.version(3)).view(function(e){return e})}l.addTable=c}),98);
__d("WAWebOffdStorage",["WALogger","WAWeb-dexie","WAWebDbRolloutUtil","WAWebDexieCastTypes","WAWebOffdStorageUtils","WAWebSchemaDanglingReceipt","WAWebSchemaPeerReadReceipt","WAWebSchemaPendingDeviceSync","WAWebSchemaReadReceipt","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s;function u(){return c.apply(this,arguments)}function c(){return c=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){return s==null&&(yield o("WAWebDbRolloutUtil").loadSchemaVersions(),o("WAWebOffdStorageUtils").createStorage(),o("WAWebSchemaReadReceipt").addTable(),o("WAWebSchemaDanglingReceipt").addTable(),o("WAWebSchemaPeerReadReceipt").addTable(),o("WAWebSchemaPendingDeviceSync").addTable(),s=o("WAWebOffdStorageUtils").getStorage().initialize().catch(function(t){throw o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["Assertion failed!"]))).verbose().devConsole(t).sendLogs("Failed to initialize offd storage",{sendLogsType:o("WALogger").SendLogsType.CRASH_OR_UNRECOVERABLE_ERROR_SAD}),t})),s}),c.apply(this,arguments)}function d(){return o("WAWebOffdStorageUtils").destroyStorage().catch(function(){return o("WAWebDexieCastTypes").dexieCastToPromise(new(r("WAWeb-dexie"))(o("WAWebOffdStorageUtils").DATABASE_NAME).delete())}).finally(function(){s=null})}l.initialize=u,l.destroy=d}),98);
__d("WAWebOfflineResumeMainThread",["WAWebABProps","WAWebBlockingOfflineResumeManager","WAWebNonBlockingOfflineResumeManager"],(function(t,n,r,o,a,i,l){function e(e){e.initState({getBlockingStageManager:function(){return o("WAWebABProps").getABPropConfigValue("web_offline_stage_manager_singleton_enabled")?(o("WAWebNonBlockingOfflineResumeManager").clearInstance(),o("WAWebBlockingOfflineResumeManager").getOrCreateInstance()):new(o("WAWebBlockingOfflineResumeManager")).OfflineBlockingResumeStageManager},getNonblockingStageManager:function(t){return o("WAWebABProps").getABPropConfigValue("web_offline_stage_manager_singleton_enabled")?(o("WAWebBlockingOfflineResumeManager").clearInstance(),o("WAWebNonBlockingOfflineResumeManager").getOrCreateInstance(t)):new(o("WAWebNonBlockingOfflineResumeManager")).OfflineNonBlockingResumeStageManager(t)}})}l.setupMainThreadResume=e}),98);
__d("WAWebParseReportResponse",["WALogger"],(function(t,n,r,o,a,i,l){var e,s;function u(t){switch(t.name){case"GroupReportResponseError":{var n=parseInt(t.value.errorSpamIqErrors.value.code,10),r=t.value.errorSpamIqErrors.value.text;return o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["parseGroupReportResponse: server response with ",", ",""])),n,r),{errorCode:n,errorText:r}}default:return t.name,t.value}}function c(e){switch(e.name){case"IndividualReportResponseError":{var t=parseInt(e.value.errorSpamIqErrors.value.code,10),n=e.value.errorSpamIqErrors.value.text;return o("WALogger").WARN(s||(s=babelHelpers.taggedTemplateLiteralLoose(["parseIndividualReportResponse: server response with ",", ",""])),t,n),{errorCode:t,errorText:n}}default:return e.name,e.value}}l.parseGroupReportResponse=u,l.parseIndividualReportResponse=c}),98);
__d("WAWebPostE2eMessageSendMetric",["WAWebBackendJobsCommon","WAWebE2eMessageSendWamEvent","WAWebWamEnumAgentEngagementEnumType","WAWebWamEnumEditType","WAWebWamMsgUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=e.to,n=e.retryCount,r=e.type,a=e.msg,i=e.editType,l=i===void 0?o("WAWebWamEnumEditType").EDIT_TYPE.NOT_EDITED:i,s=new(o("WAWebE2eMessageSendWamEvent")).E2eMessageSendWamEvent({e2eCiphertextVersion:o("WAWebBackendJobsCommon").CIPHERTEXT_VERSION,isLid:t.isLid(),retryCount:n,editType:l,botType:o("WAWebWamMsgUtils").getWamBotType(t,a==null?void 0:a.bizBotType)}),u=o("WAWebBackendJobsCommon").getMetricE2eDestination(t);return u!=null&&(s.e2eDestination=u),r!=null&&(s.e2eCiphertextType=o("WAWebBackendJobsCommon").getMetricE2eCiphertextType(r)),a&&(s.messageMediaType=o("WAWebWamMsgUtils").getWamMediaType(a),t.isBot()&&(a.id.remote.isBot()?s.agentEngagementType=o("WAWebWamEnumAgentEngagementEnumType").AGENT_ENGAGEMENT_ENUM_TYPE.DIRECT_CHAT:s.agentEngagementType=o("WAWebWamEnumAgentEngagementEnumType").AGENT_ENGAGEMENT_ENUM_TYPE.INVOKED)),s}function s(t){var n=e(t);n.e2eSuccessful=!0,n.commit()}function u(t){var n=e(t);n.e2eSuccessful=!1,n.weight=1,n.commit()}l.postSuccessDirectE2eMessageSendMetric=s,l.postFailureDirectE2eMessageSendMetric=u}),98);
__d("WAWebWamEnumPsBufferUploadResult",[],(function(t,n,r,o,a,i){var e=Object.freeze({SUCCESS:1,ERROR_PARSING:2,ERROR_DECODING:3,ERROR_CREDENTIAL:4,ERROR_OTHER:5,ERROR_CLIENT_NETWORK:6,ERROR_WAIT_FOR_TOKEN:7,ERROR_SERVER_OTHER:8,SKIPPED_NO_NETWORK:9,SKIPPED_NO_DATA:10,ERROR_ACCESS_TOKEN:11});i.PS_BUFFER_UPLOAD_RESULT=e}),66);
__d("WAWebWamEnumPsTokenNotReadyReason",[],(function(t,n,r,o,a,i){var e=Object.freeze({NO_REASON:0,REASON_UNKNOWN:1,REASON_WAIT_FOR_FIRST_TOKEN:2,REASON_INVALID_SHARED_KEY:3,REASON_INVALID_FACTOR:4,REASON_GEN_FACTOR_FAILURE:5,REASON_COMPUTE_HMAC_FAILURE:6,REASON_BLIND_FAILURE:7,REASON_UNBLIND_FAILURE:8,REASON_LAST_SIGNREQ_NETWORK_FAILURE:9,REASON_LAST_SIGNREQ_SERVER_ERROR:10,REASON_LAST_SIGNREQ_BAD_REQUEST:11,REASON_LAST_SIGNREQ_OTHER_ERROR:12,REASON_WAIT_FOR_GEN_TOKEN:13,REASON_GEN_SHAREDKEY_FAILURE:14,REASON_WAIT_FOR_GEN_FIRST_TOKEN:15});i.PS_TOKEN_NOT_READY_REASON=e}),66);
__d("WAWebWamEnumPsUploadReason",[],(function(t,n,r,o,a,i){var e=Object.freeze({REASON_PS_PINGER:0,REASON_PS_OFFCYCLE:1});i.PS_UPLOAD_REASON=e}),66);
__d("WAWebPsBufferUploadWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumApplicationState","WAWebWamEnumPsBufferUploadResult","WAWebWamEnumPsTokenNotReadyReason","WAWebWamEnumPsUploadReason"],(function(t,n,r,o,a,i,l){var e,s=(e=o("WAWebWamCodegenUtils")).defineEvents({PsBufferUpload:[2244,{applicationState:[6,o("WAWebWamEnumApplicationState").APPLICATION_STATE],isFromWamsys:[12,e.TYPES.BOOLEAN],isRealtime:[15,e.TYPES.BOOLEAN],isUserSampled:[14,e.TYPES.BOOLEAN],psBufferSequenceNumber:[13,e.TYPES.INTEGER],psBufferUploadHttpResponseCode:[3,e.TYPES.INTEGER],psBufferUploadResult:[1,o("WAWebWamEnumPsBufferUploadResult").PS_BUFFER_UPLOAD_RESULT],psBufferUploadT:[2,e.TYPES.TIMER],psDitheredT:[11,e.TYPES.INTEGER],psForceUpload:[10,e.TYPES.BOOLEAN],psTokenNotReadyReason:[4,o("WAWebWamEnumPsTokenNotReadyReason").PS_TOKEN_NOT_READY_REASON],psUploadReason:[9,o("WAWebWamEnumPsUploadReason").PS_UPLOAD_REASON],waConnectedToChatd:[5,e.TYPES.BOOLEAN]},[1,1,100],"regular"]},{PsBufferUpload:[]});l.PsBufferUploadWamEvent=s}),98);
__d("WAWebWamEnumPsIdAction",[],(function(t,n,r,o,a,i){var e=Object.freeze({CREATED:1,ROTATED:2,DELETED:3});i.PS_ID_ACTION=e}),66);
__d("WAWebPsIdUpdateWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumPsIdAction"],(function(t,n,r,o,a,i,l){var e,s=(e=o("WAWebWamCodegenUtils")).defineEvents({PsIdUpdate:[2862,{isFromWamsys:[4,e.TYPES.BOOLEAN],psIdAction:[2,o("WAWebWamEnumPsIdAction").PS_ID_ACTION],psIdKey:[1,e.TYPES.INTEGER],psIdRotationFrequence:[3,e.TYPES.INTEGER]},[1,1,1],"regular"]},{PsIdUpdate:[]});l.PsIdUpdateWamEvent=s}),98);
__d("WAWebRegistration",["Promise","WALogger","WAWebCryptoCurve25519","WAWebCryptoLibraryUtilsApi","WAWebSignalKeyApi","WAWebSignalStoreApi","WAWebUserPrefsInfoStore","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s;function u(){return c.apply(this,arguments)}function c(){return c=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=yield o("WAWebCryptoCurve25519").keyPair(),t=new Uint8Array(24);return self.crypto.getRandomValues(t),(s||(s=n("Promise"))).resolve(o("WAWebUserPrefsInfoStore").waNoiseInfo.set({recoveryToken:t.buffer,staticKeyPair:e,certificateChainBuffer:void 0}))}),c.apply(this,arguments)}function d(){return r("WAWebCryptoLibraryUtilsApi").makeRegistrationId()}function m(){return p.apply(this,arguments)}function p(){return p=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var t=d();yield o("WAWebSignalStoreApi").waSignalStore.clearCredential();var r=yield o("WAWebSignalKeyApi").generateIdentityKeyPair();try{yield(s||(s=n("Promise"))).all([o("WAWebSignalStoreApi").waSignalStore.setRegistrationInfo({registrationId:t,identityKeyPair:r}),o("WAWebSignalStoreApi").waSignalStore.rotateSignedPreKey(o("WAWebCryptoCurve25519").toSignalCurveKeyPair(r),o("WAWebSignalKeyApi").generateSignedKeyPair)])}catch(t){throw o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["failed to refreshSignalCredentials: ",""])),t),t}}),p.apply(this,arguments)}l.refreshNoiseCredentials=u,l.refreshSignalCredentials=m}),98);
__d("WAWebRetryRequestParser",["WADeprecatedWapParser","WAWebJidToWid","WAWebUserPrefsMeUser"],(function(t,n,r,o,a,i,l){var e=new(r("WADeprecatedWapParser"))("retryRequestParser",function(e){e.assertTag("receipt");var t=e.attrString("type");if(t!=="retry"&&t!=="enc_rekey_retry")throw e.createParseError('to have type "retry" or "enc_rekey_retry", got "'+t+'"');e.hasAttr("to")&&e.assertAttr("to",o("WAWebUserPrefsMeUser").getMeDevicePnOrThrow().toJid());var n=o("WAWebJidToWid").jidWithTypeToWid(e.attrJidWithType("from")),r=e.hasAttr("participant")?o("WAWebJidToWid").deviceJidToDeviceWid(e.attrDeviceJid("participant")):null,a=!1;r!=null&&r.isBot()&&e.hasAttr("is_lid")&&(a=e.attrString("is_lid")==="true");var i=e.hasAttr("recipient")?o("WAWebJidToWid").deviceJidToUserWid(e.attrDeviceJid("recipient")):null,l=e.child("retry"),s=e.maybeChild("keys"),u=null;if(s!=null){var c,d=s.child("skey"),m={identity:s.child("identity").contentBytes(32),deviceIdentity:(c=s.maybeChild("device-identity"))==null?void 0:c.contentBytes(),skey:{id:d.child("id").contentUint(3),pubkey:d.child("value").contentBytes(32),signature:d.child("signature").contentBytes(64)}};if(n.isFbidBot()||n.isGroup()&&r!=null&&r.isFbidBot()){var p=null,_=s.maybeChild("key");_!=null&&(p={id:_.child("id").contentUint(3),pubkey:_.child("value").contentBytes(32)}),u=babelHelpers.extends({type:"bot_retry"},m,{key:p})}else{var f=s.child("key");u=babelHelpers.extends({type:"regular_retry"},m,{key:{id:f.child("id").contentUint(3),pubkey:f.child("value").contentBytes(32)}})}}return{stanzaId:e.attrString("id"),originalMsgId:l.attrString("id"),ts:e.attrTime("t"),retryCount:l.hasAttr("count")?l.attrInt("count"):0,regId:e.child("registration").contentUint(4),offline:e.hasAttr("offline"),from:n,participant:r,isLid:a,recipient:i,keyBundle:u,type:t}}),s=e;l.default=s}),98);
__d("WAWebRichTextInputConst",[],(function(t,n,r,o,a,i){var e="@",l="\u200B",s=l+"(\\d+@(c\\.us|lid|bot))"+l,u=l+"((\\d+-)?\\d+@g\\.us)"+l;i.AT_SYMBOL=e,i.ZWS=l,i.userJidRegexStr=s,i.groupJidRegexStr=u}),66);
__d("WAWebScanDbRowApi",["WAWebMsgType"],(function(t,n,r,o,a,i,l){var e,s=new Set([(e=o("WAWebMsgType")).MSG_TYPE.AUDIO,e.MSG_TYPE.CHAT,e.MSG_TYPE.DOCUMENT,e.MSG_TYPE.GROUPS_V4_INVITE,e.MSG_TYPE.HSM,e.MSG_TYPE.IMAGE,e.MSG_TYPE.INTERACTIVE,e.MSG_TYPE.LIST,e.MSG_TYPE.LOCATION,e.MSG_TYPE.MULTI_VCARD,e.MSG_TYPE.ORDER,e.MSG_TYPE.PAYMENT,e.MSG_TYPE.PRODUCT,e.MSG_TYPE.PTT,e.MSG_TYPE.STICKER,e.MSG_TYPE.TEMPLATE_BUTTON_REPLY,e.MSG_TYPE.VCARD,e.MSG_TYPE.VIDEO,e.MSG_TYPE.AUTOMATED_GREETING_MESSAGE]);function u(e,t){if(t==="lru-media-meta-info"){var n=0;return e.size!=null&&typeof e.size=="number"&&(n+=e.size),n+=m(e),n}return m(e)}function c(e,t){return t==="message"&&!s.has(e.type)}function d(e,t,n){return t==="lru-media-meta-info"&&n==="lru-media-storage-idb"?1:e}function m(e){var t=0;return JSON.stringify(e,function(e,n){if(typeof e=="string"&&(t+=2*e.length),n instanceof ArrayBuffer)t+=n.byteLength;else if(n instanceof Blob)t+=n.size;else if(typeof n=="number")t+=8;else if(typeof n=="boolean")t+=1;else if(typeof n=="string")t+=2*n.length;else return n}),t}l.estimateSize=u,l.skipRow=c,l.getSampleRateOverride=d}),98);
__d("WAWebWamChatPSALogger",["WAWebChatMuteWamEvent","WAWebChatPsaActionWamEvent","WAWebChatPsaReadWamEvent","WAWebChatPsaRemoveWamEvent","WAWebWamEnumActionConducted","WAWebWamEnumChatMuteNotificationChoice","WAWebWamEnumMuteChatType","WAWebWamEnumPsaMessageActionType","WAWebWamEnumPsaMessageRemoveAction","WAWebWamEnumPsaMessageRemoveEntryPoint","WAWebWamEnumReadEntryPoint","WAWebWamEnumWaOfficialAccountName","WAWebWamMsgUtils"],(function(t,n,r,o,a,i,l){function e(e){if(e.campaignId!=null){var t;new(o("WAWebChatPsaReadWamEvent")).ChatPsaReadWamEvent({messageMediaType:e.getWamMediaType(),psaMsgId:e.id.id.toString(),psaCampaignId:(t=e.campaignId)==null?void 0:t.toString(),readEntryPoint:o("WAWebWamEnumReadEntryPoint").READ_ENTRY_POINT.CHAT}).commit()}}function s(e,t){new(o("WAWebChatMuteWamEvent")).ChatMuteWamEvent({actionConducted:o("WAWebWamEnumActionConducted").ACTION_CONDUCTED.MUTE,chatMuteNotificationChoice:o("WAWebWamEnumChatMuteNotificationChoice").CHAT_MUTE_NOTIFICATION_CHOICE.NO_NOTIFICATIONS_WHEN_MUTED,muteChatType:o("WAWebWamEnumMuteChatType").MUTE_CHAT_TYPE.ONE_ON_ONE,muteDuration:t,muteEntryPoint:e,waOfficialAccountName:o("WAWebWamEnumWaOfficialAccountName").WA_OFFICIAL_ACCOUNT_NAME.WHATSAPP_CHATPSA}).commit()}function u(e){new(o("WAWebChatMuteWamEvent")).ChatMuteWamEvent({actionConducted:o("WAWebWamEnumActionConducted").ACTION_CONDUCTED.UNMUTE,muteChatType:o("WAWebWamEnumMuteChatType").MUTE_CHAT_TYPE.ONE_ON_ONE,muteEntryPoint:e,waOfficialAccountName:o("WAWebWamEnumWaOfficialAccountName").WA_OFFICIAL_ACCOUNT_NAME.WHATSAPP_CHATPSA}).commit()}function c(e){var t;new(o("WAWebChatPsaActionWamEvent")).ChatPsaActionWamEvent({messageMediaType:e.getWamMediaType(),psaCampaignId:(t=e.campaignId)==null?void 0:t.toString(),psaMessageActionType:o("WAWebWamEnumPsaMessageActionType").PSA_MESSAGE_ACTION_TYPE.SAVE,psaMsgId:e.id.id.toString()}).commit()}function d(e){var t;new(o("WAWebChatPsaActionWamEvent")).ChatPsaActionWamEvent({messageMediaType:o("WAWebWamMsgUtils").getWamMediaType(e),psaCampaignId:(t=e.campaignId)==null?void 0:t.toString(),psaMessageActionType:o("WAWebWamEnumPsaMessageActionType").PSA_MESSAGE_ACTION_TYPE.DELETE,psaMsgId:e.id.id.toString()}).commit()}function m(e){var t;new(o("WAWebChatPsaActionWamEvent")).ChatPsaActionWamEvent({messageMediaType:e.getWamMediaType(),psaCampaignId:(t=e.campaignId)==null?void 0:t.toString(),psaMessageActionType:o("WAWebWamEnumPsaMessageActionType").PSA_MESSAGE_ACTION_TYPE.FORWARD,psaMsgId:e.id.id.toString()}).commit()}function p(e,t,n){new(o("WAWebChatPsaActionWamEvent")).ChatPsaActionWamEvent({messageMediaType:e,psaCampaignId:t==null?void 0:t.toString(),psaMessageActionType:o("WAWebWamEnumPsaMessageActionType").PSA_MESSAGE_ACTION_TYPE.MEDIA_PLAY,psaMsgId:n.toString()}).commit()}function _(e,t,n){e?new(o("WAWebChatPsaRemoveWamEvent")).ChatPsaRemoveWamEvent({lastReceivedMediaType:e.getWamMediaType(),lastReceivedMessageTs:e.t,lastReceivedMsgId:e.id.id.toString(),psaMessageRemoveAction:f(t),psaMessageRemoveEntryPoint:g(n),waOfficialAccountName:o("WAWebWamEnumWaOfficialAccountName").WA_OFFICIAL_ACCOUNT_NAME.WHATSAPP_CHATPSA}).commit():new(o("WAWebChatPsaRemoveWamEvent")).ChatPsaRemoveWamEvent({psaMessageRemoveAction:f(t),psaMessageRemoveEntryPoint:g(n),waOfficialAccountName:o("WAWebWamEnumWaOfficialAccountName").WA_OFFICIAL_ACCOUNT_NAME.WHATSAPP_CHATPSA}).commit()}function f(e){switch(e){case 1:return o("WAWebWamEnumPsaMessageRemoveAction").PSA_MESSAGE_REMOVE_ACTION.BLOCK;case 2:return o("WAWebWamEnumPsaMessageRemoveAction").PSA_MESSAGE_REMOVE_ACTION.UNBLOCK;case 3:return o("WAWebWamEnumPsaMessageRemoveAction").PSA_MESSAGE_REMOVE_ACTION.ARCHIVE;case 4:return o("WAWebWamEnumPsaMessageRemoveAction").PSA_MESSAGE_REMOVE_ACTION.UNARCHIVE;case 5:return o("WAWebWamEnumPsaMessageRemoveAction").PSA_MESSAGE_REMOVE_ACTION.CLEAR;case 6:return o("WAWebWamEnumPsaMessageRemoveAction").PSA_MESSAGE_REMOVE_ACTION.DELETE_ALL}}function g(e){switch(e){case 1:return o("WAWebWamEnumPsaMessageRemoveEntryPoint").PSA_MESSAGE_REMOVE_ENTRY_POINT.BLOCK_FROM_CONTACT_INFO;case 2:return o("WAWebWamEnumPsaMessageRemoveEntryPoint").PSA_MESSAGE_REMOVE_ENTRY_POINT.BLOCK_FROM_CHAT;case 3:return o("WAWebWamEnumPsaMessageRemoveEntryPoint").PSA_MESSAGE_REMOVE_ENTRY_POINT.UNBLOCK_FROM_CONTACT_INFO;case 4:return o("WAWebWamEnumPsaMessageRemoveEntryPoint").PSA_MESSAGE_REMOVE_ENTRY_POINT.UNBLOCK_FROM_CHAT;case 5:return o("WAWebWamEnumPsaMessageRemoveEntryPoint").PSA_MESSAGE_REMOVE_ENTRY_POINT.UNBLOCK_FROM_PRIVACY_SETTINGS;case 6:return o("WAWebWamEnumPsaMessageRemoveEntryPoint").PSA_MESSAGE_REMOVE_ENTRY_POINT.ARCHIVE_FROM_CHAT_LIST;case 7:return o("WAWebWamEnumPsaMessageRemoveEntryPoint").PSA_MESSAGE_REMOVE_ENTRY_POINT.ARCHIVE_FROM_DELETE_OPTION;case 8:return o("WAWebWamEnumPsaMessageRemoveEntryPoint").PSA_MESSAGE_REMOVE_ENTRY_POINT.UNARCHIVE_FROM_ARCHIVED_CHAT_LIST;case 9:return o("WAWebWamEnumPsaMessageRemoveEntryPoint").PSA_MESSAGE_REMOVE_ENTRY_POINT.CLEAR_FROM_CONTACT_INFO;case 10:return o("WAWebWamEnumPsaMessageRemoveEntryPoint").PSA_MESSAGE_REMOVE_ENTRY_POINT.CLEAR_FROM_CHAT_LIST;case 11:return o("WAWebWamEnumPsaMessageRemoveEntryPoint").PSA_MESSAGE_REMOVE_ENTRY_POINT.DELETE_ALL_FROM_CHAT_LIST;case 12:return o("WAWebWamEnumPsaMessageRemoveEntryPoint").PSA_MESSAGE_REMOVE_ENTRY_POINT.DELETE_ALL_FROM_CONTACT_INFO;case 13:return o("WAWebWamEnumPsaMessageRemoveEntryPoint").PSA_MESSAGE_REMOVE_ENTRY_POINT.DELETE_ALL_FROM_CONVERSATION;case 14:return o("WAWebWamEnumPsaMessageRemoveEntryPoint").PSA_MESSAGE_REMOVE_ENTRY_POINT.CLEAR_FROM_CONVERSATION}}l.logChatPSARead=e,l.logChatPSAMute=s,l.logChatPSAUnmute=u,l.logChatPSAStar=c,l.logChatPSADelete=d,l.logChatPSAForward=m,l.logChatPSAMediaPlay=p,l.logChatPSARemove=_}),98);
__d("WAWebSendReadReceiptJob",["Promise","WAJids","WALogger","WANullthrows","WATimeUtils","WAWebAck","WAWebApiChat","WAWebDBMsgUtils","WAWebHandlePlaceholderWam","WAWebLidMigrationUtils","WAWebModelStorageUtils","WAWebMsgGetters","WAWebMsgKey","WAWebMsgType","WAWebPrivacySettings","WAWebSchemaMessage","WAWebSendReceiptJobCommon","WAWebUserPrefsGeneral","WAWebUserPrefsMeUser","WAWebWamChatPSALogger","WAWebWid","WAWebWidFactory","asyncToGeneratorRuntime","justknobx"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p,_,f,g=o("WAWebWidFactory").createWid(o("WAJids").STATUS_JID);function h(e,t){return e.isNewsletter()||e.isStatus()&&t!=null&&t.isPSA()||r("WAWebWid").isPSA(e)?o("WAWebSendReceiptJobCommon").RECEIPT_TYPE.READ_SELF:e.isGroup()?o("WAWebSendReceiptJobCommon").RECEIPT_TYPE.READ:o("WAWebUserPrefsGeneral").getUserPrivacySettings().readReceipts===o("WAWebPrivacySettings").ALL_NONE.none?o("WAWebSendReceiptJobCommon").RECEIPT_TYPE.READ_SELF:o("WAWebSendReceiptJobCommon").RECEIPT_TYPE.READ}function y(e,t){return C.apply(this,arguments)}function C(){return C=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,a){o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["markChatRead"])));var i=Date.now().toString(),l=String(t.id),u=yield o("WAWebApiChat").queryPendingReadReceiptMsgRows(l);o("WALogger").DEV(s||(s=babelHelpers.taggedTemplateLiteralLoose(["markChatRead: chatId: ",", lastKey: ",", pendings: "," "])),l,a,u.length),u.sort(function(e,t){var n=e.rowId||0,r=t.rowId||0;return n-r});var c=a?String(a):null,d=u.length-1;if(c){for(d;d>=0&&u[d].id!==c;d--);d<0&&(d=u.length-1)}var m=null,p=[];for(d;d>=0;d--){var _=u[d],g=t.msgs.get(_.id);g&&r("WAWebWid").isPSA(t.id)&&o("WAWebWamChatPSALogger").logChatPSARead(g),_.rowId!=null&&(m==null||_.rowId>m)&&(m=_.rowId);var y=r("WAWebMsgKey").fromString(_.id);if(_.type===o("WAWebMsgType").MSG_TYPE.CIPHERTEXT){o("WAWebHandlePlaceholderWam").postPlaceholderActivityViewEvent([_]);continue}var C=_.broadcastId||_.from,b=_.author||_.from;p.push({id:y.id,sender:o("WAWebWidFactory").createWidFromWidLike(b),chat:o("WAWebWidFactory").createWidFromWidLike(C)})}var v=L(p),S=v[0],R=v[1];return yield(f||(f=n("Promise"))).all([].concat(Array.from(S.keys()).map(function(e){var n=S.get(e);if(n){var r;return t.trusted?r=h(t.id):r=o("WAWebSendReceiptJobCommon").RECEIPT_TYPE.READ_SELF,o("WAWebSendReceiptJobCommon").sendAggregateReceipts({to:e,type:r,t:i,groupedReceipt:n})}}),Array.from(R.keys()).map(function(e){var t=S.get(e);if(t)return o("WAWebSendReceiptJobCommon").sendAggregateReceipts({to:e,type:o("WAWebSendReceiptJobCommon").RECEIPT_TYPE.READ_SELF,t:i,groupedReceipt:t})}))),o("WAWebApiChat").markMessageAndChatAsRead(m,l,!1)}),C.apply(this,arguments)}function b(e,t,n){return v.apply(this,arguments)}function v(){return v=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n){var a=e.id;if(!o("WAWebMsgGetters").getIsStatus(e)){o("WALogger").WARN(u||(u=babelHelpers.taggedTemplateLiteralLoose(["markStatusRead: message is not a status."])));return}if(!(a.fromMe&&!r("justknobx")._("5152"))){var i=o("WAWebMsgGetters").getIsGroupStatus(e)?e.id.remote:g,l=n==null||n.sendReceipt===!0;l?yield o("WAWebSendReceiptJobCommon").sendAggregateReceipts({to:i,type:h(i,r("WANullthrows")(a.participant)),t:String(t),groupedReceipt:new Map([[r("WANullthrows")(a.participant),[a.id]]])}):o("WALogger").DEV(c||(c=babelHelpers.taggedTemplateLiteralLoose(["markStatusRead: Not marking status as read because chat is not trusted"])));var s={ack:o("WAWebAck").ACK.READ};a.participant&&a.participant.isPSA()&&(s.statusPSAReadTimestamp=t);var d=[babelHelpers.extends({id:a.toString()},s)],m=o("WAWebLidMigrationUtils").getAlternateMsgKey(a);m&&d.push(babelHelpers.extends({id:m.toString()},s)),yield o("WAWebSchemaMessage").getMessageTable().bulkMergeOnly(d)}}),v.apply(this,arguments)}function S(e){return R.apply(this,arguments)}function R(){return R=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=String(o("WATimeUtils").unixTime()),r=L(e.filter(function(e){return!o("WAWebUserPrefsMeUser").isSerializedWidMe(e.sender)}).map(function(e){return{chat:e.msgKey.remote,sender:o("WAWebWidFactory").createWidFromWidLike(e.sender),id:e.msgKey.id}})),a=r[0];yield(f||(f=n("Promise"))).all(Array.from(a.keys()).map(function(e){var n=a.get(e);if(n)return o("WAWebSendReceiptJobCommon").sendAggregateReceipts({to:e,type:o("WAWebSendReceiptJobCommon").RECEIPT_TYPE.READ_SELF,t:t,groupedReceipt:n})}))}),R.apply(this,arguments)}function L(e){var t=new Map,n=new Map;return e.forEach(function(e){var r,o,a=e.chat,i=e.sender,l=e.id,s=!a.isBot()&&i.isBot(),u=s?n:t,c=(r=u.get(a))!=null?r:new Map,d=(o=c.get(i))!=null?o:[];d.push(l),c.set(i,d),u.set(a,c)}),[t,n]}function E(e,t){return k.apply(this,arguments)}function k(){return k=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var a=String(e),i=yield I(a);if(i.length){o("WALogger").DEV(d||(d=babelHelpers.taggedTemplateLiteralLoose(["[message-edit/mark-as-read]: start"]))).devConsole({chatIdString:a,pendingMsgRows:i});var l=i.map(function(t){var n=r("WAWebMsgKey").fromString(t.latestEditMsgKey),a=t.author||t.from;return{id:n.id,sender:o("WAWebWidFactory").createWidFromWidLike(a),chat:o("WAWebWidFactory").createWidFromWidLike(e)}}),s=L(l),u=s[0],c=s[1],f=u.get(e),g=c.get(e),y=Date.now().toString();if(f){var C;t.trusted?C=h(e):C=o("WAWebSendReceiptJobCommon").RECEIPT_TYPE.READ_SELF,yield o("WAWebSendReceiptJobCommon").sendAggregateReceipts({to:e,type:C,t:y,groupedReceipt:f}),o("WALogger").DEV(m||(m=babelHelpers.taggedTemplateLiteralLoose(["[message-edit/mark-as-read]: sent read receipts"]))).devConsole({groupedReceiptsBySender:f})}return g&&(yield o("WAWebSendReceiptJobCommon").sendAggregateReceipts({to:e,type:o("WAWebSendReceiptJobCommon").RECEIPT_TYPE.READ_SELF,t:y,groupedReceipt:g}),o("WALogger").DEV(p||(p=babelHelpers.taggedTemplateLiteralLoose(["[message-edit/mark-as-read]: sent bot read-self receipts"]))).devConsole({botInvokeResponseGroupedReceiptsBySender:g})),o("WAWebModelStorageUtils").getStorage().lock(["message"],(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e[0],n=new Set(l.map(function(e){return e.id})),i=(yield I(a)).filter(function(e){return n.has(r("WAWebMsgKey").fromString(e.latestEditMsgKey).id)}),s=i.map(function(e){return{id:e.id,pendingReadReceipt:null}});s.length>0&&(yield t.bulkCreateOrMerge(s),o("WALogger").DEV(_||(_=babelHelpers.taggedTemplateLiteralLoose(["[message-edit/mark-as-read]: marked edits as read"]))).devConsole({msgUpdates:s}))});return function(t){return e.apply(this,arguments)}})())}}),k.apply(this,arguments)}function I(e){return o("WAWebSchemaMessage").getMessageTable().equals(["from","pendingReadReceipt"],[e,o("WAWebDBMsgUtils").PendingReadReceiptType.MessageEdit],{shouldDecrypt:!1})}l.getReadReceiptType=h,l.markChatRead=y,l.markStatusRead=b,l.sendAddOnReadReceipts=S,l.groupMsgIdsByChatThenSender=L,l.markEditedMsgsRead=E}),98);
__d("WAWebSetPushConfigJob",["WABase64","WADeprecatedSendIq","WADeprecatedWapParser","WALogger","WANullthrows","WAWap","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u=new(r("WADeprecatedWapParser"))("setPushConfig",function(t){if(!t.hasChild("error")){o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["setPushConfig: success"]))).tags("push-notification");return}var n=t.child("error"),r=n.attrInt("code"),a=n.attrString("text");return o("WALogger").WARN(s||(s=babelHelpers.taggedTemplateLiteralLoose(["setPushConfig: server response with ",", ",""])),r,a).tags("push-notification"),{errorCode:r,errorText:a}});function c(e){return d.apply(this,arguments)}function d(){return d=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t,n=(t=o("WAWap")).wap("iq",{to:t.S_WHATSAPP_NET,type:"set",xmlns:"urn:xmpp:whatsapp:push",id:t.generateId()},t.wap("config",{platform:"web",endpoint:t.CUSTOM_STRING(e.endpoint),auth:t.CUSTOM_STRING(o("WABase64").encodeB64(r("WANullthrows")(e.getKey("auth")))),p256dh:t.CUSTOM_STRING(o("WABase64").encodeB64(r("WANullthrows")(e.getKey("p256dh"))))})),a=yield o("WADeprecatedSendIq").deprecatedSendIq(n,u);if(!a.success){var i=a.errorCode,l=a.errorText;return{errorCode:i,errorText:l}}return a.result}),d.apply(this,arguments)}l.setPushConfig=c}),98);
__d("WAWebSetWorkerLocalStorage",["WANullthrows","WAWebApiLocalStorage","WAWebEnvironment","WAWebGuestUserPrefs","WAWebUserPrefsKeys","WAWebUserPrefsMeUser","WAWebWidToJid","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){function e(){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=r("WANullthrows")(o("WAWebUserPrefsMeUser").getMaybeMeDeviceLid()),t=o("WAWebUserPrefsMeUser").getMeDisplayNameOrThrow(),n=[{key:"deviceJid",value:o("WAWebWidToJid").widToDeviceJid(o("WAWebUserPrefsMeUser").getMeDevicePnOrThrow())},{key:"lidDeviceJid",value:e.toString()},{key:o("WAWebUserPrefsKeys").KEYS.ME_DISPLAY_NAME,value:t}];r("WAWebEnvironment").isGuest&&n.push({key:o("WAWebUserPrefsKeys").KEYS.GUEST_ACTIVE_INVITE_CODE,value:o("WAWebGuestUserPrefs").getActiveGuestInviteCode()}),yield o("WAWebApiLocalStorage").updateLocalStorage(n)}),s.apply(this,arguments)}function u(){return o("WAWebApiLocalStorage").clearLocalStorage()}l.setWorkerLocalStorage=e,l.clearWorkerLocalStorage=u}),98);
__d("WAWebSharedConstants",[],(function(t,n,r,o,a,i){var e="__wa-mms",l="mms-type";i.IS_MMS_URL_SEARCH_PARAM=e,i.MMS_URL_MEDIA_TYPE_SEARCH_PARAM=l}),66);
__d("WAWebSingleChevronInCircleIcon.react",["WAWebSvgComponentBase","react","stylex"],(function(t,n,r,o,a,i,l){var e=["iconXstyle","height","width","name","viewBox"],s,u,c=s||(s=r("react")),d="single-chevron-in-circle";function m(t){var n=t.iconXstyle,a=t.height,i=t.width,l=t.name,s=t.viewBox,m=babelHelpers.objectWithoutPropertiesLoose(t,e),p;if(s){var _=s.x,f=_===void 0?0:_,g=s.y,h=g===void 0?0:g,y=s.width,C=y===void 0?0:y,b=s.height,v=b===void 0?0:b;p=[f,h,C,v].join(" ")}var S=20,R=20;return(a!=null||i!=null)&&(S=a,R=i),c.jsx(o("WAWebSvgComponentBase").BaseSvgSpan,babelHelpers.extends({name:l!=null?l:d},m,{children:c.jsxs("svg",{viewBox:p!=null?p:"0 0 20 20",height:S,width:R,preserveAspectRatio:"xMidYMid meet",className:(u||(u=r("stylex")))(n),fill:"none",children:[c.jsx("title",{children:l!=null?l:d}),c.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M10.0034 1.66992C14.6034 1.66992 18.3367 5.40326 18.3367 10.0033C18.3367 14.6033 14.6034 18.3366 10.0034 18.3366C5.40338 18.3366 1.67004 14.6033 1.67004 10.0033C1.67004 5.40326 5.40338 1.66992 10.0034 1.66992ZM10.0034 3.33659C6.32004 3.33659 3.33671 6.31992 3.33671 10.0033C3.33671 13.6866 6.32004 16.6699 10.0034 16.6699C13.6867 16.6699 16.67 13.6866 16.67 10.0033C16.67 6.31992 13.6867 3.33659 10.0034 3.33659ZM10.7327 9.99904L8.57734 12.1565C8.25234 12.4815 8.26068 13.0148 8.57734 13.3398C8.90234 13.6648 9.42734 13.6648 9.75234 13.3398L12.4994 10.5907C12.8244 10.2657 12.8244 9.74071 12.4994 9.41571L9.75563 6.67319C9.43063 6.34819 8.90563 6.34819 8.58063 6.67319C8.25563 6.99819 8.25563 7.52319 8.58063 7.84819L10.7327 9.99904Z",fill:"currentColor "})]})}))}m.displayName=m.name+" [from "+i.id+"]",l.SingleChevronInCircleIcon=m}),98);
__d("WAWebSmbUtilsTimeUtils",["WAWeb-moment","WAWebClock"],(function(t,n,r,o,a,i,l){var e="h:mm A",s="h:mmA",u="H:mm",c="H.mm",d="HH:mm",m="HH.mm",p=[e,s,d,m,u,c],_=function(t){var e,n=t.trim();if(n){for(var o of p){var a=r("WAWeb-moment")(n,o,!0);if(a.isValid()){e=a;break}}if(e){var i=e,l=r("WAWeb-moment")().startOf("day"),s=i.diff(l);return r("WAWeb-moment").duration(s).asMinutes()}}};function f(e){return r("WAWeb-moment").utc().startOf("day").add(e,"minutes").format(o("WAWebClock").Clock.timestampStrFormat())}l.timeStringToMinutes=_,l.minutesToTime=f}),98);
__d("WAWebSpamConstants",["WAWebMsgType"],(function(t,n,r,o,a,i,l){var e,s=Object.freeze({Block:"block_dialog",OverflowMenuBlock:"overflow_menu_block",OverflowMenuReport:"overflow_menu_report",MediaViewer:"media_viewer",MessageMenu:"message_menu",CommunityHome:"community_home",AccountInfoReport:"account_info_report",AccountInfoReportAsGuestUser:"account_info_report_as_guest_user",GroupInfoReport:"group_info_report",GroupSpamBannerReport:"group_spam_banner_report",OneToOneChatSpamBannerReport:"1_1_spam_banner_report",OneToOneOldSpamBannerBlock:"1_1_old_spam_banner_block",BizSpamBannerBlock:"biz_spam_banner_block",ChatListBlock:"chat_list_block",ChatListNoInsubBlock:"chat_list_noinsub_block",NotificationBlock:"notification_block",StatusPostReport:"status_post_report",NewsletterInfoReport:"newsletter_info_report",ChatFmxCardReportAsGuestUser:"chat_fmx_card_report_as_guest_user",ChatFmxCardSafetyToolsReport:"chat_fmx_card_safety_tools_report",ChatFmxCardSafetyToolsReportSuspicious:"chat_fmx_card_safety_tools_report_suspicious",GroupFmxCardLeave:"group_fmx_card_leave",GroupFmxCardLeaveNonSuspicious:"group_fmx_card_leave_non_suspicious",GroupInfoLeaveReportUpsell:"group_info_leave_report_upsell",GroupChatlistLeaveReportUpsell:"group_chatlist_leave_report_upsell",GroupOverflowMenuLeaveReportUpsell:"group_overflow_menu_leave_report_upsell",GroupSafetyCheckModalUpsell:"group_safety_check_bottom_sheet",CommentActions:"comment_actions_bottom_sheet",NewsletterQuestionResponseReport:"newsletter_question_response_report",GalaxyFlowsContextMenuReport:"extension_menu_report"}),u=new Set([(e=o("WAWebMsgType")).MSG_TYPE.CHAT,e.MSG_TYPE.AUDIO,e.MSG_TYPE.IMAGE,e.MSG_TYPE.PTT,e.MSG_TYPE.PTV,e.MSG_TYPE.VIDEO,e.MSG_TYPE.VCARD,e.MSG_TYPE.LIST,e.MSG_TYPE.LIST_RESPONSE,e.MSG_TYPE.BUTTONS_RESPONSE,e.MSG_TYPE.NATIVE_FLOW,e.MSG_TYPE.DOCUMENT,e.MSG_TYPE.STICKER,e.MSG_TYPE.LOCATION,e.MSG_TYPE.POLL_CREATION,e.MSG_TYPE.POLL_RESULT_SNAPSHOT,e.MSG_TYPE.STATUS,e.MSG_TYPE.EVENT_CREATION,e.MSG_TYPE.STICKER_PACK,e.MSG_TYPE.NEWSLETTER_QUESTION_RESPONSE]),c=new Set([].concat(Array.from(u),[e.MSG_TYPE.UNKNOWN,e.MSG_TYPE.REVOKED,e.MSG_TYPE.CIPHERTEXT,e.MSG_TYPE.INTERACTIVE]));l.SpamFlow=s,l.SUPPORTED_MESSAGE_TYPES_FOR_MESSAGE_LEVEL_REPORTING=u,l.SPAM_REPORT_SUPPORTED_MESSAGE_TYPES=c}),98);
__d("WAWebSpamUtils",["WAWebMsgType","WAWebSpamConstants"],(function(t,n,r,o,a,i,l){function e(e){return o("WAWebSpamConstants").SUPPORTED_MESSAGE_TYPES_FOR_MESSAGE_LEVEL_REPORTING.has(e)}function s(e){return o("WAWebSpamConstants").SPAM_REPORT_SUPPORTED_MESSAGE_TYPES.has(e)}function u(e){switch(e){case"album":return 0;case"audio":return 1;case"automated_greeting_message":return 2;case"biz_content_placeholder":return 3;case"biz-cover-photo":return 4;case"broadcast_notification":return 5;case"buttons_response":return 6;case"call_log":return 7;case"chat":return 8;case"ciphertext":return 9;case"comment":return 10;case"debug":return 11;case"debug_placeholder":return 12;case"document":return 13;case"e2e_notification":return 14;case"event_creation":return 15;case"event_edit_encrypted":return 16;case"event_response":return 17;case"gp2":return 18;case"groups_v4_invite":return 19;case"guest_upsell_system_msg":return 20;case"history_bundle":return 21;case"hsm":return 22;case"image":return 23;case"interactive":return 24;case"interactive_response":return 25;case"keep_in_chat":return 26;case"list":return 27;case"list_response":return 28;case"location":return 29;case"multi_vcard":return 30;case"native_flow":return 31;case"newsletter_admin_invite":return 32;case"newsletter_notification":return 33;case"newsletter_question_response":return 34;case"notification":return 35;case"notification_template":return 36;case"order":return 37;case"oversized":return 38;case"payment":return 39;case"pin_message":return 40;case"pinned_message":return 41;case"poll_creation":return 42;case"poll_result_snapshot":return 43;case"poll_update":return 44;case"product":return 45;case"protocol":return 46;case"ptt":return 47;case"ptv":return 48;case"reaction":return 49;case"reaction_enc":return 50;case"request_phone_number":return 51;case"revoked":return 52;case"rich_response":return 53;case"status":return 54;case"status_notification":return 55;case"sticker":return 56;case"sticker-pack":return 57;case"template_button_reply":return 58;case"unknown":return 59;case"vcard":return 60;case"video":return 61;case"newsletter_follower_invite":return 62;case o("WAWebMsgType").MSG_TYPE.MESSAGE_HISTORY_BUNDLE:return 63;case"message_history_notice":return 64;case o("WAWebMsgType").MSG_TYPE.QUARANTINED:return 65;case o("WAWebMsgType").MSG_TYPE.MESSAGE_EDIT_ENCRYPTED:return 66}}l.isMsgTypeSupportedForMsgLevelReporting=e,l.isSpamSupportedForMessageType=s,l.msgTypeToReportLocalMessageType=u}),98);
__d("WAWebStatsUploadJob",["Promise","WALogger","WASmaxStatsSendBufferRPC","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m;function p(e,t){return _.apply(this,arguments)}function _(){return _=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,r){o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["fieldStatsUpload:sendSendBufferRPC start"])));var a=yield o("WASmaxStatsSendBufferRPC").sendSendBufferRPC({addT:r,addElementValue:t});o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["fieldStatsUpload:sendSendBufferRPC end"])));var i;if(a.name==="SendBufferResponseSuccess")return o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["fieldStatsUpload:sendSendBufferRPC SendBufferResponseSuccess"]))),(m||(m=n("Promise"))).resolve();a.name==="SendBufferResponseErrorNoRetry"?(i=a.value.errorSendBufferNoRetryError.value,o("WALogger").DEV(c||(c=babelHelpers.taggedTemplateLiteralLoose(["SendBufferResponseErrorNoRetry: ",""])),i.code)):(a.name,i=a.value.errorIQErrorServiceUnavailableMixin,o("WALogger").DEV(d||(d=babelHelpers.taggedTemplateLiteralLoose(["SendBufferResponseErrorRetry: ",""])),i.code));var l=i,p=l.code,_=l.text;return{errorCode:parseInt(p,10),errorText:_}}),_.apply(this,arguments)}l.default=p}),98);
__d("WAWebSubscribePushManagerAction",["WABase64","WALogger","WAWebGetPushServerSettingsJob","WAWebL10N","WAWebMiscErrors","WAWebPushNotificationsGatingUtils","WAWebSetPushConfigJob","WAWebSetWorkerLocalStorage","asyncToGeneratorRuntime","cr:9685"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p,_,f,g,h,y,C,b,v,S,R,L,E;function k(){return I.apply(this,arguments)}function I(){return I=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(o("WAWebPushNotificationsGatingUtils").canSupportOfflineNotifications()&&(o("WALogger").DEV(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[push-notification] attempt to update push manager started"]))),"serviceWorker"in navigator)){var t,a,i,l=n("cr:9685").isOfflineNotificationsEnabled(),m=(t=yield n("cr:9685").shouldSubscribePushManager(l))!=null?t:!1,p=yield(a=window.navigator.serviceWorker)==null?void 0:a.ready;if(p==null){o("WALogger").WARN(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[push-notification] failed to check and update push manager due to no service worker registration"])));return}var _=p==null||(i=p.pushManager)==null||i.getSubscription==null?void 0:i.getSubscription();if(_==null){o("WALogger").WARN(u||(u=babelHelpers.taggedTemplateLiteralLoose(["[push-notification] failed to get push manager"])));return}if(p.scope!==window.location.origin+window.location.pathname){o("WALogger").DEV(c||(c=babelHelpers.taggedTemplateLiteralLoose(["[push-notification] the current service worker scope is invalid, service worker scope: ",", current scope: ",""])),p.scope,window.location.origin+window.location.pathname);return}var f=(yield _)!=null;o("WALogger").DEV(d||(d=babelHelpers.taggedTemplateLiteralLoose(["[push-notification] hasPushSubscription: ",", shouldSubscribePushManager: ",""])),f,m),m?f?(n("cr:9685").updateOfflineNotificationL10nStrings(),r("WAWebL10N").on("locale_change",function(){n("cr:9685").updateOfflineNotificationL10nStrings()})):D():f&&$()}}),I.apply(this,arguments)}function T(e){e?D():$()}function D(){return x.apply(this,arguments)}function x(){return x=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(o("WAWebPushNotificationsGatingUtils").canEnableOfflineNotifications()){o("WALogger").DEV(m||(m=babelHelpers.taggedTemplateLiteralLoose(["[push-notification] attempt to subscribe push manager started"])));try{var e;if(!("serviceWorker"in navigator)){o("WALogger").DEV(p||(p=babelHelpers.taggedTemplateLiteralLoose(["[push-notification] failed to subscribe push manager due to service worker does not exist"])));return}var t=yield(e=window.navigator.serviceWorker)==null?void 0:e.ready;if(t==null){o("WALogger").DEV(_||(_=babelHelpers.taggedTemplateLiteralLoose(["[push-notification] failed to subscribe push manager due to service worker is not ready yet"])));return}var r=yield t.pushManager.getSubscription();if(r!=null){o("WALogger").DEV(f||(f=babelHelpers.taggedTemplateLiteralLoose(["[push-notification] failed to subscribe push manager due to push manager is already subscribed"])));return}var a=yield o("WAWebGetPushServerSettingsJob").getPushServerSettings();if(a.errorCode!=null){o("WALogger").WARN(g||(g=babelHelpers.taggedTemplateLiteralLoose(["[push-notification] failed to subscribe push manager due to unable to get push server settings with error code ",""])),a.errorCode);return}var i=new Uint8Array(o("WABase64").decodeB64UrlSafe(String(a))),l={userVisibleOnly:!0,applicationServerKey:i},s=yield t.pushManager.subscribe(l),u=yield o("WAWebSetPushConfigJob").setPushConfig(s);if((u==null?void 0:u.errorCode)!=null){o("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[push-notification] failed to subscribe push manager due to send client push subscription data to server failure with error ",""])),u.errorText);return}yield o("WAWebSetWorkerLocalStorage").setWorkerLocalStorage(),yield n("cr:9685").updateOfflineNotificationL10nStrings(),o("WALogger").DEV(y||(y=babelHelpers.taggedTemplateLiteralLoose(["[push-notification] successfully subscribed push manager"])))}catch(e){o("WALogger").WARN(C||(C=babelHelpers.taggedTemplateLiteralLoose(["[push-notification] failed to subscribe push manager due to error: ",""])),e)}}}),x.apply(this,arguments)}function $(){return P.apply(this,arguments)}function P(){return P=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(!o("WAWebPushNotificationsGatingUtils").canSupportOfflineNotifications())return!1;o("WALogger").DEV(b||(b=babelHelpers.taggedTemplateLiteralLoose(["[push-notification] attempt to unsubscribe push manager started"])));try{var e;if(!("serviceWorker"in navigator))return o("WALogger").DEV(v||(v=babelHelpers.taggedTemplateLiteralLoose(["[push-notification] failed to unsubscribe push manager due to service worker does not exist"]))),!1;var t=yield(e=window.navigator.serviceWorker)==null?void 0:e.ready;if(t==null)return o("WALogger").DEV(S||(S=babelHelpers.taggedTemplateLiteralLoose(["[push-notification] failed to unsubscribe push manager due to no service worker registration"]))),!1;var n=yield t.pushManager.getSubscription();if(n==null)return o("WALogger").DEV(R||(R=babelHelpers.taggedTemplateLiteralLoose(["[push-notification] failed to unsubscribe push manager due to no active push subscription"]))),!1;var r=yield n.unsubscribe();return yield o("WAWebSetWorkerLocalStorage").clearWorkerLocalStorage().catch(function(e){if(!(e instanceof o("WAWebMiscErrors").DbOnLogoutAbort))throw e}),o("WALogger").DEV(L||(L=babelHelpers.taggedTemplateLiteralLoose(["[push-notification] successfully unsubscribed push manager"]))),r}catch(e){return o("WALogger").WARN(E||(E=babelHelpers.taggedTemplateLiteralLoose(["[push-notification] failed to unsubscribe push manager due to error: ",""])),e),!1}}),P.apply(this,arguments)}l.updatePushManager=k,l.handleOfflineNotifications=T,l.unsubscribePushManager=$}),98);
__d("WAWebSupportChatStrings",["fbt"],(function(t,n,r,o,a,i,l,s){function e(){return s._(/*BTDS*/"Cuenta oficial de Soporte")}function u(){return s._(/*BTDS*/"Este chat es con la cuenta oficial de Soporte de WhatsApp. Haz clic para obtener m\u00e1s informaci\u00f3n.")}function c(){return s._(/*BTDS*/"Obt\u00e9n m\u00e1s informaci\u00f3n acerca de los chats con Soporte de WhatsApp.")}function d(){return s._(/*BTDS*/"WhatsApp protege tus mensajes y llamadas con esta cuenta.")}function m(){return s._(/*BTDS*/"Este es el chat oficial de Soporte de WhatsApp. M\u00e1s de 2 mil millones de personas en m\u00e1s de 180 pa\u00edses utilizan WhatsApp para mantenerse en contacto con amigos y familiares, en cualquier momento y lugar. WhatsApp es gratuito y ofrece mensajer\u00eda y llamadas sencillas, seguras y confiables, disponibles en tel\u00e9fonos de todo el mundo.")}function p(){return s._(/*BTDS*/"Iniciar chat")}function _(){return s._(/*BTDS*/"Soporte de WhatsApp recibi\u00f3 tu solicitud e iniciar\u00e1 un chat contigo en breve.")}function f(){return s._(/*BTDS*/"Si contin\u00faas, autorizas a Soporte de WhatsApp a que revise la informaci\u00f3n t\u00e9cnica de tu cuenta para poder responder tu pregunta. Es posible que los mensajes de Soporte de WhatsApp los genere la IA a trav\u00e9s de una tecnolog\u00eda segura de Meta. Tus mensajes y llamadas personales permanecen cifrados de extremo a extremo.")}function g(){return s._(/*BTDS*/"Si contin\u00faas, autorizas a Soporte de WhatsApp a que revise la informaci\u00f3n t\u00e9cnica de tu cuenta para ayudar a responder tu pregunta. Es posible que los mensajes de Soporte de WhatsApp los genere la IA a trav\u00e9s de una tecnolog\u00eda segura de Meta.")}function h(){return s._(/*BTDS*/"Algunas respuestas las genera la IA a trav\u00e9s de una tecnolog\u00eda segura de Meta. WhatsApp usa tus mensajes con Soporte de WhatsApp para proporcionarte respuestas relevantes. Tus mensajes y llamadas personales permanecen cifrados de extremo a extremo.")}function y(){return s._(/*BTDS*/"Algunas respuestas las genera la IA a trav\u00e9s de una tecnolog\u00eda segura de Meta. WhatsApp usa tus mensajes con Soporte de WhatsApp para proporcionarte respuestas relevantes.")}function C(){return s._(/*BTDS*/"Si haces clic en Enviar, indicas que aceptas que WhatsApp revise la informaci\u00f3n de diagn\u00f3stico y rendimiento, y los metadatos asociados a tu cuenta para intentar solucionar el problema reportado.")}function b(){return s._(/*BTDS*/"Sin conexi\u00f3n a Internet")}function v(){return s._(/*BTDS*/"Debes conectarte a Internet para acceder al chat con Soporte de WhatsApp. Revisa la conexi\u00f3n a Internet de tu dispositivo y vuelve a intentarlo.")}l.SupportChatSubtitle=e,l.SupportChatSystemMessage=u,l.SupportChatLearnMoreLinkText=c,l.SupportChatSecurityModalText=d,l.SupportChatDescription=m,l.SupportChatStartButtonText=p,l.SupportChatConfirmationModalText=_,l.SupportChatDeviceInfoAIDisclaimer=f,l.SupportChatDeviceInfoAISmbDisclaimer=g,l.SupportAINuxDisclaimer=h,l.SupportAINuxSmbDisclaimer=y,l.SupportChatDeviceInfoDisclaimer=C,l.SupportChatNoInternetModalTitle=b,l.SupportChatNoInternetModalMessage=v}),226);
__d("WAWebUpdaterDownloadStateType",["$InternalEnum"],(function(t,n,r,o,a,i){var e=n("$InternalEnum").Mirrored(["UPDATE_DOWNLOADED","UPDATE_NOT_AVAILABLE","ERROR"]);i.DownloadState=e}),66);
__d("WAWebUpdaterVersion",["WACustomError","WAWebBuildConstants"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(){return e.apply(this,arguments)||this}return babelHelpers.inheritsLoose(t,e),t})(o("WACustomError").customError("InvalidVersion")),s=(function(){function t(t){var n=t.split(".");if(n.length!==3)throw new e("Version format does not contain 3 numbers.");if(this.primary=Number.parseInt(n[0],10),this.secondary=Number.parseInt(n[1],10),this.tertiary=Number.parseInt(n[2],10),Number.isNaN(this.primary)||Number.isNaN(this.secondary)||Number.isNaN(this.tertiary))throw new e("Version contains a non-parseable string.")}var n=t.prototype;return n.lt=function(n){var e=n;return typeof e=="string"&&(e=new t(e)),this.primary<e.primary||this.primary===e.primary&&this.secondary<e.secondary||this.primary===e.primary&&this.secondary===e.secondary&&this.tertiary<e.tertiary},n.equals=function(n){var e=n;return e==null||e===""?!1:(typeof e=="string"&&(e=new t(e)),this.primary===e.primary&&this.secondary===e.secondary&&this.tertiary===e.tertiary)},n.toString=function(){return this.primary+"."+this.secondary+"."+this.tertiary},t})();function u(e){return e.replace(/\.[di]$/,"")}var c=u(o("WAWebBuildConstants").VERSION_STR);l.Version=s,l.sanitizeVersionStr=u,l.SANITIZED_VERSION_STR=c}),98);
__d("WAWebSwUpdater",["Promise","WALogger","WAWebBuildConstants","WAWebUpdaterDownloadStateType","WAWebUpdaterVersion"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m;function p(){o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[sw] update starts. Current app version: ",""])),String(new(o("WAWebUpdaterVersion")).Version(o("WAWebBuildConstants").VERSION_BASE)));var t=navigator.serviceWorker;return t?t.ready.then(function(e){return new(m||(m=n("Promise")))(function(n){var r;function a(e){l(),o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["Unable to update service worker to version. Error: ",""])),String(e)).sendLogs("[sw] sw-update-failed: "+String(e),{sampling:.1})}function i(){o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["[sw] updated"]))),l(),n(o("WAWebUpdaterDownloadStateType").DownloadState.UPDATE_DOWNLOADED)}function l(){t.removeEventListener("error",a),t.removeEventListener("controllerchange",i)}t.addEventListener("error",a),t.addEventListener("controllerchange",i),(r=e.active)!=null&&(r=r.scriptURL)!=null&&r.includes("serviceworker.js")?e.unregister():e.update().then(function(){e.installing||(o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["[sw] update is not available"]))),n(o("WAWebUpdaterDownloadStateType").DownloadState.UPDATE_NOT_AVAILABLE))}).catch(function(e){a(e),n(o("WAWebUpdaterDownloadStateType").DownloadState.ERROR)})})}).catch(function(e){return o("WALogger").ERROR(d||(d=babelHelpers.taggedTemplateLiteralLoose(["Unable to update serviceworker, error: ",""])),e).sendLogs("sw-update-failed"),o("WAWebUpdaterDownloadStateType").DownloadState.ERROR}):(m||(m=n("Promise"))).resolve(o("WAWebUpdaterDownloadStateType").DownloadState.ERROR)}l.updateSw=p}),98);
__d("WAWebTasksTaskType",["$InternalEnum"],(function(t,n,r,o,a,i){var e=n("$InternalEnum")({CLEAN_TC_TOKENS:"cleanTcTokens",LOG_DAILY_STATS:"logDailyStats",LOG_DB_ROW_COUNTS:"logDbRowCounts",ROTATE_KEY:"rotateKey",SYNC_AB_PROPS:"syncAbProps",SYNC_CONTACTS:"syncContacts",MONITOR_DB_STORAGE:"monitorDbStorage",REPORT_SYNCD_ACTION_STAT:"reportSyncdActionStat",LT_HASH_CHECK:"ltHashCheck",REQUEST_ALL_SYNCD_MISSING_KEYS:"requestAllSyncdMissingKeys",REPORT_SYNCD_KEY_STATS:"reportSyncdKeyStats",SYNCD_SYNC_ALL_COLLECTIONS:"syncdSyncAllCollections",CLEAN_ORPHAN_ADD_ONS:"cleanOrphanAddOns",CLEAN_PAST_PARTICIPANTS:"cleanPastParticipants",CLEAN_EXPIRED_UTM:"cleanExpiredUtm",SEND_NON_MESSAGE_DATA_REQUEST:"sendNonMessageDataRequest",LOG_HISTORY_SYNC_STATUS_AFTER_PAIRING:"logHistorySyncStatusAfterPairing",DELETE_NEWSLETTER_PREVIEW_CHATS:"deleteNewsletterPreviewChats",REPORT_DB_VERSIONS:"reportDbVersions",UPDATE_EXPIRED_TEXT_STATUS:"updateExpiredTextStatus",RESTART_RECENT_SYNC:"restartRecentSync",CLEANUP_REPORTING_TABLE:"cleanupReportingTable",CLEANUP_3PD_SIGNALS_TABLE:"cleanup3PDSignalsTable",FETCH_QUICK_PROMOTIONS:"fetchQuickPromotions",WAFFLE_SCHEDULED_TASKS:"waffleScheduledTasks",CLEAR_GALAXY_FLOWS_CACHE:"clearGalaxyFlowsCache",CLEAR_FALCO_BUFFER:"clearFalcoBuffer",SEND_WAM_FINGERPRINT:"sendWamFingerprint",INACTIVE_GROUP_LID_MIGRATION:"inactiveGroupLidMigration"});i.TaskType=e}),66);
__d("WAWebUpdateClockSkewUtils",["WATimeUtils","WAWebABProps","WAWebBackendApi","WAWebClockSkewDifferenceTWamEvent"],(function(t,n,r,o,a,i,l){function e(e){var t=Date.now()/1e3,n=Math.round(t-e),r=Math.round(n/o("WATimeUtils").HOUR_SECONDS);r!==0&&o("WAWebABProps").getABPropConfigValue("log_clock_skew")&&new(o("WAWebClockSkewDifferenceTWamEvent")).ClockSkewDifferenceTWamEvent({clockSkewHourly:r*-1}).commit(),o("WATimeUtils").setClockSkew(n),o("WAWebBackendApi").frontendFireAndForget("setWebClockSkew",{newClockSkew:n})}l.updateClockSkew=e}),98);
__d("WAWebUpdateMeLidUtils",["WANullthrows","WAWebUserPrefsMeUser"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WAWebUserPrefsMeUser").getMaybeMeDeviceLid(!1);if(!(t==null&&e==null)){if(t==null&&e!=null){o("WAWebUserPrefsMeUser").setMeLid(e);return}t!=null&&e==null||r("WANullthrows")(t).equals(e)||o("WAWebUserPrefsMeUser").setMeLid(r("WANullthrows")(e))}}l.updateMeLid=e}),98);
__d("privateStatsUpload",["Promise","WABase64","WACryptoHmac","WALogger","WAPromiseRetryLoop","WATimeUtils","WAWamStorage","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c,d,m,p,_,f,g,h,y,C="https://dit.whatsapp.net/deidentified_telemetry",b="245118376424571|3e7d275052f1522bf3200afcf53841a7",v=0,S="WAMEventBuffer.dat",R=3,L=9,E=111e3,k=3067002,I=3067003,T=3067004;function D(e){return{result:e.result,httpResponseCode:e.httpResponseCode,uploadTime:o("WATimeUtils").monotonicTimeSince(e.uploadStartTime)}}function x(e,t,n,r){return $.apply(this,arguments)}function $(){return $=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,r,a){if((yield o("WAWamStorage").privateStatsKillSwitchGetBlockedToken())===b)return o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["Removing private stats buffer without submitting it (kill switch)"]))),o("WAWamStorage").removeBufferByKey(r.key).then(function(){e()});var i=o("WATimeUtils").monotonicTime(),l=yield a();if(l==null){o("WALogger").ERROR(u||(u=babelHelpers.taggedTemplateLiteralLoose(["Couldn't get token to submit a private stats buffer"]))),e();return}var p=new FormData;p.append("access_token",b);var _=yield o("WACryptoHmac").hmacSha256(l.sharedSecret,r.content),f=o("WABase64").encodeB64UrlSafe(l.token,!0),g=o("WABase64").encodeB64UrlSafe(_,!0),h=f+"+"+g;p.append("credential",h),p.append("message",new Blob([r.content],{type:"application/octet-stream"}),S),p.append("meta_data",JSON.stringify({t:o("WATimeUtils").unixTime(),p:v}));var R={method:"POST",body:p,"Content-Type":"multipart/form-data"},L;try{L=yield fetch(C,R)}catch(e){o("WALogger").WARN(c||(c=babelHelpers.taggedTemplateLiteralLoose(["Upload of a private stats buffer failed: ",""])),e),o("WALogger").DEV(d||(d=babelHelpers.taggedTemplateLiteralLoose(["Try to submit metrics without being connected to the VPN. The PrivateStats endpoint seems to reject VPN originating connections at the CORS check level"]))),t({uploadStartTime:i,result:"error-other"});return}var E=L.status,k=function(n){e({uploadStartTime:i,httpResponseCode:E,result:n})},I=function(n){t({uploadStartTime:i,httpResponseCode:E,result:n})};switch(E){case 200:return o("WAWamStorage").removeBufferByKey(r.key).then(function(){k("success")});case 429:k("error-server-other");return;case 401:return(y||(y=n("Promise"))).all([o("WAWamStorage").privateStatsKillSwitchSet(b),o("WAWamStorage").removeBufferByKey(r.key)]).then(function(){k("error-access-token")});case 400:{var T=yield P(L),D=T.result,x=T.shouldRetry,$={uploadStartTime:i,httpResponseCode:E,result:D};x==="retry"?t($):e($);return}case 500:I("error-server-other");return}o("WALogger").WARN(m||(m=babelHelpers.taggedTemplateLiteralLoose(["Unsupported response status code from PrivateStats upload request: ",""])),E),I("error-other")}),$.apply(this,arguments)}function P(e){return N.apply(this,arguments)}function N(){return N=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=yield e.json().catch(function(){});if(typeof t!="object")return o("WALogger").WARN(p||(p=babelHelpers.taggedTemplateLiteralLoose(["Unable to parse error response 400 from PrivateStats upload request or parsed response is not an object"]))),{result:"error-other",shouldRetry:"retry"};var n=t.error;if(typeof n!="object")return o("WALogger").WARN(_||(_=babelHelpers.taggedTemplateLiteralLoose(["Incorrect or missing error entry in the error response 400 from PrivateStats upload request"]))),{result:"error-other",shouldRetry:"retry"};var r=n.code,a=n.error_subcode;if(typeof r!="number"||typeof a!="number")return o("WALogger").WARN(f||(f=babelHelpers.taggedTemplateLiteralLoose(["Incorrect code or subcode in the error response 400 from PrivateStats upload request"]))),{result:"error-other",shouldRetry:"retry"};switch(r){case L:return{result:"error-server-other",shouldRetry:"no-retry"};case E:switch(a){case k:return{result:"error-parsing",shouldRetry:"retry"};case I:return{result:"error-decoding",shouldRetry:"retry"};case T:return{result:"error-credential",shouldRetry:"retry"};default:return o("WALogger").WARN(g||(g=babelHelpers.taggedTemplateLiteralLoose(["Unsupported subcode value in the error response 400 from PrivateStats upload request: ",""])),a),{result:"error-other",shouldRetry:"retry"}}default:return o("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Unsupported code value in the error response 400 from PrivateStats upload request: ",""])),r),{result:"error-other",shouldRetry:"retry"}}}),N.apply(this,arguments)}function M(t,r){var a=t.map(function(t){var n=R,a=[],i=new(o("WAPromiseRetryLoop")).PromiseRetryLoop({name:"uploadPrivateStatsBuffer",timer:{algo:{type:"exponential",first:250},max:1e3},code:function(l){return x(l,function(t){var r=D(t);a.push(r),n<=0?(o("WALogger").DEV(e||(e=babelHelpers.taggedTemplateLiteralLoose(["Ran out of available retries for a private stats buffer submission"]))),l()):n--},t,r)}});return i.start(),i.promise().then(function(e){if(e!=null){var n=D(e);a.push(n)}return{uploadedBufferKey:(e==null?void 0:e.result)==="success"?t.key:null,metrics:a}})});return(y||(y=n("Promise"))).all(a).then(function(e){var t=e.reduce(function(e,t){return e.push.apply(e,t.metrics),e},[]),n=e.reduce(function(e,t){return t.uploadedBufferKey!=null&&e.push(t.uploadedBufferKey),e},[]);return{uploadedBufferKeys:n,metrics:t}})}function w(e){return o("WAWamStorage").getFinishedStreamBuffers("private").then(function(t){return M(t,e)})}l.upload_UNSAFE_INTERNAL_DO_NOT_USE=M,l.uploadFinishedPrivateStatsBuffers=w}),98);
__d("WAWebUploadPrivateStatsBackend",["WABackoffUtils","WABase64","WALogger","WAPromiseDelays","WAPromiseLoop","WAWebIssuePrivateStatsToken","WAWebNetworkStatus","WAWebPsBufferUploadWamEvent","WAWebWamEnumApplicationState","WAWebWamEnumPsBufferUploadResult","asyncToGeneratorRuntime","privateStatsUpload"],(function(t,n,r,o,a,i,l){var e,s,u;function c(t,r){var a=new Uint8Array(o("WABase64").decodeB64(t));return p(r,(function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var n=yield o("privateStatsUpload").upload_UNSAFE_INTERNAL_DO_NOT_USE([{key:r,content:a}],o("WAWebIssuePrivateStatsToken").getToken),i=n.uploadedBufferKeys,l=n.metrics;l.map(m),i.length===0&&t(r),o("WALogger").DEV(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[wam] sendLogs success"]))),t(void 0)});return function(e){return t.apply(this,arguments)}})())}function d(e){switch(e){case"success":return o("WAWebWamEnumPsBufferUploadResult").PS_BUFFER_UPLOAD_RESULT.SUCCESS;case"error-server-other":return o("WAWebWamEnumPsBufferUploadResult").PS_BUFFER_UPLOAD_RESULT.ERROR_SERVER_OTHER;case"error-parsing":return o("WAWebWamEnumPsBufferUploadResult").PS_BUFFER_UPLOAD_RESULT.ERROR_PARSING;case"error-decoding":return o("WAWebWamEnumPsBufferUploadResult").PS_BUFFER_UPLOAD_RESULT.ERROR_DECODING;case"error-credential":return o("WAWebWamEnumPsBufferUploadResult").PS_BUFFER_UPLOAD_RESULT.ERROR_CREDENTIAL;case"error-other":return o("WAWebWamEnumPsBufferUploadResult").PS_BUFFER_UPLOAD_RESULT.ERROR_OTHER;default:return o("WAWebWamEnumPsBufferUploadResult").PS_BUFFER_UPLOAD_RESULT.ERROR_ACCESS_TOKEN}}function m(e){var t=e.result,n=e.uploadTime,r=e.httpResponseCode,a=d(t);new(o("WAWebPsBufferUploadWamEvent")).PsBufferUploadWamEvent({psBufferUploadResult:a,psBufferUploadT:n,psBufferUploadHttpResponseCode:r,applicationState:document.visibilityState==="visible"?o("WAWebWamEnumApplicationState").APPLICATION_STATE.FOREGROUND:o("WAWebWamEnumApplicationState").APPLICATION_STATE.BACKGROUND}).commit()}function p(e,t){return o("WAPromiseLoop").promiseLoop((function(){var a=n("asyncToGeneratorRuntime").asyncToGenerator(function*(n,a,i){var l=o("WAPromiseDelays").delayMs(o("WABackoffUtils").expBackoff(i,12e4,1e3,.1));try{return yield r("WAWebNetworkStatus").waitIfOffline(),yield t(n)}catch(t){return i>1?(o("WALogger").WARN(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[wam] sendLogs failure error: ",""])),String(t)).devConsole(t),n(e)):(o("WALogger").DEV(u||(u=babelHelpers.taggedTemplateLiteralLoose(["[wam] sendLogs retry on error: ",""])),String(t)),l)}});return function(e,t,n){return a.apply(this,arguments)}})())}l.default=c}),98);
__d("WAWebWamGatingUtils",["WAWebABProps"],(function(t,n,r,o,a,i,l){"use strict";function e(){return o("WAWebABProps").getABPropConfigValue("web_delay_between_wam_upload_retries_enabled")}function s(){return o("WAWebABProps").getABPropConfigValue("web_wam_maximum_wait_time_for_online_seconds")}l.delayBetweenWamUploadRetriesEnabled=e,l.wamUploadMaximumWaitTimeForOnline=s}),98);
__d("WAWebUploadStatsBackend",["WABackoffUtils","WABase64","WALogger","WAPromiseDelays","WAPromiseLoop","WAPromiseTimeout","WATimeUtils","WAWebBackendErrors","WAWebNetworkStatus","WAWebStatsUploadJob","WAWebWamGatingUtils","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s,u,c;function d(t,a){o("WALogger").DEV(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[wam] sendLogs b64len:",""])),t.length);var i=new Uint8Array(o("WABase64").decodeB64(t)),l=o("WATimeUtils").unixTime();return m(a,(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=yield r("WAWebStatsUploadJob")(i,l);if(t!=null&&t.errorCode){if(t.errorCode>=500)throw new(o("WAWebBackendErrors")).ServerStatusCodeError(t.errorCode,t.errorText);e(a)}o("WALogger").DEV(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[wam] sendLogs success"]))),e(void 0)});return function(t){return e.apply(this,arguments)}})())}function m(e,t){return o("WAPromiseLoop").promiseLoop((function(){var r=n("asyncToGeneratorRuntime").asyncToGenerator(function*(n,r,a){var i=o("WAWebWamGatingUtils").delayBetweenWamUploadRetriesEnabled(),l;i||(l=p(a));try{return yield _(),yield t(n)}catch(t){return a>1?(o("WALogger").WARN(u||(u=babelHelpers.taggedTemplateLiteralLoose(["[wam] sendLogs failure error: ",""])),String(t)).devConsole(t),n(e)):(o("WALogger").DEV(c||(c=babelHelpers.taggedTemplateLiteralLoose(["[wam] sendLogs retry on error: ",""])),String(t)),l==null&&(l=p(a)),l)}});return function(e,t,n){return r.apply(this,arguments)}})())}function p(e){return o("WAPromiseDelays").delayMs(o("WABackoffUtils").expBackoff(e,12e4,1e3,.1))}function _(){var e=o("WAWebWamGatingUtils").wamUploadMaximumWaitTimeForOnline();return e===0?r("WAWebNetworkStatus").waitIfOffline():o("WAPromiseTimeout").promiseTimeout(r("WAWebNetworkStatus").waitIfOffline(),e*1e3,"wamUploadWaitForOnline")}l.default=d}),98);
__d("WAWebUserPrefsClearLocalState",["Promise","WAWebLoggerImpl","WAWebPermanentStorage","WAWebTemporaryStorage","WAWebUserPrefsKeys","WAWebUserPrefsStore","WAWebUserPrefsTypes","asyncToGeneratorRuntime","gkx"],(function(t,n,r,o,a,i,l){var e;function s(){var e=r("WAWebUserPrefsStore").get(o("WAWebUserPrefsKeys").KEYS.PRESERVED_USER_KEYS,{storage:r("WAWebPermanentStorage")}),t=e instanceof Array?[].concat(o("WAWebUserPrefsTypes").LS_PRESERVE_KEYS,e.filter(function(e){return typeof e=="string"})):o("WAWebUserPrefsTypes").LS_PRESERVE_KEYS;return r("WAWebUserPrefsStore").getKeys(r("WAWebPermanentStorage"),t,!0)}function u(){return r("WAWebUserPrefsStore").getKeys(r("WAWebTemporaryStorage"),o("WAWebUserPrefsTypes").TS_PRESERVE_KEYS,!0)}function c(){r("WAWebTemporaryStorage").clear(u())}function d(){return m.apply(this,arguments)}function m(){return m=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var t=s(),a=[r("WAWebTemporaryStorage").clear(u()),r("WAWebPermanentStorage").clear(t)];r("gkx")("26258")&&a.push(o("WAWebLoggerImpl").Logger.clearLogs()),yield(e||(e=n("Promise"))).all(a)}),m.apply(this,arguments)}l.clearAllTemporaryStorageData=c,l.clearAllLocalState=d}),98);
__d("WAWebUserPrefsIsLoggedIn",["WAWebUserPrefsMultiDevice"],(function(t,n,r,o,a,i,l){var e=!1;function s(){return o("WAWebUserPrefsMultiDevice").isRegistered()&&u()}function u(){return e}function c(t){e=t}l.isLoggedIn=s,l.setIsConnectedAsRegistered=c}),98);
__d("WAWebUserPrefsNuxPreferences",["WAWebBizGatingUtils","WAWebEventEmitter","WAWebNux","WAWebNuxSyncKey","WAWebUserPrefsKeys","WAWebUserPrefsStore"],(function(t,n,r,o,a,i,l){var e=(function(e){function t(){return e.apply(this,arguments)||this}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.handleNuxChange=function(t){this.trigger(t)},n.close=function(t){this.trigger("close_nux",t)},t})(r("WAWebEventEmitter")),s=new e;function u(e){var t=o("WAWebNuxSyncKey").getNuxSyncKey(e);if(t!=null&&C(t))return!1;var n=c(e);return n?n.views<v(e):!0}function c(e){var t=r("WAWebUserPrefsStore").getUser(e);if(t==null||typeof t!="object")return null;var n=t.views;return typeof n=="number"?{views:n}:null}function d(e,t){r("WAWebUserPrefsStore").setUser(e,t),s.handleNuxChange(e)}function m(e){r("WAWebUserPrefsStore").setUser(e),s.handleNuxChange(e)}function p(){var e=r("WAWebUserPrefsStore").get(o("WAWebUserPrefsKeys").KEYS.NUX_LIST);return e instanceof Array?e.filter(function(e){return typeof e=="string"}):[]}function _(){var e=r("WAWebUserPrefsStore").get(o("WAWebUserPrefsKeys").KEYS.NUX_DATA);if(e!=null&&typeof e=="object"&&!Array.isArray(e)){var t={};for(var n in e){var a=e[n];a!=null&&typeof a=="object"&&typeof a.acknowledged=="boolean"&&(t[n]={acknowledged:a.acknowledged,timestamp:typeof a.timestamp=="number"?a.timestamp:void 0})}return t}var i=p(),l={};return i.forEach(function(e){l[e]={acknowledged:!0}}),i.length>0&&r("WAWebUserPrefsStore").set(o("WAWebUserPrefsKeys").KEYS.NUX_DATA,l),l}function f(e){var t=_(),n=t[e];return(n==null?void 0:n.acknowledged)===!0?n.timestamp:null}function g(e){var t=new Set(p()),n=_();e.forEach(function(e){var r=e.nuxKey,o=e.acknowledged,a=e.timestamp;o?(t.add(r),n[r]={acknowledged:!0,timestamp:a}):(t.delete(r),n[r]={acknowledged:!1,timestamp:a})}),r("WAWebUserPrefsStore").set(o("WAWebUserPrefsKeys").KEYS.NUX_LIST,Array.from(t)),r("WAWebUserPrefsStore").set(o("WAWebUserPrefsKeys").KEYS.NUX_DATA,n),e.forEach(function(e){var t=e.nuxKey,n=b(t);n!=null&&s.handleNuxChange(n)})}function h(){r("WAWebUserPrefsStore").set(o("WAWebUserPrefsKeys").KEYS.NUX_LIST,[]),r("WAWebUserPrefsStore").set(o("WAWebUserPrefsKeys").KEYS.NUX_DATA,{})}function y(e){m(e);var t=p().filter(function(t){return t!==e}),n=_();delete n[e],r("WAWebUserPrefsStore").set(o("WAWebUserPrefsKeys").KEYS.NUX_LIST,t),r("WAWebUserPrefsStore").set(o("WAWebUserPrefsKeys").KEYS.NUX_DATA,n)}function C(e){return p().includes(e)}function b(e){switch(e){case"message_label_deprecation_migrated":return o("WAWebNux").NUX.MESSAGE_LABEL_DEPRECATION_MIGRATED_PERMANENT;case"meta_ai_cta_banner":return o("WAWebNux").NUX.META_AI_CTA_BANNER;case"newsletter_questions_response_privacy_banner":return o("WAWebNux").NUX.NEWSLETTER_QUESTIONS_RESPONSE_PRIVACY_BANNER;case"newsletter_questions_privacy_banner":return o("WAWebNux").NUX.NEWSLETTER_QUESTIONS_PRIVACY_BANNER;default:return null}}function v(e){switch(e){case"message_label_deprecation_migrated_permanent":case"desktop_upsell":return Number.POSITIVE_INFINITY;case"chat_assignment":return o("WAWebBizGatingUtils").chatAssignmentMaxNuxImpressions();case"media_hub_tooltip":return 5;case"status_quick_replies":return 3;case"web_ui_refresh":return 2;default:return 1}}l.NuxPrefsEvent=s,l.shouldShowNUX=u,l.getNUX=c,l.setNUX=d,l.removeNUX=m,l.getNuxSyncList=p,l.getNuxAcknowledgedTimestamp=f,l.updateNuxSyncList=g,l.removeAllNuxSync=h,l.resetNux=y,l.nuxExistsInNuxSync=C,l.getNuxMaxViews=v}),98);
__d("WAWebUserPrefsTabMutex",["WANullthrows","WAWebLocalStorage","WAWebPermanentStorage","WAWebUserPrefsKeys","WAWebUserPrefsStore"],(function(t,n,r,o,a,i,l){var e="x"+Math.round(Math.random()*1e9);function s(){return r("WAWebUserPrefsStore").getPSIgnoringCache(o("WAWebUserPrefsKeys").KEYS.WHATSAPP_MUTEX)}function u(t){var n=t&&e+":"+t;r("WAWebUserPrefsStore").set(o("WAWebUserPrefsKeys").KEYS.WHATSAPP_MUTEX,n,{storage:r("WAWebPermanentStorage")})}function c(){r("WAWebUserPrefsStore").set(o("WAWebUserPrefsKeys").KEYS.WHATSAPP_MUTEX,null,{storage:r("WAWebPermanentStorage")})}function d(e){var t=e?JSON.parse(e):"";return t&&t.toString().split(/:/).pop()}function m(t){if(t.key!==o("WAWebUserPrefsKeys").KEYS.WHATSAPP_MUTEX)return!1;var n=t.newValue||"";return!n.includes(e)}function p(){return(s()||"").includes(e)}function _(){var t={wa_tab_src:e};r("WANullthrows")(r("WAWebLocalStorage")).setItem(o("WAWebUserPrefsKeys").KEYS.LOCAL_TAKEOVER_OK,JSON.stringify(t)),r("WANullthrows")(r("WAWebLocalStorage")).removeItem(o("WAWebUserPrefsKeys").KEYS.LOCAL_TAKEOVER_OK)}function f(t){if(t.key!==o("WAWebUserPrefsKeys").KEYS.LOCAL_TAKEOVER_OK)return!1;var n=t.newValue||"";return!n.includes(e)}function g(e){r("WAWebUserPrefsStore").setTS(o("WAWebUserPrefsKeys").KEYS.NO_TAKEOVER,e)}function h(){return!!r("WAWebUserPrefsStore").getTS(o("WAWebUserPrefsKeys").KEYS.NO_TAKEOVER)}l.THIS_TAB=e,l.getMutex=s,l.setMutex=u,l.removeMutex=c,l.parseMutex=d,l.mutexFilter=m,l.currentTabHasMutex=p,l.localTakeoverSuccess=_,l.takeoverFilter=f,l.setNoTakeover=g,l.getNoTakeover=h}),98);
__d("WAWebWamClientErrorsWamEvent",["WAWebWamCodegenUtils"],(function(t,n,r,o,a,i,l){var e,s=(e=o("WAWebWamCodegenUtils")).defineEvents({WamClientErrors:[1144,{isFromWamsys:[27,e.TYPES.BOOLEAN],wamClientBufferDropErrorCount:[28,e.TYPES.INTEGER],wamClientBufferFetchErrorCount:[29,e.TYPES.INTEGER],wamClientBufferRotateErrorCount:[43,e.TYPES.INTEGER],wamClientBufferStoreErrorCount:[30,e.TYPES.INTEGER],wamClientCorruptedBuffersCount:[42,e.TYPES.INTEGER],wamClientDroppedEventCount:[2,e.TYPES.INTEGER],wamClientDroppedEventCountNoEnoughStorage:[41,e.TYPES.INTEGER],wamClientDroppedEventSize:[3,e.TYPES.INTEGER],wamClientErrorFlags:[1,e.TYPES.BOOLEAN],wamClientMetadataReadErrorCount:[37,e.TYPES.INTEGER],wamClientMetadataWriteErrorCount:[38,e.TYPES.INTEGER],wamClientPrivateDroppedEventCount:[24,e.TYPES.INTEGER],wamClientPrivateDroppedEventSize:[25,e.TYPES.INTEGER],wamClientPrivateRealtimeDroppedEventCount:[34,e.TYPES.INTEGER],wamClientPrivateRealtimeDroppedEventSize:[35,e.TYPES.INTEGER],wamClientPrivateRealtimeRejectedEventCount:[36,e.TYPES.INTEGER],wamClientPrivateRejectedEventCount:[31,e.TYPES.INTEGER],wamClientRealtimeDroppedEventCount:[22,e.TYPES.INTEGER],wamClientRealtimeDroppedEventSize:[23,e.TYPES.INTEGER],wamClientRealtimeRejectedEventCount:[32,e.TYPES.INTEGER],wamClientRejectedEventCount:[33,e.TYPES.INTEGER],wamErrorBadCurrentEventBufferChecksum:[18,e.TYPES.BOOLEAN],wamErrorBadEventBuffer:[16,e.TYPES.BOOLEAN],wamErrorBadFileHeader:[15,e.TYPES.BOOLEAN],wamErrorBadFileSize:[8,e.TYPES.BOOLEAN],wamErrorBadHeaderChecksum:[17,e.TYPES.BOOLEAN],wamErrorBadRotatedEventBufferChecksum:[19,e.TYPES.BOOLEAN],wamErrorCloseFile:[11,e.TYPES.BOOLEAN],wamErrorCreateWamFile:[14,e.TYPES.BOOLEAN],wamErrorFseekFile:[9,e.TYPES.BOOLEAN],wamErrorOpenFile:[10,e.TYPES.BOOLEAN],wamErrorOpenPsUploadQueueFile:[26,e.TYPES.BOOLEAN],wamErrorOpenWamFile:[13,e.TYPES.BOOLEAN],wamErrorPersistence:[20,e.TYPES.BOOLEAN],wamErrorReadFile:[7,e.TYPES.BOOLEAN],wamErrorRemoveFile:[12,e.TYPES.BOOLEAN],wamErrorWriteEventBuffer:[6,e.TYPES.BOOLEAN],wamErrorWriteFile:[4,e.TYPES.BOOLEAN],wamErrorWriteHeader:[5,e.TYPES.BOOLEAN],wamFirstErrorReadMetadata:[39,e.TYPES.BOOLEAN],wamFirstErrorWriteMetadata:[40,e.TYPES.BOOLEAN]},[1,1,1],"regular"]},{WamClientErrors:[]});l.WamClientErrorsWamEvent=s}),98);
__d("WAWebWamConstants",[],(function(t,n,r,o,a,i){var e=5e4,l=5,s=100,u=64e3,c=5,d=120;i.WAM_MAX_BUFFER_SIZE=e,i.WAM_PROTOCOL_VERSION=l,i.WAM_WORKER_DATA_BATCH_SIZE=s,i.WAM_MAX_BUFFER_SIZE_FOR_UPLOAD=u,i.WAM_IN_MEMORY_BUFFERING_DURATION_IN_SECS=c,i.WAM_BUFFER_ROTATE_INTERVAL_IN_SECS=d}),66);
__d("WAWebWebWamForceFlushWamEvent",["WAWebWamCodegenUtils"],(function(t,n,r,o,a,i,l){var e=o("WAWebWamCodegenUtils").defineEvents({WebWamForceFlush:[3264,{},[1,1,1],"regular"]},{WebWamForceFlush:[]});l.WebWamForceFlushWamEvent=e}),98);
__d("WAWebWamUtils",["WABase64","WABinary","WALogger","WAQplUploader","WAWebEnvironment","WAWebGuestWamConstants","WAWebPsIdUpdateWamEvent","WAWebUserPrefsGeneral","WAWebWamCodegenUtils","WAWebWamConstants","WAWebWamEnumAppBuildType","WAWebWamEnumWebcEnvCode","WAWebWamGlobals","WAWebWebWamForceFlushWamEvent","err","gkx"],(function(t,n,r,o,a,i,l){var e,s,u,c;function d(){new(o("WAWebWebWamForceFlushWamEvent")).WebWamForceFlushWamEvent().commitAndWaitForFlush(!0).finally(function(){return o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["force flushed all wam buffers"]))).tags("wam")}),o("WAQplUploader").forceQplUpload().finally(function(){return o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[qpl] force flushed all buffers"]))).tags("qpl")})}function m(e,t,n){new(o("WAWebPsIdUpdateWamEvent")).PsIdUpdateWamEvent({psIdAction:e,psIdKey:t,psIdRotationFrequence:n}).commit()}function p(e,t){var n=JSON.parse(t),r=o("WAWebWamCodegenUtils").events[e];if(r==null){o("WALogger").ERROR(u||(u=babelHelpers.taggedTemplateLiteralLoose(["WAM: commitWorkerWamEvent failed, "," is not defined"])),e).sendLogs("wam-worker-event-undefined-error");return}new r(n).commit()}function _(e,t){var n,r=JSON.parse(t),a=r.value;o("WAWebWamGlobals").Global.set((n={},n[e]=a,n))}function f(e){var t=e.action,n=e.name,r=e.payload;return t==="commit"?p(n,r):_(n,r)}function g(e){var t=!0;try{var n=new(o("WABinary")).Binary(o("WABase64").decodeB64(e));t=n.size()>o("WAWebWamConstants").WAM_MAX_BUFFER_SIZE_FOR_UPLOAD}catch(e){o("WALogger").ERROR(c||(c=babelHelpers.taggedTemplateLiteralLoose(["dropping invalid wam buffer"])))}return t}function h(e){return e==="regular"?"regular":e==="realtime"?"realtime":"private"}function y(){return r("gkx")("26258")?o("WAWebWamEnumAppBuildType").APP_BUILD_TYPE.RELEASE:r("gkx")("26259")?o("WAWebWamEnumAppBuildType").APP_BUILD_TYPE.BETA:o("WAWebWamEnumAppBuildType").APP_BUILD_TYPE.ALPHA}function C(){if(r("gkx")("26259"))return o("WAWebWamEnumWebcEnvCode").WEBC_ENV_CODE.INTERN;if(r("gkx")("26258"))return o("WAWebWamEnumWebcEnvCode").WEBC_ENV_CODE.PROD;if(r("gkx")("26256"))return o("WAWebWamEnumWebcEnvCode").WEBC_ENV_CODE.E2E;throw r("err")("invalid env")}function b(){return o("WAWebUserPrefsGeneral").getWhatsAppWebExternalBetaJoinedIdb()}function v(e){if(r("gkx")("26256")){var t=window.__je2e_recordWAMEvent;(t||typeof t=="function")&&t(babelHelpers.extends({name:e.$className},e.all))}}function S(e,t){if(r("gkx")("26256")){var n=window.__je2e_recordWAMEvent;(n||typeof n=="function")&&n({name:e,value:t})}}function R(){return r("WAWebEnvironment").isGuest?o("WAWebGuestWamConstants").WAM_IN_MEMORY_BUFFERING_DURATION_IN_SECS_FOR_GUEST:o("WAWebWamConstants").WAM_IN_MEMORY_BUFFERING_DURATION_IN_SECS}function L(){return r("WAWebEnvironment").isGuest?o("WAWebGuestWamConstants").WAM_BUFFER_ROTATE_INTERVAL_IN_SECS_FOR_GUEST:o("WAWebWamConstants").WAM_BUFFER_ROTATE_INTERVAL_IN_SECS}l.forceFlushAllWamAndQplBuffers=d,l.logPsIdUpdate=m,l.processWorkerWamDataRow=f,l.isWamBufferTooBigToUpload=g,l.getChannelFromBufferKey=h,l.getAppBuild=y,l.getWamEnv=C,l.getAppIsBetaRelease=b,l.maybeForwardWamEventToJestE2e=v,l.maybeForwardWamAttributeToJestE2e=S,l.getInMemoryBufferingDurationInSecs=R,l.getBufferRotateIntervalInSecs=L}),98);
__d("WAWebWamStorage",["WALogger","WAWebWAWCStorage","WAWebWamConstants","WAWebWamUtils","asyncToGeneratorRuntime","err","gkx"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p,_,f,g,h,y;function C(e,t,n){return b.apply(this,arguments)}function b(){return b=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n){var a=yield r("WAWebWAWCStorage").idb();return a.wam.add({key:e,buffer:n,channel:t},e).catch(function(e){o("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["add failed: ","\n",""],["add failed: ","\\n",""])),e,e==null?void 0:e.stack)})}),b.apply(this,arguments)}function v(e,t,n){return S.apply(this,arguments)}function S(){return S=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n){var a=0;try{a=yield r("WAWebWAWCStorage").idb().then(function(r){return r.wam.update(e,{key:e,buffer:n,channel:t})})}catch(e){o("WALogger").LOG(_||(_=babelHelpers.taggedTemplateLiteralLoose(["update failed: ","\n",""],["update failed: ","\\n",""])),e,e==null?void 0:e.stack)}return a!==0}),S.apply(this,arguments)}function R(e){return L.apply(this,arguments)}function L(){return L=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t={};try{yield r("WAWebWAWCStorage").idb().then(function(n){return n.wam.where("channel").equals(e).modify(function(e,n){t[e.key]=e.buffer,delete n.value})})}catch(e){o("WALogger").LOG(f||(f=babelHelpers.taggedTemplateLiteralLoose(["deleteAll failed: ","\n",""],["deleteAll failed: ","\\n",""])),e,e==null?void 0:e.stack)}return t}),L.apply(this,arguments)}function E(e){return k.apply(this,arguments)}function k(){return k=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=-1,a=65536;try{var i=yield r("WAWebWAWCStorage").idb();yield i.transaction("rw",["wam_meta"],n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var n=yield i.wam_meta.where("streamId").equals(e).count();n===0?(yield i.wam_meta.add({streamId:e,seqNum:1}),t=1):yield i.wam_meta.where("streamId").equals(e).modify(function(e){return t=e.seqNum+1,t>=a&&(t=1),e.seqNum=t,e})}))}catch(e){o("WALogger").LOG(g||(g=babelHelpers.taggedTemplateLiteralLoose(["getNextSequenceNumberForStream failed: ","\n",""],["getNextSequenceNumberForStream failed: ","\\n",""])),e,e==null?void 0:e.stack)}if(t===-1)throw r("gkx")("26258")||o("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[wam] getNextSequenceNumberForStream failed"]))).sendLogs("getNextSequenceNumberForStreamFailed"),r("err")("could not get seq number for streamId "+e);return t}),k.apply(this,arguments)}function I(t){return r("WAWebWAWCStorage").idb().then(function(e){return e.ps_meta.bulkDelete(t)}).catch(function(t){o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["removePsMeta failed: ","\n",""],["removePsMeta failed: ","\\n",""])),t,t==null?void 0:t.stack)})}function T(){return r("WAWebWAWCStorage").idb().then(function(e){return e.ps_meta.toArray()}).catch(function(e){return o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["getPsMeta failed: ","\n",""],["getPsMeta failed: ","\\n",""])),e,e==null?void 0:e.stack),[]})}function D(e){return r("WAWebWAWCStorage").idb().then(function(t){return t.ps_meta.bulkPut(e)}).catch(function(e){o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["addPsMeta failed: ","\n",""],["addPsMeta failed: ","\\n",""])),e,e==null?void 0:e.stack)})}function x(e){return r("WAWebWAWCStorage").idb().then(function(t){return t.ps_meta.update(e.key,e)}).catch(function(e){o("WALogger").LOG(c||(c=babelHelpers.taggedTemplateLiteralLoose(["updatePsMeta failed: ","\n",""],["updatePsMeta failed: ","\\n",""])),e,e==null?void 0:e.stack)})}function $(){return r("WAWebWAWCStorage").idb().then(function(e){return e.ps_tokens.get("token")}).catch(function(e){o("WALogger").LOG(d||(d=babelHelpers.taggedTemplateLiteralLoose(["getPsToken failed: ","\n",""],["getPsToken failed: ","\\n",""])),e,e==null?void 0:e.stack)})}function P(e){return r("WAWebWAWCStorage").idb().then(function(t){return t.transaction("rw",["ps_tokens"],function(){return t.ps_tokens.put(e)})}).catch(function(e){o("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["savePsToken failed: ","\n",""],["savePsToken failed: ","\\n",""])),e,e==null?void 0:e.stack)})}function N(e,t){return M.apply(this,arguments)}function M(){return M=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=yield r("WAWebWAWCStorage").idb();return n.transaction("rw",["core_wam","core_wam_meta"],function(){return n.core_wam.put(t).then(function(){return n.core_wam_meta.put(e)})})}),M.apply(this,arguments)}function w(e){return A.apply(this,arguments)}function A(){return A=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=yield r("WAWebWAWCStorage").idb();return t.core_wam.where("streamId").equals(e).modify({finished:!0})}),A.apply(this,arguments)}function F(e){return O.apply(this,arguments)}function O(){return O=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=yield r("WAWebWAWCStorage").idb();return t.core_wam_meta.get({streamId:e})}),O.apply(this,arguments)}function B(){return W.apply(this,arguments)}function W(){return W=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=yield r("WAWebWAWCStorage").idb();return e.core_wam.toArray()}),W.apply(this,arguments)}function q(){return U.apply(this,arguments)}function U(){return U=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=yield r("WAWebWAWCStorage").idb();return e.transaction("rw",["core_wam","core_wam_meta"],function(){return e.core_wam.clear().then(function(){return e.core_wam_meta.clear()})})}),U.apply(this,arguments)}function V(e){return H.apply(this,arguments)}function H(){return H=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=yield r("WAWebWAWCStorage").idb();return t.core_wam.delete(e)}),H.apply(this,arguments)}function G(e){return z.apply(this,arguments)}function z(){return z=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=yield r("WAWebWAWCStorage").idb();return t.transaction("rw",["worker_wam_events"],function(){return t.worker_wam_events.put(e)})}),z.apply(this,arguments)}function j(){return K.apply(this,arguments)}function K(){return K=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=yield r("WAWebWAWCStorage").idb();try{yield e.transaction("rw",["worker_wam_events"],n("asyncToGeneratorRuntime").asyncToGenerator(function*(){yield e.worker_wam_events.limit(o("WAWebWamConstants").WAM_WORKER_DATA_BATCH_SIZE).modify(function(e,t){o("WAWebWamUtils").processWorkerWamDataRow(e),delete t.value})}));var t=yield e.worker_wam_events.count();return t>0}catch(e){return o("WALogger").LOG(y||(y=babelHelpers.taggedTemplateLiteralLoose(["processWorkerWamData failed: ","\n",""],["processWorkerWamData failed: ","\\n",""])),e,e==null?void 0:e.stack),!1}}),K.apply(this,arguments)}var Q={add:C,update:v,deleteAll:R,getNextSequenceNumberForStream:E,addCoreWamBuffer:N,finishAllCoreWamBuffers:w,getCoreWamStartingSequenceNumber:F,getAllCoreWamBuffers:B,nukeAllCoreWamBuffers:q,removeWamBufferByKey:V,storeWorkerWamData:G,processWorkerWamData:j,removePsMeta:I,getPsMeta:T,addPsMeta:D,updatePsMeta:x,getPsToken:$,savePsToken:P},X=Q;l.default=X}),98);
__d("WAWebWamPrivateStats",["Promise","WALogger","WARandomHex","WAResolvable","WATimeUtils","WAWebWamEnumPsIdAction","WAWebWamGlobals","WAWebWamStorage","WAWebWamUtils","asyncToGeneratorRuntime","err"],(function(t,n,r,o,a,i,l){var e,s,u,c={},d={},m={};o("WAWebWamGlobals").PrivateStatsAllIds.map(function(e){c[e.keyHashInt]=e.key,d[e.key]=e.keyHashInt,m[e.key]={value:e.keyHashInt,rotationPeriodDays:e.rotationPeriodDays}}),c[0]="none",d.none=0,m.none={value:"none",rotationPeriodDays:-1};var p=null;function _(){return f.apply(this,arguments)}function f(){return f=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(p!=null)return p.promise;var e=new(o("WAResolvable")).Resolvable;p=e;var t=[],n=yield r("WAWebWamStorage").getPsMeta(),a=new Set;n.map(function(e){a.add(e.key),m[e.key]===void 0?t.push(e.key):m[e.key].value=e.value});var i=Object.keys(m).filter(function(e){return!a.has(e)}).map(function(e){return e!=="none"&&(m[e].value=o("WARandomHex").randomHex(16)),{key:e,value:m[e].value,rotateInDays:m[e].rotationPeriodDays,creationTs:o("WATimeUtils").unixTime()}});yield r("WAWebWamStorage").addPsMeta(i),yield r("WAWebWamStorage").removePsMeta(t),i.map(function(e){return o("WAWebWamUtils").logPsIdUpdate(o("WAWebWamEnumPsIdAction").PS_ID_ACTION.CREATED,d[e.key],e.rotateInDays)}),t.map(function(e){return o("WAWebWamUtils").logPsIdUpdate(o("WAWebWamEnumPsIdAction").PS_ID_ACTION.DELETED,d[e],m[e].rotationPeriodDays)}),e.resolve()}),f.apply(this,arguments)}function g(){var e=new Map;return o("WAWebWamGlobals").PrivateStatsAllIds.forEach(function(t){e.set(t.keyHashInt,String(m[t.key].value))}),e}function h(e){if(p==null)throw r("err")("can't call getPrivateStatsKeyFromInt without initializing");return c[e]}function y(e){if(e==="regular")throw r("err")("tried to get psId for regular channel event");if(p==null)throw r("err")("can't call getLatestPrivateStatsIdValueFromKey without initializing");return m[e].value}function C(){return b.apply(this,arguments)}function b(){return b=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var t=[];if(p==null)throw r("err")("can't call maybeRotatePsIds without initializing");try{yield p.promise;var a=yield r("WAWebWamStorage").getPsMeta();yield(u||(u=n("Promise"))).all(a.map((function(){var r=n("asyncToGeneratorRuntime").asyncToGenerator(function*(n){try{var r=n.key,a=n.rotateInDays,i=n.creationTs;R(i,a)&&(t.push(r),yield v(r))}catch(t){o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["error while rotating PS id for key ",""])),n.key)}});return function(e){return r.apply(this,arguments)}})()))}catch(e){o("WALogger").WARN(s||(s=babelHelpers.taggedTemplateLiteralLoose(["error while rotating PS ids ",""])),e)}return t}),b.apply(this,arguments)}function v(e){return S.apply(this,arguments)}function S(){return S=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=o("WARandomHex").randomHex(16);m[e].value=t,yield r("WAWebWamStorage").updatePsMeta({key:e,rotateInDays:m[e].rotationPeriodDays,value:t,creationTs:o("WATimeUtils").unixTime()}),o("WAWebWamUtils").logPsIdUpdate(o("WAWebWamEnumPsIdAction").PS_ID_ACTION.ROTATED,d[e],m[e].rotationPeriodDays)}),S.apply(this,arguments)}function R(e,t){if(t===-1||e==null)return!1;var n=t*o("WATimeUtils").DAY_SECONDS,r=Math.floor(o("WATimeUtils").unixTime()/n)*n;return e<r}l.initPrivateStats=_,l.getPrivateStatsIdsForCoreWam=g,l.getPrivateStatsKeyFromInt=h,l.getLatestPrivateStatsIdValueFromKey=y,l.maybeRotatePsIds=C}),98);
__d("WAWebWamInterop",["Promise","WACustomError","WATimeUtils","WAWamStorage","WAWebUserPrefsGeneral","WAWebWamPrivateStats","WAWebWamStorage","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s=function(r,a){return(e||(e=n("Promise"))).reject(new(o("WACustomError")).UnimplementedMethod("saveBuffer not implemented yet"))},u=function(r){return(e||(e=n("Promise"))).resolve()},c=function(r){return(e||(e=n("Promise"))).reject(new(o("WACustomError")).UnimplementedMethod("getStartingSequenceRow not implemented yet"))},d=function(){return(e||(e=n("Promise"))).reject(new(o("WACustomError")).UnimplementedMethod("getBuffers not implemented yet"))},m=function(){return(e||(e=n("Promise"))).reject(new(o("WACustomError")).UnimplementedMethod("nukeMetrics not implemented yet"))},p=function(r){return(e||(e=n("Promise"))).reject(new(o("WACustomError")).UnimplementedMethod("finishBuffer not implemented yet"))},_=function(){return(e||(e=n("Promise"))).reject(new(o("WACustomError")).UnimplementedMethod("updatePrivateStatsIds not implemented yet"))},f=(function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var o=yield r("WAWebWamStorage").getPsToken();return o?t({redeemCount:o.redeemCount,creationTs:o.creationTs},{maxExpirySeconds:86400})?r("WAWebWamStorage").savePsToken(babelHelpers.extends({},o,{redeemCount:o.redeemCount+1})).then(function(){return o.token}):(e||(e=n("Promise"))).resolve(null):null});return function(n){return t.apply(this,arguments)}})();function g(e){return r("WAWebWamStorage").savePsToken({key:"token",token:e,creationTs:o("WATimeUtils").unixTime(),redeemCount:1})}function h(){return(e||(e=n("Promise"))).resolve(o("WAWebUserPrefsGeneral").getPsKillSwitchToken())}function y(t){return o("WAWebUserPrefsGeneral").setPsKillSwitchToken(t),(e||(e=n("Promise"))).resolve()}var C={getStreamId:function(){return 1},saveBuffer:s,finishBuffer:p,getStartingSequenceRow:c,getBuffers:d,removeBufferByKey:u,nukeMetrics:m,updatePrivateStatsIds:_,redeemPrivateStatsToken:f,savePrivateStatsToken:g,privateStatsKillSwitchGetBlockedToken:h,privateStatsKillSwitchSet:y};function b(){o("WAWamStorage").startWamStorage(C)}l.startWamStore=b}),98);
__d("WAWebWamBeaconing",["WATimeUtils","WAWebUserPrefsGeneral"],(function(t,n,r,o,a,i,l){"use strict";function e(e){var t=o("WAWebUserPrefsGeneral").getWamBeaconingSettings(),n=t.find(function(t){return t.key===e}),r=null;if(n==null||s(n.ts)){var a=o("WATimeUtils").unixTime(),i=Math.random()<=.01,l={key:e,ts:a,value:i?1:null};n==null?t.push(l):(n.value=l.value,n.ts=a),r=l.value}else{if(n.value==null)return null;r=++n.value}return o("WAWebUserPrefsGeneral").setWamBeaconingSettings(t),r}function s(e){var t=Math.floor(o("WATimeUtils").unixTime()/o("WATimeUtils").DAY_SECONDS),n=Math.floor(e/o("WATimeUtils").DAY_SECONDS);return t!==n}l.maybeGetEventSequenceNumber=e}),98);
__d("WAWebWamLibProtocol",["WABinary"],(function(t,n,r,o,a,i,l){var e=8,s=0,u=1,c=2,d=4;function m(e,t,n){return f(e,t,n,s)}function p(e,t,n,r){var o=r?u:u|d;return f(e,t,n,o)}function _(e,t,n,r){var o=r?c:c|d;return f(e,t,n,o)}function f(e,t,n,r){if(n==null)r===s&&g(e,t,r);else if(typeof n=="number"&&n===(n|0))n===0?g(e,t,r|16):n===1?g(e,t,r|32):-128<=n&&n<128?(g(e,t,r|48),e.writeInt8(n)):-32768<=n&&n<32768?(g(e,t,r|64),e.writeInt16(n)):(g(e,t,r|80),e.writeInt32(n));else if(typeof n=="number")g(e,t,r|112),e.writeFloat64(n);else if(typeof n=="string"){var a=o("WABinary").numUtf8Bytes(n);a<256?(g(e,t,r|128),e.writeUint8(a)):a<65536?(g(e,t,r|144),e.writeUint16(a)):(g(e,t,r|160),e.writeUint32(a)),e.writeString(n)}}function g(t,n,r){n<256?(t.writeUint8(r),t.writeUint8(n)):(t.writeUint8(r|e),t.writeUint16(n))}l.writeGlobalAttribute=m,l.writeEvent=p,l.writeField=_}),98);
__d("WAWebWamLibContext",["WABase64","WABinary","WALogger","WAWebEventSampling","WAWebWamBeaconing","WAWebWamCodegenUtils","WAWebWamConstants","WAWebWamLibProtocol","WAWebWamPrivateStats"],(function(t,n,r,o,a,i,l){var e,s=47,u=3433,c=6005,d=0,m=1,p=2,_=2147483647,f=(function(){function t(e,t,n){this.bufferKey=e,this.buffer=new(o("WABinary")).Binary(void 0,!0),this.buffer.writeString("WAM"),this.buffer.writeUint8(o("WAWebWamConstants").WAM_PROTOCOL_VERSION),this.buffer.writeUint8(1),this.buffer.writeUint16(t),this.bufferKey==="regular"?this.buffer.writeUint8(d):this.bufferKey==="realtime"?this.buffer.writeUint8(m):this.buffer.writeUint8(p),this.eventsWritten=0,this.prevGlobals={},this.dirtyGlobals={},this.unsavedPortion=null,this.saveKey=String(Math.random()*1e9|0),this.$1(n)}var n=t.prototype;return n.size=function(){return this.buffer.size()},n.set=function(t,n){this.dirtyGlobals[String(t)]=n,this.unsavedPortion&&this.unsavedPortion.set(t,n)},n.write=function(n){var t,r=this.buffer;this.set(s,n.commitTime);var a=o("WAWebWamBeaconing").maybeGetEventSequenceNumber(this.bufferKey);a!=null&&this.set(u,a),n.wamChannel==="private"&&this.set(c,o("WAWebWamPrivateStats").getLatestPrivateStatsIdValueFromKey(this.bufferKey).toString()),this.$2();for(var i=n.all,l=Object.keys(i),d=-1,m=!1,p=0;p<l.length;p++){var f=i[l[p]];f!=null&&(d=p,m=!0)}var g=(t=o("WAWebEventSampling").getClientEventSamplingWeight(n.id))!=null?t:n.weight;o("WAWebWamLibProtocol").writeEvent(r,n.id,-g,m);for(var h=0;h<=d;h++){var y=l[h],C=o("WAWebWamCodegenUtils").metrics.getEvent(n.$className,y),b=C.id,v=C.type,S=i[y];if(S!=null){if(typeof S=="boolean"&&(S=S?1:0),m=h<d,v==="timer"&&S>_){o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[wam] invalid value for timer field ",".",""])),n.$className,y).sendLogs("wam-event-validation-error");continue}o("WAWebWamLibProtocol").writeField(r,b,S,m)}}this.eventsWritten++,this.unsavedPortion&&this.unsavedPortion.write(n)},n.stringBuffer=function(){return this.eventsWritten>0?o("WABase64").encodeB64(this.buffer.peek(function(e){return e.readByteArrayView()})):""},n.getBuffer=function(){return this.buffer},n.$1=function(t){var e=(function(e){return e==="regular"||e==="realtime"?"regular":"private"})(this.bufferKey);for(var n in t){var r=t[n],a=o("WAWebWamCodegenUtils").metrics.getGlobal(n),i=a.channels.includes(e);r!==void 0&&i&&this.set(o("WAWebWamCodegenUtils").metrics.getGlobal(n).id,r)}},n.$2=function(){var e=this.dirtyGlobals,t=this.prevGlobals;for(var n in e){var r=e[n];if(typeof r=="boolean")r=r?1:0;else if(r===void 0)r=null;else if(Number.isNaN(r))continue;if(r!==t[n]||n===String(s)||n===String(c)){t[n]=r;var a=parseInt(n,10);o("WAWebWamLibProtocol").writeGlobalAttribute(this.buffer,a,r)}}this.dirtyGlobals={}},t})();l.WamContext=f}),98);
__d("WAWebWam",["Promise","SiteData","WALogger","WANullthrows","WAResolvable","WAShiftTimer","WATimeUtils","WAWebABProps","WAWebABPropsLocalStorage","WAWebBrowserApi","WAWebBuildConstants","WAWebCrashlog","WAWebEnvironment","WAWebEventSampling","WAWebGuestWamUtils","WAWebIsOfficialClient","WAWebMiscBrowserUtils","WAWebUploadPrivateStatsBackend","WAWebUploadStatsBackend","WAWebUserPrefsIsLoggedIn","WAWebUserPrefsTabMutex","WAWebWamClientErrorsWamEvent","WAWebWamConstants","WAWebWamEnumDeviceClassification","WAWebWamEnumPlatformType","WAWebWamEnumWebcWebPlatformType","WAWebWamGlobals","WAWebWamInterop","WAWebWamLibContext","WAWebWamPlatform","WAWebWamPrivateStats","WAWebWamRuntimeProvider","WAWebWamStorage","WAWebWamUtils","asyncToGeneratorRuntime","justknobx"],(function(t,n,r,o,a,i,l){var e,s,u,c,d,m,p,_,f,g,h,y,C,b,v,S,R,L,E,k,I,T,D,x,$,P,N,M,w,A,F,O,B,W,q=[],U=[],V=!1,H="1",G={commit:j(re),set:j(ae),resumeJobs:j(ce),initialize:j(ie)};function z(){for(q=o("WAWebWamGlobals").PrivateStatsAllIds.map(function(e){return e.key}),o("WAWebWamPrivateStats").initPrivateStats().catch(function(t){o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[WAM] failed to initialise private stats for wam runtime "]))).devConsole(t)}),o("WAWebWamInterop").startWamStore(),W=new(o("WAShiftTimer")).ShiftTimer(function(e){var t=!r("WAWebEnvironment").isGuest&&!o("WAWebUserPrefsTabMutex").currentTabHasMutex();if(t){o("WALogger").WARN(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[wam] this tab is in the background, skipping WAM processing for now"])));return}de(e).catch(function(e){o("WALogger").LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["[WAM] failed to execute pending jobs for wam runtime "]))).devConsole(e)})}),o("WAWebWamRuntimeProvider").setWamRuntime(G);U.length;){var t=U.pop();t&&t()}V=!0}function j(e){return function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];if(V)return e.apply(void 0,n);U.push(function(){e.apply(void 0,n)})}}var K={},Q=0,X=[],Y=!1,J=!1,Z=null,ee=new(o("WAResolvable")).Resolvable,te=!1,ne=!1;function re(e,t){var a;if(t===void 0&&(t=!1),e.commitTime!=null&&e.commitTime!==0)return o("WALogger").WARN(c||(c=babelHelpers.taggedTemplateLiteralLoose(["wam:commit redundant commit! ",""])),e.$className),(B||(B=n("Promise"))).resolve();e.wamChannel;var i=(a=o("WAWebEventSampling").getClientEventSamplingWeight(e.id))!=null?a:e.weight;if(i!==0&&Math.random()*i>1)return e.commitTime=o("WATimeUtils").unixTimeWithoutClockSkewCorrection(),(B||(B=n("Promise"))).resolve();o("WALogger").DEV(d||(d=babelHelpers.taggedTemplateLiteralLoose(["wam:commit ",""])),e.$className).devConsole(e.all),oe(e),o("WAWebWamUtils").maybeForwardWamEventToJestE2e(e);var l;return e.wamChannel==="realtime"&&r("justknobx")._("4924")?l=r("justknobx")._("4680")?"realtime":"all":r("WAWebEnvironment").isGuest||t?l="all":l="none",se({job:e,flushWamBuffers:l})}function oe(e,t){e.commitTime=t!=null?t:o("WATimeUtils").unixTimeWithoutClockSkewCorrection()}function ae(e,t){return o("WALogger").DEV(m||(m=babelHelpers.taggedTemplateLiteralLoose(["[wam] set "," = ",""])),e.name,String(t)),o("WAWebWamUtils").maybeForwardWamAttributeToJestE2e(e.name,String(t)),se({job:[e,t],flushWamBuffers:"none"})}function ie(){return le.apply(this,arguments)}function le(){return le=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e;if(Z)return(B||(B=n("Promise"))).resolve(Z);var t=r("WAWebMiscBrowserUtils").info(),a=babelHelpers.extends({appVersion:o("WAWebBuildConstants").VERSION_BASE_WITH_WINDOWS_BUILD,appBuild:o("WAWebWamUtils").getAppBuild(),platform:o("WAWebWamEnumPlatformType").PLATFORM_TYPE.WEBCLIENT,appIsBetaRelease:yield o("WAWebWamUtils").getAppIsBetaRelease(),browser:t.name||null,browserVersion:t.ua||null,deviceName:t.os||null,deviceVersion:t.version||null,memClass:o("WAWebBrowserApi").getMemClass(),numCpu:o("WAWebBrowserApi").getNumCpu(),webcEnv:o("WAWebWamUtils").getWamEnv(),webcTabId:o("WAWebUserPrefsTabMutex").THIS_TAB,webcWebPlatform:o("WAWebWamEnumWebcWebPlatformType").WEBC_WEB_PLATFORM_TYPE[o("WAWebWamPlatform").getWamPlatform()],ocVersion:o("WAWebIsOfficialClient").isOfficialClient?1:0,deviceClassification:o("WAWebWamEnumDeviceClassification").DEVICE_CLASSIFICATION.DESKTOP,webcRevision:r("SiteData").client_revision,abKey2:o("WAWebABProps").getABPropConfigValue("wam_disable_abkey_attribute")?null:(e=o("WAWebABPropsLocalStorage").getABKey())!=null?e:""},r("WAWebEnvironment").isGuest?o("WAWebGuestWamUtils").getGuestWamOverrides():{});return Z=a,o("WALogger").DEV(f||(f=babelHelpers.taggedTemplateLiteralLoose(["[wam] initialize"]))).devConsole(Z),o("WAWebWamGlobals").Global.commitOnSet=!1,o("WAWebWamGlobals").Global.set(Z),o("WAWebWamGlobals").Global.commitOnSet=!0,Object.keys(a).forEach(function(e){return o("WAWebWamUtils").maybeForwardWamAttributeToJestE2e(e,String(a[e]))}),a}),le.apply(this,arguments)}function se(e){var t=e.job,n=e.flushWamBuffers;return X.push(t),Y?n!=="none"?(te=!1,ne=!0,self.setTimeout(function(){return W.forceRunNow(n)},1)):W.onOrBefore(o("WAWebWamUtils").getInMemoryBufferingDurationInSecs()*1e3):n==="realtime"&&r("justknobx")._("3237")?self.setTimeout(function(){return W.forceRunNow("realtime")},1):n!=="none"&&(W.cancel(),te=!0,ne=!1),ee.promise}function ue(){o("WALogger").DEV(p||(p=babelHelpers.taggedTemplateLiteralLoose(["wam pause processing"]))),Y=!1,W.cancel();var e=ee;return ee=new(o("WAResolvable")).Resolvable,e}function ce(){o("WALogger").DEV(_||(_=babelHelpers.taggedTemplateLiteralLoose(["wam enable processing"]))),Y=!0,ne=!1,X.length>0&&W.onOrBefore(o("WAWebWamUtils").getInMemoryBufferingDurationInSecs()*1e3),te&&(te=!1,ne=!0,W.forceRunNow())}function de(e){return me.apply(this,arguments)}function me(){return me=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=ne,a=!(e==="realtime"&&r("justknobx")._("3237")),i=a?ue():null,l,s;if(e==="realtime"){l=["realtime"];var u=X.reduce(function(e,t){var n=e[0],r=e[1];return!Array.isArray(t)&&t.wamChannel==="realtime"?n.push(t):r.push(t),[n,r]},[[],[]]);s=u[0],X=u[1]}else l=["regular","realtime","none"].concat(q),s=[].concat(X),X=[];try{var c=yield ie();if(e!=="realtime"){var d=yield o("WAWebWamPrivateStats").maybeRotatePsIds();yield(B||(B=n("Promise"))).all(d.map(function(e){return pe(e,c)}))}o("WALogger").DEV(g||(g=babelHelpers.taggedTemplateLiteralLoose(["[wam] executePending "," jobs"])),s.length),yield(B||(B=n("Promise"))).all(l.map(function(e){return Ce(e,s,t,c)}))}finally{a&&(i==null||i.resolve(),ce())}}),me.apply(this,arguments)}function pe(e,t){return _e.apply(this,arguments)}function _e(){return _e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){return yield ve(e,t),K[e]=yield fe(e,t),K[e]}),_e.apply(this,arguments)}function fe(e,t){return ge.apply(this,arguments)}function ge(){return ge=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){return new(o("WAWebWamLibContext")).WamContext(e,yield r("WAWebWamStorage").getNextSequenceNumberForStream(H),t)}),ge.apply(this,arguments)}function he(e,t){return ye.apply(this,arguments)}function ye(){return ye=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n,r=(n=K[e])!=null?n:yield fe(e,t);return K[e]=r,r}),ye.apply(this,arguments)}function Ce(e,t,n,r){return be.apply(this,arguments)}function be(){return be=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n,r){var a=o("WAWebWamUtils").getChannelFromBufferKey(e),i;try{i=yield he(e,r)}catch(e){o("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[wam] _executePendingForContext failed to get context ",""])),String(e!=null&&e.stack?e.stack:e));return}try{for(var l=0;l<t.length;l++){if(i.size()>o("WAWebWamConstants").WAM_MAX_BUFFER_SIZE)if(o("WAWebABProps").getABPropConfigValue("web_wam_finalize_buffers_when_full")){var s=yield pe(e,r);if(s==null)break;i=s}else{o("WALogger").WARN(y||(y=babelHelpers.taggedTemplateLiteralLoose(["[wam] _executePendingForContext drop the rest due to size limit: "," > ",""])),i.size(),o("WAWebWamConstants").WAM_MAX_BUFFER_SIZE);break}var u=t[l];if(Array.isArray(u)){var d=u[0],m=u[1],p=a==="realtime"?"regular":a;d.channels.includes(p)&&(r[d.name]=m,i.set(d.id,m))}else{var c=u;((c.wamChannel==="regular"||c.wamChannel==="realtime")&&c.wamChannel===a||c.wamChannel==="private"&&e===o("WAWebWamPrivateStats").getPrivateStatsKeyFromInt(c.privateStatsIdInt))&&i.write(c)}}var _=o("WATimeUtils").unixTimeWithoutClockSkewCorrection();if(i.eventsWritten>0&&(n||i.size()>o("WAWebWamConstants").WAM_MAX_BUFFER_SIZE||_>=Q+o("WAWebWamUtils").getBufferRotateIntervalInSecs()||!J)){var f=o("WAWebUserPrefsIsLoggedIn").isLoggedIn();if(!f){o("WALogger").DEV(C||(C=babelHelpers.taggedTemplateLiteralLoose(["[wam] _executePending wam unauthed, didn't send"]))),i.buffer.size()>o("WAWebWamConstants").WAM_MAX_BUFFER_SIZE?(K[e]=null,o("WALogger").DEV(b||(b=babelHelpers.taggedTemplateLiteralLoose(["[wam] _executePending abandoned current buffer"])))):yield ve(e,r);return}yield Re(e)}else yield ve(e,r)}catch(t){o("WALogger").WARN(v||(v=babelHelpers.taggedTemplateLiteralLoose(["[wam] _executePending error ",""])),String(t!=null&&t.stack?t.stack:t)).devConsole(t),o("WAWebCrashlog").upload({reason:"wam-error"}),new(o("WAWebWamClientErrorsWamEvent")).WamClientErrorsWamEvent({wamClientBufferDropErrorCount:1}).commit(),K[e]=null}}),be.apply(this,arguments)}function ve(e,t){return Se.apply(this,arguments)}function Se(){return Se=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){if(K[e]){var n=K[e].stringBuffer();if(n){var a=r("WANullthrows")(K[e]).unsavedPortion;if(!(a&&a.eventsWritten===0)){var i=r("WANullthrows")(K[e]).saveKey;try{if(a){o("WALogger").DEV(S||(S=babelHelpers.taggedTemplateLiteralLoose(["[wam] saveCurrentContext has unsavedPortion WamStorage.update start"])));var l=yield r("WAWebWamStorage").update(i,e,n);if(o("WALogger").DEV(R||(R=babelHelpers.taggedTemplateLiteralLoose(["[wam] saveCurrentContext has unsavedPortion WamStorage.update end"]))),!K[e])return;if(l)o("WALogger").DEV(L||(L=babelHelpers.taggedTemplateLiteralLoose(["[wam] save successfully updated ",""])),i),r("WANullthrows")(K[e]).unsavedPortion=yield fe(e,t);else{K[e]=K[e].unsavedPortion,o("WALogger").DEV(E||(E=babelHelpers.taggedTemplateLiteralLoose(["[wam] save other tab claimed buffer, cutting head"]))),yield ve(e,t);return}}else{if(o("WALogger").DEV(k||(k=babelHelpers.taggedTemplateLiteralLoose(["[wam] saveCurrentContext no unsavedPortion WamStorage.update start"]))),yield r("WAWebWamStorage").add(i,e,n),o("WALogger").DEV(I||(I=babelHelpers.taggedTemplateLiteralLoose(["[wam] saveCurrentContext no unsavedPortion WamStorage.update end"]))),!K[e])return;o("WALogger").DEV(T||(T=babelHelpers.taggedTemplateLiteralLoose(["[wam] save successfully saved new entry ",""])),i),r("WANullthrows")(K[e]).unsavedPortion=yield fe(e,t)}}catch(e){o("WALogger").WARN(D||(D=babelHelpers.taggedTemplateLiteralLoose(["[wam] save WamStorage failed to save ",""])),String(e)).devConsole(e)}}}}}),Se.apply(this,arguments)}function Re(e){return Le.apply(this,arguments)}function Le(){return Le=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t;try{t=yield r("WAWebWamStorage").deleteAll(e)}catch(e){t={},o("WALogger").WARN(x||(x=babelHelpers.taggedTemplateLiteralLoose(["[wam] sendAllLogs failed to read because ",""])),String(e)).devConsole(e)}var a=t;if(K[e]){K[e].unsavedPortion&&!(K[e].saveKey in a)&&(K[e]=K[e].unsavedPortion);var i=r("WANullthrows")(K[e]).saveKey;a[i]=r("WANullthrows")(K[e]).stringBuffer()}o("WALogger").DEV($||($=babelHelpers.taggedTemplateLiteralLoose(["sendAllLogs: sendLogs start"])));var l=yield(B||(B=n("Promise"))).all(Object.entries(a).map(function(t){var n=t[0],r=t[1];return Ee(r,n,o("WAWebWamUtils").getChannelFromBufferKey(e))}));o("WALogger").DEV(P||(P=babelHelpers.taggedTemplateLiteralLoose(["sendAllLogs: sendLogs success"])));var s=l.filter(Boolean);if(s.length!==l.length&&(Q=o("WATimeUtils").unixTimeWithoutClockSkewCorrection(),J=!0),K[e]&&!s.includes(K[e].saveKey)&&(K[e]=null),s.length!==0){var u=s.reduce(function(e,t){return e+a[t].length},0);u<o("WAWebWamConstants").WAM_MAX_BUFFER_SIZE?(o("WALogger").DEV(N||(N=babelHelpers.taggedTemplateLiteralLoose(["sendAllLogs: process failures start bufferKey ",""])),e),yield(B||(B=n("Promise"))).all(s.map((function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){try{yield r("WAWebWamStorage").add(t,e,a[t])}catch(e){o("WALogger").WARN(M||(M=babelHelpers.taggedTemplateLiteralLoose(["sendAllLogs: adding to WamStorage failed"])))}});return function(e){return t.apply(this,arguments)}})())),o("WALogger").DEV(w||(w=babelHelpers.taggedTemplateLiteralLoose(["sendAllLogs: process failures success bufferKey ",""])),e)):(K[e]=null,new(o("WAWebWamClientErrorsWamEvent")).WamClientErrorsWamEvent({wamClientBufferDropErrorCount:1}).commit(),o("WALogger").WARN(A||(A=babelHelpers.taggedTemplateLiteralLoose(["wam dropped "," buffers! ("," bytes)"])),s.length,u).devConsole(a))}}),Le.apply(this,arguments)}function Ee(e,t,n){return ke.apply(this,arguments)}function ke(){return ke=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,a){return e===""||e[0]==="["?(B||(B=n("Promise"))).resolve():o("WAWebWamUtils").isWamBufferTooBigToUpload(e)?(new(o("WAWebWamClientErrorsWamEvent")).WamClientErrorsWamEvent({wamClientBufferDropErrorCount:1}).commit(),(B||(B=n("Promise"))).resolve()):a==="private"?(o("WALogger").DEV(F||(F=babelHelpers.taggedTemplateLiteralLoose(["sendLogs: uploadPrivateStats"]))),r("WAWebUploadPrivateStatsBackend")(e,t)):(o("WALogger").DEV(O||(O=babelHelpers.taggedTemplateLiteralLoose(["sendLogs: uploadStats for channel ",""])),a),r("WAWebUploadStatsBackend")(e,t))}),ke.apply(this,arguments)}l.Wam=G,l.initWamRuntime=z,l.sendAllLogs=Re}),98);
__d("WAWebWamEnumAndroidKeystoreStateType",[],(function(t,n,r,o,a,i){var e=Object.freeze({NOT_AVAILABLE:1,SELF_TEST_FAILURE:2,ENC_KEY_READ_FAILURE:3,ENC_KEY_STORED_USED:4,ENC_KEY_PLAIN_DELETED:5,ENC_KEY_PLAIN_RECOVERED:6});i.ANDROID_KEYSTORE_STATE_TYPE=e}),66);
__d("WAWebWebcMessageSendWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumMediaType","WAWebWamEnumMessageType"],(function(t,n,r,o,a,i,l){var e=o("WAWebWamCodegenUtils").defineEvents({WebcMessageSend:[2072,{messageIsForward:[3,o("WAWebWamCodegenUtils").TYPES.BOOLEAN],messageMediaType:[2,o("WAWebWamEnumMediaType").MEDIA_TYPE],messageSendT:[4,o("WAWebWamCodegenUtils").TYPES.TIMER],messageType:[1,o("WAWebWamEnumMessageType").MESSAGE_TYPE]},[1,1,1],"regular"]},{WebcMessageSend:[]});l.WebcMessageSendWamEvent=e}),98);
__d("WAWebWebcStorageStatWamEvent",["WAWebWamCodegenUtils"],(function(t,n,r,o,a,i,l){var e,s=(e=o("WAWebWamCodegenUtils")).defineEvents({WebcStorageStat:[1504,{webcAgeOfStorage:[3,e.TYPES.INTEGER],webcPackingEnabled:[4,e.TYPES.BOOLEAN],webcStorageQuota:[2,e.TYPES.INTEGER],webcStorageUsage:[1,e.TYPES.INTEGER]},[1,1,1],"regular"]},{WebcStorageStat:[]});l.WebcStorageStatWamEvent=s}),98);
__d("WAWebWorkerStorage",["WALogger","WAWeb-dexie","WAWebDbRolloutUtil","WAWebDexieBootstrap","WAWebDexieCastTypes","WAWebSchemaDeferredMessagesStorage","WAWebSchemaLocalStorage","WAWebStorage","WAWebWorkerStorageUtils","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){var e,s;function u(){return c.apply(this,arguments)}function c(){return c=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){return o("WAWebDexieBootstrap").patchDexie(),s==null&&(yield o("WAWebDbRolloutUtil").loadSchemaVersions(),o("WAWebWorkerStorageUtils").createStorage(),o("WAWebSchemaLocalStorage").addTable(),o("WAWebSchemaDeferredMessagesStorage").addTable(),s=o("WAWebWorkerStorageUtils").getStorage().initialize().catch(function(t){var n="Unknown error";throw t instanceof o("WAWebStorage").AlreadyInitializedError||t instanceof o("WAWebStorage").NoSuchDatabaseError?n=t.toString():t instanceof r("WAWeb-dexie").DexieError&&(n="Unknown DexieError"),o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[worker] Failed to initialize model storage: ",""])),n).verbose().devConsole(t).sendLogs("failed-to-initialize-model-storage",{sendLogsType:o("WALogger").SendLogsType.CRASH_OR_UNRECOVERABLE_ERROR_SAD}),t})),s}),c.apply(this,arguments)}function d(){return o("WAWebWorkerStorageUtils").destroyStorage().catch(function(){return o("WAWebDexieCastTypes").dexieCastToPromise(new(r("WAWeb-dexie"))(o("WAWebWorkerStorageUtils").DATABASE_NAME).delete())}).finally(function(){s=null})}l.getLocalStorageTable=o("WAWebSchemaLocalStorage").getTable,l.getDeferredMessagesTable=o("WAWebSchemaDeferredMessagesStorage").getTable,l.initialize=u,l.destroy=d}),98);
__d("filterObject",[],(function(t,n,r,o,a,i){"use strict";var e=Object.prototype.hasOwnProperty;function l(t,n,r){if(!t)return null;var o={};for(var a in t)e.call(t,a)&&n.call(r,t[a],a,t)&&(o[a]=t[a]);return o}i.default=l}),66);
__d("WebWorker",["invariant","BlobFactory","Bootloader","EventListener","FBLogger","SubscriptionsHandler","TrustedTypesWebWorkerScriptURLPolicy","URI","WebWorkerConfig","XCometFBMultiSiteWebWorkerInitScriptControllerRouteBuilder","XHRRequest","cr:951783","emptyFunction","err","filterObject","getCrossOriginTransport","getWorkerInitScriptSPINParams","gkx","isSameOrigin","justknobx","memoize","nullthrows","performanceNow"],(function(t,n,r,o,a,i,l){var e,s,u=t.URL||t.webkitURL,c={remove:n("emptyFunction")},d=(function(){"use strict";function r(e){var t=this;this.$2=!1,this.$3=null,this.$4=e,this.__worker=null,this.$5=n("emptyFunction"),this.$6=n("emptyFunction"),this.$7=[],this.$8=[],this.$9=!1,this.$10=new(n("SubscriptionsHandler")),this.$1=n("cr:951783")!==null?n("cr:951783")(function(){t.$9||t.terminate()}):c,n("gkx")("20935")&&setTimeout(function(){!t.$9&&!t.isCurrentState("terminated")&&n("FBLogger")("comet_infra").mustfix("WebWorker (resource: %s) allowCrossPageTransitions must be true on Comet, or you must handle cleaning up your worker.",e.name)},1e3),this.$11("constructed")}var o=r.prototype;return o.setMessageHandler=function(t){return this.$5=t||n("emptyFunction"),this},o.setErrorHandler=function(t){return this.$6=t||n("emptyFunction"),this},o.postMessage=function(t,n){if(!this.isCurrentState("constructed")||l(0,5977),!this.isCurrentState("terminated")||l(0,5978),this.isCurrentState("preparing"))return this.$7.push(this.postMessage.bind(this,t,n)),this;var e={type:"message",message:t};return n?this.getInterfaceableWorker().postMessage(e,n):this.getInterfaceableWorker().postMessage(e),this},o.$12=function(){this.isCurrentState("terminated")||(this.$11("terminated"),this.__worker=null,this.$13(),this.$7=[],this.$8=[],this.$1&&this.$1.remove&&this.$1.remove())},o.terminate=function(){this.isCurrentState("executing")&&this.__worker!=null&&this.__worker.terminate(),this.$12()},o.execute=function(){var e=this;!this.isCurrentState("terminated")||l(0,5979);var t=["preparing","executing"];return t.some(function(t){return e.isCurrentState(t)})?this:(this.$11("preparing"),r.prepareResource(this.$4,this.$14.bind(this)),this)},o.setAllowCrossPageTransition=function(t){return n("gkx")("20935")&&!t&&n("FBLogger")("comet_infra").mustfix("allowAcrossPageTransitions must be true because we dont kill these in Comet."),this.$9=t,this},o.isCurrentState=function(t){return r.states.includes(t)||l(0,5980,t),t===this.$3},o.$14=function(){if(!this.isCurrentState("executing")||l(0,5981),!this.isCurrentState("terminated")){if(this.$4.useInitScript&&n("gkx")("21112")||this.$4.sameOriginURL||this.$4.source||l(0,19837,this.$4.name),this.$4.useInitScript&&n("gkx")("21112")){var e,t=n("nullthrows")((e=n("XCometFBMultiSiteWebWorkerInitScriptControllerRouteBuilder").buildUri({}).addQueryParams(n("getWorkerInitScriptSPINParams")()))==null?void 0:e.toString()),o=new window.URL(this.$4.url,window.location.href).href;if(o==null)throw n("err")("Can't start up worker without a resource url.");this.__worker=this.constructWorker(t,this.$4.name),this.__worker.postMessage({bundleUrl:o,doNotStartBundle:!0,isDev:!1,resource:this.$4,type:"sr-init"})}else this.$4.sameOriginURL?this.__worker=this.constructWorker(this.$4.sameOriginURL):(this.__worker=this.constructWorker(r.evalWorkerURL),this.getInterfaceableWorker().postMessage(this.$4.source));if(this.$15("ping",Date.now()),this.$4.dynamicModules)try{this.$15("defineModules",this.$4.dynamicModules)}catch(e){throw this.terminate(),this.$16("define_error",{message:e.message}),e}this.$17(),this.$11("executing"),this.$7.forEach(function(e){return e()}),this.$7=[],this.$8.forEach(function(e){return e()}),this.$8=[]}},o.$13=function(){this.$10.release()},o.$15=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];this.getInterfaceableWorker().postMessage({type:t,args:n})},o.$16=function(t,o){var e=!(this.$4.useInitScript&&n("gkx")("21112"));r.$16(t,this.$4.name,babelHelpers.extends({},o,{cross_page_transition:!!this.$9,state:this.$3}),e)},r.$18=function(t){return Object.keys(n("filterObject")({object_url:t&&r.$19(),data_url:t&&r.$20(),worker:r.isSupported()},function(e){return!!e}))},o.$17=function(){this.$10.addSubscriptions(n("EventListener").listen(this.getInterfaceableWorker(),"message",this.$21.bind(this)),n("EventListener").listen(this.getInterfaceableWorker(),"error",this.$22.bind(this)))},o.$22=function(t){var e=this.$6(t);!e&&!t.defaultPrevented&&this.$16("exception",{message:t.message})},o.$21=function(n){var e=n.data;switch(e.type){case"message":this.$5(e.message);break;case"pong":this.$2=!0,this.$16("executed",{dt:Math.floor(e.args[1]-e.args[0]),bytes:this.$4.source?this.$4.source.length:-1});break;case"terminate":this.terminate();break;case"haste-error":this.terminate(),this.$16("haste_error",{message:e.message});break;case"console":var r=e.args.shift();["log","error","info","debug","warn"].includes(r)||l(0,5983,r),t.console[r].apply(t.console,e.args);break}},o.$11=function(t){r.states.includes(t)||l(0,5984,t),this.$16("transition",{next_state:t}),this.$3=t},r.prepareResource=function(a,i){if(i===void 0&&(i=n("emptyFunction")),a.sameOriginURL||a.url||a.source||l(0,5985),r.isSupported()||l(0,5986),a.sameOriginURL)i();else if(a.url&&n("isSameOrigin")(new(e||(e=n("URI")))(a.url),new(e||(e=n("URI")))(t.location.href)))a.sameOriginURL=a.url,i();else if(a.source)n("justknobx")._("819")&&n("FBLogger")("static_resources").warn("trying to instantiate blob/data Url Worker %s %s",a.name,a.url),r.$23()&&(a.sameOriginURL=r.$24(a.source)),i();else if(n("gkx")("21112")&&a.useInitScript===!0)i();else if(n("justknobx")._("819")&&n("FBLogger")("static_resources").warn("trying to instantiate blob/data Url Worker %s %s",a.name,a.url),a.loading)a.loading.push(i);else{var o=(s||(s=n("performanceNow")))();a.loading=[i],r.$25(a.url,function(e){e?(a.source=e,r.$23()&&(a.sameOriginURL=r.$24(e)),r.$16("prepared",a.name,{dt:Math.floor((s||(s=n("performanceNow")))()-o),bytes:e.length},!1)):r.$16("failed",a.name,{dt:Math.floor((s||(s=n("performanceNow")))()-o),bytes:0},!1),a.loading.forEach(function(e){return e()}),a.loading=!1})}return a},r.releaseResource=function(t){return t.sameOriginURL.indexOf("blob:")===0&&(u.revokeObjectURL&&u.revokeObjectURL(t.sameOriginURL),t.sameOriginURL=null),t},r.isSupported=function(){return f},r.isMessageChannelSupported=function(){return r.areTransferablesSupported()&&!!t.MessageChannel},r.areTransferablesSupported=function(){return r.isSupported()&&g()},r.$25=function(t,r){new(n("XHRRequest"))(t).setTransportBuilder(n("getCrossOriginTransport")).setMethod("GET").setResponseHandler(function(e){r(e)}).setErrorHandler(r.bind(null,null)).send()},r.$24=function(t){if(r.$23()||l(0,5987),r.$19()){var e=n("BlobFactory").getBlob([t],{type:"application/javascript"});return u.createObjectURL(e)}if(r.$20())return"data:application/javascript,"+encodeURIComponent(t)},r.$19=function(){return n("BlobFactory").isSupported()&&p()},r.$20=function(){return _()},r.$23=function(){return r.$19()||r.$20()},r.$16=function(t,o,a,i){n("WebWorkerConfig").logging.enabled&&n("Bootloader").loadModules(["BanzaiLogger"],function(e){e.log(n("WebWorkerConfig").logging.config,babelHelpers.extends({},a,{features_array:r.$18(i),event:t,resource:o}))},"WebWorker")},o.constructWorker=function(t,n){return m(t,n)},o.$26=function(t,n){if(this.isCurrentState("preparing")){this.$8.push(this.$26.bind(this,t,n));return}this.getInterfaceableWorker().postMessage({type:"port",message:t},n)},o.createMessageChannel=function(t,n){var e=new MessageChannel;return this.$26(t,[e.port2].concat(n||[])),e.port1.start(),e.port1},o.getInterfaceableWorker=function(){return this.__worker},r})();d.states=["constructed","preparing","executing","terminated"],d.evalWorkerURL=n("WebWorkerConfig").evalWorkerURL;function m(e,r){return new t.Worker(n("TrustedTypesWebWorkerScriptURLPolicy").createScriptURL(e),r!=null?{name:r}:{})}var p=n("memoize")(function(){var e,t;if(!u||!u.createObjectURL)return!1;try{e=u.createObjectURL(n("BlobFactory").getBlob([""],{type:"application/javascript"}));var r=m(e);r.terminate(),t=!0}catch(e){t=!1}finally{u.revokeObjectURL&&u.revokeObjectURL(e)}return t}),_=n("memoize")(function(){var e;try{var t=m("data:application/javascript,");t.terminate(),e=!0}catch(t){e=!1}return e}),f=!!t.Worker,g=n("memoize")(function(){var e;try{var t=m(d.evalWorkerURL),n=new ArrayBuffer(0);t.postMessage({buffer:n},[n]),t.terminate(),e=!0}catch(t){e=!1}return e});a.exports=d}),null);
__d("everySet",[],(function(t,n,r,o,a,i){"use strict";function e(e,t,n){for(var r=e.entries(),o=r.next();!o.done;){var a=o.value;if(!t.call(n,a[1],a[0],e))return!1;o=r.next()}return!0}i.default=e}),66);
__d("equalsSet",["everySet"],(function(t,n,r,o,a,i,l){"use strict";function e(e,t){return e.size!==t.size?!1:r("everySet")(e,function(e){return t.has(e)})}l.default=e}),98);
__d("getMoreGranularErrorNameFromHTMLVideoElementErrorMessage",[],(function(t,n,r,o,a,i){"use strict";function e(e){var t,n,r=/^([A-Z_]+:)|([A-Z_]+\s+\(0x[0-9A-Fa-f]+\))/.exec(e),o=((t=(n=r==null?void 0:r[1])!=null?n:r==null?void 0:r[2])!=null?t:"").replace(/\s+/,"_").replace(/[^A-Za-z0-9_]/g,"");return o!==""?o:null}i.default=e}),66);
__d("partitionArray",[],(function(t,n,r,o,a,i){function e(e,t,n){var r=[],o=[];return e.forEach(function(a,i){t.call(n,a,i,e)?r.push(a):o.push(a)}),[r,o]}i.default=e}),66);
__d("sortBy",[],(function(t,n,r,o,a,i){"use strict";function e(e,t){var n=e.map(function(e,n){return{index:n,sortValue:t(e),value:e}});return n.sort(function(e,t){var n=e.sortValue,r=t.sortValue;return n>r?1:n<r?-1:e.index-t.index}),n.map(function(e){return e.value})}i.default=e}),66);
__d("sumOfArray",[],(function(t,n,r,o,a,i){function e(e){for(var t=0,n=e.length,r=0;r<n;++r)t+=e[r];return t}i.default=e}),66);
__d("uniqueBy",[],(function(t,n,r,o,a,i){"use strict";function e(e,t){var n=new Map(e.map(function(e){return[t?t(e):e,e]}));return Array.from(n.values())}i.default=e}),66);
__d("useWAWebAsync",["react","useWAWebStableCallback"],(function(t,n,r,o,a,i,l){var e,s=e||(e=o("react")),u=s.useEffect,c=s.useState,d={loading:!0,error:null,value:null};function m(e,t){var n=r("useWAWebStableCallback")(e),o=c(d),a=o[0],i=o[1];return u(function(){var e=new AbortController;return i(d),n(e.signal).then(function(t){e.signal.aborted||i({loading:!1,error:null,value:t})}).catch(function(e){i({loading:!1,error:e,value:null})}),function(){e.abort()}},[n].concat(t)),a}l.default=m}),98);
__d("useWAWebFlow",["$InternalEnum","WANullthrows","WAWebUimUie.react","WAWebVelocityTransitionGroup","react","useWAWebStableCallback","useWAWebUIM"],(function(t,n,r,o,a,i,l){var e=["ref"],s,u,c=u||(u=o("react")),d=s||(s=r("react")),m=c.useCallback,p=c.useEffect,_=c.useMemo,f=c.useReducer,g=c.useRef,h={container:{height:"x5yr21d",insetInlineStart:"x1o0tod",left:null,right:null,overflowX:"x6ikm8r",overflowY:"x10wlt62",position:"x10l6tqk",top:"x13vifvy",width:"xh8yej3",$$css:!0}};function y(){function t(t){var n=t.ref,a=babelHelpers.objectWithoutPropertiesLoose(t,e),i=a.flow,l=a.children,s=a.displayName,u=s===void 0?"FlowDrawer":s,c=i.pop,m=i.transition,p=i.activeKey;if(l==null)return null;var _=function(){a.requestFocus&&a.requestFocus()},f=function(t){a.requestDismiss?a.requestDismiss(t):c()};return d.jsx(r("WAWebVelocityTransitionGroup"),{ref:n,transitionName:m,xstyle:h.container,displayName:u+"-"+p,children:d.jsx(o("WAWebUimUie.react").UIE,{displayName:u+"-"+p,escapable:!0,requestFocus:_,requestDismiss:f,children:l},p)})}return t.displayName=t.name+" [from "+i.id+"]",t}var C=n("$InternalEnum").Mirrored(["DrawerLeft","DrawerRight","Modal","None"]);function b(e){var t=e.initialStep,n=e.initialTransition;return{stack:t!=null?[t]:[],previousStep:null,transition:n,activeKey:1,ended:!1,isPushed:!0}}function v(e,t){var n,r,o;switch(t.type){case"transition":return babelHelpers.extends({},e,{transition:(n=(r=t.payload)==null?void 0:r.transition)!=null?n:e.transition});case"push":return((o=t.payload)==null?void 0:o.step)==null?e:babelHelpers.extends({},e,{previousStep:e.stack[e.stack.length-1],stack:e.stack.concat(t.payload.step),activeKey:e.activeKey+1,ended:!1,isPushed:!0});case"pop":{var a,i,l=(a=(i=t.payload)==null?void 0:i.count)!=null?a:1,s=e.stack.slice(0,-l);return s.length>=1?babelHelpers.extends({},e,{previousStep:e.stack[e.stack.length-1],stack:s,activeKey:e.activeKey-l,isPushed:!1}):e.ended?e:babelHelpers.extends({},e,{ended:!0})}default:return e}}function S(e,t){var n=r("useWAWebUIM")(),o=t||{},a=o.transitions,i=a===void 0?C.None:a,l=o.onEnd,s=R(i),u=s.pushTransition,c=s.popTransition,d=f(v,{initialStep:e,initialTransition:u},b),h=d[0],S=d[1],L=g(null),E=m(function(e){S({type:"transition",payload:{transition:e}})},[]),k=m(function(e,t){t===void 0&&(t=u),E(t);var n=L.current;L.current=function(){n==null||n(),S({type:"push",payload:{step:e}})}},[u,E]),I=m(function(e,t){e===void 0&&(e=c),t===void 0&&(t=1),E(e),L.current=function(){return S({type:"pop",payload:{count:t}})}},[c,E]);p(function(){L.current!=null&&(L.current(),L.current=null)},void 0);var T=r("useWAWebStableCallback")(function(e){l?l(e):r("WANullthrows")(n).requestDismiss(e)}),D=r("useWAWebStableCallback")(function(){return h.stack.length});p(function(){h.ended&&T()},[T,h.ended]);var x=_(function(){return y()},[]),$={push:k,pop:I,end:T,stackSize:D,step:h.stack[h.stack.length-1],previousStep:h.previousStep,transition:h.transition,activeKey:h.activeKey,isPushed:h.isPushed};return[x,$]}function R(e){switch(e){case C.DrawerLeft:return{pushTransition:"flow-transition-drawer-pop",popTransition:"flow-transition-drawer-push"};case C.DrawerRight:return{pushTransition:"flow-transition-drawer-push",popTransition:"flow-transition-drawer-pop"};case C.Modal:return{pushTransition:"flow-transition-modal-push",popTransition:"flow-transition-modal-pop"};case C.None:return{pushTransition:"none",popTransition:"none"}}}l.FlowTransitions=C,l.useFlow=S}),98);
__d("useWAWebFocusOnMount",["WAWebFocusTracer","react"],(function(t,n,r,o,a,i,l){var e,s=e||(e=o("react")),u=s.useEffect,c=s.useRef;function d(){var e=c();return u(function(){r("WAWebFocusTracer").focus(e.current)},[]),e}l.default=d}),98);
__d("useWAWebGroupColors",["WALogger","WAWebThemeContext"],(function(t,n,r,o,a,i,l){var e,s="var(--wds-emerald-400)",u="var(--wds-sky-blue-300)",c="#e542a3",d="#a5b337",m="var(--wds-cobalt-400)",p="var(--wds-yellow-500)",_="var(--wds-green-500)",f="var(--wds-purple-400)",g="var(--wds-purple-500)",h="var(--wds-green-400)",y="var(--wds-orange-500)",C="var(--wds-pink-400)",b="#7d9ef1",v="var(--wds-orange-400)",S="var(--wds-teal-400)",R="#b4876e",L="var(--wds-yellow-400)",E="var(--wds-emerald-400)",k="var(--wds-sky-blue-300)",I="#e26ab6",T="#a5b337",D="var(--wds-orange-300)",x="var(--wds-cobalt-300)",$="var(--wds-yellow-400)",P="var(--wds-green-400)",N="var(--wds-purple-300)",M="var(--wds-red-300)",w="var(--wds-purple-400)",A="var(--wds-teal-300)",F="var(--wds-pink-300)",O="#d88deb",B="var(--wds-orange-400)",W="var(--wds-teal-400)",q="var(--wds-yellow-300)",U={color_light_1:{color:"xijeqtt",$$css:!0},color_light_2:{color:"xkgnp4b",$$css:!0},color_light_3:{color:"x240ipn",$$css:!0},color_light_4:{color:"xskf257",$$css:!0},color_light_5:{color:"xebwusc",$$css:!0},color_light_6:{color:"x3wc6wf",$$css:!0},color_light_7:{color:"x8s8ybf",$$css:!0},color_light_8:{color:"x162sf37",$$css:!0},color_light_9:{color:"x197m9ru",$$css:!0},color_light_10:{color:"x98wywu",$$css:!0},color_light_11:{color:"x1y1pzmv",$$css:!0},color_light_12:{color:"xkgndj",$$css:!0},color_light_13:{color:"x1454dyk",$$css:!0},color_light_14:{color:"xcwjfjl",$$css:!0},color_light_15:{color:"xgz8yji",$$css:!0},color_light_16:{color:"xyaa4h1",$$css:!0},color_light_17:{color:"x1n9d4q5",$$css:!0},background_light_1:{backgroundColor:"x6wgc6a",$$css:!0},background_light_2:{backgroundColor:"x17y5562",$$css:!0},background_light_3:{backgroundColor:"x1cu8r8a",$$css:!0},background_light_4:{backgroundColor:"xznryv8",$$css:!0},background_light_5:{backgroundColor:"x1n3fz2",$$css:!0},background_light_6:{backgroundColor:"xx4wtn9",$$css:!0},background_light_7:{backgroundColor:"x18a7xdx",$$css:!0},background_light_8:{backgroundColor:"x1vwqcvr",$$css:!0},background_light_9:{backgroundColor:"x1qcddwk",$$css:!0},background_light_10:{backgroundColor:"x1lrj34z",$$css:!0},background_light_11:{backgroundColor:"x1hvcrje",$$css:!0},background_light_12:{backgroundColor:"x1yh949v",$$css:!0},background_light_13:{backgroundColor:"x1tcvzfv",$$css:!0},background_light_14:{backgroundColor:"x1fu2t9j",$$css:!0},background_light_15:{backgroundColor:"x1fwelf4",$$css:!0},background_light_16:{backgroundColor:"xfhxl41",$$css:!0},background_light_17:{backgroundColor:"x18um00n",$$css:!0},color_dark_1:{color:"xijeqtt",$$css:!0},color_dark_2:{color:"xkgnp4b",$$css:!0},color_dark_3:{color:"x1hncw2u",$$css:!0},color_dark_4:{color:"xskf257",$$css:!0},color_dark_5:{color:"xs7ovuj",$$css:!0},color_dark_6:{color:"x1wxwh9x",$$css:!0},color_dark_7:{color:"x1n9d4q5",$$css:!0},color_dark_8:{color:"x98wywu",$$css:!0},color_dark_9:{color:"x18hhy9w",$$css:!0},color_dark_10:{color:"xbpqssb",$$css:!0},color_dark_11:{color:"x162sf37",$$css:!0},color_dark_12:{color:"x7y2iuh",$$css:!0},color_dark_13:{color:"xah1503",$$css:!0},color_dark_14:{color:"xyee0rz",$$css:!0},color_dark_15:{color:"xcwjfjl",$$css:!0},color_dark_16:{color:"xgz8yji",$$css:!0},color_dark_17:{color:"xly5uq6",$$css:!0},background_dark_1:{backgroundColor:"x6wgc6a",$$css:!0},background_dark_2:{backgroundColor:"x17y5562",$$css:!0},background_dark_3:{backgroundColor:"x1xd7cei",$$css:!0},background_dark_4:{backgroundColor:"xznryv8",$$css:!0},background_dark_5:{backgroundColor:"x3yiujs",$$css:!0},background_dark_6:{backgroundColor:"x1sim4je",$$css:!0},background_dark_7:{backgroundColor:"x18um00n",$$css:!0},background_dark_8:{backgroundColor:"x1lrj34z",$$css:!0},background_dark_9:{backgroundColor:"x1g15lxm",$$css:!0},background_dark_10:{backgroundColor:"x1jb1lhd",$$css:!0},background_dark_11:{backgroundColor:"x1vwqcvr",$$css:!0},background_dark_12:{backgroundColor:"xxln43k",$$css:!0},background_dark_13:{backgroundColor:"xcpx4u6",$$css:!0},background_dark_14:{backgroundColor:"x1vnpq5e",$$css:!0},background_dark_15:{backgroundColor:"x1fu2t9j",$$css:!0},background_dark_16:{backgroundColor:"x1fwelf4",$$css:!0},background_dark_17:{backgroundColor:"xd7yu05",$$css:!0}};function V(t,n,r){var a=U[n+"_"+r+"_"+t];return a==null&&(o("WALogger").WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(['Group color id "','" does not have a corresponding style'])),t),a=U[n+"_"+r+"_1"]),a}function H(e,t){var n=o("WAWebThemeContext").useTheme(),r=n.theme;return V(e,t,r)}function G(e){var t=o("WAWebThemeContext").useTheme(),n=t.theme;return n==="light"?z(e):j(e)}function z(e){switch(e){case 1:return[.024,.812,.612,1];case 2:return[.325,.741,.922,1];case 3:return[.898,.259,.639,1];case 4:return[.647,.702,.216,1];case 5:return[0,.482,.988,1];case 6:return[.773,.529,.188,1];case 7:return[.114,.667,.38,1];case 8:return[.498,.4,1,1];case 9:return[.369,.278,.871,1];case 10:return[.145,.827,.4,1];case 11:return[.769,.325,.176,1];case 12:return[1,.18,.455,1];case 13:return[.49,.62,.945,1];case 14:return[.98,.396,.2,1];case 15:return[.008,.651,.596,1];case 16:return[.706,.529,.431,1];case 17:return[1,.725,.22,1];default:return[.40000000596,.466666668653,.505882382393,1]}}function j(e){switch(e){case 1:return[.024,.812,.612,1];case 2:return[.325,.741,.922,1];case 3:return[.886,.416,.714,1];case 4:return[.647,.702,.216,1];case 5:return[.988,.592,.459,1];case 6:return[.325,.651,.992,1];case 7:return[1,.725,.22,1];case 8:return[.145,.827,.4,1];case 9:return[.655,.569,1,1];case 10:return[.984,.314,.38,1];case 11:return[.498,.4,1,1];case 12:return[.259,.78,.722,1];case 13:return[1,.447,.631,1];case 14:return[.847,.553,.922,1];case 15:return[.98,.396,.2,1];case 16:return[.008,.651,.596,1];case 17:return[1,.824,.475,1];default:return[.525490224361,.588235318661,.627451002598,1]}}l.useGroupsColorStyle=H,l.useGroupsColorRGBValue=G}),98);
__d("useWAWebInterval",["react","useWAWebStableCallback"],(function(t,n,r,o,a,i,l){var e,s=e||(e=o("react")),u=s.useCallback,c=s.useEffect,d=s.useRef;function m(e,t,n){t===void 0&&(t=0);var o=n!=null?n:{},a=o.immediate,i=a===void 0?!1:a,l=r("useWAWebStableCallback")(e),s=d(),m=u(function(){s.current&&self.clearInterval(s.current)},[]),p=u(function(){m(),s.current=self.setInterval(l,t)},[m,t,l]);return c(function(){return i&&p(),m},[i,p,m]),[p,m]}l.default=m}),98);